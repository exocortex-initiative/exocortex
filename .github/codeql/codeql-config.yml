# CodeQL Configuration for Exocortex
#
# This file configures CodeQL analysis to handle false positives and
# intentional security patterns required for SPARQL 1.1 specification compliance.

name: "Exocortex CodeQL Configuration"

# Path filters - include only source code, exclude tests and generated files
paths:
  - packages/*/src

paths-ignore:
  - "**/node_modules/**"
  - "**/dist/**"
  - "**/tests/**"
  - "**/specs/**"
  - "**/*.test.ts"
  - "**/*.test.tsx"
  - "**/*.spec.ts"
  - "packages/obsidian-plugin/main.js"      # Generated bundled output
  - "packages/obsidian-plugin/main.js.map"  # Source maps
  - "**/test-vault/**/main.js"              # Test vault generated plugin copy
  - "**/debug-main.js"                      # Debug builds
  - "**/debug-main.ts"                      # Debug builds

# NOTE: Query-level filtering is done via advanced-security/filter-sarif action
# in .github/workflows/codeql.yml to allow path-specific filtering.
#
# The filter-sarif action removes these known false positives:
# - js/weak-cryptographic-algorithm in BuiltInFunctions.ts (SPARQL 1.1 spec compliance)
# - js/insecure-randomness in BuiltInFunctions.ts (SPARQL 1.1 RAND() function)
# - js/trivial-conditional in main.js (minified bundled code artifacts)
#
# SECURITY CONTEXT:
# MD5 and SHA1 hash functions are required by W3C SPARQL 1.1 specification:
# - https://www.w3.org/TR/sparql11-query/#func-md5
# - https://www.w3.org/TR/sparql11-query/#func-sha1
#
# They are used ONLY for SPARQL query result hashing (non-security purpose),
# NOT for password hashing, authentication, or cryptographic security.
#
# Suppress warnings specific to generated/bundled files
# main.js is auto-generated by esbuild bundler and contains third-party code
# These rules are also filtered by path in codeql.yml filter-sarif step
query-filters:
  # Automatic semicolon insertion is common in minified code
  - exclude:
      id: js/automatic-semicolon-insertion
  # Useless expressions (property access with no effect) are minification artifacts
  # from bundled React/Preact code - these are not actual code quality issues
  - exclude:
      id: js/useless-expression
