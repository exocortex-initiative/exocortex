#!/usr/bin/env node
// @exocortex/cli v0.1.0
// CLI tool for Exocortex knowledge management system - SPARQL queries, task management, and more
// License: MIT

"use strict";var Aw=Object.create;var Ma=Object.defineProperty;var Cw=Object.getOwnPropertyDescriptor;var Ow=Object.getOwnPropertyNames;var Fw=Object.getPrototypeOf,Pw=Object.prototype.hasOwnProperty;var o=(r,e)=>Ma(r,"name",{value:e,configurable:!0});var Rw=(r,e)=>()=>(r&&(e=r(r=0)),e);var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Iw=(r,e)=>{for(var t in e)Ma(r,t,{get:e[t],enumerable:!0})},mg=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ow(e))!Pw.call(r,n)&&n!==t&&Ma(r,n,{get:()=>e[n],enumerable:!(i=Cw(e,n))||i.enumerable});return r};var Ke=(r,e,t)=>(t=r!=null?Aw(Fw(r)):{},mg(e||!r||!r.__esModule?Ma(t,"default",{value:r,enumerable:!0}):t,r)),Tf=r=>mg(Ma({},"__esModule",{value:!0}),r);var xf=y(()=>{var gg;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:c(),i=n(r);typeof t.Reflect<"u"&&(i=n(t.Reflect,i)),e(i,t),typeof t.Reflect>"u"&&(t.Reflect=r);function n(u,f){return function(l,h){Object.defineProperty(u,l,{configurable:!0,writable:!0,value:h}),f&&f(l,h)}}o(n,"makeExporter");function s(){try{return Function("return this;")()}catch{}}o(s,"functionThis");function a(){try{return(0,eval)("(function() { return this; })()")}catch{}}o(a,"indirectEvalThis");function c(){return s()||a()}o(c,"sloppyModeThis")})(function(e,t){var i=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",u={__proto__:[]}instanceof Array,f=!c&&!u,l={create:c?function(){return me(Object.create(null))}:u?function(){return me({__proto__:null})}:function(){return me({})},has:f?function(v,w){return i.call(v,w)}:function(v,w){return w in v},get:f?function(v,w){return i.call(v,w)?v[w]:void 0}:function(v,w){return v[w]}},h=Object.getPrototypeOf(Function),p=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:oe(),g=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:De(),S=typeof WeakMap=="function"?WeakMap:Fe(),_=n?Symbol.for("@reflect-metadata:registry"):void 0,A=ne(),F=se(A);function P(v,w,b,O){if(L(b)){if(!_e(v))throw new TypeError;if(!Se(w))throw new TypeError;return Ze(v,w)}else{if(!_e(v))throw new TypeError;if(!G(w))throw new TypeError;if(!G(O)&&!L(O)&&!le(O))throw new TypeError;return le(O)&&(O=void 0),b=ue(b),We(v,w,b,O)}}o(P,"decorate"),e("decorate",P);function j(v,w){function b(O,V){if(!G(O))throw new TypeError;if(!L(V)&&!Oe(V))throw new TypeError;W(v,w,O,V)}return o(b,"decorator"),b}o(j,"metadata"),e("metadata",j);function B(v,w,b,O){if(!G(b))throw new TypeError;return L(O)||(O=ue(O)),W(v,w,b,O)}o(B,"defineMetadata"),e("defineMetadata",B);function K(v,w,b){if(!G(w))throw new TypeError;return L(b)||(b=ue(b)),ze(v,w,b)}o(K,"hasMetadata"),e("hasMetadata",K);function Ie(v,w,b){if(!G(w))throw new TypeError;return L(b)||(b=ue(b)),Ne(v,w,b)}o(Ie,"hasOwnMetadata"),e("hasOwnMetadata",Ie);function Xe(v,w,b){if(!G(w))throw new TypeError;return L(b)||(b=ue(b)),ke(v,w,b)}o(Xe,"getMetadata"),e("getMetadata",Xe);function ot(v,w,b){if(!G(w))throw new TypeError;return L(b)||(b=ue(b)),Re(v,w,b)}o(ot,"getOwnMetadata"),e("getOwnMetadata",ot);function $(v,w){if(!G(v))throw new TypeError;return L(w)||(w=ue(w)),D(v,w)}o($,"getMetadataKeys"),e("getMetadataKeys",$);function ce(v,w){if(!G(v))throw new TypeError;return L(w)||(w=ue(w)),je(v,w)}o(ce,"getOwnMetadataKeys"),e("getOwnMetadataKeys",ce);function Pe(v,w,b){if(!G(w))throw new TypeError;if(L(b)||(b=ue(b)),!G(w))throw new TypeError;L(b)||(b=ue(b));var O=Y(w,b,!1);return L(O)?!1:O.OrdinaryDeleteMetadata(v,w,b)}o(Pe,"deleteMetadata"),e("deleteMetadata",Pe);function Ze(v,w){for(var b=v.length-1;b>=0;--b){var O=v[b],V=O(w);if(!L(V)&&!le(V)){if(!Se(V))throw new TypeError;w=V}}return w}o(Ze,"DecorateConstructor");function We(v,w,b,O){for(var V=v.length-1;V>=0;--V){var ge=v[V],Be=ge(w,b,O);if(!L(Be)&&!le(Be)){if(!G(Be))throw new TypeError;O=Be}}return O}o(We,"DecorateProperty");function ze(v,w,b){var O=Ne(v,w,b);if(O)return!0;var V=Q(w);return le(V)?!1:ze(v,V,b)}o(ze,"OrdinaryHasMetadata");function Ne(v,w,b){var O=Y(w,b,!1);return L(O)?!1:ve(O.OrdinaryHasOwnMetadata(v,w,b))}o(Ne,"OrdinaryHasOwnMetadata");function ke(v,w,b){var O=Ne(v,w,b);if(O)return Re(v,w,b);var V=Q(w);if(!le(V))return ke(v,V,b)}o(ke,"OrdinaryGetMetadata");function Re(v,w,b){var O=Y(w,b,!1);if(!L(O))return O.OrdinaryGetOwnMetadata(v,w,b)}o(Re,"OrdinaryGetOwnMetadata");function W(v,w,b,O){var V=Y(b,O,!0);V.OrdinaryDefineOwnMetadata(v,w,b,O)}o(W,"OrdinaryDefineOwnMetadata");function D(v,w){var b=je(v,w),O=Q(v);if(O===null)return b;var V=D(O,w);if(V.length<=0)return b;if(b.length<=0)return V;for(var ge=new g,Be=[],ye=0,N=b;ye<N.length;ye++){var k=N[ye],M=ge.has(k);M||(ge.add(k),Be.push(k))}for(var q=0,de=V;q<de.length;q++){var k=de[q],M=ge.has(k);M||(ge.add(k),Be.push(k))}return Be}o(D,"OrdinaryMetadataKeys");function je(v,w){var b=Y(v,w,!1);return b?b.OrdinaryOwnMetadataKeys(v,w):[]}o(je,"OrdinaryOwnMetadataKeys");function $e(v){if(v===null)return 1;switch(typeof v){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return v===null?1:6;default:return 6}}o($e,"Type");function L(v){return v===void 0}o(L,"IsUndefined");function le(v){return v===null}o(le,"IsNull");function Te(v){return typeof v=="symbol"}o(Te,"IsSymbol");function G(v){return typeof v=="object"?v!==null:typeof v=="function"}o(G,"IsObject");function xe(v,w){switch($e(v)){case 0:return v;case 1:return v;case 2:return v;case 3:return v;case 4:return v;case 5:return v}var b=w===3?"string":w===5?"number":"default",O=te(v,s);if(O!==void 0){var V=O.call(v,b);if(G(V))throw new TypeError;return V}return Ae(v,b==="default"?"number":b)}o(xe,"ToPrimitive");function Ae(v,w){if(w==="string"){var b=v.toString;if(fe(b)){var O=b.call(v);if(!G(O))return O}var V=v.valueOf;if(fe(V)){var O=V.call(v);if(!G(O))return O}}else{var V=v.valueOf;if(fe(V)){var O=V.call(v);if(!G(O))return O}var ge=v.toString;if(fe(ge)){var O=ge.call(v);if(!G(O))return O}}throw new TypeError}o(Ae,"OrdinaryToPrimitive");function ve(v){return!!v}o(ve,"ToBoolean");function Ce(v){return""+v}o(Ce,"ToString");function ue(v){var w=xe(v,3);return Te(w)?w:Ce(w)}o(ue,"ToPropertyKey");function _e(v){return Array.isArray?Array.isArray(v):v instanceof Object?v instanceof Array:Object.prototype.toString.call(v)==="[object Array]"}o(_e,"IsArray");function fe(v){return typeof v=="function"}o(fe,"IsCallable");function Se(v){return typeof v=="function"}o(Se,"IsConstructor");function Oe(v){switch($e(v)){case 3:return!0;case 4:return!0;default:return!1}}o(Oe,"IsPropertyKey");function J(v,w){return v===w||v!==v&&w!==w}o(J,"SameValueZero");function te(v,w){var b=v[w];if(b!=null){if(!fe(b))throw new TypeError;return b}}o(te,"GetMethod");function re(v){var w=te(v,a);if(!fe(w))throw new TypeError;var b=w.call(v);if(!G(b))throw new TypeError;return b}o(re,"GetIterator");function X(v){return v.value}o(X,"IteratorValue");function Z(v){var w=v.next();return w.done?!1:w}o(Z,"IteratorStep");function ee(v){var w=v.return;w&&w.call(v)}o(ee,"IteratorClose");function Q(v){var w=Object.getPrototypeOf(v);if(typeof v!="function"||v===h||w!==h)return w;var b=v.prototype,O=b&&Object.getPrototypeOf(b);if(O==null||O===Object.prototype)return w;var V=O.constructor;return typeof V!="function"||V===v?w:V}o(Q,"OrdinaryGetPrototypeOf");function ie(){var v;!L(_)&&typeof t.Reflect<"u"&&!(_ in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(v=ae(t.Reflect));var w,b,O,V=new S,ge={registerProvider:Be,getProvider:N,setProvider:M};return ge;function Be(q){if(!Object.isExtensible(ge))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case v===q:break;case L(w):w=q;break;case w===q:break;case L(b):b=q;break;case b===q:break;default:O===void 0&&(O=new g),O.add(q);break}}function ye(q,de){if(!L(w)){if(w.isProviderFor(q,de))return w;if(!L(b)){if(b.isProviderFor(q,de))return w;if(!L(O))for(var Le=re(O);;){var Me=Z(Le);if(!Me)return;var Ct=X(Me);if(Ct.isProviderFor(q,de))return ee(Le),Ct}}}if(!L(v)&&v.isProviderFor(q,de))return v}function N(q,de){var Le=V.get(q),Me;return L(Le)||(Me=Le.get(de)),L(Me)&&(Me=ye(q,de),L(Me)||(L(Le)&&(Le=new p,V.set(q,Le)),Le.set(de,Me))),Me}function k(q){if(L(q))throw new TypeError;return w===q||b===q||!L(O)&&O.has(q)}function M(q,de,Le){if(!k(Le))throw new Error("Metadata provider not registered.");var Me=N(q,de);if(Me!==Le){if(!L(Me))return!1;var Ct=V.get(q);L(Ct)&&(Ct=new p,V.set(q,Ct)),Ct.set(de,Le)}return!0}}o(ie,"CreateMetadataRegistry");function ne(){var v;return!L(_)&&G(t.Reflect)&&Object.isExtensible(t.Reflect)&&(v=t.Reflect[_]),L(v)&&(v=ie()),!L(_)&&G(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,_,{enumerable:!1,configurable:!1,writable:!1,value:v}),v}o(ne,"GetOrCreateMetadataRegistry");function se(v){var w=new S,b={isProviderFor:o(function(k,M){var q=w.get(k);return L(q)?!1:q.has(M)},"isProviderFor"),OrdinaryDefineOwnMetadata:Be,OrdinaryHasOwnMetadata:V,OrdinaryGetOwnMetadata:ge,OrdinaryOwnMetadataKeys:ye,OrdinaryDeleteMetadata:N};return A.registerProvider(b),b;function O(k,M,q){var de=w.get(k),Le=!1;if(L(de)){if(!q)return;de=new p,w.set(k,de),Le=!0}var Me=de.get(M);if(L(Me)){if(!q)return;if(Me=new p,de.set(M,Me),!v.setProvider(k,M,b))throw de.delete(M),Le&&w.delete(k),new Error("Wrong provider for target.")}return Me}o(O,"GetOrCreateMetadataMap");function V(k,M,q){var de=O(M,q,!1);return L(de)?!1:ve(de.has(k))}o(V,"OrdinaryHasOwnMetadata");function ge(k,M,q){var de=O(M,q,!1);if(!L(de))return de.get(k)}o(ge,"OrdinaryGetOwnMetadata");function Be(k,M,q,de){var Le=O(q,de,!0);Le.set(k,M)}o(Be,"OrdinaryDefineOwnMetadata");function ye(k,M){var q=[],de=O(k,M,!1);if(L(de))return q;for(var Le=de.keys(),Me=re(Le),Ct=0;;){var lr=Z(Me);if(!lr)return q.length=Ct,q;var _r=X(lr);try{q[Ct]=_r}catch(zt){try{ee(Me)}finally{throw zt}}Ct++}}o(ye,"OrdinaryOwnMetadataKeys");function N(k,M,q){var de=O(M,q,!1);if(L(de)||!de.delete(k))return!1;if(de.size===0){var Le=w.get(M);L(Le)||(Le.delete(q),Le.size===0&&w.delete(Le))}return!0}o(N,"OrdinaryDeleteMetadata")}o(se,"CreateMetadataProvider");function ae(v){var w=v.defineMetadata,b=v.hasOwnMetadata,O=v.getOwnMetadata,V=v.getOwnMetadataKeys,ge=v.deleteMetadata,Be=new S,ye={isProviderFor:o(function(N,k){var M=Be.get(N);return!L(M)&&M.has(k)?!0:V(N,k).length?(L(M)&&(M=new g,Be.set(N,M)),M.add(k),!0):!1},"isProviderFor"),OrdinaryDefineOwnMetadata:w,OrdinaryHasOwnMetadata:b,OrdinaryGetOwnMetadata:O,OrdinaryOwnMetadataKeys:V,OrdinaryDeleteMetadata:ge};return ye}o(ae,"CreateFallbackProvider");function Y(v,w,b){var O=A.getProvider(v,w);if(!L(O))return O;if(b){if(A.setProvider(v,w,F))return F;throw new Error("Illegal state.")}}o(Y,"GetMetadataProvider");function oe(){var v={},w=[],b=(function(){function ye(N,k,M){this._index=0,this._keys=N,this._values=k,this._selector=M}return o(ye,"MapIterator"),ye.prototype["@@iterator"]=function(){return this},ye.prototype[a]=function(){return this},ye.prototype.next=function(){var N=this._index;if(N>=0&&N<this._keys.length){var k=this._selector(this._keys[N],this._values[N]);return N+1>=this._keys.length?(this._index=-1,this._keys=w,this._values=w):this._index++,{value:k,done:!1}}return{value:void 0,done:!0}},ye.prototype.throw=function(N){throw this._index>=0&&(this._index=-1,this._keys=w,this._values=w),N},ye.prototype.return=function(N){return this._index>=0&&(this._index=-1,this._keys=w,this._values=w),{value:N,done:!0}},ye})(),O=(function(){function ye(){this._keys=[],this._values=[],this._cacheKey=v,this._cacheIndex=-2}return o(ye,"Map"),Object.defineProperty(ye.prototype,"size",{get:o(function(){return this._keys.length},"get"),enumerable:!0,configurable:!0}),ye.prototype.has=function(N){return this._find(N,!1)>=0},ye.prototype.get=function(N){var k=this._find(N,!1);return k>=0?this._values[k]:void 0},ye.prototype.set=function(N,k){var M=this._find(N,!0);return this._values[M]=k,this},ye.prototype.delete=function(N){var k=this._find(N,!1);if(k>=0){for(var M=this._keys.length,q=k+1;q<M;q++)this._keys[q-1]=this._keys[q],this._values[q-1]=this._values[q];return this._keys.length--,this._values.length--,J(N,this._cacheKey)&&(this._cacheKey=v,this._cacheIndex=-2),!0}return!1},ye.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=v,this._cacheIndex=-2},ye.prototype.keys=function(){return new b(this._keys,this._values,V)},ye.prototype.values=function(){return new b(this._keys,this._values,ge)},ye.prototype.entries=function(){return new b(this._keys,this._values,Be)},ye.prototype["@@iterator"]=function(){return this.entries()},ye.prototype[a]=function(){return this.entries()},ye.prototype._find=function(N,k){if(!J(this._cacheKey,N)){this._cacheIndex=-1;for(var M=0;M<this._keys.length;M++)if(J(this._keys[M],N)){this._cacheIndex=M;break}}return this._cacheIndex<0&&k&&(this._cacheIndex=this._keys.length,this._keys.push(N),this._values.push(void 0)),this._cacheIndex},ye})();return O;function V(ye,N){return ye}function ge(ye,N){return N}function Be(ye,N){return[ye,N]}}o(oe,"CreateMapPolyfill");function De(){var v=(function(){function w(){this._map=new p}return o(w,"Set"),Object.defineProperty(w.prototype,"size",{get:o(function(){return this._map.size},"get"),enumerable:!0,configurable:!0}),w.prototype.has=function(b){return this._map.has(b)},w.prototype.add=function(b){return this._map.set(b,b),this},w.prototype.delete=function(b){return this._map.delete(b)},w.prototype.clear=function(){this._map.clear()},w.prototype.keys=function(){return this._map.keys()},w.prototype.values=function(){return this._map.keys()},w.prototype.entries=function(){return this._map.entries()},w.prototype["@@iterator"]=function(){return this.keys()},w.prototype[a]=function(){return this.keys()},w})();return v}o(De,"CreateSetPolyfill");function Fe(){var v=16,w=l.create(),b=O();return(function(){function N(){this._key=O()}return o(N,"WeakMap"),N.prototype.has=function(k){var M=V(k,!1);return M!==void 0?l.has(M,this._key):!1},N.prototype.get=function(k){var M=V(k,!1);return M!==void 0?l.get(M,this._key):void 0},N.prototype.set=function(k,M){var q=V(k,!0);return q[this._key]=M,this},N.prototype.delete=function(k){var M=V(k,!1);return M!==void 0?delete M[this._key]:!1},N.prototype.clear=function(){this._key=O()},N})();function O(){var N;do N="@@WeakMap@@"+ye();while(l.has(w,N));return w[N]=!0,N}function V(N,k){if(!i.call(N,b)){if(!k)return;Object.defineProperty(N,b,{value:l.create()})}return N[b]}function ge(N,k){for(var M=0;M<k;++M)N[M]=Math.random()*255|0;return N}function Be(N){if(typeof Uint8Array=="function"){var k=new Uint8Array(N);return typeof crypto<"u"?crypto.getRandomValues(k):typeof msCrypto<"u"?msCrypto.getRandomValues(k):ge(k,N),k}return ge(new Array(N),N)}function ye(){var N=Be(v);N[6]=N[6]&79|64,N[8]=N[8]&191|128;for(var k="",M=0;M<v;++M){var q=N[M];(M===4||M===6||M===8)&&(k+="-"),q<16&&(k+="0"),k+=q.toString(16).toLowerCase()}return k}}o(Fe,"CreateWeakMapPolyfill");function me(v){return v.__=void 0,delete v.__,v}o(me,"MakeDictionary")})})(gg||(gg={}))});var Va=y(Cf=>{var yc=class extends Error{static{o(this,"CommanderError")}constructor(e,t,i){super(i),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=t,this.exitCode=e,this.nestedError=void 0}},Af=class extends yc{static{o(this,"InvalidArgumentError")}constructor(e){super(1,"commander.invalidArgument",e),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};Cf.CommanderError=yc;Cf.InvalidArgumentError=Af});var vc=y(Ff=>{var{InvalidArgumentError:Dw}=Va(),Of=class{static{o(this,"Argument")}constructor(e,t){switch(this.description=t||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,e[0]){case"<":this.required=!0,this._name=e.slice(1,-1);break;case"[":this.required=!1,this._name=e.slice(1,-1);break;default:this.required=!0,this._name=e;break}this._name.endsWith("...")&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_collectValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:(t.push(e),t)}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}argParser(e){return this.parseArg=e,this}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,i)=>{if(!this.argChoices.includes(t))throw new Dw(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(t,i):t},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function Nw(r){let e=r.name()+(r.variadic===!0?"...":"");return r.required?"<"+e+">":"["+e+"]"}o(Nw,"humanReadableArgName");Ff.Argument=Of;Ff.humanReadableArgName=Nw});var If=y(Rf=>{var{humanReadableArgName:kw}=vc(),Pf=class{static{o(this,"Help")}constructor(){this.helpWidth=void 0,this.minWidthToWrap=40,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}prepareContext(e){this.helpWidth=this.helpWidth??e.helpWidth??80}visibleCommands(e){let t=e.commands.filter(n=>!n._hidden),i=e._getHelpCommand();return i&&!i._hidden&&t.push(i),this.sortSubcommands&&t.sort((n,s)=>n.name().localeCompare(s.name())),t}compareOptions(e,t){let i=o(n=>n.short?n.short.replace(/^-/,""):n.long.replace(/^--/,""),"getSortKey");return i(e).localeCompare(i(t))}visibleOptions(e){let t=e.options.filter(n=>!n.hidden),i=e._getHelpOption();if(i&&!i.hidden){let n=i.short&&e._findOption(i.short),s=i.long&&e._findOption(i.long);!n&&!s?t.push(i):i.long&&!s?t.push(e.createOption(i.long,i.description)):i.short&&!n&&t.push(e.createOption(i.short,i.description))}return this.sortOptions&&t.sort(this.compareOptions),t}visibleGlobalOptions(e){if(!this.showGlobalOptions)return[];let t=[];for(let i=e.parent;i;i=i.parent){let n=i.options.filter(s=>!s.hidden);t.push(...n)}return this.sortOptions&&t.sort(this.compareOptions),t}visibleArguments(e){return e._argsDescription&&e.registeredArguments.forEach(t=>{t.description=t.description||e._argsDescription[t.name()]||""}),e.registeredArguments.find(t=>t.description)?e.registeredArguments:[]}subcommandTerm(e){let t=e.registeredArguments.map(i=>kw(i)).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}argumentTerm(e){return e.name()}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleSubcommandTerm(t.subcommandTerm(n)))),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleOptionTerm(t.optionTerm(n)))),0)}longestGlobalOptionTermLength(e,t){return t.visibleGlobalOptions(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleOptionTerm(t.optionTerm(n)))),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleArgumentTerm(t.argumentTerm(n)))),0)}commandUsage(e){let t=e._name;e._aliases[0]&&(t=t+"|"+e._aliases[0]);let i="";for(let n=e.parent;n;n=n.parent)i=n.name()+" "+i;return i+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.summary()||e.description()}optionDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),e.defaultValue!==void 0&&(e.required||e.optional||e.isBoolean()&&typeof e.defaultValue=="boolean")&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),e.presetArg!==void 0&&e.optional&&t.push(`preset: ${JSON.stringify(e.presetArg)}`),e.envVar!==void 0&&t.push(`env: ${e.envVar}`),t.length>0){let i=`(${t.join(", ")})`;return e.description?`${e.description} ${i}`:i}return e.description}argumentDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),e.defaultValue!==void 0&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),t.length>0){let i=`(${t.join(", ")})`;return e.description?`${e.description} ${i}`:i}return e.description}formatItemList(e,t,i){return t.length===0?[]:[i.styleTitle(e),...t,""]}groupItems(e,t,i){let n=new Map;return e.forEach(s=>{let a=i(s);n.has(a)||n.set(a,[])}),t.forEach(s=>{let a=i(s);n.has(a)||n.set(a,[]),n.get(a).push(s)}),n}formatHelp(e,t){let i=t.padWidth(e,t),n=t.helpWidth??80;function s(h,p){return t.formatItem(h,i,p,t)}o(s,"callFormatItem");let a=[`${t.styleTitle("Usage:")} ${t.styleUsage(t.commandUsage(e))}`,""],c=t.commandDescription(e);c.length>0&&(a=a.concat([t.boxWrap(t.styleCommandDescription(c),n),""]));let u=t.visibleArguments(e).map(h=>s(t.styleArgumentTerm(t.argumentTerm(h)),t.styleArgumentDescription(t.argumentDescription(h))));if(a=a.concat(this.formatItemList("Arguments:",u,t)),this.groupItems(e.options,t.visibleOptions(e),h=>h.helpGroupHeading??"Options:").forEach((h,p)=>{let g=h.map(S=>s(t.styleOptionTerm(t.optionTerm(S)),t.styleOptionDescription(t.optionDescription(S))));a=a.concat(this.formatItemList(p,g,t))}),t.showGlobalOptions){let h=t.visibleGlobalOptions(e).map(p=>s(t.styleOptionTerm(t.optionTerm(p)),t.styleOptionDescription(t.optionDescription(p))));a=a.concat(this.formatItemList("Global Options:",h,t))}return this.groupItems(e.commands,t.visibleCommands(e),h=>h.helpGroup()||"Commands:").forEach((h,p)=>{let g=h.map(S=>s(t.styleSubcommandTerm(t.subcommandTerm(S)),t.styleSubcommandDescription(t.subcommandDescription(S))));a=a.concat(this.formatItemList(p,g,t))}),a.join(`
`)}displayWidth(e){return yg(e).length}styleTitle(e){return e}styleUsage(e){return e.split(" ").map(t=>t==="[options]"?this.styleOptionText(t):t==="[command]"?this.styleSubcommandText(t):t[0]==="["||t[0]==="<"?this.styleArgumentText(t):this.styleCommandText(t)).join(" ")}styleCommandDescription(e){return this.styleDescriptionText(e)}styleOptionDescription(e){return this.styleDescriptionText(e)}styleSubcommandDescription(e){return this.styleDescriptionText(e)}styleArgumentDescription(e){return this.styleDescriptionText(e)}styleDescriptionText(e){return e}styleOptionTerm(e){return this.styleOptionText(e)}styleSubcommandTerm(e){return e.split(" ").map(t=>t==="[options]"?this.styleOptionText(t):t[0]==="["||t[0]==="<"?this.styleArgumentText(t):this.styleSubcommandText(t)).join(" ")}styleArgumentTerm(e){return this.styleArgumentText(e)}styleOptionText(e){return e}styleArgumentText(e){return e}styleSubcommandText(e){return e}styleCommandText(e){return e}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestGlobalOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}preformatted(e){return/\n[^\S\r\n]/.test(e)}formatItem(e,t,i,n){let a=" ".repeat(2);if(!i)return a+e;let c=e.padEnd(t+e.length-n.displayWidth(e)),u=2,l=(this.helpWidth??80)-t-u-2,h;return l<this.minWidthToWrap||n.preformatted(i)?h=i:h=n.boxWrap(i,l).replace(/\n/g,`
`+" ".repeat(t+u)),a+c+" ".repeat(u)+h.replace(/\n/g,`
${a}`)}boxWrap(e,t){if(t<this.minWidthToWrap)return e;let i=e.split(/\r\n|\n/),n=/[\s]*[^\s]+/g,s=[];return i.forEach(a=>{let c=a.match(n);if(c===null){s.push("");return}let u=[c.shift()],f=this.displayWidth(u[0]);c.forEach(l=>{let h=this.displayWidth(l);if(f+h<=t){u.push(l),f+=h;return}s.push(u.join(""));let p=l.trimStart();u=[p],f=this.displayWidth(p)}),s.push(u.join(""))}),s.join(`
`)}};function yg(r){let e=/\x1b\[\d*(;\d*)*m/g;return r.replace(e,"")}o(yg,"stripColor");Rf.Help=Pf;Rf.stripColor=yg});var jf=y(kf=>{var{InvalidArgumentError:jw}=Va(),Df=class{static{o(this,"Option")}constructor(e,t){this.flags=e,this.description=t||"",this.required=e.includes("<"),this.optional=e.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(e),this.mandatory=!1;let i=Lw(e);this.short=i.shortFlag,this.long=i.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0,this.helpGroupHeading=void 0}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}preset(e){return this.presetArg=e,this}conflicts(e){return this.conflictsWith=this.conflictsWith.concat(e),this}implies(e){let t=e;return typeof e=="string"&&(t={[e]:!0}),this.implied=Object.assign(this.implied||{},t),this}env(e){return this.envVar=e,this}argParser(e){return this.parseArg=e,this}makeOptionMandatory(e=!0){return this.mandatory=!!e,this}hideHelp(e=!0){return this.hidden=!!e,this}_collectValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:(t.push(e),t)}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,i)=>{if(!this.argChoices.includes(t))throw new jw(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(t,i):t},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return this.negate?vg(this.name().replace(/^no-/,"")):vg(this.name())}helpGroup(e){return this.helpGroupHeading=e,this}is(e){return this.short===e||this.long===e}isBoolean(){return!this.required&&!this.optional&&!this.negate}},Nf=class{static{o(this,"DualOptions")}constructor(e){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,e.forEach(t=>{t.negate?this.negativeOptions.set(t.attributeName(),t):this.positiveOptions.set(t.attributeName(),t)}),this.negativeOptions.forEach((t,i)=>{this.positiveOptions.has(i)&&this.dualOptions.add(i)})}valueFromOption(e,t){let i=t.attributeName();if(!this.dualOptions.has(i))return!0;let n=this.negativeOptions.get(i).presetArg,s=n!==void 0?n:!1;return t.negate===(s===e)}};function vg(r){return r.split("-").reduce((e,t)=>e+t[0].toUpperCase()+t.slice(1))}o(vg,"camelcase");function Lw(r){let e,t,i=/^-[^-]$/,n=/^--[^-]/,s=r.split(/[ |,]+/).concat("guard");if(i.test(s[0])&&(e=s.shift()),n.test(s[0])&&(t=s.shift()),!e&&i.test(s[0])&&(e=s.shift()),!e&&n.test(s[0])&&(e=t,t=s.shift()),s[0].startsWith("-")){let a=s[0],c=`option creation failed due to '${a}' in option flags '${r}'`;throw/^-[^-][^-]/.test(a)?new Error(`${c}
- a short flag is a single dash and a single character
  - either use a single dash and a single character (for a short flag)
  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`):i.test(a)?new Error(`${c}
- too many short flags`):n.test(a)?new Error(`${c}
- too many long flags`):new Error(`${c}
- unrecognised flag format`)}if(e===void 0&&t===void 0)throw new Error(`option creation failed due to no flags found in '${r}'.`);return{shortFlag:e,longFlag:t}}o(Lw,"splitOptionFlags");kf.Option=Df;kf.DualOptions=Nf});var Sg=y(_g=>{function Mw(r,e){if(Math.abs(r.length-e.length)>3)return Math.max(r.length,e.length);let t=[];for(let i=0;i<=r.length;i++)t[i]=[i];for(let i=0;i<=e.length;i++)t[0][i]=i;for(let i=1;i<=e.length;i++)for(let n=1;n<=r.length;n++){let s=1;r[n-1]===e[i-1]?s=0:s=1,t[n][i]=Math.min(t[n-1][i]+1,t[n][i-1]+1,t[n-1][i-1]+s),n>1&&i>1&&r[n-1]===e[i-2]&&r[n-2]===e[i-1]&&(t[n][i]=Math.min(t[n][i],t[n-2][i-2]+1))}return t[r.length][e.length]}o(Mw,"editDistance");function Vw(r,e){if(!e||e.length===0)return"";e=Array.from(new Set(e));let t=r.startsWith("--");t&&(r=r.slice(2),e=e.map(a=>a.slice(2)));let i=[],n=3,s=.4;return e.forEach(a=>{if(a.length<=1)return;let c=Mw(r,a),u=Math.max(r.length,a.length);(u-c)/u>s&&(c<n?(n=c,i=[a]):c===n&&i.push(a))}),i.sort((a,c)=>a.localeCompare(c)),t&&(i=i.map(a=>`--${a}`)),i.length>1?`
(Did you mean one of ${i.join(", ")}?)`:i.length===1?`
(Did you mean ${i[0]}?)`:""}o(Vw,"suggestSimilar");_g.suggestSimilar=Vw});var Tg=y($f=>{var qw=require("node:events").EventEmitter,Lf=require("node:child_process"),Gi=require("node:path"),_c=require("node:fs"),qe=require("node:process"),{Argument:$w,humanReadableArgName:Uw}=vc(),{CommanderError:Mf}=Va(),{Help:Bw,stripColor:Gw}=If(),{Option:wg,DualOptions:Ww}=jf(),{suggestSimilar:bg}=Sg(),Vf=class r extends qw{static{o(this,"Command")}constructor(e){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!1,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=e||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._savedState=null,this._outputConfiguration={writeOut:o(t=>qe.stdout.write(t),"writeOut"),writeErr:o(t=>qe.stderr.write(t),"writeErr"),outputError:o((t,i)=>i(t),"outputError"),getOutHelpWidth:o(()=>qe.stdout.isTTY?qe.stdout.columns:void 0,"getOutHelpWidth"),getErrHelpWidth:o(()=>qe.stderr.isTTY?qe.stderr.columns:void 0,"getErrHelpWidth"),getOutHasColors:o(()=>qf()??(qe.stdout.isTTY&&qe.stdout.hasColors?.()),"getOutHasColors"),getErrHasColors:o(()=>qf()??(qe.stderr.isTTY&&qe.stderr.hasColors?.()),"getErrHasColors"),stripColor:o(t=>Gw(t),"stripColor")},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={},this._helpGroupHeading=void 0,this._defaultCommandGroup=void 0,this._defaultOptionGroup=void 0}copyInheritedSettings(e){return this._outputConfiguration=e._outputConfiguration,this._helpOption=e._helpOption,this._helpCommand=e._helpCommand,this._helpConfiguration=e._helpConfiguration,this._exitCallback=e._exitCallback,this._storeOptionsAsProperties=e._storeOptionsAsProperties,this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue,this._allowExcessArguments=e._allowExcessArguments,this._enablePositionalOptions=e._enablePositionalOptions,this._showHelpAfterError=e._showHelpAfterError,this._showSuggestionAfterError=e._showSuggestionAfterError,this}_getCommandAndAncestors(){let e=[];for(let t=this;t;t=t.parent)e.push(t);return e}command(e,t,i){let n=t,s=i;typeof n=="object"&&n!==null&&(s=n,n=null),s=s||{};let[,a,c]=e.match(/([^ ]+) *(.*)/),u=this.createCommand(a);return n&&(u.description(n),u._executableHandler=!0),s.isDefault&&(this._defaultCommandName=u._name),u._hidden=!!(s.noHelp||s.hidden),u._executableFile=s.executableFile||null,c&&u.arguments(c),this._registerCommand(u),u.parent=this,u.copyInheritedSettings(this),n?this:u}createCommand(e){return new r(e)}createHelp(){return Object.assign(new Bw,this.configureHelp())}configureHelp(e){return e===void 0?this._helpConfiguration:(this._helpConfiguration=e,this)}configureOutput(e){return e===void 0?this._outputConfiguration:(this._outputConfiguration={...this._outputConfiguration,...e},this)}showHelpAfterError(e=!0){return typeof e!="string"&&(e=!!e),this._showHelpAfterError=e,this}showSuggestionAfterError(e=!0){return this._showSuggestionAfterError=!!e,this}addCommand(e,t){if(!e._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return t=t||{},t.isDefault&&(this._defaultCommandName=e._name),(t.noHelp||t.hidden)&&(e._hidden=!0),this._registerCommand(e),e.parent=this,e._checkForBrokenPassThrough(),this}createArgument(e,t){return new $w(e,t)}argument(e,t,i,n){let s=this.createArgument(e,t);return typeof i=="function"?s.default(n).argParser(i):s.default(i),this.addArgument(s),this}arguments(e){return e.trim().split(/ +/).forEach(t=>{this.argument(t)}),this}addArgument(e){let t=this.registeredArguments.slice(-1)[0];if(t?.variadic)throw new Error(`only the last argument can be variadic '${t.name()}'`);if(e.required&&e.defaultValue!==void 0&&e.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${e.name()}'`);return this.registeredArguments.push(e),this}helpCommand(e,t){if(typeof e=="boolean")return this._addImplicitHelpCommand=e,e&&this._defaultCommandGroup&&this._initCommandGroup(this._getHelpCommand()),this;let i=e??"help [command]",[,n,s]=i.match(/([^ ]+) *(.*)/),a=t??"display help for command",c=this.createCommand(n);return c.helpOption(!1),s&&c.arguments(s),a&&c.description(a),this._addImplicitHelpCommand=!0,this._helpCommand=c,(e||t)&&this._initCommandGroup(c),this}addHelpCommand(e,t){return typeof e!="object"?(this.helpCommand(e,t),this):(this._addImplicitHelpCommand=!0,this._helpCommand=e,this._initCommandGroup(e),this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(e,t){let i=["preSubcommand","preAction","postAction"];if(!i.includes(e))throw new Error(`Unexpected value for event passed to hook : '${e}'.
Expecting one of '${i.join("', '")}'`);return this._lifeCycleHooks[e]?this._lifeCycleHooks[e].push(t):this._lifeCycleHooks[e]=[t],this}exitOverride(e){return e?this._exitCallback=e:this._exitCallback=t=>{if(t.code!=="commander.executeSubCommandAsync")throw t},this}_exit(e,t,i){this._exitCallback&&this._exitCallback(new Mf(e,t,i)),qe.exit(e)}action(e){let t=o(i=>{let n=this.registeredArguments.length,s=i.slice(0,n);return this._storeOptionsAsProperties?s[n]=this:s[n]=this.opts(),s.push(this),e.apply(this,s)},"listener");return this._actionHandler=t,this}createOption(e,t){return new wg(e,t)}_callParseArg(e,t,i,n){try{return e.parseArg(t,i)}catch(s){if(s.code==="commander.invalidArgument"){let a=`${n} ${s.message}`;this.error(a,{exitCode:s.exitCode,code:s.code})}throw s}}_registerOption(e){let t=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(t){let i=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${i}'
-  already used by option '${t.flags}'`)}this._initOptionGroup(e),this.options.push(e)}_registerCommand(e){let t=o(n=>[n.name()].concat(n.aliases()),"knownBy"),i=t(e).find(n=>this._findCommand(n));if(i){let n=t(this._findCommand(i)).join("|"),s=t(e).join("|");throw new Error(`cannot add command '${s}' as already have command '${n}'`)}this._initCommandGroup(e),this.commands.push(e)}addOption(e){this._registerOption(e);let t=e.name(),i=e.attributeName();if(e.negate){let s=e.long.replace(/^--no-/,"--");this._findOption(s)||this.setOptionValueWithSource(i,e.defaultValue===void 0?!0:e.defaultValue,"default")}else e.defaultValue!==void 0&&this.setOptionValueWithSource(i,e.defaultValue,"default");let n=o((s,a,c)=>{s==null&&e.presetArg!==void 0&&(s=e.presetArg);let u=this.getOptionValue(i);s!==null&&e.parseArg?s=this._callParseArg(e,s,u,a):s!==null&&e.variadic&&(s=e._collectValue(s,u)),s==null&&(e.negate?s=!1:e.isBoolean()||e.optional?s=!0:s=""),this.setOptionValueWithSource(i,s,c)},"handleOptionValue");return this.on("option:"+t,s=>{let a=`error: option '${e.flags}' argument '${s}' is invalid.`;n(s,a,"cli")}),e.envVar&&this.on("optionEnv:"+t,s=>{let a=`error: option '${e.flags}' value '${s}' from env '${e.envVar}' is invalid.`;n(s,a,"env")}),this}_optionEx(e,t,i,n,s){if(typeof t=="object"&&t instanceof wg)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let a=this.createOption(t,i);if(a.makeOptionMandatory(!!e.mandatory),typeof n=="function")a.default(s).argParser(n);else if(n instanceof RegExp){let c=n;n=o((u,f)=>{let l=c.exec(u);return l?l[0]:f},"fn"),a.default(s).argParser(n)}else a.default(n);return this.addOption(a)}option(e,t,i,n){return this._optionEx({},e,t,i,n)}requiredOption(e,t,i,n){return this._optionEx({mandatory:!0},e,t,i,n)}combineFlagAndOptionalValue(e=!0){return this._combineFlagAndOptionalValue=!!e,this}allowUnknownOption(e=!0){return this._allowUnknownOption=!!e,this}allowExcessArguments(e=!0){return this._allowExcessArguments=!!e,this}enablePositionalOptions(e=!0){return this._enablePositionalOptions=!!e,this}passThroughOptions(e=!0){return this._passThroughOptions=!!e,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(e=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!e,this}getOptionValue(e){return this._storeOptionsAsProperties?this[e]:this._optionValues[e]}setOptionValue(e,t){return this.setOptionValueWithSource(e,t,void 0)}setOptionValueWithSource(e,t,i){return this._storeOptionsAsProperties?this[e]=t:this._optionValues[e]=t,this._optionValueSources[e]=i,this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let t;return this._getCommandAndAncestors().forEach(i=>{i.getOptionValueSource(e)!==void 0&&(t=i.getOptionValueSource(e))}),t}_prepareUserArgs(e,t){if(e!==void 0&&!Array.isArray(e))throw new Error("first parameter to parse must be array or undefined");if(t=t||{},e===void 0&&t.from===void 0){qe.versions?.electron&&(t.from="electron");let n=qe.execArgv??[];(n.includes("-e")||n.includes("--eval")||n.includes("-p")||n.includes("--print"))&&(t.from="eval")}e===void 0&&(e=qe.argv),this.rawArgs=e.slice();let i;switch(t.from){case void 0:case"node":this._scriptPath=e[1],i=e.slice(2);break;case"electron":qe.defaultApp?(this._scriptPath=e[1],i=e.slice(2)):i=e.slice(1);break;case"user":i=e.slice(0);break;case"eval":i=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",i}parse(e,t){this._prepareForParse();let i=this._prepareUserArgs(e,t);return this._parseCommand([],i),this}async parseAsync(e,t){this._prepareForParse();let i=this._prepareUserArgs(e,t);return await this._parseCommand([],i),this}_prepareForParse(){this._savedState===null?this.saveStateBeforeParse():this.restoreStateBeforeParse()}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.
- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name,this._scriptPath=null,this.rawArgs=[],this._optionValues={...this._savedState._optionValues},this._optionValueSources={...this._savedState._optionValueSources},this.args=[],this.processedArgs=[]}_checkForMissingExecutable(e,t,i){if(_c.existsSync(e))return;let n=t?`searched for local subcommand relative to directory '${t}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",s=`'${e}' does not exist
 - if '${i}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${n}`;throw new Error(s)}_executeSubCommand(e,t){t=t.slice();let i=!1,n=[".js",".ts",".tsx",".mjs",".cjs"];function s(l,h){let p=Gi.resolve(l,h);if(_c.existsSync(p))return p;if(n.includes(Gi.extname(h)))return;let g=n.find(S=>_c.existsSync(`${p}${S}`));if(g)return`${p}${g}`}o(s,"findFile"),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let a=e._executableFile||`${this._name}-${e._name}`,c=this._executableDir||"";if(this._scriptPath){let l;try{l=_c.realpathSync(this._scriptPath)}catch{l=this._scriptPath}c=Gi.resolve(Gi.dirname(l),c)}if(c){let l=s(c,a);if(!l&&!e._executableFile&&this._scriptPath){let h=Gi.basename(this._scriptPath,Gi.extname(this._scriptPath));h!==this._name&&(l=s(c,`${h}-${e._name}`))}a=l||a}i=n.includes(Gi.extname(a));let u;qe.platform!=="win32"?i?(t.unshift(a),t=Eg(qe.execArgv).concat(t),u=Lf.spawn(qe.argv[0],t,{stdio:"inherit"})):u=Lf.spawn(a,t,{stdio:"inherit"}):(this._checkForMissingExecutable(a,c,e._name),t.unshift(a),t=Eg(qe.execArgv).concat(t),u=Lf.spawn(qe.execPath,t,{stdio:"inherit"})),u.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(h=>{qe.on(h,()=>{u.killed===!1&&u.exitCode===null&&u.kill(h)})});let f=this._exitCallback;u.on("close",l=>{l=l??1,f?f(new Mf(l,"commander.executeSubCommandAsync","(close)")):qe.exit(l)}),u.on("error",l=>{if(l.code==="ENOENT")this._checkForMissingExecutable(a,c,e._name);else if(l.code==="EACCES")throw new Error(`'${a}' not executable`);if(!f)qe.exit(1);else{let h=new Mf(1,"commander.executeSubCommandAsync","(error)");h.nestedError=l,f(h)}}),this.runningCommand=u}_dispatchSubcommand(e,t,i){let n=this._findCommand(e);n||this.help({error:!0}),n._prepareForParse();let s;return s=this._chainOrCallSubCommandHook(s,n,"preSubcommand"),s=this._chainOrCall(s,()=>{if(n._executableHandler)this._executeSubCommand(n,t.concat(i));else return n._parseCommand(t,i)}),s}_dispatchHelpCommand(e){e||this.help();let t=this._findCommand(e);return t&&!t._executableHandler&&t.help(),this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((e,t)=>{e.required&&this.args[t]==null&&this.missingArgument(e.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){let e=o((i,n,s)=>{let a=n;if(n!==null&&i.parseArg){let c=`error: command-argument value '${n}' is invalid for argument '${i.name()}'.`;a=this._callParseArg(i,n,s,c)}return a},"myParseArg");this._checkNumberOfArguments();let t=[];this.registeredArguments.forEach((i,n)=>{let s=i.defaultValue;i.variadic?n<this.args.length?(s=this.args.slice(n),i.parseArg&&(s=s.reduce((a,c)=>e(i,c,a),i.defaultValue))):s===void 0&&(s=[]):n<this.args.length&&(s=this.args[n],i.parseArg&&(s=e(i,s,i.defaultValue))),t[n]=s}),this.processedArgs=t}_chainOrCall(e,t){return e?.then&&typeof e.then=="function"?e.then(()=>t()):t()}_chainOrCallHooks(e,t){let i=e,n=[];return this._getCommandAndAncestors().reverse().filter(s=>s._lifeCycleHooks[t]!==void 0).forEach(s=>{s._lifeCycleHooks[t].forEach(a=>{n.push({hookedCommand:s,callback:a})})}),t==="postAction"&&n.reverse(),n.forEach(s=>{i=this._chainOrCall(i,()=>s.callback(s.hookedCommand,this))}),i}_chainOrCallSubCommandHook(e,t,i){let n=e;return this._lifeCycleHooks[i]!==void 0&&this._lifeCycleHooks[i].forEach(s=>{n=this._chainOrCall(n,()=>s(this,t))}),n}_parseCommand(e,t){let i=this.parseOptions(t);if(this._parseOptionsEnv(),this._parseOptionsImplied(),e=e.concat(i.operands),t=i.unknown,this.args=e.concat(t),e&&this._findCommand(e[0]))return this._dispatchSubcommand(e[0],e.slice(1),t);if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(e[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(t),this._dispatchSubcommand(this._defaultCommandName,e,t);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(i.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let n=o(()=>{i.unknown.length>0&&this.unknownOption(i.unknown[0])},"checkForUnknownOptions"),s=`command:${this.name()}`;if(this._actionHandler){n(),this._processArguments();let a;return a=this._chainOrCallHooks(a,"preAction"),a=this._chainOrCall(a,()=>this._actionHandler(this.processedArgs)),this.parent&&(a=this._chainOrCall(a,()=>{this.parent.emit(s,e,t)})),a=this._chainOrCallHooks(a,"postAction"),a}if(this.parent?.listenerCount(s))n(),this._processArguments(),this.parent.emit(s,e,t);else if(e.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",e,t);this.listenerCount("command:*")?this.emit("command:*",e,t):this.commands.length?this.unknownCommand():(n(),this._processArguments())}else this.commands.length?(n(),this.help({error:!0})):(n(),this._processArguments())}_findCommand(e){if(e)return this.commands.find(t=>t._name===e||t._aliases.includes(e))}_findOption(e){return this.options.find(t=>t.is(e))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(e=>{e.options.forEach(t=>{t.mandatory&&e.getOptionValue(t.attributeName())===void 0&&e.missingMandatoryOptionValue(t)})})}_checkForConflictingLocalOptions(){let e=this.options.filter(i=>{let n=i.attributeName();return this.getOptionValue(n)===void 0?!1:this.getOptionValueSource(n)!=="default"});e.filter(i=>i.conflictsWith.length>0).forEach(i=>{let n=e.find(s=>i.conflictsWith.includes(s.attributeName()));n&&this._conflictingOption(i,n)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(e=>{e._checkForConflictingLocalOptions()})}parseOptions(e){let t=[],i=[],n=t;function s(l){return l.length>1&&l[0]==="-"}o(s,"maybeOption");let a=o(l=>/^-(\d+|\d*\.\d+)(e[+-]?\d+)?$/.test(l)?!this._getCommandAndAncestors().some(h=>h.options.map(p=>p.short).some(p=>/^-\d$/.test(p))):!1,"negativeNumberArg"),c=null,u=null,f=0;for(;f<e.length||u;){let l=u??e[f++];if(u=null,l==="--"){n===i&&n.push(l),n.push(...e.slice(f));break}if(c&&(!s(l)||a(l))){this.emit(`option:${c.name()}`,l);continue}if(c=null,s(l)){let h=this._findOption(l);if(h){if(h.required){let p=e[f++];p===void 0&&this.optionMissingArgument(h),this.emit(`option:${h.name()}`,p)}else if(h.optional){let p=null;f<e.length&&(!s(e[f])||a(e[f]))&&(p=e[f++]),this.emit(`option:${h.name()}`,p)}else this.emit(`option:${h.name()}`);c=h.variadic?h:null;continue}}if(l.length>2&&l[0]==="-"&&l[1]!=="-"){let h=this._findOption(`-${l[1]}`);if(h){h.required||h.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${h.name()}`,l.slice(2)):(this.emit(`option:${h.name()}`),u=`-${l.slice(2)}`);continue}}if(/^--[^=]+=/.test(l)){let h=l.indexOf("="),p=this._findOption(l.slice(0,h));if(p&&(p.required||p.optional)){this.emit(`option:${p.name()}`,l.slice(h+1));continue}}if(n===t&&s(l)&&!(this.commands.length===0&&a(l))&&(n=i),(this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&i.length===0){if(this._findCommand(l)){t.push(l),i.push(...e.slice(f));break}else if(this._getHelpCommand()&&l===this._getHelpCommand().name()){t.push(l,...e.slice(f));break}else if(this._defaultCommandName){i.push(l,...e.slice(f));break}}if(this._passThroughOptions){n.push(l,...e.slice(f));break}n.push(l)}return{operands:t,unknown:i}}opts(){if(this._storeOptionsAsProperties){let e={},t=this.options.length;for(let i=0;i<t;i++){let n=this.options[i].attributeName();e[n]=n===this._versionOptionName?this._version:this[n]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((e,t)=>Object.assign(e,t.opts()),{})}error(e,t){this._outputConfiguration.outputError(`${e}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));let i=t||{},n=i.exitCode||1,s=i.code||"commander.error";this._exit(n,s,e)}_parseOptionsEnv(){this.options.forEach(e=>{if(e.envVar&&e.envVar in qe.env){let t=e.attributeName();(this.getOptionValue(t)===void 0||["default","config","env"].includes(this.getOptionValueSource(t)))&&(e.required||e.optional?this.emit(`optionEnv:${e.name()}`,qe.env[e.envVar]):this.emit(`optionEnv:${e.name()}`))}})}_parseOptionsImplied(){let e=new Ww(this.options),t=o(i=>this.getOptionValue(i)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(i)),"hasCustomOptionValue");this.options.filter(i=>i.implied!==void 0&&t(i.attributeName())&&e.valueFromOption(this.getOptionValue(i.attributeName()),i)).forEach(i=>{Object.keys(i.implied).filter(n=>!t(n)).forEach(n=>{this.setOptionValueWithSource(n,i.implied[n],"implied")})})}missingArgument(e){let t=`error: missing required argument '${e}'`;this.error(t,{code:"commander.missingArgument"})}optionMissingArgument(e){let t=`error: option '${e.flags}' argument missing`;this.error(t,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){let t=`error: required option '${e.flags}' not specified`;this.error(t,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,t){let i=o(a=>{let c=a.attributeName(),u=this.getOptionValue(c),f=this.options.find(h=>h.negate&&c===h.attributeName()),l=this.options.find(h=>!h.negate&&c===h.attributeName());return f&&(f.presetArg===void 0&&u===!1||f.presetArg!==void 0&&u===f.presetArg)?f:l||a},"findBestOptionFromValue"),n=o(a=>{let c=i(a),u=c.attributeName();return this.getOptionValueSource(u)==="env"?`environment variable '${c.envVar}'`:`option '${c.flags}'`},"getErrorMessage"),s=`error: ${n(e)} cannot be used with ${n(t)}`;this.error(s,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let t="";if(e.startsWith("--")&&this._showSuggestionAfterError){let n=[],s=this;do{let a=s.createHelp().visibleOptions(s).filter(c=>c.long).map(c=>c.long);n=n.concat(a),s=s.parent}while(s&&!s._enablePositionalOptions);t=bg(e,n)}let i=`error: unknown option '${e}'${t}`;this.error(i,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;let t=this.registeredArguments.length,i=t===1?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${t} argument${i} but got ${e.length}.`;this.error(s,{code:"commander.excessArguments"})}unknownCommand(){let e=this.args[0],t="";if(this._showSuggestionAfterError){let n=[];this.createHelp().visibleCommands(this).forEach(s=>{n.push(s.name()),s.alias()&&n.push(s.alias())}),t=bg(e,n)}let i=`error: unknown command '${e}'${t}`;this.error(i,{code:"commander.unknownCommand"})}version(e,t,i){if(e===void 0)return this._version;this._version=e,t=t||"-V, --version",i=i||"output the version number";let n=this.createOption(t,i);return this._versionOptionName=n.attributeName(),this._registerOption(n),this.on("option:"+n.name(),()=>{this._outputConfiguration.writeOut(`${e}
`),this._exit(0,"commander.version",e)}),this}description(e,t){return e===void 0&&t===void 0?this._description:(this._description=e,t&&(this._argsDescription=t),this)}summary(e){return e===void 0?this._summary:(this._summary=e,this)}alias(e){if(e===void 0)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(t=this.commands[this.commands.length-1]),e===t._name)throw new Error("Command alias can't be the same as its name");let i=this.parent?._findCommand(e);if(i){let n=[i.name()].concat(i.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${n}'`)}return t._aliases.push(e),this}aliases(e){return e===void 0?this._aliases:(e.forEach(t=>this.alias(t)),this)}usage(e){if(e===void 0){if(this._usage)return this._usage;let t=this.registeredArguments.map(i=>Uw(i));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?t:[]).join(" ")}return this._usage=e,this}name(e){return e===void 0?this._name:(this._name=e,this)}helpGroup(e){return e===void 0?this._helpGroupHeading??"":(this._helpGroupHeading=e,this)}commandsGroup(e){return e===void 0?this._defaultCommandGroup??"":(this._defaultCommandGroup=e,this)}optionsGroup(e){return e===void 0?this._defaultOptionGroup??"":(this._defaultOptionGroup=e,this)}_initOptionGroup(e){this._defaultOptionGroup&&!e.helpGroupHeading&&e.helpGroup(this._defaultOptionGroup)}_initCommandGroup(e){this._defaultCommandGroup&&!e.helpGroup()&&e.helpGroup(this._defaultCommandGroup)}nameFromFilename(e){return this._name=Gi.basename(e,Gi.extname(e)),this}executableDir(e){return e===void 0?this._executableDir:(this._executableDir=e,this)}helpInformation(e){let t=this.createHelp(),i=this._getOutputContext(e);t.prepareContext({error:i.error,helpWidth:i.helpWidth,outputHasColors:i.hasColors});let n=t.formatHelp(this,t);return i.hasColors?n:this._outputConfiguration.stripColor(n)}_getOutputContext(e){e=e||{};let t=!!e.error,i,n,s;return t?(i=o(c=>this._outputConfiguration.writeErr(c),"baseWrite"),n=this._outputConfiguration.getErrHasColors(),s=this._outputConfiguration.getErrHelpWidth()):(i=o(c=>this._outputConfiguration.writeOut(c),"baseWrite"),n=this._outputConfiguration.getOutHasColors(),s=this._outputConfiguration.getOutHelpWidth()),{error:t,write:o(c=>(n||(c=this._outputConfiguration.stripColor(c)),i(c)),"write"),hasColors:n,helpWidth:s}}outputHelp(e){let t;typeof e=="function"&&(t=e,e=void 0);let i=this._getOutputContext(e),n={error:i.error,write:i.write,command:this};this._getCommandAndAncestors().reverse().forEach(a=>a.emit("beforeAllHelp",n)),this.emit("beforeHelp",n);let s=this.helpInformation({error:i.error});if(t&&(s=t(s),typeof s!="string"&&!Buffer.isBuffer(s)))throw new Error("outputHelp callback must return a string or a Buffer");i.write(s),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",n),this._getCommandAndAncestors().forEach(a=>a.emit("afterAllHelp",n))}helpOption(e,t){return typeof e=="boolean"?(e?(this._helpOption===null&&(this._helpOption=void 0),this._defaultOptionGroup&&this._initOptionGroup(this._getHelpOption())):this._helpOption=null,this):(this._helpOption=this.createOption(e??"-h, --help",t??"display help for command"),(e||t)&&this._initOptionGroup(this._helpOption),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(e){return this._helpOption=e,this._initOptionGroup(e),this}help(e){this.outputHelp(e);let t=Number(qe.exitCode??0);t===0&&e&&typeof e!="function"&&e.error&&(t=1),this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){let i=["beforeAll","before","after","afterAll"];if(!i.includes(e))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${i.join("', '")}'`);let n=`${e}Help`;return this.on(n,s=>{let a;typeof t=="function"?a=t({error:s.error,command:s.command}):a=t,a&&s.write(`${a}
`)}),this}_outputHelpIfRequested(e){let t=this._getHelpOption();t&&e.find(n=>t.is(n))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}};function Eg(r){return r.map(e=>{if(!e.startsWith("--inspect"))return e;let t,i="127.0.0.1",n="9229",s;return(s=e.match(/^(--inspect(-brk)?)$/))!==null?t=s[1]:(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(t=s[1],/^\d+$/.test(s[3])?n=s[3]:i=s[3]):(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(t=s[1],i=s[3],n=s[4]),t&&n!=="0"?`${t}=${i}:${parseInt(n)+1}`:e})}o(Eg,"incrementNodeInspectorPort");function qf(){if(qe.env.NO_COLOR||qe.env.FORCE_COLOR==="0"||qe.env.FORCE_COLOR==="false")return!1;if(qe.env.FORCE_COLOR||qe.env.CLICOLOR_FORCE!==void 0)return!0}o(qf,"useColor");$f.Command=Vf;$f.useColor=qf});var Og=y(Fr=>{var{Argument:xg}=vc(),{Command:Uf}=Tg(),{CommanderError:Hw,InvalidArgumentError:Ag}=Va(),{Help:zw}=If(),{Option:Cg}=jf();Fr.program=new Uf;Fr.createCommand=r=>new Uf(r);Fr.createOption=(r,e)=>new Cg(r,e);Fr.createArgument=(r,e)=>new xg(r,e);Fr.Command=Uf;Fr.Option=Cg;Fr.Argument=xg;Fr.Help=zw;Fr.CommanderError=Hw;Fr.InvalidArgumentError=Ag;Fr.InvalidOptionArgumentError=Ag});var Bf=y(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.AssetClass=void 0;var Pg;(function(r){r.AREA="ems__Area",r.TASK="ems__Task",r.PROJECT="ems__Project",r.MEETING="ems__Meeting",r.INITIATIVE="ems__Initiative",r.TASK_PROTOTYPE="ems__TaskPrototype",r.MEETING_PROTOTYPE="ems__MeetingPrototype",r.EVENT_PROTOTYPE="exo__EventPrototype",r.PROJECT_PROTOTYPE="ems__ProjectPrototype",r.EVENT="exo__Event",r.DAILY_NOTE="pn__DailyNote",r.CONCEPT="ims__Concept",r.SESSION_START_EVENT="ems__SessionStartEvent",r.SESSION_END_EVENT="ems__SessionEndEvent",r.PROTOTYPE="exo__Prototype",r.CLASS="exo__Class"})(Pg||(Sc.AssetClass=Pg={}))});var Gf=y(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.EffortStatus=void 0;var Rg;(function(r){r.DRAFT="ems__EffortStatusDraft",r.BACKLOG="ems__EffortStatusBacklog",r.ANALYSIS="ems__EffortStatusAnalysis",r.TODO="ems__EffortStatusToDo",r.DOING="ems__EffortStatusDoing",r.DONE="ems__EffortStatusDone",r.TRASHED="ems__EffortStatusTrashed"})(Rg||(wc.EffortStatus=Rg={}))});var Dg=y(Ig=>{"use strict";Object.defineProperty(Ig,"__esModule",{value:!0})});var kg=y(Ng=>{"use strict";Object.defineProperty(Ng,"__esModule",{value:!0})});var Lg=y(jg=>{"use strict";Object.defineProperty(jg,"__esModule",{value:!0})});var Vg=y(Mg=>{"use strict";Object.defineProperty(Mg,"__esModule",{value:!0})});var at=y(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.IRI=void 0;var Wf=class r{static{o(this,"IRI")}constructor(e){let t=e.trim();if(t.length===0)throw new Error("IRI cannot be empty");if(!r.isValidIRI(t))throw new Error("Invalid IRI format");this._value=t}get value(){return this._value}equals(e){return this._value===e._value}toString(){return this._value}static isValidIRI(e){if(!e||e.trim().length===0||/\s/.test(e)||!/^[a-z][a-z0-9+.-]*:/i.test(e))return!1;let i=["http","https","ftp","ftps","file","mailto","tel","data","ws","wss","urn","obsidian"],n=e.match(/^([a-z][a-z0-9+.-]*?):/i);if(n){let s=n[1].toLowerCase();if(!i.includes(s))return!1}try{return new URL(e),!0}catch{return/^urn:[a-z0-9][a-z0-9-]{0,31}:[^\s]+$/i.test(e)}}};bc.IRI=Wf});var Pt=y(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.Literal=void 0;var Kw="http://www.w3.org/2001/XMLSchema#string",Hf=class{static{o(this,"Literal")}constructor(e,t,i){if(e.length===0)throw new Error("Literal value cannot be empty");if(t&&i)throw new Error("Literal cannot have both datatype and language tag");this._value=e,this._datatype=t,this._language=i?i.toLowerCase():void 0}get value(){return this._value}get datatype(){return this._datatype}get language(){return this._language}equals(e){if(this._value!==e._value||this._language!==e._language)return!1;let t=this.normalizedDatatype(),i=e.normalizedDatatype();return t===i}normalizedDatatype(){return!this._datatype||this._datatype.value===Kw?null:this._datatype.value}toString(){let e=`"${this._value}"`;return this._datatype?e+=`^^<${this._datatype.value}>`:this._language&&(e+=`@${this._language}`),e}};Ec.Literal=Hf});var Sr=y(xc=>{"use strict";Object.defineProperty(xc,"__esModule",{value:!0});xc.BlankNode=void 0;var Tc=class r{static{o(this,"BlankNode")}constructor(e){let t=e.trim();if(t.length===0)throw new Error("BlankNode id cannot be empty");this._id=t}get id(){return this._id}equals(e){return this._id===e._id}toString(){return`_:${this._id}`}static generateId(){return`b${++r.counter}`}static create(){return new r(r.generateId())}};xc.BlankNode=Tc;Tc.counter=0});var bi=y(Ac=>{"use strict";Object.defineProperty(Ac,"__esModule",{value:!0});Ac.Namespace=void 0;var qg=at(),Jt=class{static{o(this,"Namespace")}constructor(e,t){if(e.trim().length===0)throw new Error("Namespace prefix cannot be empty");this._prefix=e,this._iri=new qg.IRI(t)}get prefix(){return this._prefix}get iri(){return this._iri}term(e){return new qg.IRI(`${this._iri.value}${e}`)}expand(e){let t=e.split(":");if(t.length!==2)return null;let[i,n]=t;return i!==this._prefix?null:this.term(n)}};Ac.Namespace=Jt;Jt.RDF=new Jt("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#");Jt.RDFS=new Jt("rdfs","http://www.w3.org/2000/01/rdf-schema#");Jt.OWL=new Jt("owl","http://www.w3.org/2002/07/owl#");Jt.XSD=new Jt("xsd","http://www.w3.org/2001/XMLSchema#");Jt.EXO=new Jt("exo","https://exocortex.my/ontology/exo#");Jt.EMS=new Jt("ems","https://exocortex.my/ontology/ems#")});var Wn=y(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.Triple=void 0;var zf=at(),Kf=Pt(),Yf=Sr(),Qf=class{static{o(this,"Triple")}constructor(e,t,i){this._subject=e,this._predicate=t,this._object=i}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}equals(e){return!(!this.equalsNode(this._subject,e._subject)||!this._predicate.equals(e._predicate)||!this.equalsNode(this._object,e._object))}equalsNode(e,t){return e instanceof zf.IRI&&t instanceof zf.IRI||e instanceof Yf.BlankNode&&t instanceof Yf.BlankNode||e instanceof Kf.Literal&&t instanceof Kf.Literal?e.equals(t):!1}toString(){let e=this.nodeToString(this._subject),t=`<${this._predicate.value}>`,i=this.nodeToString(this._object);return`${e} ${t} ${i} .`}nodeToString(e){return e instanceof zf.IRI?`<${e.value}>`:e instanceof Yf.BlankNode||e instanceof Kf.Literal?e.toString():""}};Cc.Triple=Qf});var $g=y(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.Triple=Rr.Namespace=Rr.BlankNode=Rr.Literal=Rr.IRI=void 0;var Yw=at();Object.defineProperty(Rr,"IRI",{enumerable:!0,get:o(function(){return Yw.IRI},"get")});var Qw=Pt();Object.defineProperty(Rr,"Literal",{enumerable:!0,get:o(function(){return Qw.Literal},"get")});var Jw=Sr();Object.defineProperty(Rr,"BlankNode",{enumerable:!0,get:o(function(){return Jw.BlankNode},"get")});var Xw=bi();Object.defineProperty(Rr,"Namespace",{enumerable:!0,get:o(function(){return Xw.Namespace},"get")});var Zw=Wn();Object.defineProperty(Rr,"Triple",{enumerable:!0,get:o(function(){return Zw.Triple},"get")})});var Hn=y(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.WikiLinkHelpers=void 0;var Oc=class{static{o(this,"WikiLinkHelpers")}static normalize(e){return e?e.replace(this.WIKI_LINK_PATTERN,"").trim():""}static normalizeArray(e){return e?(Array.isArray(e)?e:[e]).map(i=>this.normalize(i)).filter(i=>i.length>0):[]}static equals(e,t){return this.normalize(e)===this.normalize(t)}static includes(e,t){let i=this.normalizeArray(e),n=this.normalize(t);return i.includes(n)}};Fc.WikiLinkHelpers=Oc;Oc.WIKI_LINK_PATTERN=/\[\[|\]\]/g});var qt=y(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.EffortStatus=Is.AssetClass=void 0;var eb=Bf();Object.defineProperty(Is,"AssetClass",{enumerable:!0,get:o(function(){return eb.AssetClass},"get")});var tb=Gf();Object.defineProperty(Is,"EffortStatus",{enumerable:!0,get:o(function(){return tb.EffortStatus},"get")})});var hn=y($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.hasClass=Kn;$t.isAreaOrProject=rb;$t.isEffort=ib;$t.hasStatus=nb;$t.isAssetArchived=sb;$t.hasEmptyProperties=ab;$t.needsFolderRepair=ob;$t.getTodayDateString=Jf;$t.isPlannedForToday=cb;$t.hasPlannedStartTimestamp=ub;$t.extractDailyNoteDate=lb;$t.isCurrentDateGteDay=fb;$t.inheritsFromPrototype=Gg;$t.isPrototypeClass=db;var Bg=Hn(),zn=qt();function Kn(r,e){return r?(Array.isArray(r)?r:[r]).some(i=>Bg.WikiLinkHelpers.normalize(i)===e):!1}o(Kn,"hasClass");function rb(r){return Kn(r,zn.AssetClass.AREA)||Kn(r,zn.AssetClass.PROJECT)}o(rb,"isAreaOrProject");function ib(r){return Kn(r,zn.AssetClass.TASK)||Kn(r,zn.AssetClass.PROJECT)||Kn(r,zn.AssetClass.MEETING)}o(ib,"isEffort");function nb(r,e){if(!r)return!1;let t=Array.isArray(r)?r[0]:r;return t?Bg.WikiLinkHelpers.normalize(t)===e:!1}o(nb,"hasStatus");function sb(r){if(r===!0||r===1)return!0;if(typeof r=="string"){let e=r.toLowerCase();return e==="true"||e==="yes"}return!1}o(sb,"isAssetArchived");function ab(r){return!r||Object.keys(r).length===0?!1:Object.values(r).some(e=>!!(e==null||typeof e=="string"&&e.trim()===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0))}o(ab,"hasEmptyProperties");function ob(r,e){if(!e)return!1;let t=r.replace(/\/$/,""),i=e.replace(/\/$/,"");return t!==i}o(ob,"needsFolderRepair");function Jf(){let r=new Date,e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}o(Jf,"getTodayDateString");function cb(r){let e=r.ems__Effort_plannedStartTimestamp;if(!e)return!1;let t=Jf();return typeof e=="string"?e.split("T")[0]===t:Array.isArray(e)&&e.length>0?String(e[0]).split("T")[0]===t:!1}o(cb,"isPlannedForToday");function ub(r){let e=r.ems__Effort_plannedStartTimestamp;return e?typeof e=="string"?e.trim().length>0:Array.isArray(e)&&e.length>0?String(e[0]).trim().length>0:!1:!1}o(ub,"hasPlannedStartTimestamp");function lb(r){let e=r.pn__DailyNote_day;if(!e)return null;if(typeof e=="string"){let t=e.match(/\[\[(.+?)\]\]/);return t?t[1]:e}if(Array.isArray(e)&&e.length>0){let t=String(e[0]),i=t.match(/\[\[(.+?)\]\]/);return i?i[1]:t}return null}o(lb,"extractDailyNoteDate");function fb(r){return Jf()>=r}o(fb,"isCurrentDateGteDay");function Ug(r){return r?r.replace(/^["']|["']$/g,"").replace(/\[\[|\]\]/g,"").trim():""}o(Ug,"normalizeWithQuotes");var hb=10;function Gg(r,e=hb){let t=r.exo__Class_superClass;if(!t)return!1;let i=new Set,n=[],s=Array.isArray(t)?t:[t];for(let a of s){let c=Ug(a);c&&n.push({className:c,depth:0})}for(;n.length>0;){let a=n.shift();if(!a)continue;let{className:c,depth:u}=a;if(u>e)continue;if(c===zn.AssetClass.PROTOTYPE)return!0;if(i.has(c))continue;i.add(c);let f=`${c}__exo__Class_superClass`,l=r[f];if(l){let h=Array.isArray(l)?l:[l];for(let p of h){let g=Ug(p);g&&!i.has(g)&&n.push({className:g,depth:u+1})}}}return!1}o(Gg,"inheritsFromPrototype");function db(r,e){return Kn(r,zn.AssetClass.CLASS)?Gg(e):!1}o(db,"isPrototypeClass")});var Hg=y(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.canCreateTask=pb;qa.canCreateRelatedTask=mb;qa.canConvertTaskToProject=gb;var Pc=hn(),Wg=qt();function pb(r){return(0,Pc.isAreaOrProject)(r.instanceClass)}o(pb,"canCreateTask");function mb(r){return!(!(0,Pc.hasClass)(r.instanceClass,Wg.AssetClass.TASK)||(0,Pc.isAssetArchived)(r.isArchived))}o(mb,"canCreateRelatedTask");function gb(r){return(0,Pc.hasClass)(r.instanceClass,Wg.AssetClass.TASK)}o(gb,"canConvertTaskToProject")});var zg=y(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.canCreateProject=yb;Ds.canMoveToAnalysis=vb;Ds.canMoveToToDo=_b;Ds.canConvertProjectToTask=Sb;var dn=hn(),pn=qt();function yb(r){return(0,dn.hasClass)(r.instanceClass,pn.AssetClass.AREA)||(0,dn.hasClass)(r.instanceClass,pn.AssetClass.INITIATIVE)||(0,dn.hasClass)(r.instanceClass,pn.AssetClass.PROJECT)}o(yb,"canCreateProject");function vb(r){return(0,dn.hasClass)(r.instanceClass,pn.AssetClass.PROJECT)?(0,dn.hasStatus)(r.currentStatus,pn.EffortStatus.BACKLOG):!1}o(vb,"canMoveToAnalysis");function _b(r){return(0,dn.hasClass)(r.instanceClass,pn.AssetClass.PROJECT)?(0,dn.hasStatus)(r.currentStatus,pn.EffortStatus.ANALYSIS):!1}o(_b,"canMoveToToDo");function Sb(r){return(0,dn.hasClass)(r.instanceClass,pn.AssetClass.PROJECT)}o(Sb,"canConvertProjectToTask")});var Qg=y(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.canCreateChildArea=wb;Rc.canSetActiveFocus=bb;var Kg=hn(),Yg=qt();function wb(r){return(0,Kg.hasClass)(r.instanceClass,Yg.AssetClass.AREA)}o(wb,"canCreateChildArea");function bb(r){return(0,Kg.hasClass)(r.instanceClass,Yg.AssetClass.AREA)}o(bb,"canSetActiveFocus")});var Xg=y(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.canPlanOnToday=Eb;hr.canPlanForEvening=Tb;hr.canShiftDayBackward=xb;hr.canShiftDayForward=Ab;hr.canSetDraftStatus=Cb;hr.canMoveToBacklog=Ob;hr.canStartEffort=Fb;hr.canMarkDone=Pb;hr.canTrashEffort=Rb;hr.canVoteOnEffort=Ib;hr.canRollbackStatus=Db;hr.canArchiveTask=Nb;var Jg=Hn(),Ye=hn(),wr=qt();function Eb(r){return!(!(0,Ye.isEffort)(r.instanceClass)||(0,Ye.isPlannedForToday)(r.metadata))}o(Eb,"canPlanOnToday");function Tb(r){return!(0,Ye.hasClass)(r.instanceClass,wr.AssetClass.TASK)&&!(0,Ye.hasClass)(r.instanceClass,wr.AssetClass.MEETING)?!1:(0,Ye.hasStatus)(r.currentStatus,wr.EffortStatus.BACKLOG)}o(Tb,"canPlanForEvening");function xb(r){return(0,Ye.isEffort)(r.instanceClass)?(0,Ye.hasPlannedStartTimestamp)(r.metadata):!1}o(xb,"canShiftDayBackward");function Ab(r){return(0,Ye.isEffort)(r.instanceClass)?(0,Ye.hasPlannedStartTimestamp)(r.metadata):!1}o(Ab,"canShiftDayForward");function Cb(r){return(0,Ye.isEffort)(r.instanceClass)?!r.currentStatus:!1}o(Cb,"canSetDraftStatus");function Ob(r){return(0,Ye.isEffort)(r.instanceClass)?(0,Ye.hasStatus)(r.currentStatus,wr.EffortStatus.DRAFT):!1}o(Ob,"canMoveToBacklog");function Fb(r){return(0,Ye.isEffort)(r.instanceClass)?(0,Ye.hasClass)(r.instanceClass,wr.AssetClass.TASK)||(0,Ye.hasClass)(r.instanceClass,wr.AssetClass.MEETING)?(0,Ye.hasStatus)(r.currentStatus,wr.EffortStatus.BACKLOG):(0,Ye.hasClass)(r.instanceClass,wr.AssetClass.PROJECT)?(0,Ye.hasStatus)(r.currentStatus,wr.EffortStatus.TODO):!1:!1}o(Fb,"canStartEffort");function Pb(r){return(0,Ye.isEffort)(r.instanceClass)?(0,Ye.hasStatus)(r.currentStatus,wr.EffortStatus.DOING):!1}o(Pb,"canMarkDone");function Rb(r){return(0,Ye.isEffort)(r.instanceClass)?r.currentStatus?!(Array.isArray(r.currentStatus)?r.currentStatus:[r.currentStatus]).some(i=>{let n=Jg.WikiLinkHelpers.normalize(i);return n===wr.EffortStatus.TRASHED||n===wr.EffortStatus.DONE}):!0:!1}o(Rb,"canTrashEffort");function Ib(r){return!(!(0,Ye.isEffort)(r.instanceClass)||(0,Ye.isAssetArchived)(r.isArchived))}o(Ib,"canVoteOnEffort");function Db(r){if(!(0,Ye.isEffort)(r.instanceClass)||(0,Ye.isAssetArchived)(r.isArchived)||!r.currentStatus)return!1;let e=Array.isArray(r.currentStatus)?r.currentStatus[0]:r.currentStatus;return!(!e||Jg.WikiLinkHelpers.normalize(e)===wr.EffortStatus.TRASHED)}o(Db,"canRollbackStatus");function Nb(r){return!(0,Ye.isAssetArchived)(r.isArchived)}o(Nb,"canArchiveTask")});var Zg=y(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.canCreateEvent=kb;Vr.canCreateInstance=jb;Vr.canCleanProperties=Lb;Vr.canRepairFolder=Mb;Vr.canRenameToUid=Vb;Vr.canCopyLabelToAliases=qb;Vr.canCreateNarrowerConcept=$b;Vr.canCreateSubclass=Ub;Vr.canCreateTaskForDailyNote=Bb;var dr=hn(),mn=qt();function kb(r){return(0,dr.isAreaOrProject)(r.instanceClass)}o(kb,"canCreateEvent");function jb(r){return(0,dr.hasClass)(r.instanceClass,mn.AssetClass.TASK_PROTOTYPE)||(0,dr.hasClass)(r.instanceClass,mn.AssetClass.MEETING_PROTOTYPE)||(0,dr.hasClass)(r.instanceClass,mn.AssetClass.EVENT_PROTOTYPE)||(0,dr.hasClass)(r.instanceClass,mn.AssetClass.PROJECT_PROTOTYPE)?!0:(0,dr.isPrototypeClass)(r.instanceClass,r.metadata)}o(jb,"canCreateInstance");function Lb(r){return(0,dr.hasEmptyProperties)(r.metadata)}o(Lb,"canCleanProperties");function Mb(r){return(0,dr.needsFolderRepair)(r.currentFolder,r.expectedFolder)}o(Mb,"canRepairFolder");function Vb(r,e){let t=r.metadata.exo__Asset_uid;return!t||(0,dr.hasClass)(r.instanceClass,mn.AssetClass.CONCEPT)?!1:e!==t}o(Vb,"canRenameToUid");function qb(r){let e=r.metadata.exo__Asset_label;if(!e||typeof e!="string"||e.trim()==="")return!1;let t=e.trim(),i=r.metadata.aliases;return!i||!Array.isArray(i)||i.length===0?!0:!i.some(n=>typeof n!="string"?!1:n.trim()===t)}o(qb,"canCopyLabelToAliases");function $b(r){return(0,dr.hasClass)(r.instanceClass,mn.AssetClass.CONCEPT)}o($b,"canCreateNarrowerConcept");function Ub(r){return(0,dr.hasClass)(r.instanceClass,mn.AssetClass.CLASS)}o(Ub,"canCreateSubclass");function Bb(r){if(!(0,dr.hasClass)(r.instanceClass,mn.AssetClass.DAILY_NOTE)||r.isArchived)return!1;let e=(0,dr.extractDailyNoteDate)(r.metadata);return e?(0,dr.isCurrentDateGteDay)(e):!1}o(Bb,"canCreateTaskForDailyNote")});var t0=y(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.canCreateTaskForDailyNote=I.canCreateSubclass=I.canCreateNarrowerConcept=I.canCopyLabelToAliases=I.canRenameToUid=I.canRepairFolder=I.canCleanProperties=I.canCreateInstance=I.canCreateEvent=I.canArchiveTask=I.canRollbackStatus=I.canVoteOnEffort=I.canTrashEffort=I.canMarkDone=I.canStartEffort=I.canMoveToBacklog=I.canSetDraftStatus=I.canShiftDayForward=I.canShiftDayBackward=I.canPlanForEvening=I.canPlanOnToday=I.canSetActiveFocus=I.canCreateChildArea=I.canConvertProjectToTask=I.canMoveToToDo=I.canMoveToAnalysis=I.canCreateProject=I.canConvertTaskToProject=I.canCreateRelatedTask=I.canCreateTask=I.isPrototypeClass=I.inheritsFromPrototype=I.isCurrentDateGteDay=I.extractDailyNoteDate=I.hasPlannedStartTimestamp=I.isPlannedForToday=I.getTodayDateString=I.needsFolderRepair=I.hasEmptyProperties=I.isAssetArchived=I.hasStatus=I.isEffort=I.isAreaOrProject=I.hasClass=void 0;var pr=hn();Object.defineProperty(I,"hasClass",{enumerable:!0,get:o(function(){return pr.hasClass},"get")});Object.defineProperty(I,"isAreaOrProject",{enumerable:!0,get:o(function(){return pr.isAreaOrProject},"get")});Object.defineProperty(I,"isEffort",{enumerable:!0,get:o(function(){return pr.isEffort},"get")});Object.defineProperty(I,"hasStatus",{enumerable:!0,get:o(function(){return pr.hasStatus},"get")});Object.defineProperty(I,"isAssetArchived",{enumerable:!0,get:o(function(){return pr.isAssetArchived},"get")});Object.defineProperty(I,"hasEmptyProperties",{enumerable:!0,get:o(function(){return pr.hasEmptyProperties},"get")});Object.defineProperty(I,"needsFolderRepair",{enumerable:!0,get:o(function(){return pr.needsFolderRepair},"get")});Object.defineProperty(I,"getTodayDateString",{enumerable:!0,get:o(function(){return pr.getTodayDateString},"get")});Object.defineProperty(I,"isPlannedForToday",{enumerable:!0,get:o(function(){return pr.isPlannedForToday},"get")});Object.defineProperty(I,"hasPlannedStartTimestamp",{enumerable:!0,get:o(function(){return pr.hasPlannedStartTimestamp},"get")});Object.defineProperty(I,"extractDailyNoteDate",{enumerable:!0,get:o(function(){return pr.extractDailyNoteDate},"get")});Object.defineProperty(I,"isCurrentDateGteDay",{enumerable:!0,get:o(function(){return pr.isCurrentDateGteDay},"get")});Object.defineProperty(I,"inheritsFromPrototype",{enumerable:!0,get:o(function(){return pr.inheritsFromPrototype},"get")});Object.defineProperty(I,"isPrototypeClass",{enumerable:!0,get:o(function(){return pr.isPrototypeClass},"get")});var Xf=Hg();Object.defineProperty(I,"canCreateTask",{enumerable:!0,get:o(function(){return Xf.canCreateTask},"get")});Object.defineProperty(I,"canCreateRelatedTask",{enumerable:!0,get:o(function(){return Xf.canCreateRelatedTask},"get")});Object.defineProperty(I,"canConvertTaskToProject",{enumerable:!0,get:o(function(){return Xf.canConvertTaskToProject},"get")});var Ic=zg();Object.defineProperty(I,"canCreateProject",{enumerable:!0,get:o(function(){return Ic.canCreateProject},"get")});Object.defineProperty(I,"canMoveToAnalysis",{enumerable:!0,get:o(function(){return Ic.canMoveToAnalysis},"get")});Object.defineProperty(I,"canMoveToToDo",{enumerable:!0,get:o(function(){return Ic.canMoveToToDo},"get")});Object.defineProperty(I,"canConvertProjectToTask",{enumerable:!0,get:o(function(){return Ic.canConvertProjectToTask},"get")});var e0=Qg();Object.defineProperty(I,"canCreateChildArea",{enumerable:!0,get:o(function(){return e0.canCreateChildArea},"get")});Object.defineProperty(I,"canSetActiveFocus",{enumerable:!0,get:o(function(){return e0.canSetActiveFocus},"get")});var Ir=Xg();Object.defineProperty(I,"canPlanOnToday",{enumerable:!0,get:o(function(){return Ir.canPlanOnToday},"get")});Object.defineProperty(I,"canPlanForEvening",{enumerable:!0,get:o(function(){return Ir.canPlanForEvening},"get")});Object.defineProperty(I,"canShiftDayBackward",{enumerable:!0,get:o(function(){return Ir.canShiftDayBackward},"get")});Object.defineProperty(I,"canShiftDayForward",{enumerable:!0,get:o(function(){return Ir.canShiftDayForward},"get")});Object.defineProperty(I,"canSetDraftStatus",{enumerable:!0,get:o(function(){return Ir.canSetDraftStatus},"get")});Object.defineProperty(I,"canMoveToBacklog",{enumerable:!0,get:o(function(){return Ir.canMoveToBacklog},"get")});Object.defineProperty(I,"canStartEffort",{enumerable:!0,get:o(function(){return Ir.canStartEffort},"get")});Object.defineProperty(I,"canMarkDone",{enumerable:!0,get:o(function(){return Ir.canMarkDone},"get")});Object.defineProperty(I,"canTrashEffort",{enumerable:!0,get:o(function(){return Ir.canTrashEffort},"get")});Object.defineProperty(I,"canVoteOnEffort",{enumerable:!0,get:o(function(){return Ir.canVoteOnEffort},"get")});Object.defineProperty(I,"canRollbackStatus",{enumerable:!0,get:o(function(){return Ir.canRollbackStatus},"get")});Object.defineProperty(I,"canArchiveTask",{enumerable:!0,get:o(function(){return Ir.canArchiveTask},"get")});var Wi=Zg();Object.defineProperty(I,"canCreateEvent",{enumerable:!0,get:o(function(){return Wi.canCreateEvent},"get")});Object.defineProperty(I,"canCreateInstance",{enumerable:!0,get:o(function(){return Wi.canCreateInstance},"get")});Object.defineProperty(I,"canCleanProperties",{enumerable:!0,get:o(function(){return Wi.canCleanProperties},"get")});Object.defineProperty(I,"canRepairFolder",{enumerable:!0,get:o(function(){return Wi.canRepairFolder},"get")});Object.defineProperty(I,"canRenameToUid",{enumerable:!0,get:o(function(){return Wi.canRenameToUid},"get")});Object.defineProperty(I,"canCopyLabelToAliases",{enumerable:!0,get:o(function(){return Wi.canCopyLabelToAliases},"get")});Object.defineProperty(I,"canCreateNarrowerConcept",{enumerable:!0,get:o(function(){return Wi.canCreateNarrowerConcept},"get")});Object.defineProperty(I,"canCreateSubclass",{enumerable:!0,get:o(function(){return Wi.canCreateSubclass},"get")});Object.defineProperty(I,"canCreateTaskForDailyNote",{enumerable:!0,get:o(function(){return Wi.canCreateTaskForDailyNote},"get")})});var r0=y(Yn=>{"use strict";var Gb=Yn&&Yn.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),Wb=Yn&&Yn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Gb(e,r,t)};Object.defineProperty(Yn,"__esModule",{value:!0});Wb(t0(),Yn)});var n0=y($a=>{"use strict";Object.defineProperty($a,"__esModule",{value:!0});$a.PropertyFieldType=void 0;$a.rangeToFieldType=Kb;var Rt;(function(r){r.Text="text",r.Number="number",r.Date="date",r.DateTime="datetime",r.Boolean="boolean",r.Reference="reference",r.Enum="enum",r.StatusSelect="status-select",r.SizeSelect="size-select",r.Wikilink="wikilink",r.Timestamp="timestamp",r.Unknown="unknown"})(Rt||($a.PropertyFieldType=Rt={}));var i0="http://www.w3.org/2001/XMLSchema#",Hb="https://exocortex.my/ontology/exo#",zb="https://exocortex.my/ontology/ems#";function Kb(r){if(!r)return Rt.Unknown;let e=r.trim();if(!e)return Rt.Unknown;if(e.startsWith(i0)){let t=e.substring(i0.length);return Zf(t)}if(e.startsWith("xsd:")){let t=e.substring(4);return Zf(t)}if(e.includes("XMLSchema#")){let t=e.indexOf("XMLSchema#"),i=e.substring(t+10);return Zf(i)}return e.startsWith(zb)||e.startsWith("ems:")?Yb(e):e.startsWith(Hb)||e.startsWith("exo:")||Qb(e)?Rt.Reference:Rt.Text}o(Kb,"rangeToFieldType");function Zf(r){switch(r.toLowerCase()){case"string":case"normalizedstring":case"token":case"language":case"nmtoken":case"name":case"ncname":case"anyuri":return Rt.Text;case"integer":case"int":case"long":case"short":case"byte":case"nonnegativeinteger":case"positiveinteger":case"nonpositiveinteger":case"negativeinteger":case"unsignedlong":case"unsignedint":case"unsignedshort":case"unsignedbyte":case"decimal":case"float":case"double":return Rt.Number;case"date":return Rt.Date;case"datetime":case"datetimestamp":return Rt.DateTime;case"boolean":return Rt.Boolean;case"time":return Rt.Timestamp;default:return Rt.Text}}o(Zf,"xsdTypeToFieldType");function Yb(r){let e=r.toLowerCase();return e.includes("effortstatus")?Rt.StatusSelect:e.includes("tasksize")?Rt.SizeSelect:Rt.Reference}o(Yb,"emsTypeToFieldType");function Qb(r){let e=r.toLowerCase();return e.includes("exocortex.my/ontology")?!0:["asset","task","project","area","effort","class","property","concept"].some(i=>e.includes(i))}o(Qb,"isClassReference")});var a0=y(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.propertyNameToUri=Jb;Ua.uriToPropertyName=s0;Ua.extractPropertyLabel=Xb;function Jb(r){return r.replace(/^([a-z]+)__/,"$1:")}o(Jb,"propertyNameToUri");function s0(r){if(r.startsWith("http://")||r.startsWith("https://")){let e=r.match(/\/([a-z]+)#([A-Za-z0-9_]+)$/);if(e)return`${e[1]}__${e[2]}`;let t=r.lastIndexOf("#"),i=r.lastIndexOf("/"),n=Math.max(t,i);return n>=0?r.substring(n+1):r}return r.replace(/^([a-z]+):/,"$1__")}o(s0,"uriToPropertyName");function Xb(r){let i=(r.includes(":")?s0(r):r).replace(/^[a-z]+__/,"").split("_");return(i.length>1?i.slice(1).join(" "):i[0]).replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,s=>s.toUpperCase())}o(Xb,"extractPropertyLabel")});var Dc={};Iw(Dc,{__assign:()=>th,__asyncDelegator:()=>fE,__asyncGenerator:()=>lE,__asyncValues:()=>hE,__await:()=>Ba,__awaiter:()=>nE,__classPrivateFieldGet:()=>gE,__classPrivateFieldSet:()=>yE,__createBinding:()=>aE,__decorate:()=>tE,__exportStar:()=>oE,__extends:()=>Zb,__generator:()=>sE,__importDefault:()=>mE,__importStar:()=>pE,__makeTemplateObject:()=>dE,__metadata:()=>iE,__param:()=>rE,__read:()=>o0,__rest:()=>eE,__spread:()=>cE,__spreadArrays:()=>uE,__values:()=>rh});function Zb(r,e){eh(r,e);function t(){this.constructor=r}o(t,"__"),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function eE(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(t[i[n]]=r[i[n]]);return t}function tE(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}function rE(r,e){return function(t,i){e(t,i,r)}}function iE(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function nE(r,e,t,i){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return o(n,"adopt"),new(t||(t=Promise))(function(s,a){function c(l){try{f(i.next(l))}catch(h){a(h)}}o(c,"fulfilled");function u(l){try{f(i.throw(l))}catch(h){a(h)}}o(u,"rejected");function f(l){l.done?s(l.value):n(l.value).then(c,u)}o(f,"step"),f((i=i.apply(r,e||[])).next())})}function sE(r,e){var t={label:0,sent:o(function(){if(s[0]&1)throw s[1];return s[1]},"sent"),trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(l){return u([f,l])}}function u(f){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(s=f[0]&2?n.return:f[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,f[1])).done)return s;switch(n=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return t.label++,{value:f[1],done:!1};case 5:t.label++,n=f[1],f=[0];continue;case 7:f=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){t=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){t.label=f[1];break}if(f[0]===6&&t.label<s[1]){t.label=s[1],s=f;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(f);break}s[2]&&t.ops.pop(),t.trys.pop();continue}f=e.call(r,t)}catch(l){f=[6,l],n=0}finally{i=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function aE(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function oE(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function rh(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:o(function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}},"next")};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o0(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return s}function cE(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(o0(arguments[e]));return r}function uE(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),n=0,e=0;e<t;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Ba(r){return this instanceof Ba?(this.v=r,this):new Ba(r)}function lE(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(p){i[p]&&(n[p]=function(g){return new Promise(function(S,_){s.push([p,g,S,_])>1||c(p,g)})})}function c(p,g){try{u(i[p](g))}catch(S){h(s[0][3],S)}}function u(p){p.value instanceof Ba?Promise.resolve(p.value.v).then(f,l):h(s[0][2],p)}function f(p){c("next",p)}function l(p){c("throw",p)}function h(p,g){p(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function fE(r){var e,t;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=r[n]?function(a){return(t=!t)?{value:Ba(r[n](a)),done:n==="return"}:s?s(a):a}:s}}function hE(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof rh=="function"?rh(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=r[s]&&function(a){return new Promise(function(c,u){a=r[s](a),n(c,u,a.done,a.value)})}}function n(s,a,c,u){Promise.resolve(u).then(function(f){s({value:f,done:c})},a)}}function dE(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function pE(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function mE(r){return r&&r.__esModule?r:{default:r}}function gE(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function yE(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var eh,th,Nc=Rw(()=>{eh=o(function(r,e){return eh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},eh(r,e)},"extendStatics");o(Zb,"__extends");th=o(function(){return th=Object.assign||o(function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},"__assign"),th.apply(this,arguments)},"__assign");o(eE,"__rest");o(tE,"__decorate");o(rE,"__param");o(iE,"__metadata");o(nE,"__awaiter");o(sE,"__generator");o(aE,"__createBinding");o(oE,"__exportStar");o(rh,"__values");o(o0,"__read");o(cE,"__spread");o(uE,"__spreadArrays");o(Ba,"__await");o(lE,"__asyncGenerator");o(fE,"__asyncDelegator");o(hE,"__asyncValues");o(dE,"__makeTemplateObject");o(pE,"__importStar");o(mE,"__importDefault");o(gE,"__classPrivateFieldGet");o(yE,"__classPrivateFieldSet")});var sh=y(nh=>{"use strict";Object.defineProperty(nh,"__esModule",{value:!0});var ih;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(ih||(ih={}));nh.default=ih});var c0=y(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});var vE=sh();Object.defineProperty(ah,"Lifecycle",{enumerable:!0,get:o(function(){return vE.default},"get")})});var Qn=y(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.defineInjectionTokenMetadata=qr.getParamInfo=qr.INJECTION_TOKEN_METADATA_KEY=void 0;qr.INJECTION_TOKEN_METADATA_KEY="injectionTokens";function _E(r){let e=Reflect.getMetadata("design:paramtypes",r)||[],t=Reflect.getOwnMetadata(qr.INJECTION_TOKEN_METADATA_KEY,r)||{};return Object.keys(t).forEach(i=>{e[+i]=t[i]}),e}o(_E,"getParamInfo");qr.getParamInfo=_E;function SE(r,e){return function(t,i,n){let s=Reflect.getOwnMetadata(qr.INJECTION_TOKEN_METADATA_KEY,t)||{};s[n]=e?{token:r,transform:e.transformToken,transformArgs:e.args||[]}:r,Reflect.defineMetadata(qr.INJECTION_TOKEN_METADATA_KEY,s,t)}}o(SE,"defineInjectionTokenMetadata");qr.defineInjectionTokenMetadata=SE});var oh=y(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.isClassProvider=void 0;function wE(r){return!!r.useClass}o(wE,"isClassProvider");kc.isClassProvider=wE});var ch=y(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.isFactoryProvider=void 0;function bE(r){return!!r.useFactory}o(bE,"isFactoryProvider");jc.isFactoryProvider=bE});var Mc=y(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.delay=Ns.DelayedConstructor=void 0;var Lc=class{static{o(this,"DelayedConstructor")}constructor(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}createProxy(e){let t={},i=!1,n,s=o(()=>(i||(n=e(this.wrap()),i=!0),n),"delayedObject");return new Proxy(t,this.createHandler(s))}createHandler(e){let t={},i=o(n=>{t[n]=(...s)=>{s[0]=e();let a=Reflect[n];return a(...s)}},"install");return this.reflectMethods.forEach(i),t}};Ns.DelayedConstructor=Lc;function EE(r){if(typeof r>"u")throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new Lc(r)}o(EE,"delay");Ns.delay=EE});var Vc=y(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});Ei.isConstructorToken=Ei.isTransformDescriptor=Ei.isTokenDescriptor=Ei.isNormalToken=void 0;var TE=Mc();function xE(r){return typeof r=="string"||typeof r=="symbol"}o(xE,"isNormalToken");Ei.isNormalToken=xE;function AE(r){return typeof r=="object"&&"token"in r&&"multiple"in r}o(AE,"isTokenDescriptor");Ei.isTokenDescriptor=AE;function CE(r){return typeof r=="object"&&"token"in r&&"transform"in r}o(CE,"isTransformDescriptor");Ei.isTransformDescriptor=CE;function OE(r){return typeof r=="function"||r instanceof TE.DelayedConstructor}o(OE,"isConstructorToken");Ei.isConstructorToken=OE});var uh=y(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.isTokenProvider=void 0;function FE(r){return!!r.useToken}o(FE,"isTokenProvider");qc.isTokenProvider=FE});var lh=y($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.isValueProvider=void 0;function PE(r){return r.useValue!=null}o(PE,"isValueProvider");$c.isValueProvider=PE});var fh=y(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});var RE=oh();Object.defineProperty(Jn,"isClassProvider",{enumerable:!0,get:o(function(){return RE.isClassProvider},"get")});var IE=ch();Object.defineProperty(Jn,"isFactoryProvider",{enumerable:!0,get:o(function(){return IE.isFactoryProvider},"get")});var DE=Vc();Object.defineProperty(Jn,"isNormalToken",{enumerable:!0,get:o(function(){return DE.isNormalToken},"get")});var NE=uh();Object.defineProperty(Jn,"isTokenProvider",{enumerable:!0,get:o(function(){return NE.isTokenProvider},"get")});var kE=lh();Object.defineProperty(Jn,"isValueProvider",{enumerable:!0,get:o(function(){return kE.isValueProvider},"get")})});var u0=y(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.isProvider=void 0;var jE=oh(),LE=lh(),ME=uh(),VE=ch();function qE(r){return jE.isClassProvider(r)||LE.isValueProvider(r)||ME.isTokenProvider(r)||VE.isFactoryProvider(r)}o(qE,"isProvider");Uc.isProvider=qE});var ph=y(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});var hh=class{static{o(this,"RegistryBase")}constructor(){this._registryMap=new Map}entries(){return this._registryMap.entries()}getAll(e){return this.ensure(e),this._registryMap.get(e)}get(e){this.ensure(e);let t=this._registryMap.get(e);return t[t.length-1]||null}set(e,t){this.ensure(e),this._registryMap.get(e).push(t)}setAll(e,t){this._registryMap.set(e,t)}has(e){return this.ensure(e),this._registryMap.get(e).length>0}clear(){this._registryMap.clear()}ensure(e){this._registryMap.has(e)||this._registryMap.set(e,[])}};dh.default=hh});var l0=y(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});var $E=ph(),mh=class extends $E.default{static{o(this,"Registry")}};gh.default=mh});var f0=y(vh=>{"use strict";Object.defineProperty(vh,"__esModule",{value:!0});var yh=class{static{o(this,"ResolutionContext")}constructor(){this.scopedResolutions=new Map}};vh.default=yh});var _h=y(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.formatErrorCtor=void 0;function UE(r,e){return r===null?`at position #${e}`:`"${r.split(",")[e].trim()}" at position #${e}`}o(UE,"formatDependency");function BE(r,e,t="    "){return[r,...e.message.split(`
`).map(i=>t+i)].join(`
`)}o(BE,"composeErrorMessage");function GE(r,e,t){let[,i=null]=r.toString().match(/constructor\(([\w, ]+)\)/)||[],n=UE(i,e);return BE(`Cannot inject the dependency ${n} of "${r.name}" constructor. Reason:`,t)}o(GE,"formatErrorCtor");Bc.formatErrorCtor=GE});var h0=y(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.isDisposable=void 0;function WE(r){return!(typeof r.dispose!="function"||r.dispose.length>0)}o(WE,"isDisposable");Gc.isDisposable=WE});var p0=y(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.PostResolutionInterceptors=Xn.PreResolutionInterceptors=void 0;var d0=ph(),Wc=class extends d0.default{static{o(this,"PreResolutionInterceptors")}};Xn.PreResolutionInterceptors=Wc;var Hc=class extends d0.default{static{o(this,"PostResolutionInterceptors")}};Xn.PostResolutionInterceptors=Hc;var Sh=class{static{o(this,"Interceptors")}constructor(){this.preResolution=new Wc,this.postResolution=new Hc}};Xn.default=Sh});var gn=y(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.instance=Hi.typeInfo=void 0;var HE=(Nc(),Tf(Dc)),Xt=fh(),zE=u0(),zc=Vc(),KE=l0(),mr=sh(),Kc=f0(),YE=_h(),QE=Mc(),JE=h0(),XE=p0();Hi.typeInfo=new Map;var wh=class r{static{o(this,"InternalDependencyContainer")}constructor(e){this.parent=e,this._registry=new KE.default,this.interceptors=new XE.default,this.disposed=!1,this.disposables=new Set}register(e,t,i={lifecycle:mr.default.Transient}){this.ensureNotDisposed();let n;if(zE.isProvider(t)?n=t:n={useClass:t},Xt.isTokenProvider(n)){let s=[e],a=n;for(;a!=null;){let c=a.useToken;if(s.includes(c))throw new Error(`Token registration cycle detected! ${[...s,c].join(" -> ")}`);s.push(c);let u=this._registry.get(c);u&&Xt.isTokenProvider(u.provider)?a=u.provider:a=null}}if((i.lifecycle===mr.default.Singleton||i.lifecycle==mr.default.ContainerScoped||i.lifecycle==mr.default.ResolutionScoped)&&(Xt.isValueProvider(n)||Xt.isFactoryProvider(n)))throw new Error(`Cannot use lifecycle "${mr.default[i.lifecycle]}" with ValueProviders or FactoryProviders`);return this._registry.set(e,{provider:n,options:i}),this}registerType(e,t){return this.ensureNotDisposed(),Xt.isNormalToken(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})}registerInstance(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})}registerSingleton(e,t){if(this.ensureNotDisposed(),Xt.isNormalToken(e)){if(Xt.isNormalToken(t))return this.register(e,{useToken:t},{lifecycle:mr.default.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:mr.default.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}let i=e;return t&&!Xt.isNormalToken(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:mr.default.Singleton})}resolve(e,t=new Kc.default,i=!1){this.ensureNotDisposed();let n=this.getRegistration(e);if(!n&&Xt.isNormalToken(e)){if(i)return;throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"Single"),n){let s=this.resolveRegistration(n,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}if(zc.isConstructorToken(e)){let s=this.construct(e,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")}executePreResolutionInterceptor(e,t){if(this.interceptors.preResolution.has(e)){let i=[];for(let n of this.interceptors.preResolution.getAll(e))n.options.frequency!="Once"&&i.push(n),n.callback(e,t);this.interceptors.preResolution.setAll(e,i)}}executePostResolutionInterceptor(e,t,i){if(this.interceptors.postResolution.has(e)){let n=[];for(let s of this.interceptors.postResolution.getAll(e))s.options.frequency!="Once"&&n.push(s),s.callback(e,t,i);this.interceptors.postResolution.setAll(e,n)}}resolveRegistration(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===mr.default.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);let i=e.options.lifecycle===mr.default.Singleton,n=e.options.lifecycle===mr.default.ContainerScoped,s=i||n,a;return Xt.isValueProvider(e.provider)?a=e.provider.useValue:Xt.isTokenProvider(e.provider)?a=s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):Xt.isClassProvider(e.provider)?a=s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Xt.isFactoryProvider(e.provider)?a=e.provider.useFactory(this):a=this.construct(e.provider,t),e.options.lifecycle===mr.default.ResolutionScoped&&t.scopedResolutions.set(e,a),a}resolveAll(e,t=new Kc.default,i=!1){this.ensureNotDisposed();let n=this.getAllRegistrations(e);if(!n&&Xt.isNormalToken(e)){if(i)return[];throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"All"),n){let a=n.map(c=>this.resolveRegistration(c,t));return this.executePostResolutionInterceptor(e,a,"All"),a}let s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s}isRegistered(e,t=!1){return this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)}reset(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()}clearInstances(){this.ensureNotDisposed();for(let[e,t]of this._registry.entries())this._registry.setAll(e,t.filter(i=>!Xt.isValueProvider(i.provider)).map(i=>(i.instance=void 0,i)))}createChildContainer(){this.ensureNotDisposed();let e=new r(this);for(let[t,i]of this._registry.entries())i.some(({options:n})=>n.lifecycle===mr.default.ContainerScoped)&&e._registry.setAll(t,i.map(n=>n.options.lifecycle===mr.default.ContainerScoped?{provider:n.provider,options:n.options}:n));return e}beforeResolution(e,t,i={frequency:"Always"}){this.interceptors.preResolution.set(e,{callback:t,options:i})}afterResolution(e,t,i={frequency:"Always"}){this.interceptors.postResolution.set(e,{callback:t,options:i})}dispose(){return HE.__awaiter(this,void 0,void 0,function*(){this.disposed=!0;let e=[];this.disposables.forEach(t=>{let i=t.dispose();i&&e.push(i)}),yield Promise.all(e)})}getRegistration(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null}getAllRegistrations(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null}construct(e,t){if(e instanceof QE.DelayedConstructor)return e.createProxy(n=>this.resolve(n,t));let i=(()=>{let n=Hi.typeInfo.get(e);if(!n||n.length===0){if(e.length===0)return new e;throw new Error(`TypeInfo not known for "${e.name}"`)}let s=n.map(this.resolveParams(t,e));return new e(...s)})();return JE.isDisposable(i)&&this.disposables.add(i),i}resolveParams(e,t){return(i,n)=>{try{return zc.isTokenDescriptor(i)?zc.isTransformDescriptor(i)?i.multiple?this.resolve(i.transform).transform(this.resolveAll(i.token,new Kc.default,i.isOptional),...i.transformArgs):this.resolve(i.transform).transform(this.resolve(i.token,e,i.isOptional),...i.transformArgs):i.multiple?this.resolveAll(i.token,new Kc.default,i.isOptional):this.resolve(i.token,e,i.isOptional):zc.isTransformDescriptor(i)?this.resolve(i.transform,e).transform(this.resolve(i.token,e),...i.transformArgs):this.resolve(i,e)}catch(s){throw new Error(YE.formatErrorCtor(t,n,s))}}}ensureNotDisposed(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")}};Hi.instance=new wh;Hi.default=Hi.instance});var m0=y(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});var ZE=Qn(),zi=gn(),bh=Vc(),eT=_h();function tT(){return function(r){let e=ZE.getParamInfo(r);return class extends r{constructor(...t){super(...t.concat(e.slice(t.length).map((i,n)=>{try{return bh.isTokenDescriptor(i)?bh.isTransformDescriptor(i)?i.multiple?zi.instance.resolve(i.transform).transform(zi.instance.resolveAll(i.token),...i.transformArgs):zi.instance.resolve(i.transform).transform(zi.instance.resolve(i.token),...i.transformArgs):i.multiple?zi.instance.resolveAll(i.token):zi.instance.resolve(i.token):bh.isTransformDescriptor(i)?zi.instance.resolve(i.transform).transform(zi.instance.resolve(i.token),...i.transformArgs):zi.instance.resolve(i)}catch(s){let a=n+t.length;throw new Error(eT.formatErrorCtor(r,a,s))}})))}}}}o(tT,"autoInjectable");Eh.default=tT});var g0=y(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});var rT=Qn();function iT(r,e){let t={token:r,multiple:!1,isOptional:e&&e.isOptional};return rT.defineInjectionTokenMetadata(t)}o(iT,"inject");Th.default=iT});var Yc=y(xh=>{"use strict";Object.defineProperty(xh,"__esModule",{value:!0});var nT=Qn(),sT=gn(),y0=gn();function aT(r){return function(e){sT.typeInfo.set(e,nT.getParamInfo(e)),r&&r.token&&(Array.isArray(r.token)?r.token.forEach(t=>{y0.instance.register(t,e)}):y0.instance.register(r.token,e))}}o(aT,"injectable");xh.default=aT});var v0=y(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});var oT=(Nc(),Tf(Dc)),cT=gn();function uT(r=[]){return function(e){return r.forEach(t=>{var{token:i,options:n}=t,s=oT.__rest(t,["token","options"]);return cT.instance.register(i,s,n)}),e}}o(uT,"registry");Ah.default=uT});var _0=y(Ch=>{"use strict";Object.defineProperty(Ch,"__esModule",{value:!0});var lT=Yc(),fT=gn();function hT(){return function(r){lT.default()(r),fT.instance.registerSingleton(r)}}o(hT,"singleton");Ch.default=hT});var S0=y(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});var dT=Qn();function pT(r,e){let t={token:r,multiple:!0,isOptional:e&&e.isOptional};return dT.defineInjectionTokenMetadata(t)}o(pT,"injectAll");Oh.default=pT});var w0=y(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});var mT=Qn();function gT(r,e,...t){let i={token:r,multiple:!0,transform:e,transformArgs:t};return mT.defineInjectionTokenMetadata(i)}o(gT,"injectAllWithTransform");Fh.default=gT});var b0=y(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});var yT=Qn();function vT(r,e,...t){return yT.defineInjectionTokenMetadata(r,{transformToken:e,args:t})}o(vT,"injectWithTransform");Ph.default=vT});var E0=y(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});var _T=Yc(),ST=gn();function wT(r,e){return function(t){_T.default()(t),ST.instance.register(e||t,t,{lifecycle:r})}}o(wT,"scoped");Rh.default=wT});var T0=y($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});var bT=m0();Object.defineProperty($r,"autoInjectable",{enumerable:!0,get:o(function(){return bT.default},"get")});var ET=g0();Object.defineProperty($r,"inject",{enumerable:!0,get:o(function(){return ET.default},"get")});var TT=Yc();Object.defineProperty($r,"injectable",{enumerable:!0,get:o(function(){return TT.default},"get")});var xT=v0();Object.defineProperty($r,"registry",{enumerable:!0,get:o(function(){return xT.default},"get")});var AT=_0();Object.defineProperty($r,"singleton",{enumerable:!0,get:o(function(){return AT.default},"get")});var CT=S0();Object.defineProperty($r,"injectAll",{enumerable:!0,get:o(function(){return CT.default},"get")});var OT=w0();Object.defineProperty($r,"injectAllWithTransform",{enumerable:!0,get:o(function(){return OT.default},"get")});var FT=b0();Object.defineProperty($r,"injectWithTransform",{enumerable:!0,get:o(function(){return FT.default},"get")});var PT=E0();Object.defineProperty($r,"scoped",{enumerable:!0,get:o(function(){return PT.default},"get")})});var x0=y(Ih=>{"use strict";Object.defineProperty(Ih,"__esModule",{value:!0});function RT(r){let e;return t=>(e==null&&(e=r(t)),e)}o(RT,"instanceCachingFactory");Ih.default=RT});var A0=y(Dh=>{"use strict";Object.defineProperty(Dh,"__esModule",{value:!0});function IT(r){let e=new WeakMap;return t=>{let i=e.get(t);return i==null&&(i=r(t),e.set(t,i)),i}}o(IT,"instancePerContainerCachingFactory");Dh.default=IT});var C0=y(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});function DT(r,e,t,i=!0){let n,s;return a=>{let c=r(a);return(!i||s!==c)&&((s=c)?n=a.resolve(e):n=a.resolve(t)),n}}o(DT,"predicateAwareClassFactory");Nh.default=DT});var O0=y(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});var NT=x0();Object.defineProperty(Ga,"instanceCachingFactory",{enumerable:!0,get:o(function(){return NT.default},"get")});var kT=A0();Object.defineProperty(Ga,"instancePerContainerCachingFactory",{enumerable:!0,get:o(function(){return kT.default},"get")});var jT=C0();Object.defineProperty(Ga,"predicateAwareClassFactory",{enumerable:!0,get:o(function(){return jT.default},"get")})});var Qe=y(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});var kh=(Nc(),Tf(Dc));if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var LT=c0();Object.defineProperty(yn,"Lifecycle",{enumerable:!0,get:o(function(){return LT.Lifecycle},"get")});kh.__exportStar(T0(),yn);kh.__exportStar(O0(),yn);kh.__exportStar(fh(),yn);var MT=Mc();Object.defineProperty(yn,"delay",{enumerable:!0,get:o(function(){return MT.delay},"get")});var VT=gn();Object.defineProperty(yn,"container",{enumerable:!0,get:o(function(){return VT.instance},"get")})});var F0=y(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.default="ffffffff-ffff-ffff-ffff-ffffffffffff"});var P0=y(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.default="00000000-0000-0000-0000-000000000000"});var R0=y(Mh=>{"use strict";Object.defineProperty(Mh,"__esModule",{value:!0});Mh.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i});var Wa=y(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});var qT=R0();function $T(r){return typeof r=="string"&&qT.default.test(r)}o($T,"validate");Vh.default=$T});var Ha=y(qh=>{"use strict";Object.defineProperty(qh,"__esModule",{value:!0});var UT=Wa();function BT(r){if(!(0,UT.default)(r))throw TypeError("Invalid UUID");let e;return Uint8Array.of((e=parseInt(r.slice(0,8),16))>>>24,e>>>16&255,e>>>8&255,e&255,(e=parseInt(r.slice(9,13),16))>>>8,e&255,(e=parseInt(r.slice(14,18),16))>>>8,e&255,(e=parseInt(r.slice(19,23),16))>>>8,e&255,(e=parseInt(r.slice(24,36),16))/1099511627776&255,e/4294967296&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255)}o(BT,"parse");qh.default=BT});var Ki=y(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.unsafeStringify=void 0;var GT=Wa(),It=[];for(let r=0;r<256;++r)It.push((r+256).toString(16).slice(1));function I0(r,e=0){return(It[r[e+0]]+It[r[e+1]]+It[r[e+2]]+It[r[e+3]]+"-"+It[r[e+4]]+It[r[e+5]]+"-"+It[r[e+6]]+It[r[e+7]]+"-"+It[r[e+8]]+It[r[e+9]]+"-"+It[r[e+10]]+It[r[e+11]]+It[r[e+12]]+It[r[e+13]]+It[r[e+14]]+It[r[e+15]]).toLowerCase()}o(I0,"unsafeStringify");za.unsafeStringify=I0;function WT(r,e=0){let t=I0(r,e);if(!(0,GT.default)(t))throw TypeError("Stringified UUID is invalid");return t}o(WT,"stringify");za.default=WT});var Xc=y($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});var HT=require("crypto"),Jc=new Uint8Array(256),Qc=Jc.length;function zT(){return Qc>Jc.length-16&&((0,HT.randomFillSync)(Jc),Qc=0),Jc.slice(Qc,Qc+=16)}o(zT,"rng");$h.default=zT});var Uh=y(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.updateV1State=void 0;var D0=Xc(),KT=Ki(),Ka={};function YT(r,e,t){let i,n=r?._v6??!1;if(r){let s=Object.keys(r);s.length===1&&s[0]==="_v6"&&(r=void 0)}if(r)i=N0(r.random??r.rng?.()??(0,D0.default)(),r.msecs,r.nsecs,r.clockseq,r.node,e,t);else{let s=Date.now(),a=(0,D0.default)();k0(Ka,s,a),i=N0(a,Ka.msecs,Ka.nsecs,n?void 0:Ka.clockseq,n?void 0:Ka.node,e,t)}return e??(0,KT.unsafeStringify)(i)}o(YT,"v1");function k0(r,e,t){return r.msecs??=-1/0,r.nsecs??=0,e===r.msecs?(r.nsecs++,r.nsecs>=1e4&&(r.node=void 0,r.nsecs=0)):e>r.msecs?r.nsecs=0:e<r.msecs&&(r.node=void 0),r.node||(r.node=t.slice(10,16),r.node[0]|=1,r.clockseq=(t[8]<<8|t[9])&16383),r.msecs=e,r}o(k0,"updateV1State");Ya.updateV1State=k0;function N0(r,e,t,i,n,s,a=0){if(r.length<16)throw new Error("Random bytes length must be >= 16");if(!s)s=new Uint8Array(16),a=0;else if(a<0||a+16>s.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);e??=Date.now(),t??=0,i??=(r[8]<<8|r[9])&16383,n??=r.slice(10,16),e+=122192928e5;let c=((e&268435455)*1e4+t)%4294967296;s[a++]=c>>>24&255,s[a++]=c>>>16&255,s[a++]=c>>>8&255,s[a++]=c&255;let u=e/4294967296*1e4&268435455;s[a++]=u>>>8&255,s[a++]=u&255,s[a++]=u>>>24&15|16,s[a++]=u>>>16&255,s[a++]=i>>>8|128,s[a++]=i&255;for(let f=0;f<6;++f)s[a++]=n[f];return s}o(N0,"v1Bytes");Ya.default=YT});var Gh=y(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});var QT=Ha(),JT=Ki();function XT(r){let e=typeof r=="string"?(0,QT.default)(r):r,t=ZT(e);return typeof r=="string"?(0,JT.unsafeStringify)(t):t}o(XT,"v1ToV6");Bh.default=XT;function ZT(r){return Uint8Array.of((r[6]&15)<<4|r[7]>>4&15,(r[7]&15)<<4|(r[4]&240)>>4,(r[4]&15)<<4|(r[5]&240)>>4,(r[5]&15)<<4|(r[0]&240)>>4,(r[0]&15)<<4|(r[1]&240)>>4,(r[1]&15)<<4|(r[2]&240)>>4,96|r[2]&15,r[3],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}o(ZT,"_v1ToV6")});var j0=y(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});var ex=require("crypto");function tx(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),(0,ex.createHash)("md5").update(r).digest()}o(tx,"md5");Wh.default=tx});var Qa=y(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.URL=Yi.DNS=Yi.stringToBytes=void 0;var L0=Ha(),rx=Ki();function M0(r){r=unescape(encodeURIComponent(r));let e=new Uint8Array(r.length);for(let t=0;t<r.length;++t)e[t]=r.charCodeAt(t);return e}o(M0,"stringToBytes");Yi.stringToBytes=M0;Yi.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Yi.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ix(r,e,t,i,n,s){let a=typeof t=="string"?M0(t):t,c=typeof i=="string"?(0,L0.default)(i):i;if(typeof i=="string"&&(i=(0,L0.default)(i)),i?.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+a.length);if(u.set(c),u.set(a,c.length),u=e(u),u[6]=u[6]&15|r,u[8]=u[8]&63|128,n){s=s||0;for(let f=0;f<16;++f)n[s+f]=u[f];return n}return(0,rx.unsafeStringify)(u)}o(ix,"v35");Yi.default=ix});var q0=y(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.URL=Zn.DNS=void 0;var nx=j0(),Hh=Qa(),V0=Qa();Object.defineProperty(Zn,"DNS",{enumerable:!0,get:o(function(){return V0.DNS},"get")});Object.defineProperty(Zn,"URL",{enumerable:!0,get:o(function(){return V0.URL},"get")});function zh(r,e,t,i){return(0,Hh.default)(48,nx.default,r,e,t,i)}o(zh,"v3");zh.DNS=Hh.DNS;zh.URL=Hh.URL;Zn.default=zh});var $0=y(Kh=>{"use strict";Object.defineProperty(Kh,"__esModule",{value:!0});var sx=require("crypto");Kh.default={randomUUID:sx.randomUUID}});var B0=y(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});var U0=$0(),ax=Xc(),ox=Ki();function cx(r,e,t){if(U0.default.randomUUID&&!e&&!r)return U0.default.randomUUID();r=r||{};let i=r.random??r.rng?.()??(0,ax.default)();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let n=0;n<16;++n)e[t+n]=i[n];return e}return(0,ox.unsafeStringify)(i)}o(cx,"v4");Yh.default=cx});var G0=y(Qh=>{"use strict";Object.defineProperty(Qh,"__esModule",{value:!0});var ux=require("crypto");function lx(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),(0,ux.createHash)("sha1").update(r).digest()}o(lx,"sha1");Qh.default=lx});var H0=y(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.URL=es.DNS=void 0;var fx=G0(),Jh=Qa(),W0=Qa();Object.defineProperty(es,"DNS",{enumerable:!0,get:o(function(){return W0.DNS},"get")});Object.defineProperty(es,"URL",{enumerable:!0,get:o(function(){return W0.URL},"get")});function Xh(r,e,t,i){return(0,Jh.default)(80,fx.default,r,e,t,i)}o(Xh,"v5");Xh.DNS=Jh.DNS;Xh.URL=Jh.URL;es.default=Xh});var z0=y(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});var hx=Ki(),dx=Uh(),px=Gh();function mx(r,e,t){r??={},t??=0;let i=(0,dx.default)({...r,_v6:!0},new Uint8Array(16));if(i=(0,px.default)(i),e){for(let n=0;n<16;n++)e[t+n]=i[n];return e}return(0,hx.unsafeStringify)(i)}o(mx,"v6");Zh.default=mx});var K0=y(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});var gx=Ha(),yx=Ki();function vx(r){let e=typeof r=="string"?(0,gx.default)(r):r,t=_x(e);return typeof r=="string"?(0,yx.unsafeStringify)(t):t}o(vx,"v6ToV1");ed.default=vx;function _x(r){return Uint8Array.of((r[3]&15)<<4|r[4]>>4&15,(r[4]&15)<<4|(r[5]&240)>>4,(r[5]&15)<<4|r[6]&15,r[7],(r[1]&15)<<4|(r[2]&240)>>4,(r[2]&15)<<4|(r[3]&240)>>4,16|(r[0]&240)>>4,(r[0]&15)<<4|(r[1]&240)>>4,r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}o(_x,"_v6ToV1")});var X0=y(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.updateV7State=void 0;var Y0=Xc(),Sx=Ki(),td={};function wx(r,e,t){let i;if(r)i=Q0(r.random??r.rng?.()??(0,Y0.default)(),r.msecs,r.seq,e,t);else{let n=Date.now(),s=(0,Y0.default)();J0(td,n,s),i=Q0(s,td.msecs,td.seq,e,t)}return e??(0,Sx.unsafeStringify)(i)}o(wx,"v7");function J0(r,e,t){return r.msecs??=-1/0,r.seq??=0,e>r.msecs?(r.seq=t[6]<<23|t[7]<<16|t[8]<<8|t[9],r.msecs=e):(r.seq=r.seq+1|0,r.seq===0&&r.msecs++),r}o(J0,"updateV7State");Ja.updateV7State=J0;function Q0(r,e,t,i,n=0){if(r.length<16)throw new Error("Random bytes length must be >= 16");if(!i)i=new Uint8Array(16),n=0;else if(n<0||n+16>i.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);return e??=Date.now(),t??=r[6]*127<<24|r[7]<<16|r[8]<<8|r[9],i[n++]=e/1099511627776&255,i[n++]=e/4294967296&255,i[n++]=e/16777216&255,i[n++]=e/65536&255,i[n++]=e/256&255,i[n++]=e&255,i[n++]=112|t>>>28&15,i[n++]=t>>>20&255,i[n++]=128|t>>>14&63,i[n++]=t>>>6&255,i[n++]=t<<2&255|r[10]&3,i[n++]=r[11],i[n++]=r[12],i[n++]=r[13],i[n++]=r[14],i[n++]=r[15],i}o(Q0,"v7Bytes");Ja.default=wx});var Z0=y(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});var bx=Wa();function Ex(r){if(!(0,bx.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}o(Ex,"version");rd.default=Ex});var Dr=y(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.version=Ue.validate=Ue.v7=Ue.v6ToV1=Ue.v6=Ue.v5=Ue.v4=Ue.v3=Ue.v1ToV6=Ue.v1=Ue.stringify=Ue.parse=Ue.NIL=Ue.MAX=void 0;var Tx=F0();Object.defineProperty(Ue,"MAX",{enumerable:!0,get:o(function(){return Tx.default},"get")});var xx=P0();Object.defineProperty(Ue,"NIL",{enumerable:!0,get:o(function(){return xx.default},"get")});var Ax=Ha();Object.defineProperty(Ue,"parse",{enumerable:!0,get:o(function(){return Ax.default},"get")});var Cx=Ki();Object.defineProperty(Ue,"stringify",{enumerable:!0,get:o(function(){return Cx.default},"get")});var Ox=Uh();Object.defineProperty(Ue,"v1",{enumerable:!0,get:o(function(){return Ox.default},"get")});var Fx=Gh();Object.defineProperty(Ue,"v1ToV6",{enumerable:!0,get:o(function(){return Fx.default},"get")});var Px=q0();Object.defineProperty(Ue,"v3",{enumerable:!0,get:o(function(){return Px.default},"get")});var Rx=B0();Object.defineProperty(Ue,"v4",{enumerable:!0,get:o(function(){return Rx.default},"get")});var Ix=H0();Object.defineProperty(Ue,"v5",{enumerable:!0,get:o(function(){return Ix.default},"get")});var Dx=z0();Object.defineProperty(Ue,"v6",{enumerable:!0,get:o(function(){return Dx.default},"get")});var Nx=K0();Object.defineProperty(Ue,"v6ToV1",{enumerable:!0,get:o(function(){return Nx.default},"get")});var kx=X0();Object.defineProperty(Ue,"v7",{enumerable:!0,get:o(function(){return kx.default},"get")});var jx=Wa();Object.defineProperty(Ue,"validate",{enumerable:!0,get:o(function(){return jx.default},"get")});var Lx=Z0();Object.defineProperty(Ue,"version",{enumerable:!0,get:o(function(){return Lx.default},"get")})});var Ur=y(Zc=>{"use strict";Object.defineProperty(Zc,"__esModule",{value:!0});Zc.MetadataHelpers=void 0;var id=class{static{o(this,"MetadataHelpers")}static findAllReferencingProperties(e,t){let i=[];for(let[n,s]of Object.entries(e))this.containsReference(s,t)&&i.push(n);return i}static findReferencingProperty(e,t){for(let[i,n]of Object.entries(e))if(this.containsReference(n,t))return i}static containsReference(e,t){if(!e)return!1;let i=t.replace(/\.md$/,"");if(typeof e=="string"){let n=/\[\[([^\]]+)\]\]/g,s;for(;(s=n.exec(e))!==null;){let c=s[1].split("|")[0].trim();if(c===i||c.endsWith(`/${i}`))return!0}return!1}return Array.isArray(e)?e.some(n=>this.containsReference(n,t)):!1}static isAssetArchived(e){let t=e?.exo__Asset_isArchived;if(t!=null){if(t===!0||t===1)return!0;if(typeof t=="string"){let n=t.toLowerCase().trim();if(n==="true"||n==="yes"||n==="1")return!0}if(typeof t=="boolean")return t}let i=e?.archived;if(i==null)return!1;if(typeof i=="boolean")return i;if(typeof i=="number")return i!==0;if(typeof i=="string"){let n=i.toLowerCase().trim();return n==="true"||n==="yes"||n==="1"}return!1}static getPropertyValue(e,t){return t==="Name"||t==="title"?e.title:t==="created"?e.created:t==="modified"?e.modified:t==="path"?e.path:e.metadata?.[t]}static ensureQuoted(e){return!e||e==='""'?'""':e.startsWith('"')&&e.endsWith('"')?e:`"${e}"`}static buildFileContent(e,t){let i=Object.entries(e).map(([s,a])=>{if(Array.isArray(a)){let c=a.map(u=>`  - ${u}`).join(`
`);return`${s}:
${c}`}return`${s}: ${a}`}).join(`
`),n=t?`
${t}
`:`
`;return`---
${i}
---
${n}`}};Zc.MetadataHelpers=id});var gr=y(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.DateFormatter=void 0;var nd=class r{static{o(this,"DateFormatter")}static toISOTimestamp(e){return e.toISOString().replace(/\.\d{3}Z$/,"Z")}static toLocalTimestamp(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),c=String(e.getSeconds()).padStart(2,"0");return`${t}-${i}-${n}T${s}:${a}:${c}`}static toDateWikilink(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`"[[${t}-${i}-${n}]]"`}static getTodayWikilink(){return r.toDateWikilink(new Date)}static toDateString(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${n}`}static parseWikilink(e){let i=e.replace(/^["']|["']$/g,"").match(/\[\[(\d{4}-\d{2}-\d{2})\]\]/);return i?i[1]:null}static addDays(e,t){let i=new Date(e);return i.setDate(i.getDate()+t),i}static isSameDay(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}static getTodayStartTimestamp(){let e=new Date;return e.setHours(0,0,0,0),r.toLocalTimestamp(e)}static toTimestampAtStartOfDay(e){let t=e.split("-").map(Number);if(t.length!==3||t.some(isNaN))throw new Error(`Invalid date format: ${e}. Expected YYYY-MM-DD`);let[i,n,s]=t,a=new Date(i,n-1,s,0,0,0,0);if(isNaN(a.getTime()))throw new Error(`Invalid date values: ${e}`);return r.toLocalTimestamp(a)}static normalizeTimestamp(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e;let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`Invalid timestamp format: ${e}`);return r.toISOTimestamp(t)}static isISOTimestamp(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e)}};eu.DateFormatter=nd});var Xa=y(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.MetadataExtractor=void 0;var Mx=Ur(),sd=class{static{o(this,"MetadataExtractor")}constructor(e){this.vault=e}extractMetadata(e){return e?this.vault.getFrontmatter(e)||{}:{}}extractInstanceClass(e){return e.exo__Instance_class||null}extractStatus(e){return e.ems__Effort_status||null}extractIsArchived(e){return Mx.MetadataHelpers.isAssetArchived(e)}static extractIsDefinedBy(e){let t=e.exo__Asset_isDefinedBy||'""';return Array.isArray(t)&&(t=t[0]||'""'),t}extractExpectedFolder(e){let t=e.exo__Asset_isDefinedBy;if(!t)return null;let i=Array.isArray(t)?t[0]:t;if(!i||typeof i!="string")return null;let n=i.replace(/["'[\]]/g,"").trim();if(!n)return null;let s=n.split("/");return s.pop(),s.join("/")}extractCommandVisibilityContext(e){let t=this.extractMetadata(e),i=this.extractInstanceClass(t),n=this.extractStatus(t),s=this.extractIsArchived(t),a=e.parent?.path||"",c=this.extractExpectedFolder(t);return{instanceClass:i,currentStatus:n,metadata:t,isArchived:s,currentFolder:a,expectedFolder:c}}extractCache(e){return e?this.vault.getFrontmatter(e):null}};tu.MetadataExtractor=sd});var ru=y(ts=>{"use strict";var Vx=ts&&ts.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(ts,"__esModule",{value:!0});ts.TaskFrontmatterGenerator=void 0;var qx=Qe(),e2=Dr(),ad=gr(),$x=Hn(),t2=Xa(),r2=Ur(),ut=qt(),Ux=hn(),Bx={[ut.AssetClass.AREA]:"ems__Effort_area",[ut.AssetClass.PROJECT]:"ems__Effort_parent",[ut.AssetClass.TASK_PROTOTYPE]:"exo__Asset_prototype",[ut.AssetClass.MEETING_PROTOTYPE]:"exo__Asset_prototype",[ut.AssetClass.EVENT_PROTOTYPE]:"exo__Asset_prototype",[ut.AssetClass.PROJECT_PROTOTYPE]:"exo__Asset_prototype"},Gx={[ut.AssetClass.AREA]:ut.AssetClass.TASK,[ut.AssetClass.PROJECT]:ut.AssetClass.TASK,[ut.AssetClass.TASK_PROTOTYPE]:ut.AssetClass.TASK,[ut.AssetClass.MEETING_PROTOTYPE]:ut.AssetClass.MEETING,[ut.AssetClass.EVENT_PROTOTYPE]:ut.AssetClass.EVENT,[ut.AssetClass.PROJECT_PROTOTYPE]:ut.AssetClass.PROJECT},od=class{static{o(this,"TaskFrontmatterGenerator")}generateTaskFrontmatter(e,t,i,n,s,a,c){let u=new Date,f=ad.DateFormatter.toLocalTimestamp(u),l=t2.MetadataExtractor.extractIsDefinedBy(e),h=$x.WikiLinkHelpers.normalize(i),p=Bx[h],g=Gx[h]||ut.AssetClass.TASK,S={};S.exo__Asset_isDefinedBy=r2.MetadataHelpers.ensureQuoted(l),S.exo__Asset_uid=s||(0,e2.v4)(),S.exo__Asset_createdAt=f,S.exo__Instance_class=[`"[[${g}]]"`],S.ems__Effort_status='"[[ems__EffortStatusDraft]]"',p?S[p]=`"[[${t}]]"`:(0,Ux.isPrototypeClass)(i,e)&&(S.exo__Asset_prototype=`"[[${t}]]"`);let _=n;if(g===ut.AssetClass.MEETING&&(!n||n.trim()==="")){let A=e.exo__Asset_label||t,F=ad.DateFormatter.toDateString(u);_=`${A} ${F}`}if(_&&_.trim()!==""){let A=_.trim();S.exo__Asset_label=A,S.aliases=[A]}return a&&(S.ems__Task_size=a),c&&(S.ems__Effort_plannedStartTimestamp=c),S}generateRelatedTaskFrontmatter(e,t,i,n,s){let a=new Date,c=ad.DateFormatter.toLocalTimestamp(a),u=t2.MetadataExtractor.extractIsDefinedBy(e),f={};if(f.exo__Asset_isDefinedBy=r2.MetadataHelpers.ensureQuoted(u),f.exo__Asset_uid=n||(0,e2.v4)(),f.exo__Asset_createdAt=c,f.exo__Instance_class=[`"[[${ut.AssetClass.TASK}]]"`],f.ems__Effort_status='"[[ems__EffortStatusDraft]]"',f.exo__Asset_relates=[`"[[${t}]]"`],i&&i.trim()!==""){let l=i.trim();f.exo__Asset_label=l,f.aliases=[l]}return s&&(f.ems__Task_size=s),f}};ts.TaskFrontmatterGenerator=od;ts.TaskFrontmatterGenerator=od=Vx([(0,qx.injectable)()],od)});var iu=y(rs=>{"use strict";var Wx=rs&&rs.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(rs,"__esModule",{value:!0});rs.AlgorithmExtractor=void 0;var Hx=Qe(),cd=class{static{o(this,"AlgorithmExtractor")}extractH2Section(e,t){let i=e.split(`
`),n=`## ${t}`,s=!1,a=[];for(let u of i){if(u.trim()===n){s=!0;continue}if(s){if(u.startsWith("## ")||u.startsWith("# "))break;a.push(u)}}return a.length===0?null:a.join(`
`).trim()||null}};rs.AlgorithmExtractor=cd;rs.AlgorithmExtractor=cd=Wx([(0,Hx.injectable)()],cd)});var n2=y(i2=>{"use strict";Object.defineProperty(i2,"__esModule",{value:!0})});var it=y(nu=>{"use strict";Object.defineProperty(nu,"__esModule",{value:!0});nu.DI_TOKENS=void 0;nu.DI_TOKENS={IFileSystemAdapter:Symbol.for("IFileSystemAdapter"),IVaultAdapter:Symbol.for("IVaultAdapter"),IVaultContext:Symbol.for("IVaultContext"),IMultiVaultManager:Symbol.for("IMultiVaultManager"),ILogger:Symbol.for("ILogger"),IEventBus:Symbol.for("IEventBus"),IConfiguration:Symbol.for("IConfiguration"),INotificationService:Symbol.for("INotificationService"),TaskCreationService:Symbol.for("TaskCreationService"),ProjectCreationService:Symbol.for("ProjectCreationService"),AreaCreationService:Symbol.for("AreaCreationService"),ClassCreationService:Symbol.for("ClassCreationService"),ConceptCreationService:Symbol.for("ConceptCreationService"),FleetingNoteCreationService:Symbol.for("FleetingNoteCreationService"),SupervisionCreationService:Symbol.for("SupervisionCreationService"),TaskFrontmatterGenerator:Symbol.for("TaskFrontmatterGenerator"),DynamicFrontmatterGenerator:Symbol.for("DynamicFrontmatterGenerator"),AlgorithmExtractor:Symbol.for("AlgorithmExtractor"),TaskStatusService:Symbol.for("TaskStatusService"),EffortStatusWorkflow:Symbol.for("EffortStatusWorkflow"),StatusTimestampService:Symbol.for("StatusTimestampService"),PropertyCleanupService:Symbol.for("PropertyCleanupService"),FolderRepairService:Symbol.for("FolderRepairService"),LabelToAliasService:Symbol.for("LabelToAliasService"),RenameToUidService:Symbol.for("RenameToUidService"),PlanningService:Symbol.for("PlanningService"),EffortVotingService:Symbol.for("EffortVotingService"),SessionEventService:Symbol.for("SessionEventService"),AssetConversionService:Symbol.for("AssetConversionService"),NoteToRDFConverter:Symbol.for("NoteToRDFConverter"),AreaHierarchyBuilder:Symbol.for("AreaHierarchyBuilder"),URIConstructionService:Symbol.for("URIConstructionService")}});var ld=y(Dt=>{"use strict";var zx=Dt&&Dt.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),Kx=Dt&&Dt.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),Yx=Dt&&Dt.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Qx=Dt&&Dt.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var i=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[i.length]=n);return i},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i=r(e),n=0;n<i.length;n++)i[n]!=="default"&&zx(t,e,i[n]);return Kx(t,e),t}})(),Jx=Dt&&Dt.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},Xx=Dt&&Dt.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.TaskCreationService=void 0;var s2=Qe(),a2=Dr(),Zx=Hn(),o2=Ur(),eA=qt(),tA=ru(),rA=iu(),WN=Qx(n2()),iA=it(),ud=class{static{o(this,"TaskCreationService")}constructor(e,t,i){this.vault=e,this.frontmatterGenerator=t,this.algorithmExtractor=i}async createTask(e,t,i,n,s,a){let c=(0,a2.v4)(),u=`${c}.md`,f=this.frontmatterGenerator.generateTaskFrontmatter(t,e.basename,i,n,c,s,a),l="";if(Zx.WikiLinkHelpers.normalize(i)===eA.AssetClass.TASK_PROTOTYPE){let A=await this.vault.read(e),F=this.algorithmExtractor.extractH2Section(A,"Algorithm");F&&(l=`## Algorithm

${F}`)}let p=o2.MetadataHelpers.buildFileContent(f,l),g=e.parent?.path||"",S=g?`${g}/${u}`:u;return await this.vault.create(S,p)}async createRelatedTask(e,t,i,n){let s=(0,a2.v4)(),a=`${s}.md`,c=this.frontmatterGenerator.generateRelatedTaskFrontmatter(t,e.basename,i,s,n),u=o2.MetadataHelpers.buildFileContent(c),f=e.parent?.path||"",l=f?`${f}/${a}`:a,h=await this.vault.create(l,u);return await this.addRelationToSourceFile(e,s),h}generateTaskFrontmatter(e,t,i,n,s,a,c){return this.frontmatterGenerator.generateTaskFrontmatter(e,t,i,n,s,a,c)}generateRelatedTaskFrontmatter(e,t,i,n,s){return this.frontmatterGenerator.generateRelatedTaskFrontmatter(e,t,i,n,s)}extractH2Section(e,t){return this.algorithmExtractor.extractH2Section(e,t)}async addRelationToSourceFile(e,t){let i=await this.vault.read(e),n=this.addRelationToFrontmatter(i,t);await this.vault.modify(e,n)}addRelationToFrontmatter(e,t){let i=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(i),s=e.includes(`\r
`)?`\r
`:`
`;if(!n)return`---${s}exo__Asset_relates:${s}  - "[[${t}]]"${s}---${s}${e}`;let c=n[1];if(c.includes("exo__Asset_relates:")){let u=c.match(/exo__Asset_relates:\r?\n((?: {2}- .*\r?\n)*)/);if(u){let f=u[1],l=`  - "[[${t}]]"${s}`;c=c.replace(/exo__Asset_relates:\r?\n((?: {2}- .*\r?\n)*)/,`exo__Asset_relates:${s}${f}${l}`)}}else c+=`${s}exo__Asset_relates:${s}  - "[[${t}]]"`;return e.replace(i,`---${s}${c}${s}---`)}};Dt.TaskCreationService=ud;Dt.TaskCreationService=ud=Yx([(0,s2.injectable)(),Xx(0,(0,s2.inject)(iA.DI_TOKENS.IVaultAdapter)),Jx("design:paramtypes",[Object,tA.TaskFrontmatterGenerator,rA.AlgorithmExtractor])],ud)});var hd=y(Br=>{"use strict";var nA=Br&&Br.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},sA=Br&&Br.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},aA=Br&&Br.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Br,"__esModule",{value:!0});Br.ProjectCreationService=void 0;var c2=Qe(),u2=Dr(),oA=Hn(),su=qt(),cA=gr(),uA=Xa(),l2=Ur(),lA=it(),fA={[su.AssetClass.AREA]:"ems__Effort_area",[su.AssetClass.INITIATIVE]:"ems__Effort_parent",[su.AssetClass.PROJECT]:"ems__Effort_parent"},fd=class{static{o(this,"ProjectCreationService")}constructor(e){this.vault=e}async createProject(e,t,i,n){let s=(0,u2.v4)(),a=`${s}.md`,c=this.generateProjectFrontmatter(t,e.basename,i,n,s),u=l2.MetadataHelpers.buildFileContent(c),f=e.parent?.path||"",l=f?`${f}/${a}`:a;return await this.vault.create(l,u)}generateProjectFrontmatter(e,t,i,n,s){let a=new Date,c=cA.DateFormatter.toLocalTimestamp(a),u=uA.MetadataExtractor.extractIsDefinedBy(e),f=oA.WikiLinkHelpers.normalize(i),l=fA[f]||"ems__Effort_area",h={};if(h.exo__Asset_isDefinedBy=l2.MetadataHelpers.ensureQuoted(u),h.exo__Asset_uid=s||(0,u2.v4)(),h.exo__Asset_createdAt=c,h.exo__Instance_class=[`"[[${su.AssetClass.PROJECT}]]"`],h.ems__Effort_status='"[[ems__EffortStatusDraft]]"',h[l]=`"[[${t}]]"`,n&&n.trim()!==""){let p=n.trim();h.exo__Asset_label=p,h.aliases=[p]}return h}};Br.ProjectCreationService=fd;Br.ProjectCreationService=fd=nA([(0,c2.injectable)(),aA(0,(0,c2.inject)(lA.DI_TOKENS.IVaultAdapter)),sA("design:paramtypes",[Object])],fd)});var ks=y(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.FrontmatterService=void 0;var au=class r{static{o(this,"FrontmatterService")}parse(e){let t=e.match(r.FRONTMATTER_REGEX);return t?{exists:!0,content:t[1],originalContent:e}:{exists:!1,content:"",originalContent:e}}updateProperty(e,t,i){let n=this.parse(e);if(!n.exists)return this.createFrontmatter(e,{[t]:i});let s=n.content;if(this.hasProperty(s,t)){let a=new RegExp(`${this.escapeRegex(t)}:.*$`,"m");s=s.replace(a,`${t}: ${i}`)}else{let a=s.length>0?`
`:"";s+=`${a}${t}: ${i}`}return e.replace(r.FRONTMATTER_REGEX,`---
${s}
---`)}addProperty(e,t,i){return this.updateProperty(e,t,i)}removeProperty(e,t){let i=this.parse(e);if(!i.exists||!this.hasProperty(i.content,t))return e;let n=new RegExp(`
?${this.escapeRegex(t)}:.*(?:
 {2}- .*)*`,"gm"),s=i.content.replace(n,"");return e.replace(r.FRONTMATTER_REGEX,`---
${s}
---`)}hasProperty(e,t){return e.includes(`${t}:`)}createFrontmatter(e,t){let n=`---
${Object.entries(t).map(([a,c])=>`${a}: ${c}`).join(`
`)}
---`,s=e.startsWith(`
`)?"":`
`;return`${n}${s}${e}`}getPropertyValue(e,t){let i=new RegExp(`${this.escapeRegex(t)}:\\s*(.*)$`,"m"),n=e.match(i);return n?n[1].trim():null}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}};ou.FrontmatterService=au;au.FRONTMATTER_REGEX=/^---\n([\s\S]*?)\n---/});var cu=y(is=>{"use strict";var hA=is&&is.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(is,"__esModule",{value:!0});is.EffortStatusWorkflow=void 0;var dA=Qe(),br=qt(),dd=class{static{o(this,"EffortStatusWorkflow")}getPreviousStatus(e,t){let i=this.normalizeStatus(e);if(i===br.EffortStatus.DRAFT)return null;if(i===br.EffortStatus.BACKLOG)return this.wrapStatus(br.EffortStatus.DRAFT);if(i===br.EffortStatus.ANALYSIS)return this.wrapStatus(br.EffortStatus.BACKLOG);if(i===br.EffortStatus.TODO)return this.wrapStatus(br.EffortStatus.ANALYSIS);if(i===br.EffortStatus.DOING)return this.hasInstanceClass(t,br.AssetClass.PROJECT)?this.wrapStatus(br.EffortStatus.TODO):this.wrapStatus(br.EffortStatus.BACKLOG);if(i===br.EffortStatus.DONE)return this.wrapStatus(br.EffortStatus.DOING)}normalizeStatus(e){return e.replace(/["'[\]]/g,"").trim()}wrapStatus(e){return`"[[${e}]]"`}hasInstanceClass(e,t){return e?(Array.isArray(e)?e:[e]).some(n=>n.replace(/["'[\]]/g,"").trim()===t):!1}};is.EffortStatusWorkflow=dd;is.EffortStatusWorkflow=dd=hA([(0,dA.injectable)()],dd)});var uu=y(Gr=>{"use strict";var pA=Gr&&Gr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},mA=Gr&&Gr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},gA=Gr&&Gr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Gr,"__esModule",{value:!0});Gr.StatusTimestampService=void 0;var f2=Qe(),yA=ks(),Za=gr(),vA=it(),pd=class{static{o(this,"StatusTimestampService")}constructor(e){this.vault=e,this.frontmatterService=new yA.FrontmatterService}async addStartTimestamp(e){let t=await this.vault.read(e),i=Za.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_startTimestamp",i);await this.vault.modify(e,n)}async addEndTimestamp(e,t){let i=await this.vault.read(e),n=t||new Date,s=Za.DateFormatter.toLocalTimestamp(n),a=this.frontmatterService.updateProperty(i,"ems__Effort_endTimestamp",s);await this.vault.modify(e,a)}async addResolutionTimestamp(e){let t=await this.vault.read(e),i=Za.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_resolutionTimestamp",i);await this.vault.modify(e,n)}async addEndAndResolutionTimestamps(e,t){let i=await this.vault.read(e),n=t||new Date,s=Za.DateFormatter.toLocalTimestamp(n),a=this.frontmatterService.updateProperty(i,"ems__Effort_endTimestamp",s);a=this.frontmatterService.updateProperty(a,"ems__Effort_resolutionTimestamp",s),await this.vault.modify(e,a)}async removeStartTimestamp(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_startTimestamp");await this.vault.modify(e,i)}async removeEndTimestamp(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_endTimestamp");await this.vault.modify(e,i)}async removeResolutionTimestamp(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_resolutionTimestamp");await this.vault.modify(e,i)}async removeEndAndResolutionTimestamps(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_endTimestamp");i=this.frontmatterService.removeProperty(i,"ems__Effort_resolutionTimestamp"),await this.vault.modify(e,i)}async shiftPlannedEndTimestamp(e,t){let i=await this.vault.read(e),n=this.frontmatterService.parse(i);if(!n.exists)return;let s=this.frontmatterService.getPropertyValue(n.content,"ems__Effort_plannedEndTimestamp");if(!s)return;let a=new Date(s.replace(/["']/g,""));if(isNaN(a.getTime()))return;let c=new Date(a.getTime()+t),u=Za.DateFormatter.toLocalTimestamp(c),f=this.frontmatterService.updateProperty(i,"ems__Effort_plannedEndTimestamp",u);await this.vault.modify(e,f)}};Gr.StatusTimestampService=pd;Gr.StatusTimestampService=pd=pA([(0,f2.injectable)(),gA(0,(0,f2.inject)(vA.DI_TOKENS.IVaultAdapter)),mA("design:paramtypes",[Object])],pd)});var gd=y(Wr=>{"use strict";var _A=Wr&&Wr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},SA=Wr&&Wr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},wA=Wr&&Wr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.TaskStatusService=void 0;var h2=Qe(),bA=ks(),ns=gr(),EA=cu(),TA=uu(),xA=it(),md=class{static{o(this,"TaskStatusService")}constructor(e,t,i){this.vault=e,this.workflow=t,this.timestampService=i,this.frontmatterService=new bA.FrontmatterService}async setDraftStatus(e){await this.updateStatus(e,"ems__EffortStatusDraft")}async moveToBacklog(e){await this.updateStatus(e,"ems__EffortStatusBacklog")}async moveToAnalysis(e){await this.updateStatus(e,"ems__EffortStatusAnalysis")}async moveToToDo(e){await this.updateStatus(e,"ems__EffortStatusToDo")}async startEffort(e){let t=await this.vault.read(e),i=ns.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');n=this.frontmatterService.updateProperty(n,"ems__Effort_startTimestamp",i),await this.vault.modify(e,n)}async markTaskAsDone(e){let t=await this.vault.read(e),i=ns.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');n=this.frontmatterService.updateProperty(n,"ems__Effort_endTimestamp",i),n=this.frontmatterService.updateProperty(n,"ems__Effort_resolutionTimestamp",i),await this.vault.modify(e,n)}async syncEffortEndTimestamp(e,t){await this.timestampService.addEndAndResolutionTimestamps(e,t)}async shiftPlannedEndTimestamp(e,t){await this.timestampService.shiftPlannedEndTimestamp(e,t)}async trashEffort(e,t){let i=await this.vault.read(e),n=ns.DateFormatter.toLocalTimestamp(new Date),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),t&&(s=this.appendTrashReason(s,t)),await this.vault.modify(e,s)}appendTrashReason(e,t){let i=`

## Trash Reason

${t}`;return e.trimEnd()+i}async archiveTask(e){let t=await this.vault.read(e),i=this.frontmatterService.updateProperty(t,"archived","true");i=this.frontmatterService.removeProperty(i,"aliases"),await this.vault.modify(e,i)}async planOnToday(e){let t=await this.vault.read(e),i=ns.DateFormatter.getTodayStartTimestamp(),n=this.frontmatterService.updateProperty(t,"ems__Effort_plannedStartTimestamp",i);await this.vault.modify(e,n)}async planForEvening(e){let t=await this.vault.read(e),i=new Date;i.setHours(19,0,0,0);let n=ns.DateFormatter.toLocalTimestamp(i),s=this.frontmatterService.updateProperty(t,"ems__Effort_plannedStartTimestamp",n);await this.vault.modify(e,s)}async shiftDayBackward(e){await this.shiftDay(e,-1)}async shiftDayForward(e){await this.shiftDay(e,1)}async rollbackStatus(e){let t=await this.vault.read(e),i=this.extractCurrentStatus(t),n=this.extractInstanceClass(t);if(!i)throw new Error("No current status to rollback from");let s=this.workflow.getPreviousStatus(i,n);if(s===void 0)throw new Error("Cannot rollback from current status");let a=t;s===null?a=this.frontmatterService.removeProperty(a,"ems__Effort_status"):a=this.frontmatterService.updateProperty(a,"ems__Effort_status",s);let c=this.workflow.normalizeStatus(i);c==="ems__EffortStatusDone"?(a=this.frontmatterService.removeProperty(a,"ems__Effort_endTimestamp"),a=this.frontmatterService.removeProperty(a,"ems__Effort_resolutionTimestamp")):c==="ems__EffortStatusDoing"&&(a=this.frontmatterService.removeProperty(a,"ems__Effort_startTimestamp")),await this.vault.modify(e,a)}async updateStatus(e,t){let i=await this.vault.read(e),n=this.frontmatterService.updateProperty(i,"ems__Effort_status",`"[[${t}]]"`);await this.vault.modify(e,n)}async shiftDay(e,t){let i=await this.vault.read(e),n=this.extractPlannedStartTimestamp(i);if(!n)throw new Error("ems__Effort_plannedStartTimestamp property not found");let s=this.parseDateFromTimestamp(n);if(!s)throw new Error("Invalid date format in ems__Effort_plannedStartTimestamp");let a=ns.DateFormatter.addDays(s,t);a.setHours(0,0,0,0);let c=ns.DateFormatter.toLocalTimestamp(a),u=this.frontmatterService.updateProperty(i,"ems__Effort_plannedStartTimestamp",c);await this.vault.modify(e,u)}parseDateFromTimestamp(e){let t=new Date(e);return isNaN(t.getTime())?null:t}extractPlannedStartTimestamp(e){let t=this.frontmatterService.parse(e);return t.exists?this.frontmatterService.getPropertyValue(t.content,"ems__Effort_plannedStartTimestamp"):null}extractCurrentStatus(e){let t=this.frontmatterService.parse(e);return t.exists?this.frontmatterService.getPropertyValue(t.content,"ems__Effort_status"):null}extractInstanceClass(e){let t=this.frontmatterService.parse(e);if(!t.exists)return null;let i=t.content.match(/exo__Instance_class:\s*\n((?:\s*-\s*.*\n?)+)/);return i?i[1].split(`
`).filter(s=>s.trim()).map(s=>s.replace(/^\s*-\s*/,"").trim()):this.frontmatterService.getPropertyValue(t.content,"exo__Instance_class")}};Wr.TaskStatusService=md;Wr.TaskStatusService=md=_A([(0,h2.injectable)(),wA(0,(0,h2.inject)(xA.DI_TOKENS.IVaultAdapter)),SA("design:paramtypes",[Object,EA.EffortStatusWorkflow,TA.StatusTimestampService])],md)});var vd=y(Hr=>{"use strict";var AA=Hr&&Hr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},CA=Hr&&Hr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},OA=Hr&&Hr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.AreaCreationService=void 0;var d2=Qe(),p2=Dr(),FA=qt(),PA=gr(),RA=Xa(),m2=Ur(),IA=it(),yd=class{static{o(this,"AreaCreationService")}constructor(e){this.vault=e}async createChildArea(e,t,i){let n=(0,p2.v4)(),s=`${n}.md`,a=this.generateChildAreaFrontmatter(t,e.basename,i,n),c=m2.MetadataHelpers.buildFileContent(a),u=e.parent?.path||"",f=u?`${u}/${s}`:s;return await this.vault.create(f,c)}generateChildAreaFrontmatter(e,t,i,n){let s=new Date,a=PA.DateFormatter.toLocalTimestamp(s),c=RA.MetadataExtractor.extractIsDefinedBy(e),u={};if(u.exo__Asset_isDefinedBy=m2.MetadataHelpers.ensureQuoted(c),u.exo__Asset_uid=n||(0,p2.v4)(),u.exo__Asset_createdAt=a,u.exo__Instance_class=[`"[[${FA.AssetClass.AREA}]]"`],u.ems__Area_parent=`"[[${t}]]"`,i&&i.trim()!==""){let f=i.trim();u.exo__Asset_label=f,u.aliases=[f]}return u}};Hr.AreaCreationService=yd;Hr.AreaCreationService=yd=AA([(0,d2.injectable)(),OA(0,(0,d2.inject)(IA.DI_TOKENS.IVaultAdapter)),CA("design:paramtypes",[Object])],yd)});var Sd=y(zr=>{"use strict";var DA=zr&&zr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},NA=zr&&zr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},kA=zr&&zr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(zr,"__esModule",{value:!0});zr.AreaHierarchyBuilder=void 0;var g2=Qe(),y2=qt(),jA=it(),_d=class{static{o(this,"AreaHierarchyBuilder")}constructor(e){this.vault=e}buildHierarchy(e,t){let i=this.vault.getAbstractFileByPath(e);if(!this.isFile(i))return null;let n=this.vault.getFrontmatter(i)||{};if(this.extractInstanceClass(n)!==y2.AssetClass.AREA)return null;let a=this.collectAllAreasFromVault(),c=new Set;return this.buildTree(e,a,c,0)}isFile(e){return e&&typeof e=="object"&&"basename"in e&&"path"in e}extractInstanceClass(e){let t=e.exo__Instance_class||"";return Array.isArray(t)?this.cleanWikiLink(t[0]||""):this.cleanWikiLink(t)}cleanWikiLink(e){return typeof e!="string"?"":e.replace(/^\[\[|\]\]$/g,"").trim()}collectAllAreasFromVault(){let e=new Map,t=new Map,i=this.vault.getAllFiles();for(let n of i){let s=this.vault.getFrontmatter(n)||{};if(this.extractInstanceClass(s)===y2.AssetClass.AREA){let c=this.extractParentPath(s);e.set(n.path,{path:n.path,title:n.basename,label:s.exo__Asset_label||void 0,isArchived:this.isArchived(s),depth:0,parentPath:c||void 0}),t.set(n.basename,n.path)}}for(let[,n]of e.entries())n.parentPath&&t.has(n.parentPath)&&(n.parentPath=t.get(n.parentPath));return e}extractParentPath(e){let t=e.ems__Area_parent;if(!t)return null;if(Array.isArray(t)){let i=t[0]||"";return this.cleanWikiLink(i)}return this.cleanWikiLink(t)}isArchived(e){let t=e.exo__Asset_archived;if(t===!0||t==="true")return!0;if(Array.isArray(t)&&t.length>0){let i=t[0];return i===!0||i==="true"}return!1}buildTree(e,t,i,n){if(i.has(e))return null;i.add(e);let s=t.get(e);if(!s)return null;let a=[];for(let[c,u]of t.entries())if(u.parentPath===e){let f=this.buildTree(c,t,i,n+1);f&&a.push(f)}return a.sort((c,u)=>{let f=c.label||c.title,l=u.label||u.title;return f.localeCompare(l)}),{path:s.path,title:s.title,label:s.label,isArchived:s.isArchived,depth:n,parentPath:s.parentPath,children:a}}};zr.AreaHierarchyBuilder=_d;zr.AreaHierarchyBuilder=_d=DA([(0,g2.injectable)(),kA(0,(0,g2.inject)(jA.DI_TOKENS.IVaultAdapter)),NA("design:paramtypes",[Object])],_d)});var bd=y(Kr=>{"use strict";var LA=Kr&&Kr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},MA=Kr&&Kr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},VA=Kr&&Kr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.ClassCreationService=void 0;var v2=Qe(),qA=Dr(),$A=gr(),UA=Ur(),BA=it(),wd=class{static{o(this,"ClassCreationService")}constructor(e){this.vault=e}async createSubclass(e,t,i){let n=(0,qA.v4)(),s=this.generateFileName(t),a=s.endsWith(".md")?s:`${s}.md`,c=this.generateClassFrontmatter(e.basename,t,n,i),u=UA.MetadataHelpers.buildFileContent(c),f="classes",l=`${f}/${a}`;return this.vault.getAbstractFileByPath(f)||await this.vault.createFolder(f),await this.vault.create(l,u)}generateFileName(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}generateClassFrontmatter(e,t,i,n){let s=new Date,a=$A.DateFormatter.toLocalTimestamp(s),c={};c.exo__Asset_uid=i,c.exo__Asset_label=t,c.exo__Asset_createdAt=a,c.exo__Instance_class=['"[[exo__Class]]"'],c.exo__Class_superClass=`"[[${e}]]"`;let u=n.exo__Asset_isDefinedBy||'"[[Ontology/EXO]]"';return c.exo__Asset_isDefinedBy=u,c.aliases=[t],c}};Kr.ClassCreationService=wd;Kr.ClassCreationService=wd=LA([(0,v2.injectable)(),VA(0,(0,v2.inject)(BA.DI_TOKENS.IVaultAdapter)),MA("design:paramtypes",[Object])],wd)});var Td=y(Yr=>{"use strict";var GA=Yr&&Yr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},WA=Yr&&Yr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},HA=Yr&&Yr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.ConceptCreationService=void 0;var _2=Qe(),zA=Dr(),KA=gr(),YA=Ur(),QA=qt(),JA=it(),Ed=class{static{o(this,"ConceptCreationService")}constructor(e){this.vault=e}async createNarrowerConcept(e,t,i,n){let s=(0,zA.v4)(),a=t.endsWith(".md")?t:`${t}.md`,c=this.generateConceptFrontmatter(e.basename,i,n,s),u=YA.MetadataHelpers.buildFileContent(c),f="concepts",l=`${f}/${a}`;return this.vault.getAbstractFileByPath(f)||await this.vault.createFolder(f),await this.vault.create(l,u)}generateConceptFrontmatter(e,t,i,n){let s=new Date,a=KA.DateFormatter.toLocalTimestamp(s),c={};return c.exo__Asset_isDefinedBy='"[[!concepts]]"',c.exo__Asset_uid=n,c.exo__Asset_createdAt=a,c.exo__Instance_class=[`"[[${QA.AssetClass.CONCEPT}]]"`],c.ims__Concept_broader=`"[[${e}]]"`,c.ims__Concept_definition=t,i.length>0&&(c.aliases=i),c}};Yr.ConceptCreationService=Ed;Yr.ConceptCreationService=Ed=GA([(0,_2.injectable)(),HA(0,(0,_2.inject)(JA.DI_TOKENS.IVaultAdapter)),WA("design:paramtypes",[Object])],Ed)});var Ad=y(Qr=>{"use strict";var XA=Qr&&Qr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ZA=Qr&&Qr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},e4=Qr&&Qr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.EffortVotingService=void 0;var S2=Qe(),t4=it(),xd=class{static{o(this,"EffortVotingService")}constructor(e){this.vault=e}async incrementEffortVotes(e){let t=await this.vault.read(e),n=this.extractVoteCount(t)+1,s=this.updateFrontmatterWithVotes(t,n);return await this.vault.modify(e,s),n}extractVoteCount(e){let t=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(t);if(!i)return 0;let s=i[1].match(/ems__Effort_votes:\s*(\d+)/);return s&&s[1]?parseInt(s[1],10):0}updateFrontmatterWithVotes(e,t){let i=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(i),s=e.includes(`\r
`)?`\r
`:`
`;if(!n)return`---${s}ems__Effort_votes: ${t}${s}---${s}${e}`;let c=n[1];return c.includes("ems__Effort_votes:")?c=c.replace(/ems__Effort_votes:.*$/m,`ems__Effort_votes: ${t}`):c+=`${s}ems__Effort_votes: ${t}`,e.replace(i,`---${s}${c}${s}---`)}};Qr.EffortVotingService=xd;Qr.EffortVotingService=xd=XA([(0,S2.injectable)(),e4(0,(0,S2.inject)(t4.DI_TOKENS.IVaultAdapter)),ZA("design:paramtypes",[Object])],xd)});var Od=y(Jr=>{"use strict";var r4=Jr&&Jr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},i4=Jr&&Jr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},n4=Jr&&Jr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.FolderRepairService=void 0;var w2=Qe(),s4=it(),Cd=class{static{o(this,"FolderRepairService")}constructor(e){this.vault=e}async getExpectedFolder(e,t){let i=t?.exo__Asset_isDefinedBy;if(!i)return null;let n=this.extractReference(i);if(!n)return null;let s=this.vault.getFirstLinkpathDest(n,e.path);return s?this.getFileFolder(s):null}async repairFolder(e,t){let i=`${t}/${e.name}`;if(this.vault.getAbstractFileByPath(i))throw new Error(`Cannot move file: ${i} already exists`);await this.ensureFolderExists(t),await this.vault.rename(e,i)}getFileFolder(e){return e.parent?.path||""}extractReference(e){if(typeof e!="string")return null;let t=e.trim().replace(/^["']|["']$/g,"");return t=t.replace(/^\[\[|\]\]$/g,""),t||null}async ensureFolderExists(e){if(!e)return;let t=this.vault.getAbstractFileByPath(e);if(!(t&&"children"in t))try{await this.vault.createFolder(e)}catch(i){if(i instanceof Error&&i.message.includes("Folder already exists"))return;throw i}}};Jr.FolderRepairService=Cd;Jr.FolderRepairService=Cd=r4([(0,w2.injectable)(),n4(0,(0,w2.inject)(s4.DI_TOKENS.IVaultAdapter)),i4("design:paramtypes",[Object])],Cd)});var Pd=y(Xr=>{"use strict";var a4=Xr&&Xr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},o4=Xr&&Xr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},c4=Xr&&Xr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.LabelToAliasService=void 0;var b2=Qe(),u4=it(),Fd=class{static{o(this,"LabelToAliasService")}constructor(e){this.vault=e}async copyLabelToAliases(e){let t=await this.vault.read(e),i=this.extractLabel(t);if(!i)throw new Error("No exo__Asset_label found in file");let n=this.addLabelToAliases(t,i);await this.vault.modify(e,n)}extractLabel(e){let t=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(t);if(!i)return null;let s=i[1].match(/exo__Asset_label:\s*["']?([^"'\r\n]+)["']?/);return s&&s[1]?s[1].trim():null}addLabelToAliases(e,t){let i=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(i),s=e.includes(`\r
`)?`\r
`:`
`;if(!n)return`---${s}aliases:${s}  - "${t}"${s}---${s}${e}`;let c=n[1];return c.includes("aliases:")?c.match(/(aliases:\r?\n(?: {2}- .*\r?\n)*)/)&&(c=c.replace(/(aliases:\r?\n(?: {2}- .*\r?\n)*)/,`$1  - "${t}"${s}`)):c+=`${s}aliases:${s}  - "${t}"`,e.replace(i,`---${s}${c}${s}---`)}};Xr.LabelToAliasService=Fd;Xr.LabelToAliasService=Fd=a4([(0,b2.injectable)(),c4(0,(0,b2.inject)(u4.DI_TOKENS.IVaultAdapter)),o4("design:paramtypes",[Object])],Fd)});var Rd=y(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.LoggingService=void 0;var eo=class{static{o(this,"LoggingService")}static setVerbose(e){this.isVerbose=e}static setDevelopmentMode(e){this.isDevelopment=e}static checkIsDevelopment(){return this.isDevelopment!==void 0?this.isDevelopment:typeof process<"u"?(this.isDevelopment=!1,this.isDevelopment):(this.isDevelopment=!1,this.isDevelopment)}static debug(e,t){this.isVerbose&&console.debug(`[Exocortex] ${e}`,t??"")}static info(e,t){console.log(`[Exocortex] ${e}`,t??"")}static warn(e,t){console.warn(`[Exocortex] ${e}`,t??"")}static error(e,t,i){let n=this.checkIsDevelopment(),s=i?` [${i}]`:"";n?(console.error(`[Exocortex ERROR]${s} ${e}`,t??""),t?.stack&&console.error(`  Stack trace:
${t.stack}`)):(console.error(`[Exocortex ERROR]${s} ${e}`),t?.message&&console.error(`  Details: ${t.message}`))}};lu.LoggingService=eo;eo.isVerbose=!1;eo.isDevelopment=void 0});var Nd=y(Zr=>{"use strict";var l4=Zr&&Zr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},f4=Zr&&Zr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},E2=Zr&&Zr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.PropertyCleanupService=void 0;var Id=Qe(),T2=it(),Dd=class{static{o(this,"PropertyCleanupService")}constructor(e,t){this.vault=e,this.logger=t,this.logger.debug("PropertyCleanupService initialized")}async cleanEmptyProperties(e){this.logger.debug("Cleaning empty properties",{path:e.path});let t=await this.vault.read(e),i=this.removeEmptyPropertiesFromContent(t);await this.vault.modify(e,i),this.logger.info("Empty properties cleaned",{path:e.path})}removeEmptyPropertiesFromContent(e){let t=/^---\n([\s\S]*?)\n---/,i=e.match(t);if(!i)return e;let s=i[1].split(`
`),a=[],c=0;for(;c<s.length;){let f=s[c],l=f.trim();if(l===""){a.push(f),c++;continue}let h=l.match(/^([^:]+):\s*(.*)$/);if(h){let p=h[2];if(p===""&&c+1<s.length&&s[c+1].match(/^\s+- /)){let S=[],_=c+1;for(;_<s.length&&s[_].match(/^\s+- /);)S.push(s[_]),_++;if(S.every(F=>{let P=F.replace(/^\s+- /,"").trim();return this.isEmptyValue(P)})){c=_;continue}else{a.push(f);for(let F=c+1;F<_;F++)a.push(s[F]);c=_;continue}}if(this.isEmptyValue(p)){c++;continue}a.push(f),c++}else l.match(/^\s*- /)||a.push(f),c++}let u=a.join(`
`);return e.replace(t,`---
${u}
---`)}isEmptyValue(e){let t=e.trim();return t===""||t==="null"||t==="undefined"||t==="[]"||t==="{}"||t==='""'||t==="''"}};Zr.PropertyCleanupService=Dd;Zr.PropertyCleanupService=Dd=l4([(0,Id.injectable)(),E2(0,(0,Id.inject)(T2.DI_TOKENS.IVaultAdapter)),E2(1,(0,Id.inject)(T2.DI_TOKENS.ILogger)),f4("design:paramtypes",[Object,Object])],Dd)});var jd=y(ei=>{"use strict";var h4=ei&&ei.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},d4=ei&&ei.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},p4=ei&&ei.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ei,"__esModule",{value:!0});ei.RenameToUidService=void 0;var x2=Qe(),m4=it(),kd=class{static{o(this,"RenameToUidService")}constructor(e){this.vault=e}async renameToUid(e,t){let i=t.exo__Asset_uid;if(!i)throw new Error("Asset has no exo__Asset_uid property");let n=e.basename,s=i;if(n===s)throw new Error("File is already named according to UID");let a=t.exo__Asset_label;if(!a||a.trim()===""){let l=this.isAssetArchived(t);await this.updateLabel(e,n,l)}let u=e.parent?.path||"",f=u?`${u}/${s}.md`:`${s}.md`;await this.vault.updateLinks(e.path,f,n),await this.vault.rename(e,f)}async updateLabel(e,t,i){await this.vault.process(e,n=>{let s=/^---\n([\s\S]*?)\n---/,a=n.match(s);if(!a)return n;let c=a[1],u=i?`${c}
exo__Asset_label: ${t}`:`${c}
exo__Asset_label: ${t}
aliases:
  - ${t}`;return n.replace(s,`---
${u}
---`)})}isAssetArchived(e){if(e?.exo__Asset_isArchived===!0)return!0;let t=e?.archived;if(t==null)return!1;if(typeof t=="boolean")return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){let i=t.toLowerCase().trim();return i==="true"||i==="yes"||i==="1"}return!1}};ei.RenameToUidService=kd;ei.RenameToUidService=kd=h4([(0,x2.injectable)(),p4(0,(0,x2.inject)(m4.DI_TOKENS.IVaultAdapter)),d4("design:paramtypes",[Object])],kd)});var Md=y(ti=>{"use strict";var g4=ti&&ti.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},y4=ti&&ti.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},v4=ti&&ti.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ti,"__esModule",{value:!0});ti.SupervisionCreationService=void 0;var A2=Qe(),_4=Dr(),S4=gr(),w4=it(),Ld=class{static{o(this,"SupervisionCreationService")}constructor(e){this.vault=e}async createSupervision(e){let t=(0,_4.v4)(),i=`${t}.md`,n=this.generateFrontmatter(t),s=this.generateBody(e),a=this.buildFileContent(n,s),c=`01 Inbox/${i}`;return await this.vault.create(c,a)}generateFrontmatter(e){let t=new Date,i=S4.DateFormatter.toLocalTimestamp(t);return{exo__Asset_isDefinedBy:'"[[!kitelev]]"',exo__Asset_uid:e,exo__Asset_createdAt:i,exo__Instance_class:['"[[ztlk__FleetingNote]]"'],ztlk__FleetingNote_type:'"[[CBT-Diary Record]]"'}}generateBody(e){return[{label:"\u0421\u0438\u0442\u0443\u0430\u0446\u0438\u044F/\u0442\u0440\u0438\u0433\u0433\u0435\u0440",value:e.situation},{label:"\u042D\u043C\u043E\u0446\u0438\u0438",value:e.emotions},{label:"\u041C\u044B\u0441\u043B\u0438",value:e.thoughts},{label:"\u041F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u0435",value:e.behavior},{label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0441\u0440\u043E\u0447\u043D\u044B\u0435 \u043F\u043E\u0441\u043B\u0435\u0434\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F",value:e.shortTermConsequences},{label:"\u0414\u043E\u043B\u0433\u043E\u0441\u0440\u043E\u0447\u043D\u044B\u0435 \u043F\u043E\u0441\u043B\u0435\u0434\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F",value:e.longTermConsequences}].map(i=>`- ${i.label}: ${i.value}`).join(`
`)}buildFileContent(e,t){return`---
${Object.entries(e).map(([n,s])=>{if(Array.isArray(s)){let a=s.map(c=>`  - ${c}`).join(`
`);return`${n}:
${a}`}return`${n}: ${s}`}).join(`
`)}
---

${t}
`}};ti.SupervisionCreationService=Ld;ti.SupervisionCreationService=Ld=g4([(0,A2.injectable)(),v4(0,(0,A2.inject)(w4.DI_TOKENS.IVaultAdapter)),y4("design:paramtypes",[Object])],Ld)});var qd=y(ri=>{"use strict";var b4=ri&&ri.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},E4=ri&&ri.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},T4=ri&&ri.__param||function(r,e){return function(t,i){e(t,i,r)}},Vd;Object.defineProperty(ri,"__esModule",{value:!0});ri.FleetingNoteCreationService=void 0;var C2=Qe(),x4=Dr(),A4=gr(),C4=Ur(),O4=it(),fu=Vd=class{static{o(this,"FleetingNoteCreationService")}constructor(e){this.vault=e}async createFleetingNote(e){let t=(0,x4.v4)(),i=`${t}.md`,n=this.generateFrontmatter(t,e),s=C4.MetadataHelpers.buildFileContent(n),a=`${Vd.INBOX_FOLDER}/${i}`;return await this.vault.create(a,s)}generateFrontmatter(e,t){let i=new Date,n=A4.DateFormatter.toLocalTimestamp(i),s=t.trim();return{exo__Asset_isDefinedBy:'"[[!kitelev]]"',exo__Asset_uid:e,exo__Asset_createdAt:n,exo__Instance_class:['"[[ztlk__FleetingNote]]"'],exo__Asset_label:s,aliases:[s]}}};ri.FleetingNoteCreationService=fu;fu.INBOX_FOLDER="01 Inbox";ri.FleetingNoteCreationService=fu=Vd=b4([(0,C2.injectable)(),T4(0,(0,C2.inject)(O4.DI_TOKENS.IVaultAdapter)),E4("design:paramtypes",[Object])],fu)});var Ud=y(ss=>{"use strict";var F4=ss&&ss.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(ss,"__esModule",{value:!0});ss.DynamicFrontmatterGenerator=void 0;var P4=Qe(),R4=Dr(),to=gr(),$d=class{static{o(this,"DynamicFrontmatterGenerator")}generate(e,t,i,n){let s={},a=new Date;n?.isDefinedBy&&(s.exo__Asset_isDefinedBy=this.ensureQuoted(n.isDefinedBy)),s.exo__Asset_uid=n?.uid||(0,R4.v4)(),s.exo__Asset_createdAt=n?.createdAt||to.DateFormatter.toLocalTimestamp(a),s.exo__Instance_class=[this.formatWikilink(e)];let c=new Map;for(let f of i)c.set(f.name,f.type);for(let[f,l]of Object.entries(t)){if(l==null||f==="exo__Asset_uid"||f==="exo__Asset_createdAt"||f==="exo__Instance_class"||f==="exo__Asset_isDefinedBy")continue;let h=c.get(f);s[f]=this.formatValue(l,h)}let u=t.exo__Asset_label;if(u&&typeof u=="string"&&u.trim()!==""){let f=u.trim();s.exo__Asset_label=f,s.aliases=[f]}return s}formatValue(e,t){if(e==null)return null;if(!t)return this.formatInferredValue(e);switch(t){case"text":return this.formatText(e);case"wikilink":return this.formatWikilink(e);case"status-select":case"size-select":return this.formatWikilink(e);case"number":return this.formatNumber(e);case"boolean":return this.formatBoolean(e);case"timestamp":return this.formatTimestamp(e);default:return this.formatText(e)}}formatText(e){return typeof e=="string"?e:String(e)}formatWikilink(e){let t=String(e);return t.startsWith('"[[')&&t.endsWith(']]"')?t:t.startsWith("[[")&&t.endsWith("]]")?`"${t}"`:`"[[${t}]]"`}formatNumber(e){if(typeof e=="number")return e;let t=Number(e);return isNaN(t)?0:t}formatBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){let t=e.toLowerCase().trim();return t==="true"||t==="yes"||t==="1"}return typeof e=="number"?e!==0:!!e}formatTimestamp(e){if(e instanceof Date)return to.DateFormatter.toLocalTimestamp(e);if(typeof e=="string"){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e.replace("Z","");let t=new Date(e);return isNaN(t.getTime())?e:to.DateFormatter.toLocalTimestamp(t)}if(typeof e=="number"){let t=new Date(e);if(!isNaN(t.getTime()))return to.DateFormatter.toLocalTimestamp(t)}return String(e)}formatInferredValue(e){return typeof e=="boolean"||typeof e=="number"?e:e instanceof Date?to.DateFormatter.toLocalTimestamp(e):typeof e=="string"?e.startsWith("[[")||e.startsWith('"[[')?this.formatWikilink(e):e:String(e)}ensureQuoted(e){return!e||e==='""'?'""':e.startsWith('"')&&e.endsWith('"')?e:`"${e}"`}generateYAML(e,t,i,n){let s=this.generate(e,t,i,n);return this.toYAML(s)}toYAML(e){return`---
${Object.entries(e).map(([i,n])=>{if(Array.isArray(n)){let s=n.map(a=>`  - ${a}`).join(`
`);return`${i}:
${s}`}return`${i}: ${n}`}).join(`
`)}
---`}};ss.DynamicFrontmatterGenerator=$d;ss.DynamicFrontmatterGenerator=$d=F4([(0,P4.injectable)()],$d)});var Gd=y(ii=>{"use strict";var I4=ii&&ii.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},D4=ii&&ii.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},N4=ii&&ii.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ii,"__esModule",{value:!0});ii.PlanningService=void 0;var O2=Qe(),k4=ks(),j4=gr(),L4=it(),Bd=class{static{o(this,"PlanningService")}constructor(e){this.vault=e,this.frontmatterService=new k4.FrontmatterService}async planOnToday(e){let t=this.vault.getAbstractFileByPath(e);if(!t||!this.isFile(t))throw new Error(`File not found: ${e}`);let i=await this.vault.read(t),n=j4.DateFormatter.getTodayStartTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_plannedStartTimestamp",n);await this.vault.modify(t,s)}isFile(e){return"basename"in e}};ii.PlanningService=Bd;ii.PlanningService=Bd=I4([(0,O2.injectable)(),N4(0,(0,O2.inject)(L4.DI_TOKENS.IVaultAdapter)),D4("design:paramtypes",[Object])],Bd)});var Hd=y(ni=>{"use strict";var M4=ni&&ni.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},V4=ni&&ni.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},q4=ni&&ni.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ni,"__esModule",{value:!0});ni.AssetConversionService=void 0;var F2=Qe(),P2=qt(),$4=ks(),hu=Rd(),U4=it(),Wd=class{static{o(this,"AssetConversionService")}constructor(e){this.vault=e,this.frontmatterService=new $4.FrontmatterService}async convertTaskToProject(e){try{let t=await this.vault.read(e),i=this.removeInstanceClassProperty(t);return i=this.frontmatterService.updateProperty(i,"exo__Instance_class",`["[[${P2.AssetClass.PROJECT}]]"]`),await this.vault.modify(e,i),hu.LoggingService.info(`Converted Task to Project: ${e.basename} (${e.path})`),e}catch(t){let i=`Failed to convert Task to Project: ${e.path}`;throw hu.LoggingService.error(i,t instanceof Error?t:void 0),new Error(i)}}async convertProjectToTask(e){try{let t=await this.vault.read(e),i=this.removeInstanceClassProperty(t);return i=this.frontmatterService.updateProperty(i,"exo__Instance_class",`["[[${P2.AssetClass.TASK}]]"]`),await this.vault.modify(e,i),hu.LoggingService.info(`Converted Project to Task: ${e.basename} (${e.path})`),e}catch(t){let i=`Failed to convert Project to Task: ${e.path}`;throw hu.LoggingService.error(i,t instanceof Error?t:void 0),new Error(i)}}removeInstanceClassProperty(e){let t=this.frontmatterService.parse(e);if(!t.exists)return e;let i=/^exo__Instance_class:.*$(\n  -.*$)*/gm,n=t.content.replace(i,"").replace(/\n\n+/g,`
`).trim();return e.replace(/^---\n[\s\S]*?\n---/,`---
${n}
---`)}};ni.AssetConversionService=Wd;ni.AssetConversionService=Wd=M4([(0,F2.injectable)(),q4(0,(0,F2.inject)(U4.DI_TOKENS.IVaultAdapter)),V4("design:paramtypes",[Object])],Wd)});var Kd=y(si=>{"use strict";var B4=si&&si.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},G4=si&&si.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},W4=si&&si.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(si,"__esModule",{value:!0});si.SessionEventService=void 0;var R2=Qe(),H4=Dr(),I2=qt(),z4=gr(),K4=Ur(),Y4=it(),zd=class{static{o(this,"SessionEventService")}constructor(e){this.vault=e,this.folderPathCache=null,this.defaultOntologyAsset=null}setDefaultOntologyAsset(e){this.defaultOntologyAsset=e,this.folderPathCache=null}async createSessionStartEvent(e){return this.createSessionEvent(e,I2.AssetClass.SESSION_START_EVENT)}async createSessionEndEvent(e){return this.createSessionEvent(e,I2.AssetClass.SESSION_END_EVENT)}async getOntologyAssetFolder(){if(this.folderPathCache!==null)return this.folderPathCache;if(!this.defaultOntologyAsset){let i=this.vault.getDefaultNewFileParent();return this.folderPathCache=i?.path||"",this.folderPathCache}let e=this.vault.getAllFiles();for(let i of e)if(i.basename===this.defaultOntologyAsset){let n=i.parent?.path||"";return this.folderPathCache=n,this.folderPathCache}let t=this.vault.getDefaultNewFileParent();return this.folderPathCache=t?.path||"",this.folderPathCache}async createSessionEvent(e,t){let i=(0,H4.v4)(),n=z4.DateFormatter.toLocalTimestamp(new Date),s=this.defaultOntologyAsset?`"[[${this.defaultOntologyAsset}]]"`:'"[[!kitelev]]"',a={exo__Asset_uid:i,exo__Asset_createdAt:n,exo__Asset_isDefinedBy:s,exo__Instance_class:[`"[[${t}]]"`],ems__SessionEvent_timestamp:n,ems__Session_area:`"[[${e}]]"`},c=K4.MetadataHelpers.buildFileContent(a),u=await this.getOntologyAssetFolder();u&&!await this.vault.exists(u)&&await this.vault.createFolder(u);let f=u?`${u}/${i}.md`:`${i}.md`;return await this.vault.create(f,c)}};si.SessionEventService=zd;si.SessionEventService=zd=B4([(0,R2.injectable)(),W4(0,(0,R2.inject)(Y4.DI_TOKENS.IVaultAdapter)),G4("design:paramtypes",[Object])],zd)});var Qd=y(ai=>{"use strict";var Q4=ai&&ai.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},J4=ai&&ai.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},X4=ai&&ai.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ai,"__esModule",{value:!0});ai.URIConstructionService=void 0;var D2=Qe(),Z4=it(),Yd=class{static{o(this,"URIConstructionService")}constructor(e){this.fileSystem=e,this.defaultOntologyURL="https://exocortex.my/default/",this.strictValidation=!0}configure(e){e?.defaultOntologyURL&&(this.defaultOntologyURL=e.defaultOntologyURL),e?.strictValidation!==void 0&&(this.strictValidation=e.strictValidation)}async constructAssetURI(e){let t=this.extractUID(e);if(!t){if(this.strictValidation)throw new Error(`Asset missing exo__Asset_uid: ${e.path}`);return console.warn(`Asset ${e.path} missing UID, using filename fallback`),this.constructFallbackURI(e)}let i=await this.resolveOntologyURL(e);if(!this.validateOntologyURL(i))throw new Error(`Invalid ontology URL: ${i}`);return`${i.endsWith("/")?i:`${i}/`}${t}`}validateOntologyURL(e){if(!e)return!1;try{let t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}async resolveOntologyURL(e){let t=e.frontmatter?.exo__Asset_isDefinedBy;if(!t)return this.defaultOntologyURL;let i=this.extractWikiLink(t),n=i,s=await this.fileSystem.fileExists(i);return!s&&!i.endsWith(".md")&&(n=`${i}.md`,s=await this.fileSystem.fileExists(n)),s?(await this.fileSystem.getFileMetadata(n))?.exo__Ontology_url||this.defaultOntologyURL:(console.warn(`Ontology file not found: ${i}, using default`),this.defaultOntologyURL)}extractUID(e){return e.frontmatter?.exo__Asset_uid||null}extractWikiLink(e){return e.replace(/^\[\[|\]\]$/g,"")}constructFallbackURI(e){let t=e.path.split("/").pop()?.replace(".md","")||"unknown";return`${this.defaultOntologyURL}${t}`}};ai.URIConstructionService=Yd;ai.URIConstructionService=Yd=Q4([(0,D2.injectable)(),X4(0,(0,D2.inject)(Z4.DI_TOKENS.IFileSystemAdapter)),J4("design:paramtypes",[Object])],Yd)});var N2=y(du=>{"use strict";Object.defineProperty(du,"__esModule",{value:!0});du.EffortSortingHelpers=void 0;var Jd=class r{static{o(this,"EffortSortingHelpers")}static getTimeFromTimestamp(e){if(!e)return"00:00:00";let t=new Date(e);if(isNaN(t.getTime()))return"00:00:00";let i=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return`${i}:${n}:${s}`}static sortByStartTime(e,t){let i=r.getTimeFromTimestamp(e.startTimestamp),n=r.getTimeFromTimestamp(t.startTimestamp),s=i==="00:00:00",a=n==="00:00:00";return s&&!a?1:!s&&a?-1:i.localeCompare(n)}static sortByPriority(e,t){if(e.isTrashed!==t.isTrashed)return e.isTrashed?1:-1;if(e.isDone!==t.isDone)return e.isDone?1:-1;let i=typeof e.metadata.ems__Effort_votes=="number"?e.metadata.ems__Effort_votes:0,n=typeof t.metadata.ems__Effort_votes=="number"?t.metadata.ems__Effort_votes:0;return i!==n?n-i:e.startTime&&t.startTime?e.startTime.localeCompare(t.startTime):e.startTime?-1:t.startTime?1:0}};du.EffortSortingHelpers=Jd});var k2=y(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});pu.FilenameValidator=void 0;var as=class{static{o(this,"FilenameValidator")}static validate(e,t={}){let{maxLength:i=this.DEFAULT_MAX_LENGTH,replacementChar:n=this.DEFAULT_REPLACEMENT,allowEmpty:s=!1}=t,a=[],c=e;if(!e||e.trim().length===0)return s||a.push("Filename cannot be empty"),{valid:a.length===0,sanitized:"",errors:a};e.endsWith(" ")&&a.push("Filename should not end with a space"),c=e.trim(),this.INVALID_CHARS_PATTERN.test(c)&&a.push('Filename contains invalid characters: / \\ : * ? " < > |');let u=this.getBaseName(c);return this.RESERVED_NAMES.has(u.toUpperCase())&&a.push(`"${u}" is a reserved filename on Windows`),c.length>i&&a.push(`Filename exceeds maximum length of ${i} characters`),c.startsWith(".")&&a.push("Filename should not start with a dot"),c.endsWith(".")&&a.push("Filename should not end with a dot"),c=this.sanitize(e,{maxLength:i,replacementChar:n}),{valid:a.length===0,sanitized:c,errors:a}}static sanitize(e,t={}){let{maxLength:i=this.DEFAULT_MAX_LENGTH,replacementChar:n=this.DEFAULT_REPLACEMENT}=t;if(!e||e.trim().length===0)return"";let s=e.trim();for(s=s.replace(this.INVALID_CHARS_PATTERN,n);s.startsWith(".")&&s.length>1;)s=s.substring(1);s=s.replace(/[. ]+$/,"");let a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");s=s.replace(new RegExp(`${a}+`,"g"),n),s=s.replace(new RegExp(`^${a}+|${a}+$`,"g"),"");let c=this.getBaseName(s);if(this.RESERVED_NAMES.has(c.toUpperCase())){let u=this.getExtension(s);s=c+n+u}return s.length>i&&(s=s.slice(0,i),s=s.replace(new RegExp(`${a}+$`,"g"),"")),s}static hasInvalidChars(e){return this.INVALID_CHARS_PATTERN.test(e)}static getInvalidChars(e){let t=e.match(this.INVALID_CHARS_PATTERN);return t?[...new Set(t)]:[]}static getBaseName(e){let t=e.lastIndexOf(".");return t===-1||t===0?e:e.substring(0,t)}static getExtension(e){let t=e.lastIndexOf(".");return t===-1||t===0?"":e.substring(t)}};pu.FilenameValidator=as;as.INVALID_CHARS_PATTERN=/[/\\:*?"<>|\x00-\x1F]/g;as.RESERVED_NAMES=new Set(["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"]);as.DEFAULT_MAX_LENGTH=200;as.DEFAULT_REPLACEMENT="_"});var Zd=y(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.NTriplesSerializer=void 0;var Xd=class{static{o(this,"NTriplesSerializer")}serialize(e,t={}){let i=t.newline??`
`;return e.length===0?"":e.map(n=>n.toString()).join(i)+i}serializeChunk(e,t){return e.length===0?"":e.map(i=>i.toString()).join(t)+t}};mu.NTriplesSerializer=Xd});var j2=y(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.TurtleSerializer=void 0;var js=bi(),eC=Zd(),tC={rdf:js.Namespace.RDF.iri.value,rdfs:js.Namespace.RDFS.iri.value,owl:js.Namespace.OWL.iri.value,xsd:js.Namespace.XSD.iri.value,exo:js.Namespace.EXO.iri.value,ems:js.Namespace.EMS.iri.value},ep=class{static{o(this,"TurtleSerializer")}constructor(){this.nTriplesSerializer=new eC.NTriplesSerializer}serialize(e,t={}){let i=t.newline??`
`,n=this.composePrefixes(t),s=this.serializePrefixes(n,i),a=this.nTriplesSerializer.serialize(e,{newline:i}).trimEnd();return s?a?`${s}${i}${i}${a}${i}`:`${s}${i}`:a?`${a}${i}`:""}serializePrefixes(e,t){let i=Object.entries(e);return i.length===0?"":i.map(([n,s])=>`@prefix ${n}: <${s}> .`).join(t)}composePrefixes(e){return e.includeDefaultPrefixes??!0?{...tC,...e.prefixes??{}}:{...e.prefixes??{}}}serializeTriplesOnly(e,t){return this.nTriplesSerializer.serializeChunk(e,t).trimEnd()}};gu.TurtleSerializer=ep});var V2=y(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});yu.JSONLDSerializer=void 0;var L2=at(),M2=Sr(),rC=Pt(),Ls=bi(),iC={rdf:Ls.Namespace.RDF.iri.value,rdfs:Ls.Namespace.RDFS.iri.value,owl:Ls.Namespace.OWL.iri.value,xsd:Ls.Namespace.XSD.iri.value,exo:Ls.Namespace.EXO.iri.value,ems:Ls.Namespace.EMS.iri.value},tp=class{static{o(this,"JSONLDSerializer")}toDocument(e,t={}){let i={...iC,...t.context??{}},n=new Map;for(let s of e){let a=this.subjectToId(s.subject),c=this.compactIri(s.predicate.value,i),u=this.objectToJSONLD(s.object,i),f=n.get(a)??{"@id":a},l=f[c];l===void 0?f[c]=u:Array.isArray(l)?l.push(u):f[c]=[l,u],n.set(a,f)}return{"@context":i,"@graph":Array.from(n.values())}}serialize(e,t={}){let i=this.toDocument(e,t),n=t.pretty?t.indent??2:void 0;return JSON.stringify(i,null,n)}subjectToId(e){return e instanceof L2.IRI?e.value:e instanceof M2.BlankNode?`_:${e.id}`:String(e)}compactIri(e,t){for(let[i,n]of Object.entries(t))if(e.startsWith(n)){let s=e.slice(n.length);if(s.length>0)return`${i}:${s}`}return e}objectToJSONLD(e,t){if(e instanceof L2.IRI)return{"@id":e.value};if(e instanceof M2.BlankNode)return{"@id":`_:${e.id}`};if(e instanceof rC.Literal){let i={"@value":e.value};return e.datatype?i["@type"]=this.compactIri(e.datatype.value,t):e.language&&(i["@language"]=e.language),i}return e}};yu.JSONLDSerializer=tp});var np=y(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.NTriplesParser=void 0;var nC=Wn(),q2=at(),rp=Pt(),sC=Sr(),Ms=bi(),aC={rdf:Ms.Namespace.RDF.iri.value,rdfs:Ms.Namespace.RDFS.iri.value,owl:Ms.Namespace.OWL.iri.value,xsd:Ms.Namespace.XSD.iri.value,exo:Ms.Namespace.EXO.iri.value,ems:Ms.Namespace.EMS.iri.value},ip=class{static{o(this,"NTriplesParser")}parse(e,t={}){let i={prefixes:{...aC,...t.prefixes??{}},strict:t.strict??!1},n=[];return e.split(/\r?\n/).forEach((a,c)=>{let u=a.trim();!u||u.startsWith("#")||n.push(this.parseLine(u,c+1,i))}),n}parseLine(e,t,i){if(!e.endsWith("."))throw new Error(`Invalid RDF statement at line ${t}: missing '.' terminator`);let s=e.slice(0,-1).trim(),a=this.parseSubject(s,t,i);s=a.rest.trim();let c=this.parsePredicate(s,t,i);s=c.rest.trim();let u=this.parseObject(s,t,i);if(s=u.rest.trim(),s.length>0)throw new Error(`Unexpected tokens after object at line ${t}`);return new nC.Triple(a.node,c.node,u.node)}parseSubject(e,t,i){return e.startsWith("<")?this.consumeIRI(e,t,i):e.startsWith("_:")?this.consumeBlankNode(e,t):this.consumePrefixedName(e,t,i)}parsePredicate(e,t,i){return e.startsWith("<")?this.consumeIRI(e,t,i):this.consumePrefixedName(e,t,i)}parseObject(e,t,i){return e.startsWith("<")?this.consumeIRI(e,t,i):e.startsWith("_:")?this.consumeBlankNode(e,t):e.startsWith('"')?this.consumeLiteral(e,t,i):this.consumePrefixedName(e,t,i)}consumePrefixedName(e,t,i){let n=e.match(/^([a-zA-Z_][\w-]*):([^\s]+)(?:\s+(.*))?$/);if(!n)throw new Error(`Invalid token at line ${t}: ${e}`);let[,s,a,c]=n,u=i.prefixes[s];if(!u)throw new Error(`Unknown prefix "${s}" at line ${t}`);return{node:new q2.IRI(`${u}${a}`),rest:(c??"").trimStart()}}consumeIRI(e,t,i){let n=this.findClosingBracket(e,"<",">");if(n===-1)throw new Error(`Invalid IRI at line ${t}`);let s=e.slice(1,n),a=new q2.IRI(s),c=e.slice(n+1).trimStart();return{node:a,rest:c}}consumeBlankNode(e,t){let i=e.match(/^_:(\w+)(?:\s+(.*))?$/);if(!i)throw new Error(`Invalid blank node identifier at line ${t}`);let[,n,s]=i;return{node:new sC.BlankNode(n),rest:(s??"").trimStart()}}consumeLiteral(e,t,i){let{value:n,rest:s}=this.consumeQuotedString(e,t),a=s.trimStart();if(a.startsWith("^^")){a=a.slice(2).trimStart();let c=a.startsWith("<")?this.consumeIRI(a,t,i):this.consumePrefixedName(a,t,i);return{node:new rp.Literal(n,c.node),rest:c.rest}}if(a.startsWith("@")){let c=a.match(/^@([a-zA-Z-]+)(?:\s+(.*))?$/);if(!c)throw new Error(`Invalid language tag at line ${t}`);let[,u,f]=c;return{node:new rp.Literal(n,void 0,u),rest:(f??"").trimStart()}}return{node:new rp.Literal(n),rest:a}}consumeQuotedString(e,t){if(!e.startsWith('"'))throw new Error(`Expected quoted string at line ${t}`);let i="";for(let n=1;n<e.length;n++){let s=e[n];if(s==="\\"){if(n+1>=e.length)throw new Error(`Invalid escape sequence at line ${t}`);let a=e[n+1];switch(a){case"t":i+="	",n+=1;break;case"b":i+="\b",n+=1;break;case"n":i+=`
`,n+=1;break;case"r":i+="\r",n+=1;break;case"f":i+="\f",n+=1;break;case'"':i+='"',n+=1;break;case"\\":i+="\\",n+=1;break;case"u":{let c=e.slice(n+2,n+6);if(c.length!==4||!/^[0-9a-fA-F]{4}$/.test(c))throw new Error(`Invalid \\u escape at line ${t}`);i+=String.fromCharCode(parseInt(c,16)),n+=5;break}case"U":{let c=e.slice(n+2,n+10);if(c.length!==8||!/^[0-9a-fA-F]{8}$/.test(c))throw new Error(`Invalid \\U escape at line ${t}`);i+=String.fromCodePoint(parseInt(c,16)),n+=9;break}default:throw new Error(`Unknown escape sequence \\${a} at line ${t}`)}continue}if(s==='"'){let a=e.slice(n+1);return{value:i,rest:a}}i+=s}throw new Error(`Unterminated string literal at line ${t}`)}findClosingBracket(e,t,i){let n=0;for(let s=0;s<e.length;s++){let a=e[s];if(a===t){n++;continue}if(a===i&&(n--,n===0))return s}return-1}};vu.NTriplesParser=ip});var $2=y(_u=>{"use strict";Object.defineProperty(_u,"__esModule",{value:!0});_u.TurtleParser=void 0;var Vs=bi(),oC=np(),cC={rdf:Vs.Namespace.RDF.iri.value,rdfs:Vs.Namespace.RDFS.iri.value,owl:Vs.Namespace.OWL.iri.value,xsd:Vs.Namespace.XSD.iri.value,exo:Vs.Namespace.EXO.iri.value,ems:Vs.Namespace.EMS.iri.value},uC=/^@prefix\s+([a-zA-Z_][\w-]*):\s*<([^>]+)>\s*\.$/,sp=class{static{o(this,"TurtleParser")}constructor(){this.nTriplesParser=new oC.NTriplesParser}parse(e,t={}){let i={...cC,...t.prefixes??{}},n=this.collectStatements(e),s=[];return n.forEach(({statement:a,lineNumber:c})=>{if(this.isPrefixStatement(a)){let f=a.match(uC);if(!f)throw new Error(`Invalid prefix declaration at line ${c}`);let[,l,h]=f;i[l]=h;return}if(a.includes(";")||a.includes(","))throw new Error(`Complex Turtle statements with ';' or ',' are not supported (line ${c})`);let u=this.normalizeShortcuts(a);s.push(this.nTriplesParser.parseLine(u,c,{prefixes:i,strict:!1}))}),s}collectStatements(e){let t=e.split(/\r?\n/),i=[],n="",s=0;if(t.forEach((a,c)=>{let u=a.trim();!u||u.startsWith("#")||(n||(s=c+1),n=n?`${n} ${u}`:u,u.endsWith(".")&&(i.push({statement:n,lineNumber:s}),n=""))}),n)throw new Error(`Unterminated Turtle statement near line ${s}`);return i}isPrefixStatement(e){return e.startsWith("@prefix")}normalizeShortcuts(e){return e.includes(" a ")?e.replace(/\sa\s/g," rdf:type "):e}};_u.TurtleParser=sp});var U2=y(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.RDFSerializer=void 0;var qs=Wn(),os=at(),$s=Pt(),ap=Sr(),Ti=bi(),lC=j2(),fC=Zd(),hC=V2(),dC=$2(),pC=np(),mC=1024,gC=`
`,yC={rdf:Ti.Namespace.RDF.iri.value,rdfs:Ti.Namespace.RDFS.iri.value,owl:Ti.Namespace.OWL.iri.value,xsd:Ti.Namespace.XSD.iri.value,exo:Ti.Namespace.EXO.iri.value,ems:Ti.Namespace.EMS.iri.value},op=class{static{o(this,"RDFSerializer")}constructor(e){this.store=e,this.turtleSerializer=new lC.TurtleSerializer,this.nTriplesSerializer=new fC.NTriplesSerializer,this.jsonldSerializer=new hC.JSONLDSerializer,this.turtleParser=new dC.TurtleParser,this.nTriplesParser=new pC.NTriplesParser}async serialize(e,t={}){let i=await this.store.match();return this.serializeTriples(i,e,t)}serializeTriples(e,t,i={}){switch(t){case"turtle":return this.turtleSerializer.serialize(e,{prefixes:i.prefixes,includeDefaultPrefixes:i.includeDefaultPrefixes,newline:i.newline});case"n-triples":return this.nTriplesSerializer.serialize(e,{newline:i.newline});case"json-ld":return this.jsonldSerializer.serialize(e,{context:i.prefixes,pretty:i.pretty,indent:i.indent});default:throw new Error(`Unsupported serialization format: ${t}`)}}stream(e,t={}){let i=t.newline??gC,n=t.batchSize??mC,s=t.includeDefaultPrefixes,a=t.prefixes,c=this,u=!1,f=[],l=[],h=0,p=o(async()=>{if(!u){if(l=await c.store.match(),e==="json-ld"){let S=c.jsonldSerializer.toDocument(l,{context:a,pretty:!1});f.push(...c.buildJsonLdChunks(S))}else if(e==="turtle"){let S=c.turtleSerializer.serializePrefixes(c.composePrefixes(a,s),i);S&&f.push(`${S}${i}${i}`)}u=!0}},"ensureInitialized");return{async next(){if(await p(),f.length>0)return{value:f.shift(),done:!1};if(e==="json-ld")return{value:void 0,done:!0};if(h>=l.length)return{value:void 0,done:!0};let S=l.slice(h,h+n);h+=S.length;let _="";if(e==="turtle"){let A=c.turtleSerializer.serializeTriplesOnly(S,i);A&&(_=`${A}${i}`)}else e==="n-triples"&&(_=c.nTriplesSerializer.serializeChunk(S,i));return _?{value:_,done:!1}:this.next()},async return(){return f=[],l=[],h=0,{value:void 0,done:!0}},[Symbol.asyncIterator](){return this}}}async load(e,t,i={}){let n=this.parse(e,t,i);return i.mode!=="append"&&await this.store.clear(),await this.store.addAll(n),n.length}parse(e,t,i={}){switch(t){case"turtle":return this.turtleParser.parse(e,this.buildTurtleParseOptions(i));case"n-triples":return this.nTriplesParser.parse(e,this.buildNTriplesParseOptions(i));case"json-ld":return this.parseJsonLd(e,i);default:throw new Error(`Unsupported serialization format: ${t}`)}}buildTurtleParseOptions(e){return{prefixes:this.composePrefixes(e.prefixes,!0),strict:e.strict}}buildNTriplesParseOptions(e){return{prefixes:this.composePrefixes(e.prefixes,!0),strict:e.strict}}composePrefixes(e,t){return t??!0?{...yC,...e??{}}:{...e??{}}}parseJsonLd(e,t){let i;try{i=JSON.parse(e)}catch(f){throw new Error(`Invalid JSON-LD document: ${f.message}`)}let n=this.composePrefixes(t.prefixes,!0),s=this.extractContext(i),a={...n,...s},c=this.extractGraph(i),u=[];return c.forEach((f,l)=>{if(!f||typeof f!="object"||Array.isArray(f))throw new Error(`Invalid JSON-LD node at index ${l}`);let h=this.parseSubjectFromNode(f,a,l),p=Object.entries(f);for(let[g,S]of p){if(g==="@id"||g==="@context")continue;if(g==="@type"){this.collectTypeTriples(h,S,u,a);continue}let _=this.expandTerm(g,a),A=new os.IRI(_);this.collectTriplesForValue(h,A,S,u,a)}}),u}extractContext(e){if(!e||typeof e!="object"||Array.isArray(e))return{};let t=e["@context"];if(!t||typeof t!="object"||Array.isArray(t))return{};let i={};return Object.entries(t).forEach(([n,s])=>{typeof s=="string"&&(i[n]=s)}),i}extractGraph(e){if(Array.isArray(e))return e;if(!e||typeof e!="object")return[];let t=e["@graph"];return Array.isArray(t)?t:[e]}parseSubjectFromNode(e,t,i){let n=e["@id"];if(typeof n=="string"){if(n.startsWith("_:"))return new ap.BlankNode(n.slice(2));if(this.isAbsoluteIri(n))return new os.IRI(n);let s=this.expandTerm(n,t);return new os.IRI(s)}return new ap.BlankNode(`jsonld_${i}`)}collectTypeTriples(e,t,i,n){let s=Ti.Namespace.RDF.term("type");(Array.isArray(t)?t:[t]).forEach(c=>{if(typeof c!="string")throw new Error("Invalid @type value in JSON-LD node");let u=this.expandTerm(c,n);i.push(new qs.Triple(e,s,new os.IRI(u)))})}collectTriplesForValue(e,t,i,n,s){if(i!=null){if(Array.isArray(i)){i.forEach(a=>this.collectTriplesForValue(e,t,a,n,s));return}if(typeof i=="object"){let a=i;if(typeof a["@id"]=="string"){let c=this.parseIdNode(a["@id"],s);n.push(new qs.Triple(e,t,c));return}if(a["@value"]!==void 0){let c=this.parseLiteralObject(a,s);n.push(new qs.Triple(e,t,c));return}}if(typeof i=="string"){n.push(new qs.Triple(e,t,new $s.Literal(i)));return}if(typeof i=="number"){let a=Number.isInteger(i)?Ti.Namespace.XSD.term("integer"):Ti.Namespace.XSD.term("decimal");n.push(new qs.Triple(e,t,new $s.Literal(i.toString(),a)));return}if(typeof i=="boolean"){let a=Ti.Namespace.XSD.term("boolean");n.push(new qs.Triple(e,t,new $s.Literal(i.toString(),a)));return}throw new Error("Unsupported JSON-LD value encountered")}}parseIdNode(e,t){if(e.startsWith("_:"))return new ap.BlankNode(e.slice(2));if(this.isAbsoluteIri(e))return new os.IRI(e);let i=this.expandTerm(e,t);return new os.IRI(i)}parseLiteralObject(e,t){let i=e["@value"];if(typeof i!="string")throw new Error("JSON-LD literal values must be strings");if(typeof e["@language"]=="string")return new $s.Literal(i,void 0,e["@language"]);if(typeof e["@type"]=="string"){let n=this.expandTerm(e["@type"],t);return new $s.Literal(i,new os.IRI(n))}return new $s.Literal(i)}expandTerm(e,t){if(this.isAbsoluteIri(e))return e;let i=e.indexOf(":");if(i>0){let s=e.slice(0,i),a=e.slice(i+1),c=t[s];if(!c)throw new Error(`Unknown prefix "${s}" in JSON-LD document`);return`${c}${a}`}let n=t["@vocab"];if(n)return`${n}${e}`;throw new Error(`Unable to expand JSON-LD term "${e}"`)}isAbsoluteIri(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)}buildJsonLdChunks(e){let t=[],i=JSON.stringify(e["@context"]);return t.push(`{"@context":${i},"@graph":[`),e["@graph"].forEach((n,s)=>{let a=JSON.stringify(n);s>0?t.push(`,${a}`):t.push(a)}),t.push(`]}
`),t}};Su.RDFSerializer=op});var B2=y(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.TransactionError=vn.TripleNotFoundError=vn.TripleAlreadyExistsError=void 0;var cp=class extends Error{static{o(this,"TripleAlreadyExistsError")}constructor(e){super(`Triple already exists: ${e.toString()}`),this.name="TripleAlreadyExistsError"}};vn.TripleAlreadyExistsError=cp;var up=class extends Error{static{o(this,"TripleNotFoundError")}constructor(e){super(`Triple not found: ${e.toString()}`),this.name="TripleNotFoundError"}};vn.TripleNotFoundError=up;var lp=class extends Error{static{o(this,"TransactionError")}constructor(e){super(e),this.name="TransactionError"}};vn.TransactionError=lp});var hp=y(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.LRUCache=void 0;var fp=class{static{o(this,"LRUCache")}constructor(e){this.maxSize=e,this.cache=new Map}get(e){let t=this.cache.get(e);return t!==void 0&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){let i=this.cache.keys().next().value;i!==void 0&&this.cache.delete(i)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}};wu.LRUCache=fp});var G2=y(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});Eu.InMemoryTripleStore=void 0;var _n=B2(),bu=at(),vC=Sr(),_C=Pt(),SC=bi(),wC=hp(),bC=SC.Namespace.XSD.term("string").value,EC=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi,Us="__default__",dp=class r{static{o(this,"InMemoryTripleStore")}constructor(){this.triples=new Map,this.spo=new Map,this.sop=new Map,this.pso=new Map,this.pos=new Map,this.osp=new Map,this.ops=new Map,this.queryCache=new wC.LRUCache(1e3),this.uuidIndex=new Map,this.namedGraphs=new Map}async add(e){let t=this.getTripleKey(e);if(this.triples.has(t))return;this.triples.set(t,e);let i=this.getNodeKey(e.subject),n=this.getNodeKey(e.predicate),s=this.getNodeKey(e.object);this.addToIndex(this.spo,i,n,s),this.addToIndex(this.sop,i,s,n),this.addToIndex(this.pso,n,i,s),this.addToIndex(this.pos,n,s,i),this.addToIndex(this.osp,s,i,n),this.addToIndex(this.ops,s,n,i),this.addToUUIDIndex(e.subject),this.queryCache.clear()}async remove(e){let t=this.getTripleKey(e);if(!this.triples.has(t))return!1;this.triples.delete(t);let i=this.getNodeKey(e.subject),n=this.getNodeKey(e.predicate),s=this.getNodeKey(e.object);return this.removeFromIndex(this.spo,i,n,s),this.removeFromIndex(this.sop,i,s,n),this.removeFromIndex(this.pso,n,i,s),this.removeFromIndex(this.pos,n,s,i),this.removeFromIndex(this.osp,s,i,n),this.removeFromIndex(this.ops,s,n,i),this.queryCache.clear(),!0}async has(e){let t=this.getTripleKey(e);return this.triples.has(t)}async match(e,t,i){let n=this.getMatchCacheKey(e,t,i),s=this.queryCache.get(n);if(s!==void 0)return s;let a;return!e&&!t&&!i?a=Array.from(this.triples.values()):e&&t&&i?a=this.matchSPO(e,t,i):e&&t?a=this.matchSP(e,t):e&&i?a=this.matchSO(e,i):t&&i?a=this.matchPO(t,i):e?a=this.matchS(e):t?a=this.matchP(t):i?a=this.matchO(i):a=[],this.queryCache.set(n,a),a}async addAll(e){for(let t of e)await this.add(t)}async removeAll(e){let t=0;for(let i of e)await this.remove(i)&&t++;return t}async clear(){this.triples.clear(),this.spo.clear(),this.sop.clear(),this.pso.clear(),this.pos.clear(),this.osp.clear(),this.ops.clear(),this.uuidIndex.clear(),this.queryCache.clear()}async count(){return this.triples.size}async subjects(){let e=new Set;for(let t of this.triples.values())e.add(t.subject);return Array.from(e)}async predicates(){let e=new Set;for(let t of this.triples.values())e.add(t.predicate);return Array.from(e)}async objects(){let e=new Set;for(let t of this.triples.values())e.add(t.object);return Array.from(e)}async beginTransaction(){return new pp(this)}async findSubjectsByUUID(e){return this.findSubjectsByUUIDSync(e)}findSubjectsByUUIDSync(e){let t=e.toLowerCase(),i=this.uuidIndex.get(t);if(!i||i.size===0)return[];let n=[];for(let s of i)this.spo.has(`i:${s}`)&&n.push(new bu.IRI(s));return n}addToUUIDIndex(e){if(!(e instanceof bu.IRI))return;let t=e.value,i=t.match(EC);if(i)for(let n of i){let s=n.toLowerCase();this.uuidIndex.has(s)||this.uuidIndex.set(s,new Set),this.uuidIndex.get(s).add(t)}}matchSPO(e,t,i){let n=this.getNodeKey(e),s=this.getNodeKey(t),a=this.getNodeKey(i),c=this.spo.get(n);if(!c)return[];let u=c.get(s);if(!u)return[];if(u.has(a)){let f=this.buildTripleKey(n,s,a),l=this.triples.get(f);return l?[l]:[]}return[]}matchSP(e,t){let i=this.getNodeKey(e),n=this.getNodeKey(t),s=this.spo.get(i);if(!s)return[];let a=s.get(n);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(i,n,c))):[]}matchSO(e,t){let i=this.getNodeKey(e),n=this.getNodeKey(t),s=this.sop.get(i);if(!s)return[];let a=s.get(n);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(i,c,n))):[]}matchPO(e,t){let i=this.getNodeKey(e),n=this.getNodeKey(t),s=this.pos.get(i);if(!s)return[];let a=s.get(n);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(c,i,n))):[]}matchS(e){let t=this.getNodeKey(e),i=this.spo.get(t);if(!i)return[];let n=[];for(let[s,a]of i.entries())for(let c of a)n.push(this.buildTripleKey(t,s,c));return this.getTriplesByKeys(n)}matchP(e){let t=this.getNodeKey(e),i=this.pso.get(t);if(!i)return[];let n=[];for(let[s,a]of i.entries())for(let c of a)n.push(this.buildTripleKey(s,t,c));return this.getTriplesByKeys(n)}matchO(e){let t=this.getNodeKey(e),i=this.osp.get(t);if(!i)return[];let n=[];for(let[s,a]of i.entries())for(let c of a)n.push(this.buildTripleKey(s,c,t));return this.getTriplesByKeys(n)}getTriplesByKeys(e){let t=[];for(let i of e){let n=this.triples.get(i);n&&t.push(n)}return t}addToIndex(e,t,i,n){e.has(t)||e.set(t,new Map);let s=e.get(t);s.has(i)||s.set(i,new Set),s.get(i).add(n)}removeFromIndex(e,t,i,n){let s=e.get(t);if(!s)return;let a=s.get(i);a&&(a.delete(n),a.size===0&&s.delete(i),s.size===0&&e.delete(t))}getTripleKey(e){let t=this.getNodeKey(e.subject),i=this.getNodeKey(e.predicate),n=this.getNodeKey(e.object);return this.buildTripleKey(t,i,n)}buildTripleKey(e,t,i){return`${e}|${t}|${i}`}getNodeKey(e){if(e instanceof bu.IRI)return`i:${e.value}`;if(e instanceof vC.BlankNode)return`b:${e.id}`;if(e instanceof _C.Literal){let t=`l:${e.value}`;return e.datatype&&e.datatype.value!==bC?t+=`^^${e.datatype.value}`:e.language&&(t+=`@${e.language}`),t}return""}getMatchCacheKey(e,t,i){let n=e?this.getNodeKey(e):"?",s=t?this.getNodeKey(t):"?",a=i?this.getNodeKey(i):"?";return`${n}|${s}|${a}`}getGraphKey(e){return e?e.value:Us}getOrCreateGraphStore(e){let t=this.getGraphKey(e);return t===Us?this:(this.namedGraphs.has(t)||this.namedGraphs.set(t,new r),this.namedGraphs.get(t))}async addToGraph(e,t){await this.getOrCreateGraphStore(t).add(e)}async removeFromGraph(e,t){let i=this.getGraphKey(t);if(i===Us)return this.remove(e);let n=this.namedGraphs.get(i);return n?n.remove(e):!1}async matchInGraph(e,t,i,n){let s=this.getGraphKey(n);if(s===Us)return this.match(e,t,i);let a=this.namedGraphs.get(s);return a?a.match(e,t,i):[]}async getNamedGraphs(){return Array.from(this.namedGraphs.keys()).map(e=>new bu.IRI(e))}async hasGraph(e){let t=this.namedGraphs.get(e.value);return t?await t.count()>0:!1}async clearGraph(e){let t=this.getGraphKey(e);if(t===Us){await this.clear();return}let i=this.namedGraphs.get(t);i&&(await i.clear(),this.namedGraphs.delete(t))}async countInGraph(e){let t=this.getGraphKey(e);if(t===Us)return this.count();let i=this.namedGraphs.get(t);return i?i.count():0}};Eu.InMemoryTripleStore=dp;var pp=class{static{o(this,"InMemoryTransaction")}constructor(e){this.store=e,this.operations=[],this.committed=!1,this.rolledBack=!1}async add(e){if(this.committed)throw new _n.TransactionError("Transaction already committed");if(this.rolledBack)throw new _n.TransactionError("Transaction already rolled back");this.operations.push({type:"add",triple:e})}async remove(e){if(this.committed)throw new _n.TransactionError("Transaction already committed");if(this.rolledBack)throw new _n.TransactionError("Transaction already rolled back");return this.operations.push({type:"remove",triple:e}),!0}async commit(){if(this.committed)throw new _n.TransactionError("Transaction already committed");if(this.rolledBack)throw new _n.TransactionError("Transaction already rolled back");for(let e of this.operations)e.type==="add"?await this.store.add(e.triple):await this.store.remove(e.triple);this.committed=!0,this.operations=[]}async rollback(){if(this.committed)throw new _n.TransactionError("Transaction already committed");if(this.rolledBack)throw new _n.TransactionError("Transaction already rolled back");this.operations=[],this.rolledBack=!0}}});var gp=y(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.RDFVocabularyMapper=void 0;var Er=Wn(),W2=at(),he=bi(),mp=class{static{o(this,"RDFVocabularyMapper")}constructor(){this.propertyMappings=new Map([["exo__Instance_class",he.Namespace.RDF.term("type")],["exo__Asset_isDefinedBy",he.Namespace.RDFS.term("isDefinedBy")],["exo__Class_superClass",he.Namespace.RDFS.term("subClassOf")],["exo__Property_range",he.Namespace.RDFS.term("range")],["exo__Property_domain",he.Namespace.RDFS.term("domain")],["exo__Property_superProperty",he.Namespace.RDFS.term("subPropertyOf")]])}generateClassHierarchyTriples(){let e=[];return e.push(new Er.Triple(he.Namespace.EXO.term("Asset"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.RDFS.term("Resource"))),e.push(new Er.Triple(he.Namespace.EXO.term("Class"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.RDFS.term("Class"))),e.push(new Er.Triple(he.Namespace.EXO.term("Property"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.RDF.term("Property"))),e.push(new Er.Triple(he.Namespace.EMS.term("Task"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.EXO.term("Asset"))),e.push(new Er.Triple(he.Namespace.EMS.term("Project"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.EXO.term("Asset"))),e.push(new Er.Triple(he.Namespace.EMS.term("Area"),he.Namespace.RDFS.term("subClassOf"),he.Namespace.EXO.term("Asset"))),e}generatePropertyHierarchyTriples(){let e=[];return e.push(new Er.Triple(he.Namespace.EXO.term("Instance_class"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDF.term("type"))),e.push(new Er.Triple(he.Namespace.EXO.term("Asset_isDefinedBy"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("isDefinedBy"))),e.push(new Er.Triple(he.Namespace.EXO.term("Class_superClass"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("subClassOf"))),e.push(new Er.Triple(he.Namespace.EXO.term("Property_range"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("range"))),e.push(new Er.Triple(he.Namespace.EXO.term("Property_domain"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("domain"))),e.push(new Er.Triple(he.Namespace.EXO.term("Property_superProperty"),he.Namespace.RDFS.term("subPropertyOf"),he.Namespace.RDFS.term("subPropertyOf"))),e}generateMappedTriple(e,t,i){let n=this.propertyMappings.get(t);if(!n)return null;let s;if(i instanceof W2.IRI)s=i;else{let a=i.match(/^(ems|exo)__(.+)$/);if(a){let[,c,u]=a;s=(c==="ems"?he.Namespace.EMS:he.Namespace.EXO).term(u)}else s=new W2.IRI(i)}return new Er.Triple(e,n,s)}hasMappingFor(e){return this.propertyMappings.has(e)}};Tu.RDFVocabularyMapper=mp});var vp=y(oi=>{"use strict";var TC=oi&&oi.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},xC=oi&&oi.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},AC=oi&&oi.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(oi,"__esModule",{value:!0});oi.NoteToRDFConverter=void 0;var H2=Qe(),xu=Wn(),z2=at(),xi=Pt(),Qi=bi(),CC=it(),OC=gp(),yp=class{static{o(this,"NoteToRDFConverter")}constructor(e){this.vault=e,this.OBSIDIAN_VAULT_SCHEME="obsidian://vault/",this.vocabularyMapper=new OC.RDFVocabularyMapper}async convertNote(e){let t=this.vault.getFrontmatter(e);if(!t)return[];let i=[],n=this.notePathToIRI(e.path),s=Qi.Namespace.EXO.term("Asset_fileName");i.push(new xu.Triple(n,s,new xi.Literal(e.basename)));for(let[a,c]of Object.entries(t)){if(!this.isExocortexProperty(a))continue;let u=this.propertyKeyToIRI(a),f=Array.isArray(c)?c:[c];for(let l of f)if(a==="exo__Instance_class"){let h=this.valueToClassURI(l);i.push(new xu.Triple(n,u,h))}else{let h=await this.valueToRDFObject(l,e);if(i.push(new xu.Triple(n,u,h)),this.vocabularyMapper.hasMappingFor(a)&&h instanceof z2.IRI){let p=this.vocabularyMapper.generateMappedTriple(n,a,h);p&&i.push(p)}}if(a==="exo__Instance_class")for(let l of f){let h=this.expandClassValue(l);if(h){let p=Qi.Namespace.RDF.term("type");i.push(new xu.Triple(n,p,h))}}}return i}async convertVault(){let e=this.vault.getAllFiles(),t=[];for(let i of e)try{let n=await this.convertNote(i);t.push(...n)}catch(n){console.warn(`\u26A0\uFE0F Skipping file with invalid IRI: ${i.path}`),console.warn(`   Reason: ${n instanceof Error?n.message:String(n)}`);continue}return t}notePathToIRI(e){let t=encodeURI(e);return new z2.IRI(`${this.OBSIDIAN_VAULT_SCHEME}${t}`)}isExocortexProperty(e){return e.startsWith("exo__")||e.startsWith("ems__")}propertyKeyToIRI(e){if(e.startsWith("exo__")){let t=e.substring(5);return Qi.Namespace.EXO.term(t)}if(e.startsWith("ems__")){let t=e.substring(5);return Qi.Namespace.EMS.term(t)}throw new Error(`Invalid property key: ${e}`)}async valueToRDFObject(e,t){if(typeof e=="string"){let i=this.removeQuotes(e),n=this.extractWikilink(i);if(n){let s=this.vault.getFirstLinkpathDest(n,t.path);if(s)return this.notePathToIRI(s.path);if(this.isClassReference(n)){let a=this.expandClassValue(n);if(a)return a}return new xi.Literal(i)}if(this.isClassReference(i)){let s=this.expandClassValue(i);if(s)return s}return this.isISO8601DateTime(i)?new xi.Literal(i,Qi.Namespace.XSD.term("dateTime")):new xi.Literal(i)}return typeof e=="boolean"?new xi.Literal(e.toString()):typeof e=="number"?new xi.Literal(e.toString(),Qi.Namespace.XSD.term("decimal")):e instanceof Date?new xi.Literal(e.toISOString(),Qi.Namespace.XSD.term("dateTime")):new xi.Literal(String(e))}isISO8601DateTime(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{1,3})?(Z|[+-]\d{2}:\d{2})?$/.test(e)}removeQuotes(e){let t=e.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.substring(1,t.length-1):e}extractWikilink(e){let t=e.match(/^\[\[([^\]]+)\]\]$/);return t?t[1]:null}valueToClassURI(e){if(typeof e!="string")return new xi.Literal(String(e));let t=this.removeQuotes(e),n=this.extractWikilink(t)||t,s=this.expandClassValue(n);return s||new xi.Literal(t)}isClassReference(e){return(e.startsWith("ems__")||e.startsWith("exo__"))&&!/\s/.test(e)}expandClassValue(e){let t=this.removeQuotes(e);if(t.startsWith("ems__")){let i=t.substring(5);return Qi.Namespace.EMS.term(i)}if(t.startsWith("exo__")){let i=t.substring(5);return Qi.Namespace.EXO.term(i)}return null}};oi.NoteToRDFConverter=yp;oi.NoteToRDFConverter=yp=TC([(0,H2.injectable)(),AC(0,(0,H2.inject)(CC.DI_TOKENS.IVaultAdapter)),xC("design:paramtypes",[Object])],yp)});var _p=y((Ij,K2)=>{var Bs=class{static{o(this,"Wildcard")}constructor(){return FC||this}equals(e){return e&&this.termType===e.termType}};Object.defineProperty(Bs.prototype,"value",{enumerable:!0,value:"*"});Object.defineProperty(Bs.prototype,"termType",{enumerable:!0,value:"Wildcard"});var FC=new Bs;K2.exports.Wildcard=Bs});var Q2=y((Nj,Y2)=>{var PC=(function(){var r=o(function(x,E,C,R){for(C=C||{},R=x.length;R--;C[x[R]]=E);return C},"o"),e=[6,12,13,15,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],t=[2,247],i=[100,110,113,115,116,123,126,131,329,330,331,332,333],n=[2,409],s=[1,18],a=[1,27],c=[13,16,45,197,224,229,308],u=[28,29,53],f=[28,53],l=[1,42],h=[1,45],p=[1,41],g=[1,44],S=[123,126],_=[1,67],A=[39,45,87],F=[13,16,45,197,224,308],P=[1,87],j=[2,281],B=[1,86],K=[13,16,45,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],Ie=[6,28,29,53,63,70,73,81,83,85],Xe=[6,13,16,28,29,53,63,70,73,81,83,85,87,308],ot=[6,13,16,28,29,45,53,63,70,73,81,82,83,85,87,89,197,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314],$=[6,13,16,28,29,31,39,45,47,48,53,63,70,73,81,82,83,85,87,89,109,112,121,123,126,128,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,337,338,340,341,342,343,344,345,346],ce=[13,16,308],Pe=[112,132,327,334],Ze=[13,16,112,132,308],We=[1,111],ze=[1,117],Ne=[112,132,327,328,334],ke=[13,16,112,132,308,328],Re=[28,29,45,53,87],W=[1,138],D=[1,151],je=[1,128],$e=[1,127],L=[1,129],le=[1,140],Te=[1,141],G=[1,142],xe=[1,143],Ae=[1,144],ve=[1,145],Ce=[1,147],ue=[1,148],_e=[2,457],fe=[1,158],Se=[1,159],Oe=[1,160],J=[1,152],te=[1,153],re=[1,156],X=[1,171],Z=[1,172],ee=[1,173],Q=[1,174],ie=[1,175],ne=[1,176],se=[1,167],ae=[1,168],Y=[1,169],oe=[1,170],De=[1,157],Fe=[1,166],me=[1,161],v=[1,162],w=[1,163],b=[1,164],O=[1,165],V=[6,13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],ge=[1,195],Be=[6,31,73,81,83,85],ye=[2,285],N=[1,199],k=[1,201],M=[6,31,70,73,81,83,85],q=[2,283],de=[1,207],Le=[1,218],Me=[1,223],Ct=[1,219],lr=[1,225],_r=[1,226],zt=[1,224],C1=[6,63,70,73,81,83,85],O1=[1,236],F1=[2,334],P1=[1,243],R1=[1,241],Ot=[6,193],Yo=[2,349],I1=[2,339],un=[28,128],D1=[47,48,193,272],Qo=[47,48,193,242,272],ws=[47,48,193,242,246,272],bs=[47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,341,342,343,344,345,346],St=[39,47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,338,341,342,343,344,345,346],N1=[1,271],k1=[1,270],ft=[6,13,16,29,31,39,45,47,48,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],j1=[1,281],L1=[1,280],Kt=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],Oa=[45,89],Jo=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],Xo=[13,16,31,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Zo=[31,89],ec=[48,87],kn=[6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338],gi=[6,13,16,39,45,48,82,87,89,231,263,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338,340],M1=[1,313],Es=[6,85],rf=[6,31,81,83,85],V1=[2,361],ji=[2,353],jn=[1,343],Fa=[31,112,335],Li=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],nf=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335],q1=[6,109,193],Ln=[31,112],ht=[13,16,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],sf=[1,390],af=[1,391],ln=[13,16,87,197,308,314],$1=[13,16,39,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],tc=[1,417],rc=[1,418],U1=[13,16,48,197,229,308],fn=[6,31,85],B1=[6,13,16,31,45,73,81,83,85,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],of=[6,13,16,29,31,45,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,231,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,346,347,348,349,350,351],Mn=[29,31,85,112,159,160,161,163,164],ic=[1,443],nc=[1,444],G1=[1,449],Vn=[31,112,193,232,318,335],sc=[13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],W1=[13,16,31,45,48,82,87,89,112,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],cf=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Pa=[13,16,31,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Ra=[31,45],H1=[1,507],z1=[1,508],K1=[6,13,16,29,31,39,45,47,48,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,336,338,341,342,343,344,345,346,347,348,349,350,351],ac=[29,31,85,112,159,160,161,163,164,335],qn=[6,13,16,31,45,70,73,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],Y1=[13,16,31,45,48,82,87,89,112,193,197,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Q1=[2,352],uf=[13,16,197,308,314],J1=[1,565],Ts=[6,13,16,31,45,76,78,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],X1=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],Mi=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],Z1=[13,16,87,308],Vi=[2,364],xs=[29,31,85,112,159,160,161,163,164,193,232,318,335],oc=[31,112,193,232,272,318,335],qi=[2,359],eg=[13,16,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],cc=[29,31,85,112,159,160,161,163,164,193,232,272,318,335],tg=[13,16,31,45,82,87,89,112,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],rg=[2,347],lf={trace:o(function(){},"trace"),yy:{},symbols_:{error:2,QueryOrUpdate:3,Prologue:4,QueryOrUpdate_group0:5,EOF:6,Query:7,Qry:8,Query_option0:9,Prologue_repetition0:10,BaseDecl:11,BASE:12,IRIREF:13,PrefixDecl:14,PREFIX:15,PNAME_NS:16,SelectClauseWildcard:17,Qry_repetition0:18,WhereClause:19,SolutionModifierNoGroup:20,SelectClauseVars:21,Qry_repetition1:22,SolutionModifier:23,CONSTRUCT:24,ConstructTemplate:25,Qry_repetition2:26,Qry_repetition3:27,WHERE:28,"{":29,Qry_option0:30,"}":31,DESCRIBE:32,Qry_group0:33,Qry_repetition4:34,Qry_option1:35,ASK:36,Qry_repetition5:37,SelectClauseBase:38,"*":39,SelectClauseVars_repetition_plus0:40,SELECT:41,SelectClauseBase_option0:42,SelectClauseItem:43,Var:44,"(":45,Expression:46,AS:47,")":48,SubSelect:49,SubSelect_option0:50,SubSelect_option1:51,DatasetClause:52,FROM:53,DatasetClause_option0:54,iri:55,WhereClause_option0:56,GroupGraphPattern:57,SolutionModifier_option0:58,SolutionModifierNoGroup_option0:59,SolutionModifierNoGroup_option1:60,SolutionModifierNoGroup_option2:61,GroupClause:62,GROUP:63,BY:64,GroupClause_repetition_plus0:65,GroupCondition:66,BuiltInCall:67,FunctionCall:68,HavingClause:69,HAVING:70,HavingClause_repetition_plus0:71,OrderClause:72,ORDER:73,OrderClause_repetition_plus0:74,OrderCondition:75,ASC:76,BrackettedExpression:77,DESC:78,Constraint:79,LimitOffsetClauses:80,LIMIT:81,INTEGER:82,OFFSET:83,ValuesClause:84,VALUES:85,InlineData:86,VAR:87,InlineData_repetition0:88,NIL:89,InlineData_repetition1:90,InlineData_repetition_plus2:91,InlineData_repetition3:92,DataBlock:93,DataBlockValueList:94,DataBlockValueList_repetition_plus0:95,Update:96,Update_repetition0:97,Update1:98,Update_option0:99,LOAD:100,Update1_option0:101,Update1_option1:102,Update1_group0:103,Update1_option2:104,GraphRefAll:105,Update1_group1:106,Update1_option3:107,GraphOrDefault:108,TO:109,CREATE:110,Update1_option4:111,GRAPH:112,INSERTDATA:113,QuadPattern:114,DELETEDATA:115,DELETEWHERE:116,Update1_option5:117,InsertDeleteClause:118,Update1_repetition0:119,IntoGraphClause:120,INTO:121,GraphRef:122,DELETE:123,InsertDeleteClause_option0:124,InsertClause:125,INSERT:126,UsingClause:127,USING:128,UsingClause_option0:129,WithClause:130,WITH:131,DEFAULT:132,GraphOrDefault_option0:133,GraphRefAll_group0:134,Quads:135,Quads_option0:136,Quads_repetition0:137,QuadsNotTriples:138,VarOrIri:139,QuadsNotTriples_option0:140,QuadsNotTriples_option1:141,QuadsNotTriples_option2:142,TriplesTemplate:143,TriplesTemplate_repetition0:144,TriplesSameSubject:145,TriplesTemplate_option0:146,GroupGraphPatternSub:147,GroupGraphPatternSub_option0:148,GroupGraphPatternSub_repetition0:149,GroupGraphPatternSubTail:150,GraphPatternNotTriples:151,GroupGraphPatternSubTail_option0:152,GroupGraphPatternSubTail_option1:153,TriplesBlock:154,TriplesBlock_repetition0:155,TriplesSameSubjectPath:156,TriplesBlock_option0:157,GroupOrUnionGraphPattern:158,OPTIONAL:159,MINUS:160,SERVICE:161,GraphPatternNotTriples_option0:162,FILTER:163,BIND:164,InlineDataOneVar:165,InlineDataFull:166,InlineDataOneVar_repetition0:167,InlineDataFull_repetition0:168,InlineDataFull_repetition_plus1:169,InlineDataFull_repetition2:170,DataBlockValue:171,Literal:172,QuotedTriple:173,UNDEF:174,GroupOrUnionGraphPattern_repetition0:175,ArgList:176,ArgList_option0:177,ArgList_repetition0:178,ExpressionList:179,ExpressionList_repetition0:180,ConstructTemplate_option0:181,ConstructTriples:182,ConstructTriples_repetition0:183,ConstructTriples_option0:184,VarOrTermOrQuotedTP:185,PropertyListNotEmpty:186,TriplesNode:187,PropertyList:188,PropertyList_option0:189,VerbObjectList:190,PropertyListNotEmpty_repetition0:191,SemiOptionalVerbObjectList:192,";":193,SemiOptionalVerbObjectList_option0:194,Verb:195,ObjectList:196,a:197,ObjectList_repetition0:198,Object:199,GraphNode:200,Object_option0:201,PropertyListPathNotEmpty:202,TriplesNodePath:203,TriplesSameSubjectPath_option0:204,O:205,PropertyListPathNotEmpty_repetition0:206,PropertyListPathNotEmptyTail:207,O_group0:208,ObjectListPath:209,ObjectListPath_repetition0:210,ObjectPath:211,GraphNodePath:212,ObjectPath_option0:213,Path:214,Path_repetition0:215,PathSequence:216,PathSequence_repetition0:217,PathEltOrInverse:218,PathElt:219,PathPrimary:220,PathElt_option0:221,PathEltOrInverse_option0:222,IriOrA:223,"!":224,PathNegatedPropertySet:225,PathOneInPropertySet:226,PathNegatedPropertySet_repetition0:227,PathNegatedPropertySet_option0:228,"^":229,TriplesNode_repetition_plus0:230,"[":231,"]":232,TriplesNodePath_repetition_plus0:233,VarOrTermOrQuotedTPExpr:234,VarOrTerm:235,GraphTerm:236,BlankNode:237,ConditionalOrExpression:238,ConditionalAndExpression:239,ConditionalOrExpression_repetition0:240,ConditionalOrExpressionTail:241,"||":242,RelationalExpression:243,ConditionalAndExpression_repetition0:244,ConditionalAndExpressionTail:245,"&&":246,NumericExpression:247,RelationalExpression_group0:248,RelationalExpression_option0:249,IN:250,MultiplicativeExpression:251,NumericExpression_repetition0:252,AdditiveExpressionTail:253,AdditiveExpressionTail_group0:254,NumericLiteralPositive:255,AdditiveExpressionTail_repetition0:256,NumericLiteralNegative:257,AdditiveExpressionTail_repetition1:258,UnaryExpression:259,MultiplicativeExpression_repetition0:260,MultiplicativeExpressionTail:261,MultiplicativeExpressionTail_group0:262,"+":263,PrimaryExpression:264,"-":265,ExprQuotedTP:266,Aggregate:267,FUNC_ARITY0:268,FUNC_ARITY1:269,FUNC_ARITY1_SPARQL_STAR:270,FUNC_ARITY2:271,",":272,FUNC_ARITY3:273,FUNC_ARITY3_SPARQL_STAR:274,BuiltInCall_group0:275,BOUND:276,BNODE:277,BuiltInCall_option0:278,EXISTS:279,COUNT:280,Aggregate_option0:281,Aggregate_group0:282,FUNC_AGGREGATE:283,Aggregate_option1:284,GROUP_CONCAT:285,Aggregate_option2:286,Aggregate_option3:287,GroupConcatSeparator:288,SEPARATOR:289,"=":290,String:291,LANGTAG:292,"^^":293,DECIMAL:294,DOUBLE:295,BOOLEAN:296,INTEGER_POSITIVE:297,DECIMAL_POSITIVE:298,DOUBLE_POSITIVE:299,INTEGER_NEGATIVE:300,DECIMAL_NEGATIVE:301,DOUBLE_NEGATIVE:302,STRING_LITERAL1:303,STRING_LITERAL2:304,STRING_LITERAL_LONG1:305,STRING_LITERAL_LONG2:306,PrefixedName:307,PNAME_LN:308,BLANK_NODE_LABEL:309,ANON:310,QuotedTP:311,"<<":312,qtSubjectOrObject:313,">>":314,DataValueTerm:315,AnnotationPattern:316,"{|":317,"|}":318,AnnotationPatternPath:319,ExprVarOrTerm:320,QueryOrUpdate_group0_option0:321,Prologue_repetition0_group0:322,Qry_group0_repetition_plus0:323,SelectClauseBase_option0_group0:324,DISTINCT:325,REDUCED:326,NAMED:327,SILENT:328,CLEAR:329,DROP:330,ADD:331,MOVE:332,COPY:333,ALL:334,".":335,UNION:336,"|":337,"/":338,PathElt_option0_group0:339,"?":340,"!=":341,"<":342,">":343,"<=":344,">=":345,NOT:346,CONCAT:347,COALESCE:348,SUBSTR:349,REGEX:350,REPLACE:351,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",12:"BASE",13:"IRIREF",15:"PREFIX",16:"PNAME_NS",24:"CONSTRUCT",28:"WHERE",29:"{",31:"}",32:"DESCRIBE",36:"ASK",39:"*",41:"SELECT",45:"(",47:"AS",48:")",53:"FROM",63:"GROUP",64:"BY",70:"HAVING",73:"ORDER",76:"ASC",78:"DESC",81:"LIMIT",82:"INTEGER",83:"OFFSET",85:"VALUES",87:"VAR",89:"NIL",100:"LOAD",109:"TO",110:"CREATE",112:"GRAPH",113:"INSERTDATA",115:"DELETEDATA",116:"DELETEWHERE",121:"INTO",123:"DELETE",126:"INSERT",128:"USING",131:"WITH",132:"DEFAULT",159:"OPTIONAL",160:"MINUS",161:"SERVICE",163:"FILTER",164:"BIND",174:"UNDEF",193:";",197:"a",224:"!",229:"^",231:"[",232:"]",242:"||",246:"&&",250:"IN",263:"+",265:"-",268:"FUNC_ARITY0",269:"FUNC_ARITY1",270:"FUNC_ARITY1_SPARQL_STAR",271:"FUNC_ARITY2",272:",",273:"FUNC_ARITY3",274:"FUNC_ARITY3_SPARQL_STAR",276:"BOUND",277:"BNODE",279:"EXISTS",280:"COUNT",283:"FUNC_AGGREGATE",285:"GROUP_CONCAT",289:"SEPARATOR",290:"=",292:"LANGTAG",293:"^^",294:"DECIMAL",295:"DOUBLE",296:"BOOLEAN",297:"INTEGER_POSITIVE",298:"DECIMAL_POSITIVE",299:"DOUBLE_POSITIVE",300:"INTEGER_NEGATIVE",301:"DECIMAL_NEGATIVE",302:"DOUBLE_NEGATIVE",303:"STRING_LITERAL1",304:"STRING_LITERAL2",305:"STRING_LITERAL_LONG1",306:"STRING_LITERAL_LONG2",308:"PNAME_LN",309:"BLANK_NODE_LABEL",310:"ANON",312:"<<",314:">>",317:"{|",318:"|}",325:"DISTINCT",326:"REDUCED",327:"NAMED",328:"SILENT",329:"CLEAR",330:"DROP",331:"ADD",332:"MOVE",333:"COPY",334:"ALL",335:".",336:"UNION",337:"|",338:"/",340:"?",341:"!=",342:"<",343:">",344:"<=",345:">=",346:"NOT",347:"CONCAT",348:"COALESCE",349:"SUBSTR",350:"REGEX",351:"REPLACE"},productions_:[0,[3,3],[7,2],[4,1],[11,2],[14,3],[8,4],[8,4],[8,5],[8,7],[8,5],[8,4],[17,2],[21,2],[38,2],[43,1],[43,5],[49,4],[49,4],[52,3],[19,2],[23,2],[20,3],[62,3],[66,1],[66,1],[66,3],[66,5],[66,1],[69,2],[72,3],[75,2],[75,2],[75,1],[75,1],[80,2],[80,2],[80,4],[80,4],[84,2],[86,4],[86,4],[86,6],[86,2],[94,3],[96,3],[98,4],[98,3],[98,5],[98,4],[98,2],[98,2],[98,2],[98,5],[120,2],[118,3],[118,1],[125,2],[127,3],[130,2],[108,1],[108,2],[122,2],[105,1],[105,1],[114,3],[135,2],[138,7],[143,3],[57,3],[57,3],[147,2],[150,3],[154,3],[151,1],[151,2],[151,2],[151,3],[151,4],[151,2],[151,6],[151,1],[93,1],[93,1],[165,4],[166,4],[166,6],[171,1],[171,1],[171,1],[171,1],[158,2],[79,1],[79,1],[79,1],[68,2],[176,1],[176,5],[179,1],[179,4],[25,3],[182,3],[145,2],[145,2],[188,1],[186,2],[192,2],[190,2],[195,1],[195,1],[196,2],[199,2],[156,2],[156,2],[202,2],[207,1],[207,2],[205,2],[209,2],[211,2],[214,2],[216,2],[219,2],[218,2],[220,1],[220,2],[220,3],[225,1],[225,1],[225,4],[226,1],[226,2],[187,3],[187,3],[203,3],[203,3],[200,1],[200,1],[212,1],[212,1],[234,1],[235,1],[235,1],[139,1],[139,1],[44,1],[236,1],[236,1],[236,1],[236,1],[46,1],[238,2],[241,2],[239,2],[245,2],[243,1],[243,3],[243,4],[247,2],[253,2],[253,2],[253,2],[251,2],[261,2],[259,2],[259,2],[259,2],[259,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[77,3],[67,1],[67,2],[67,4],[67,4],[67,6],[67,8],[67,8],[67,2],[67,4],[67,2],[67,4],[67,3],[267,5],[267,5],[267,6],[288,4],[172,1],[172,2],[172,3],[172,1],[172,1],[172,1],[172,1],[172,1],[172,1],[255,1],[255,1],[255,1],[257,1],[257,1],[257,1],[291,1],[291,1],[291,1],[291,1],[55,1],[55,1],[307,1],[307,1],[237,1],[237,1],[311,5],[173,5],[313,1],[313,1],[313,1],[313,1],[313,1],[315,1],[315,1],[315,1],[185,1],[185,1],[185,1],[316,3],[319,3],[266,5],[320,1],[320,1],[320,1],[223,1],[223,1],[321,0],[321,1],[5,1],[5,1],[5,1],[9,0],[9,1],[322,1],[322,1],[10,0],[10,2],[18,0],[18,2],[22,0],[22,2],[26,0],[26,2],[27,0],[27,2],[30,0],[30,1],[323,1],[323,2],[33,1],[33,1],[34,0],[34,2],[35,0],[35,1],[37,0],[37,2],[40,1],[40,2],[324,1],[324,1],[42,0],[42,1],[50,0],[50,1],[51,0],[51,1],[54,0],[54,1],[56,0],[56,1],[58,0],[58,1],[59,0],[59,1],[60,0],[60,1],[61,0],[61,1],[65,1],[65,2],[71,1],[71,2],[74,1],[74,2],[88,0],[88,2],[90,0],[90,2],[91,1],[91,2],[92,0],[92,2],[95,1],[95,2],[97,0],[97,4],[99,0],[99,2],[101,0],[101,1],[102,0],[102,1],[103,1],[103,1],[104,0],[104,1],[106,1],[106,1],[106,1],[107,0],[107,1],[111,0],[111,1],[117,0],[117,1],[119,0],[119,2],[124,0],[124,1],[129,0],[129,1],[133,0],[133,1],[134,1],[134,1],[134,1],[136,0],[136,1],[137,0],[137,2],[140,0],[140,1],[141,0],[141,1],[142,0],[142,1],[144,0],[144,3],[146,0],[146,1],[148,0],[148,1],[149,0],[149,2],[152,0],[152,1],[153,0],[153,1],[155,0],[155,3],[157,0],[157,1],[162,0],[162,1],[167,0],[167,2],[168,0],[168,2],[169,1],[169,2],[170,0],[170,2],[175,0],[175,3],[177,0],[177,1],[178,0],[178,3],[180,0],[180,3],[181,0],[181,1],[183,0],[183,3],[184,0],[184,1],[189,0],[189,1],[191,0],[191,2],[194,0],[194,1],[198,0],[198,3],[201,0],[201,1],[204,0],[204,1],[206,0],[206,2],[208,1],[208,1],[210,0],[210,3],[213,0],[213,1],[215,0],[215,3],[217,0],[217,3],[339,1],[339,1],[339,1],[221,0],[221,1],[222,0],[222,1],[227,0],[227,3],[228,0],[228,1],[230,1],[230,2],[233,1],[233,2],[240,0],[240,2],[244,0],[244,2],[248,1],[248,1],[248,1],[248,1],[248,1],[248,1],[249,0],[249,1],[252,0],[252,2],[254,1],[254,1],[256,0],[256,2],[258,0],[258,2],[260,0],[260,2],[262,1],[262,1],[275,1],[275,1],[275,1],[275,1],[275,1],[278,0],[278,1],[281,0],[281,1],[282,1],[282,1],[284,0],[284,1],[286,0],[286,1],[287,0],[287,1]],performAction:o(function(E,C,R,H,pe,d,Qt){var m=d.length-1;switch(pe){case 1:if(d[m-1]=d[m-1]||{},we.base&&(d[m-1].base=we.base),we.base="",d[m-1].prefixes=we.prefixes,we.prefixes=null,we.pathOnly){if(d[m-1].type==="path"||"termType"in d[m-1])return d[m-1];throw new Error("Received full SPARQL query in path only mode")}else if(d[m-1].type==="path"||"termType"in d[m-1])throw new Error("Received only path in full SPARQL mode");if(d[m-1].type==="update"){let He={};for(let rt of d[m-1].updates)if(rt.updateType==="insert"){let Ve={};for(let Ge of rt.insert)if(Ge.type==="bgp"||Ge.type==="graph")for(let fr of Ge.triples)fr.subject.termType==="BlankNode"&&(Ve[fr.subject.value]=!0),fr.predicate.termType==="BlankNode"&&(Ve[fr.predicate.value]=!0),fr.object.termType==="BlankNode"&&(Ve[fr.object.value]=!0);for(let Ge of Object.keys(Ve)){if(He[Ge])throw new Error("Detected reuse blank node across different INSERT DATA clauses");He[Ge]=!0}}}return d[m-1];case 2:this.$={...d[m-1],...d[m],type:"query"};break;case 4:we.base=Ia(d[m]);break;case 5:we.prefixes||(we.prefixes={}),d[m-1]=d[m-1].substr(0,d[m-1].length-1),d[m]=Ia(d[m]),we.prefixes[d[m-1]]=d[m];break;case 6:this.$={...d[m-3],...Bn(d[m-2]),...d[m-1],...d[m]};break;case 7:if(!we.skipValidation&&(vf(d[m-3].variables.map(rt=>yf(rt.expression))).some(rt=>rt.aggregation==="count"&&!(rt.expression instanceof uc))||d[m].group)){for(let rt of d[m-3].variables)if(rt.termType==="Variable"){if(!d[m].group||!d[m].group.map(Ve=>Fs(Ve)).includes(Fs(rt)))throw Error("Projection of ungrouped variable (?"+Fs(rt)+")")}else if(yf(rt.expression).length===0){let Ve=Ew(rt.expression);for(let Ge of Ve)if(!d[m].group||!d[m].group.map||!d[m].group.map(fr=>Fs(fr)).includes(Fs(Ge)))throw Error("Use of ungrouped variable in projection of operation (?"+Fs(Ge)+")")}}let Si=d[m-1].where.filter(He=>He.type==="query");if(Si.length>0){let He=d[m-3].variables.filter(Ve=>Ve.variable&&Ve.variable.value).map(Ve=>Ve.variable.value),rt=vf(Si.map(Ve=>Ve.variables)).map(Ve=>Ve.value||Ve.variable.value);for(let Ve of He)if(rt.indexOf(Ve)>=0)throw Error("Target id of 'AS' (?"+Ve+") already used in subquery")}this.$=ct(d[m-3],Bn(d[m-2]),d[m-1],d[m]);break;case 8:this.$=ct({queryType:"CONSTRUCT",template:d[m-3]},Bn(d[m-2]),d[m-1],d[m]);break;case 9:this.$=ct({queryType:"CONSTRUCT",template:d[m-2]=d[m-2]?d[m-2].triples:[]},Bn(d[m-5]),{where:[{type:"bgp",triples:Un([],d[m-2])}]},d[m]);break;case 10:this.$=ct({queryType:"DESCRIBE",variables:d[m-3]==="*"?[new uc]:d[m-3]},Bn(d[m-2]),d[m-1],d[m]);break;case 11:this.$=ct({queryType:"ASK"},Bn(d[m-2]),d[m-1],d[m]);break;case 12:this.$=ct(d[m-1],{variables:[new uc]});break;case 13:let La=d[m].map(He=>He.value||He.variable.value),Ps=Tw(La);if(Ps.length>0)throw Error("Two or more of the resulting columns have the same name (?"+Ps[0]+")");this.$=ct(d[m-1],{variables:d[m]});break;case 14:this.$=ct({queryType:"SELECT"},d[m]&&(d[m-1]=Yt(d[m]),d[m]={},d[m][d[m-1]]=!0,d[m]));break;case 16:case 27:this.$=As(d[m-3],{variable:d[m-1]});break;case 17:case 18:this.$=ct(d[m-3],d[m-2],d[m-1],d[m],{type:"query"});break;case 19:case 58:this.$={iri:d[m],named:!!d[m-1]};break;case 20:this.$={where:d[m].patterns};break;case 21:this.$=ct(d[m-1],d[m]);break;case 22:this.$=ct(d[m-2],d[m-1],d[m]);break;case 23:this.$={group:d[m]};break;case 24:case 25:case 28:case 31:case 33:case 34:this.$=As(d[m]);break;case 26:this.$=As(d[m-1]);break;case 29:this.$={having:d[m]};break;case 30:this.$={order:d[m]};break;case 32:this.$=As(d[m],{descending:!0});break;case 35:this.$={limit:Os(d[m])};break;case 36:this.$={offset:Os(d[m])};break;case 37:this.$={limit:Os(d[m-2]),offset:Os(d[m])};break;case 38:this.$={limit:Os(d[m]),offset:Os(d[m-2])};break;case 39:case 43:this.$={type:"values",values:d[m]};break;case 40:case 84:this.$=d[m-1].map(He=>({[d[m-3]]:He}));break;case 41:case 85:this.$=d[m-1].map(()=>({}));break;case 42:case 86:var _i=d[m-4].length;d[m-4]=d[m-4].map(ff),this.$=d[m-1].map(function(He){if(He.length!==_i)throw Error("Inconsistent VALUES length");for(var rt={},Ve=0;Ve<_i;Ve++)rt["?"+d[m-4][Ve].value]=He[Ve];return rt});break;case 44:case 65:case 100:case 126:case 175:this.$=d[m-1];break;case 45:this.$={type:"update",updates:$i(d[m-2],d[m-1])};break;case 46:this.$=ct({type:"load",silent:!!d[m-2],source:d[m-1]},d[m]&&{destination:d[m]});break;case 47:this.$={type:Yt(d[m-2]),silent:!!d[m-1],graph:d[m]};break;case 48:this.$={type:Yt(d[m-4]),silent:!!d[m-3],source:d[m-2],destination:d[m]};break;case 49:this.$={type:"create",silent:!!d[m-2],graph:{type:"graph",name:d[m]}};break;case 50:this.$={updateType:"insert",insert:dg(d[m])};break;case 51:this.$={updateType:"delete",delete:wf(dg(d[m]))};break;case 52:this.$={updateType:"deletewhere",delete:wf(d[m])};break;case 53:this.$={updateType:"insertdelete",...d[m-4],...d[m-3],...Bn(d[m-2],"using"),where:d[m].patterns};break;case 54:case 57:case 62:case 167:case 191:case 236:this.$=d[m];break;case 55:this.$={delete:wf(d[m-1]),insert:d[m]||[]};break;case 56:this.$={delete:[],insert:d[m]};break;case 59:this.$={graph:d[m]};break;case 60:this.$={type:"graph",default:!0};break;case 61:case 63:this.$={type:"graph",name:d[m]};break;case 64:this.$={[Yt(d[m])]:!0};break;case 66:this.$=d[m-1]?yi(d[m],[d[m-1]]):yi(d[m]);break;case 67:var ka=ct(d[m-3]||{triples:[]},{type:"graph",name:d[m-5]});this.$=d[m]?[ka,d[m]]:[ka];break;case 68:case 73:this.$={type:"bgp",triples:yi(d[m-2],[d[m-1]])};break;case 69:this.$={type:"group",patterns:[d[m-1]]};break;case 70:for(let He of d[m-1].filter(rt=>rt.type==="bind")){let rt=d[m-1].indexOf(He),Ve=new Set;for(let Ge of d[m-1].slice(0,rt))(Ge.type==="group"||Ge.type==="bgp")&&fg(Ge).forEach(fr=>Ve.add(fr));if(Ve.has(He.variable.value))throw Error("Variable used to bind is already bound (?"+He.variable.value+")")}this.$={type:"group",patterns:d[m-1]};break;case 71:this.$=d[m-1]?yi([d[m-1]],d[m]):yi(d[m]);break;case 72:this.$=d[m]?[d[m-2],d[m]]:d[m-2];break;case 75:this.$=ct(d[m],{type:"optional"});break;case 76:this.$=ct(d[m],{type:"minus"});break;case 77:this.$=ct(d[m],{type:"graph",name:d[m-1]});break;case 78:this.$=ct(d[m],{type:"service",name:d[m-1],silent:!!d[m-2]});break;case 79:this.$={type:"filter",expression:d[m]};break;case 80:this.$={type:"bind",variable:d[m-1],expression:d[m-3]};break;case 89:this.$=Na(d[m]);break;case 90:this.$=void 0;break;case 91:this.$=d[m-1].length?{type:"union",patterns:yi(d[m-1].map(df),[df(d[m])])}:d[m];break;case 95:this.$={...d[m],function:d[m-1]};break;case 96:this.$={type:"functionCall",args:[]};break;case 97:this.$={type:"functionCall",args:$i(d[m-2],d[m-1]),distinct:!!d[m-3]};break;case 98:case 115:case 128:case 247:case 249:case 251:case 253:case 255:case 263:case 267:case 297:case 299:case 303:case 307:case 328:case 341:case 349:case 355:case 361:case 367:case 369:case 373:case 375:case 379:case 381:case 385:case 391:case 395:case 401:case 405:case 409:case 411:case 420:case 428:case 430:case 440:case 444:case 446:case 448:this.$=[];break;case 99:this.$=$i(d[m-2],d[m-1]);break;case 101:this.$=yi(d[m-2],[d[m-1]]);break;case 102:case 112:this.$=Sf(d[m].map(He=>ct(Ui(d[m-1]),He)));break;case 103:this.$=Sf(Un(d[m].map(He=>ct(Ui(d[m-1].entity),He)),d[m-1].triples));break;case 105:this.$=yi([d[m-1]],d[m]);break;case 106:this.$=yi(d[m]);break;case 107:this.$=gf(d[m-1],d[m]);break;case 109:case 237:this.$=we.factory.namedNode(dw);break;case 110:case 118:this.$=$i(d[m-1],d[m]);break;case 111:this.$=d[m]?{annotation:d[m],object:d[m-1]}:d[m-1];break;case 113:this.$=d[m]?Sf(Un(d[m].map(He=>ct(Ui(d[m-1].entity),He)),d[m-1].triples)):d[m-1].triples;break;case 114:this.$=gf(...d[m-1],d[m]);break;case 116:this.$=gf(...d[m]);break;case 117:case 159:case 163:this.$=[d[m-1],d[m]];break;case 119:this.$=d[m]?{object:d[m-1],annotation:d[m]}:d[m-1];break;case 120:this.$=d[m-1].length?Cs("|",$i(d[m-1],d[m])):d[m];break;case 121:this.$=d[m-1].length?Cs("/",$i(d[m-1],d[m])):d[m];break;case 122:this.$=d[m]?Cs(d[m],[d[m-1]]):d[m-1];break;case 123:this.$=d[m-1]?Cs(d[m-1],[d[m]]):d[m];break;case 125:case 131:this.$=Cs(d[m-1],[d[m]]);break;case 129:this.$=Cs("|",$i(d[m-2],d[m-1]));break;case 132:case 134:this.$=ww(d[m-1]);break;case 133:case 135:this.$=bw(d[m-1]);break;case 140:this.$={entity:d[m],triples:[]};break;case 145:this.$=ff(d[m]);break;case 149:this.$=we.factory.namedNode(ig);break;case 151:case 153:case 158:case 162:this.$=hf(d[m-1],d[m]);break;case 152:this.$=["||",d[m]];break;case 154:this.$=["&&",d[m]];break;case 156:this.$=Ft(d[m-1],[d[m-2],d[m]]);break;case 157:this.$=Ft(d[m-2]?"notin":"in",[d[m-3],d[m]]);break;case 160:this.$=["+",hf(d[m-1],d[m])];break;case 161:var hc=vi(d[m-1].value.replace("-",""),d[m-1].datatype);this.$=["-",hf(hc,d[m])];break;case 164:this.$=Ft("UPLUS",[d[m]]);break;case 165:this.$=Ft(d[m-1],[d[m]]);break;case 166:this.$=Ft("UMINUS",[d[m]]);break;case 177:this.$=Ft(Yt(d[m-1]));break;case 178:this.$=Ft(Yt(d[m-3]),[d[m-1]]);break;case 179:this.$=Na(Ft(Yt(d[m-3]),[d[m-1]]));break;case 180:this.$=Ft(Yt(d[m-5]),[d[m-3],d[m-1]]);break;case 181:this.$=Ft(Yt(d[m-7]),[d[m-5],d[m-3],d[m-1]]);break;case 182:this.$=Na(Ft(Yt(d[m-7]),[d[m-5],d[m-3],d[m-1]]));break;case 183:this.$=Ft(Yt(d[m-1]),d[m]);break;case 184:this.$=Ft("bound",[ff(d[m-1])]);break;case 185:this.$=Ft(d[m-1],[]);break;case 186:this.$=Ft(d[m-3],[d[m-1]]);break;case 187:this.$=Ft(d[m-2]?"notexists":"exists",[df(d[m])]);break;case 188:case 189:this.$=As(d[m-1],{type:"aggregate",aggregation:Yt(d[m-4]),distinct:!!d[m-2]});break;case 190:this.$=As(d[m-2],{type:"aggregate",aggregation:Yt(d[m-5]),distinct:!!d[m-3],separator:typeof d[m-1]=="string"?d[m-1]:" "});break;case 192:this.$=vi(d[m]);break;case 193:this.$=yw(d[m-1],Yt(d[m].substr(1)));break;case 194:this.$=vi(d[m-2],d[m]);break;case 195:case 204:this.$=vi(d[m],ng);break;case 196:case 205:this.$=vi(d[m],sg);break;case 197:case 206:this.$=vi(Yt(d[m]),ag);break;case 200:this.$=vi(d[m].toLowerCase(),gw);break;case 201:this.$=vi(d[m].substr(1),ng);break;case 202:this.$=vi(d[m].substr(1),sg);break;case 203:this.$=vi(d[m].substr(1).toLowerCase(),ag);break;case 207:case 208:this.$=lg(d[m],1);break;case 209:case 210:this.$=lg(d[m],3);break;case 211:this.$=we.factory.namedNode(Ia(d[m]));break;case 213:var dc=d[m].indexOf(":"),ja=d[m].substr(0,dc),pc=we.prefixes[ja];if(!pc)throw new Error("Unknown prefix: "+ja);var st=Ia(pc+d[m].substr(dc+1));this.$=we.factory.namedNode(st);break;case 214:if(d[m]=d[m].substr(0,d[m].length-1),!(d[m]in we.prefixes))throw new Error("Unknown prefix: "+d[m]);var st=Ia(we.prefixes[d[m]]);this.$=we.factory.namedNode(st);break;case 215:this.$=Da(d[m].replace(/^(_:)/,""));break;case 216:this.$=Da();break;case 217:case 218:case 232:this.$=Na(pf(d[m-3],d[m-2],d[m-1]));break;case 230:case 231:this.$=Na(d[m-1]);break;case 248:case 250:case 252:case 254:case 256:case 260:case 264:case 268:case 270:case 292:case 294:case 296:case 298:case 300:case 302:case 304:case 306:case 329:case 342:case 356:case 368:case 370:case 372:case 374:case 392:case 402:case 425:case 427:case 429:case 431:case 441:case 445:case 447:case 449:d[m-1].push(d[m]);break;case 259:case 269:case 291:case 293:case 295:case 301:case 305:case 371:case 424:case 426:this.$=[d[m]];break;case 308:d[m-3].push(d[m-2]);break;case 350:case 362:case 376:case 380:case 382:case 386:case 396:case 406:case 410:case 412:case 421:d[m-2].push(d[m-1]);break}},"anonymous"),table:[r(e,t,{3:1,4:2,10:3}),{1:[3]},r(i,[2,307],{5:4,7:5,321:6,214:7,8:8,96:9,215:10,17:11,21:12,97:16,38:17,6:[2,238],13:n,16:n,45:n,197:n,224:n,229:n,308:n,24:[1,13],32:[1,14],36:[1,15],41:s}),r([6,13,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],[2,3],{322:19,11:20,14:21,12:[1,22],15:[1,23]}),{6:[1,24]},{6:[2,240]},{6:[2,241]},{6:[2,242]},{6:[2,243],9:25,84:26,85:a},{6:[2,239]},r(c,[2,411],{216:28,217:29}),r(u,[2,249],{18:30}),r(u,[2,251],{22:31}),r(f,[2,255],{25:32,27:33,29:[1,34]}),{13:l,16:h,33:35,39:[1,37],44:39,55:40,87:p,139:38,307:43,308:g,323:36},r(u,[2,267],{37:46}),r(S,[2,326],{98:47,103:49,106:50,117:55,130:61,100:[1,48],110:[1,51],113:[1,52],115:[1,53],116:[1,54],131:[1,62],329:[1,56],330:[1,57],331:[1,58],332:[1,59],333:[1,60]}),{39:[1,63],40:64,43:65,44:66,45:_,87:p},r(A,[2,273],{42:68,324:69,325:[1,70],326:[1,71]}),r(e,[2,248]),r(e,[2,245]),r(e,[2,246]),{13:[1,72]},{16:[1,73]},{1:[2,1]},{6:[2,2]},{6:[2,244]},{45:[1,77],85:[1,78],86:74,87:[1,75],89:[1,76]},r([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],[2,120],{337:[1,79]}),r(F,[2,418],{218:80,222:81,229:[1,82]}),{19:83,28:P,29:j,52:84,53:B,56:85},{19:88,28:P,29:j,52:89,53:B,56:85},r(u,[2,253],{26:90}),{28:[1,91],52:92,53:B},r(K,[2,385],{181:93,182:94,183:95,31:[2,383]}),r(Ie,[2,263],{34:96}),r(Ie,[2,261],{44:39,55:40,307:43,139:97,13:l,16:h,87:p,308:g}),r(Ie,[2,262]),r(Xe,[2,259]),r(ot,[2,143]),r(ot,[2,144]),r([6,13,16,28,29,31,39,45,47,48,53,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,145]),r($,[2,211]),r($,[2,212]),r($,[2,213]),r($,[2,214]),{19:98,28:P,29:j,52:99,53:B,56:85},{6:[2,309],99:100,193:[1,101]},r(ce,[2,311],{101:102,328:[1,103]}),r(Pe,[2,317],{104:104,328:[1,105]}),r(Ze,[2,322],{107:106,328:[1,107]}),{111:108,112:[2,324],328:[1,109]},{29:We,114:110},{29:We,114:112},{29:We,114:113},{118:114,123:[1,115],125:116,126:ze},r(Ne,[2,315]),r(Ne,[2,316]),r(ke,[2,319]),r(ke,[2,320]),r(ke,[2,321]),r(S,[2,327]),{13:l,16:h,55:118,307:43,308:g},r(u,[2,12]),r(u,[2,13],{44:66,43:119,45:_,87:p}),r(Re,[2,269]),r(Re,[2,15]),{13:l,16:h,44:136,45:W,46:120,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(A,[2,14]),r(A,[2,274]),r(A,[2,271]),r(A,[2,272]),r(e,[2,4]),{13:[1,177]},r(V,[2,39]),{29:[1,178]},{29:[1,179]},{87:[1,181],91:180},{45:[1,187],87:[1,185],89:[1,186],93:182,165:183,166:184},r(c,[2,410]),r([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337],[2,121],{338:[1,188]}),{13:l,16:h,45:[1,193],55:194,197:ge,219:189,220:190,223:191,224:[1,192],307:43,308:g},r(F,[2,419]),r(Be,ye,{20:196,59:197,69:198,70:N}),r(u,[2,250]),{29:k,57:200},r(ce,[2,279],{54:202,327:[1,203]}),{29:[2,282]},r(M,q,{23:204,58:205,62:206,63:de}),r(u,[2,252]),{19:208,28:P,29:j,52:209,53:B,56:85},{29:[1,210]},r(f,[2,256]),{31:[1,211]},{31:[2,384]},{13:l,16:h,44:215,45:Le,55:220,82:D,87:p,89:Me,145:212,172:221,185:213,187:214,231:Ct,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(C1,[2,265],{56:85,35:227,52:228,19:229,28:P,29:j,53:B}),r(Xe,[2,260]),r(M,q,{58:205,62:206,23:230,63:de}),r(u,[2,268]),{6:[2,45]},r(e,t,{10:3,4:231}),{13:l,16:h,55:232,307:43,308:g},r(ce,[2,312]),{105:233,112:O1,122:234,132:[1,237],134:235,327:[1,238],334:[1,239]},r(Pe,[2,318]),r(ce,F1,{108:240,133:242,112:P1,132:R1}),r(Ze,[2,323]),{112:[1,244]},{112:[2,325]},r(Ot,[2,50]),r(K,Yo,{135:245,136:246,143:247,144:248,31:I1,112:I1}),r(Ot,[2,51]),r(Ot,[2,52]),r(un,[2,328],{119:249}),{29:We,114:250},r(un,[2,56]),{29:We,114:251},r(S,[2,59]),r(Re,[2,270]),{47:[1,252]},r(D1,[2,150]),r(Qo,[2,428],{240:253}),r(ws,[2,430],{244:254}),r(ws,[2,155],{248:255,249:256,250:[2,438],290:[1,257],341:[1,258],342:[1,259],343:[1,260],344:[1,261],345:[1,262],346:[1,263]}),r(bs,[2,440],{252:264}),r(St,[2,448],{260:265}),{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,255:154,257:155,264:266,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,255:154,257:155,264:267,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,255:154,257:155,264:268,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(St,[2,167]),r(St,[2,168]),r(St,[2,169]),r(St,[2,170],{176:269,45:N1,89:k1}),r(St,[2,171]),r(St,[2,172]),r(St,[2,173]),r(St,[2,174]),{13:l,16:h,44:136,45:W,46:272,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ft,[2,176]),{89:[1,273]},{45:[1,274]},{45:[1,275]},{45:[1,276]},{45:[1,277]},{45:[1,278]},{45:j1,89:L1,179:279},{45:[1,282]},{45:[1,284],89:[1,283]},{279:[1,285]},r(Kt,[2,192],{292:[1,286],293:[1,287]}),r(Kt,[2,195]),r(Kt,[2,196]),r(Kt,[2,197]),r(Kt,[2,198]),r(Kt,[2,199]),r(Kt,[2,200]),{13:l,16:h,44:39,55:40,82:D,87:p,139:289,172:291,255:154,257:155,266:290,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,320:288},{45:[1,292]},{45:[1,293]},{45:[1,294]},r(Oa,[2,452]),r(Oa,[2,453]),r(Oa,[2,454]),r(Oa,[2,455]),r(Oa,[2,456]),{279:[2,458]},r(Jo,[2,207]),r(Jo,[2,208]),r(Jo,[2,209]),r(Jo,[2,210]),r(Kt,[2,201]),r(Kt,[2,202]),r(Kt,[2,203]),r(Kt,[2,204]),r(Kt,[2,205]),r(Kt,[2,206]),r(e,[2,5]),r(Xo,[2,297],{88:295}),r(Zo,[2,299],{90:296}),{48:[1,297],87:[1,298]},r(ec,[2,301]),r(V,[2,43]),r(V,[2,82]),r(V,[2,83]),{29:[1,299]},{29:[1,300]},{87:[1,302],169:301},r(c,[2,412]),r(kn,[2,123]),r(kn,[2,416],{221:303,339:304,39:[1,306],263:[1,307],340:[1,305]}),r(gi,[2,124]),{13:l,16:h,45:[1,311],55:194,89:[1,310],197:ge,223:312,225:308,226:309,229:M1,307:43,308:g},r(c,n,{215:10,214:314}),r(gi,[2,236]),r(gi,[2,237]),r(Es,[2,6]),r(rf,[2,287],{60:315,72:316,73:[1,317]}),r(Be,[2,286]),{13:l,16:h,45:W,55:323,67:321,68:322,71:318,77:320,79:319,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,307:43,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O},r([6,31,63,70,73,81,83,85],[2,20]),r(K,V1,{38:17,49:324,147:325,17:326,21:327,148:328,154:329,155:330,29:ji,31:ji,85:ji,112:ji,159:ji,160:ji,161:ji,163:ji,164:ji,41:s}),{13:l,16:h,55:331,307:43,308:g},r(ce,[2,280]),r(Es,[2,7]),r(Be,ye,{59:197,69:198,20:332,70:N}),r(M,[2,284]),{64:[1,333]},r(M,q,{58:205,62:206,23:334,63:de}),r(u,[2,254]),r(K,Yo,{144:248,30:335,143:336,31:[2,257]}),r(u,[2,100]),{31:[2,387],184:337,335:[1,338]},{13:l,16:h,44:39,55:40,87:p,139:342,186:339,190:340,195:341,197:jn,307:43,308:g},r(Fa,[2,389],{44:39,55:40,307:43,190:340,195:341,139:342,188:344,189:345,186:346,13:l,16:h,87:p,197:jn,308:g}),r(Li,[2,227]),r(Li,[2,228]),r(Li,[2,229]),{13:l,16:h,44:215,45:Le,55:220,82:D,87:p,89:Me,172:221,185:351,187:350,200:348,230:347,231:Ct,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},{13:l,16:h,44:39,55:40,87:p,139:342,186:352,190:340,195:341,197:jn,307:43,308:g},r(Li,[2,146]),r(Li,[2,147]),r(Li,[2,148]),r(Li,[2,149]),{13:l,16:h,44:354,55:355,82:D,87:p,172:357,237:356,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:358,312:zt,313:353},r(nf,[2,215]),r(nf,[2,216]),r(M,q,{58:205,62:206,23:359,63:de}),r(Ie,[2,264]),r(C1,[2,266]),r(Es,[2,11]),r(i,[2,308],{6:[2,310]}),r(Ot,[2,313],{102:360,120:361,121:[1,362]}),r(Ot,[2,47]),r(Ot,[2,63]),r(Ot,[2,64]),{13:l,16:h,55:363,307:43,308:g},r(Ot,[2,336]),r(Ot,[2,337]),r(Ot,[2,338]),{109:[1,364]},r(q1,[2,60]),{13:l,16:h,55:365,307:43,308:g},r(ce,[2,335]),{13:l,16:h,55:366,307:43,308:g},{31:[1,367]},r(Ln,[2,341],{137:368}),r(Ln,[2,340]),{13:l,16:h,44:215,45:Le,55:220,82:D,87:p,89:Me,145:369,172:221,185:213,187:214,231:Ct,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},{28:[1,370],127:371,128:[1,372]},r(un,[2,330],{124:373,125:374,126:ze}),r(un,[2,57]),{44:375,87:p},r(D1,[2,151],{241:376,242:[1,377]}),r(Qo,[2,153],{245:378,246:[1,379]}),{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,247:380,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{250:[1,381]},r(ht,[2,432]),r(ht,[2,433]),r(ht,[2,434]),r(ht,[2,435]),r(ht,[2,436]),r(ht,[2,437]),{250:[2,439]},r([47,48,193,242,246,250,272,290,341,342,343,344,345,346],[2,158],{253:382,254:383,255:384,257:385,263:[1,386],265:[1,387],297:X,298:Z,299:ee,300:Q,301:ie,302:ne}),r(bs,[2,162],{261:388,262:389,39:sf,338:af}),r(St,[2,164]),r(St,[2,165]),r(St,[2,166]),r(ft,[2,95]),r(ft,[2,96]),r(ht,[2,377],{177:392,325:[1,393]}),{48:[1,394]},r(ft,[2,177]),{13:l,16:h,44:136,45:W,46:395,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:396,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:397,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:398,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:399,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ft,[2,183]),r(ft,[2,98]),r(ht,[2,381],{180:400}),{87:[1,401]},r(ft,[2,185]),{13:l,16:h,44:136,45:W,46:402,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{29:k,57:403},r(Kt,[2,193]),{13:l,16:h,55:404,307:43,308:g},{13:l,16:h,44:39,55:40,87:p,139:342,195:405,197:jn,307:43,308:g},r(ln,[2,233]),r(ln,[2,234]),r(ln,[2,235]),r($1,[2,459],{281:406,325:[1,407]}),r(ht,[2,463],{284:408,325:[1,409]}),r(ht,[2,465],{286:410,325:[1,411]}),{13:l,16:h,31:[1,412],55:414,82:D,171:413,172:415,173:416,174:tc,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:rc},{31:[1,419],89:[1,420]},{29:[1,421]},r(ec,[2,302]),r(Xo,[2,367],{167:422}),r(Zo,[2,369],{168:423}),{48:[1,424],87:[1,425]},r(ec,[2,371]),r(kn,[2,122]),r(kn,[2,417]),r(kn,[2,413]),r(kn,[2,414]),r(kn,[2,415]),r(gi,[2,125]),r(gi,[2,127]),r(gi,[2,128]),r(U1,[2,420],{227:426}),r(gi,[2,130]),{13:l,16:h,55:194,197:ge,223:427,307:43,308:g},{48:[1,428]},r(fn,[2,289],{61:429,80:430,81:[1,431],83:[1,432]}),r(rf,[2,288]),{64:[1,433]},r(Be,[2,29],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:434,13:l,16:h,45:W,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,276:Ce,277:ue,279:_e,280:fe,283:Se,285:Oe,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O}),r(B1,[2,293]),r(of,[2,92]),r(of,[2,93]),r(of,[2,94]),{45:N1,89:k1,176:269},{31:[1,435]},{31:[1,436]},{19:437,28:P,29:j,56:85},{19:438,28:P,29:j,56:85},r(Mn,[2,355],{149:439}),r(Mn,[2,354]),{13:l,16:h,44:215,45:ic,55:220,82:D,87:p,89:Me,156:440,172:221,185:441,203:442,231:nc,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(Ie,[2,19]),r(fn,[2,21]),{13:l,16:h,44:450,45:G1,55:323,65:445,66:446,67:447,68:448,87:p,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,307:43,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O},r(Es,[2,8]),{31:[1,451]},{31:[2,258]},{31:[2,101]},r(K,[2,386],{31:[2,388]}),r(Fa,[2,102]),r(Vn,[2,391],{191:452}),r(K,[2,395],{196:453,198:454}),r(K,[2,108]),r(K,[2,109]),r(Fa,[2,103]),r(Fa,[2,104]),r(Fa,[2,390]),{13:l,16:h,44:215,45:Le,48:[1,455],55:220,82:D,87:p,89:Me,172:221,185:351,187:350,200:456,231:Ct,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(sc,[2,424]),r(W1,[2,136]),r(W1,[2,137]),r(cf,[2,140]),{232:[1,457]},{13:l,16:h,44:39,55:40,87:p,139:342,195:458,197:jn,307:43,308:g},r(ln,[2,219]),r(ln,[2,220]),r(ln,[2,221]),r(ln,[2,222]),r(ln,[2,223]),r(Es,[2,10]),r(Ot,[2,46]),r(Ot,[2,314]),{112:O1,122:459},r(Ot,[2,62]),r(ce,F1,{133:242,108:460,112:P1,132:R1}),r(q1,[2,61]),r(Ot,[2,49]),r([6,28,126,128,193],[2,65]),{31:[2,66],112:[1,462],138:461},r(Ln,[2,351],{146:463,335:[1,464]}),{29:k,57:465},r(un,[2,329]),r(ce,[2,332],{129:466,327:[1,467]}),r(un,[2,55]),r(un,[2,331]),{48:[1,468]},r(Qo,[2,429]),{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,239:469,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ws,[2,431]),{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,243:470,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ws,[2,156]),{45:j1,89:L1,179:471},r(bs,[2,441]),{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,251:472,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(St,[2,444],{256:473}),r(St,[2,446],{258:474}),r(ht,[2,442]),r(ht,[2,443]),r(St,[2,449]),{13:l,16:h,44:136,45:W,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,255:154,257:155,259:475,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ht,[2,450]),r(ht,[2,451]),r(ht,[2,379],{178:476}),r(ht,[2,378]),r([6,13,16,29,31,39,45,47,48,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,175]),{48:[1,477]},{48:[1,478]},{272:[1,479]},{272:[1,480]},{272:[1,481]},{13:l,16:h,44:136,45:W,46:482,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{48:[1,483]},{48:[1,484]},r(ft,[2,187]),r(Kt,[2,194]),{13:l,16:h,44:39,55:40,82:D,87:p,139:289,172:291,255:154,257:155,266:290,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,320:485},{13:l,16:h,39:[1,487],44:136,45:W,46:488,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,282:486,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r($1,[2,460]),{13:l,16:h,44:136,45:W,46:489,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ht,[2,464]),{13:l,16:h,44:136,45:W,46:490,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ht,[2,466]),r(V,[2,40]),r(Xo,[2,298]),r(Pa,[2,87]),r(Pa,[2,88]),r(Pa,[2,89]),r(Pa,[2,90]),{13:l,16:h,55:492,82:D,172:493,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,311:494,312:zt,315:491},r(V,[2,41]),r(Zo,[2,300]),r(Ra,[2,303],{92:495}),{13:l,16:h,31:[1,496],55:414,82:D,171:497,172:415,173:416,174:tc,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:rc},{31:[1,498],89:[1,499]},{29:[1,500]},r(ec,[2,372]),{13:l,16:h,48:[2,422],55:194,197:ge,223:312,226:502,228:501,229:M1,307:43,308:g},r(gi,[2,131]),r(gi,[2,126]),r(fn,[2,22]),r(fn,[2,290]),{82:[1,503]},{82:[1,504]},{13:l,16:h,44:510,45:W,55:323,67:321,68:322,74:505,75:506,76:H1,77:320,78:z1,79:509,87:p,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,307:43,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O},r(B1,[2,294]),r(K1,[2,69]),r(K1,[2,70]),r(Be,ye,{59:197,69:198,20:511,70:N}),r(M,q,{58:205,62:206,23:512,63:de}),{29:[2,375],31:[2,71],84:522,85:a,112:[1,518],150:513,151:514,158:515,159:[1,516],160:[1,517],161:[1,519],163:[1,520],164:[1,521],175:523},r(Mn,[2,363],{157:524,335:[1,525]}),r(c,n,{215:10,202:526,205:527,208:528,214:529,44:530,87:p}),r(ac,[2,399],{215:10,205:527,208:528,214:529,44:530,204:531,202:532,13:n,16:n,45:n,197:n,224:n,229:n,308:n,87:p}),{13:l,16:h,44:215,45:ic,55:220,82:D,87:p,89:Me,172:221,185:351,203:536,212:534,231:nc,233:533,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(c,n,{215:10,205:527,208:528,214:529,44:530,202:537,87:p}),r(M,[2,23],{307:43,267:139,275:146,278:149,55:323,67:447,68:448,44:450,66:538,13:l,16:h,45:G1,87:p,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,276:Ce,277:ue,279:_e,280:fe,283:Se,285:Oe,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O}),r(qn,[2,291]),r(qn,[2,24]),r(qn,[2,25]),{13:l,16:h,44:136,45:W,46:539,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(qn,[2,28]),r(M,q,{58:205,62:206,23:540,63:de}),r([31,112,232,318,335],[2,105],{192:541,193:[1,542]}),r(Vn,[2,107]),{13:l,16:h,44:215,45:Le,55:220,82:D,87:p,89:Me,172:221,185:351,187:350,199:543,200:544,231:Ct,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(Y1,[2,132]),r(sc,[2,425]),r(Y1,[2,133]),{13:l,16:h,44:354,55:355,82:D,87:p,172:357,237:356,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:358,312:zt,313:545},r(Ot,[2,54]),r(Ot,[2,48]),r(Ln,[2,342]),{13:l,16:h,44:39,55:40,87:p,139:546,307:43,308:g},r(Ln,[2,68]),r(K,[2,350],{31:Q1,112:Q1}),r(Ot,[2,53]),{13:l,16:h,55:547,307:43,308:g},r(ce,[2,333]),r(Re,[2,16]),r(Qo,[2,152]),r(ws,[2,154]),r(ws,[2,157]),r(bs,[2,159]),r(bs,[2,160],{262:389,261:548,39:sf,338:af}),r(bs,[2,161],{262:389,261:549,39:sf,338:af}),r(St,[2,163]),{13:l,16:h,44:136,45:W,46:550,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ft,[2,178]),r(ft,[2,179]),{13:l,16:h,44:136,45:W,46:551,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:552,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:553,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{48:[1,554],272:[1,555]},r(ft,[2,184]),r(ft,[2,186]),{314:[1,556]},{48:[1,557]},{48:[2,461]},{48:[2,462]},{48:[1,558]},{48:[2,467],193:[1,561],287:559,288:560},{13:l,16:h,55:194,197:ge,223:562,307:43,308:g},r(uf,[2,224]),r(uf,[2,225]),r(uf,[2,226]),{31:[1,563],45:J1,94:564},r(V,[2,84]),r(Xo,[2,368]),r(V,[2,85]),r(Zo,[2,370]),r(Ra,[2,373],{170:566}),{48:[1,567]},{48:[2,423],337:[1,568]},r(fn,[2,35],{83:[1,569]}),r(fn,[2,36],{81:[1,570]}),r(rf,[2,30],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:509,44:510,75:571,13:l,16:h,45:W,76:H1,78:z1,87:p,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,276:Ce,277:ue,279:_e,280:fe,283:Se,285:Oe,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O}),r(Ts,[2,295]),{45:W,77:572},{45:W,77:573},r(Ts,[2,33]),r(Ts,[2,34]),{31:[2,275],50:574,84:575,85:a},{31:[2,277],51:576,84:577,85:a},r(Mn,[2,356]),r(X1,[2,357],{152:578,335:[1,579]}),r(Mi,[2,74]),{29:k,57:580},{29:k,57:581},{13:l,16:h,44:39,55:40,87:p,139:582,307:43,308:g},r(Z1,[2,365],{162:583,328:[1,584]}),{13:l,16:h,45:W,55:323,67:321,68:322,77:320,79:585,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,307:43,308:g,346:Fe,347:me,348:v,349:w,350:b,351:O},{45:[1,586]},r(Mi,[2,81]),{29:k,57:587},r(Mn,[2,73]),r(K,[2,362],{29:Vi,31:Vi,85:Vi,112:Vi,159:Vi,160:Vi,161:Vi,163:Vi,164:Vi}),r(ac,[2,112]),r(xs,[2,401],{206:588}),r(K,[2,405],{209:589,210:590}),r(K,[2,403]),r(K,[2,404]),r(ac,[2,113]),r(ac,[2,400]),{13:l,16:h,44:215,45:ic,48:[1,591],55:220,82:D,87:p,89:Me,172:221,185:351,203:536,212:592,231:nc,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(sc,[2,426]),r(cf,[2,138]),r(cf,[2,139]),{232:[1,593]},r(qn,[2,292]),{47:[1,595],48:[1,594]},r(Es,[2,9]),r(Vn,[2,392]),r(Vn,[2,393],{44:39,55:40,307:43,195:341,139:342,194:596,190:597,13:l,16:h,87:p,197:jn,308:g}),r(Vn,[2,110],{272:[1,598]}),r(oc,[2,397],{201:599,316:600,317:[1,601]}),{314:[1,602]},{29:[1,603]},r(un,[2,58]),r(St,[2,445]),r(St,[2,447]),{48:[1,604],272:[1,605]},{48:[1,606]},{272:[1,607]},{272:[1,608]},r(ft,[2,99]),r(ht,[2,382]),r([13,16,39,47,48,87,193,197,242,246,250,263,265,272,290,297,298,299,300,301,302,308,314,338,341,342,343,344,345,346],[2,232]),r(ft,[2,188]),r(ft,[2,189]),{48:[1,609]},{48:[2,468]},{289:[1,610]},{13:l,16:h,55:492,82:D,172:493,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,311:494,312:zt,315:611},r(V,[2,42]),r(Ra,[2,304]),{13:l,16:h,55:414,82:D,95:612,171:613,172:415,173:416,174:tc,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:rc},{31:[1,614],45:J1,94:615},r(gi,[2,129]),r(U1,[2,421]),{82:[1,616]},{82:[1,617]},r(Ts,[2,296]),r(Ts,[2,31]),r(Ts,[2,32]),{31:[2,17]},{31:[2,276]},{31:[2,18]},{31:[2,278]},r(K,V1,{155:330,153:618,154:619,29:qi,31:qi,85:qi,112:qi,159:qi,160:qi,161:qi,163:qi,164:qi}),r(X1,[2,358]),r(Mi,[2,75]),r(Mi,[2,76]),{29:k,57:620},{13:l,16:h,44:39,55:40,87:p,139:621,307:43,308:g},r(Z1,[2,366]),r(Mi,[2,79]),{13:l,16:h,44:136,45:W,46:622,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(Mi,[2,91],{336:[1,623]}),r([29,31,85,112,159,160,161,163,164,232,318,335],[2,114],{207:624,193:[1,625]}),r(xs,[2,117]),{13:l,16:h,44:215,45:ic,55:220,82:D,87:p,89:Me,172:221,185:351,203:536,211:626,212:627,231:nc,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,309:lr,310:_r,311:217,312:zt},r(Li,[2,134]),r(sc,[2,427]),r(Li,[2,135]),r(qn,[2,26]),{44:628,87:p},r(Vn,[2,106]),r(Vn,[2,394]),r(K,[2,396]),r(oc,[2,111]),r(oc,[2,398]),{13:l,16:h,44:39,55:40,87:p,139:342,186:629,190:340,195:341,197:jn,307:43,308:g},r(nf,[2,217]),r(K,Yo,{144:248,140:630,143:631,31:[2,343]}),r(ft,[2,97]),r(ht,[2,380]),r(ft,[2,180]),{13:l,16:h,44:136,45:W,46:632,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},{13:l,16:h,44:136,45:W,46:633,55:133,67:132,68:134,77:131,82:D,87:p,172:135,224:je,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:$e,264:130,265:L,266:137,267:139,268:le,269:Te,270:G,271:xe,273:Ae,274:ve,275:146,276:Ce,277:ue,278:149,279:_e,280:fe,283:Se,285:Oe,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:De,346:Fe,347:me,348:v,349:w,350:b,351:O},r(ft,[2,190]),{290:[1,634]},{314:[1,635]},{13:l,16:h,48:[1,636],55:414,82:D,171:637,172:415,173:416,174:tc,255:154,257:155,291:150,294:J,295:te,296:re,297:X,298:Z,299:ee,300:Q,301:ie,302:ne,303:se,304:ae,305:Y,306:oe,307:43,308:g,312:rc},r(eg,[2,305]),r(V,[2,86]),r(Ra,[2,374]),r(fn,[2,37]),r(fn,[2,38]),r(Mn,[2,72]),r(Mn,[2,360]),r(Mi,[2,77]),{29:k,57:638},{47:[1,639]},{29:[2,376]},r(xs,[2,402]),r(xs,[2,115],{215:10,208:528,214:529,44:530,205:640,13:n,16:n,45:n,197:n,224:n,229:n,308:n,87:p}),r(xs,[2,118],{272:[1,641]}),r(cc,[2,407],{213:642,319:643,317:[1,644]}),{48:[1,645]},{318:[1,646]},{31:[1,647]},{31:[2,344]},{48:[1,648]},{48:[1,649]},{291:650,303:se,304:ae,305:Y,306:oe},r(Pa,[2,218]),r(Ra,[2,44]),r(eg,[2,306]),r(Mi,[2,78]),{44:651,87:p},r(xs,[2,116]),r(K,[2,406]),r(cc,[2,119]),r(cc,[2,408]),r(c,n,{215:10,205:527,208:528,214:529,44:530,202:652,87:p}),r(qn,[2,27]),r(oc,[2,230]),r(tg,[2,345],{141:653,335:[1,654]}),r(ft,[2,181]),r(ft,[2,182]),{48:[2,191]},{48:[1,655]},{318:[1,656]},r(K,Yo,{144:248,142:657,143:658,31:rg,112:rg}),r(tg,[2,346]),r(Mi,[2,80]),r(cc,[2,231]),r(Ln,[2,67]),r(Ln,[2,348])],defaultActions:{5:[2,240],6:[2,241],7:[2,242],9:[2,239],24:[2,1],25:[2,2],26:[2,244],87:[2,282],94:[2,384],100:[2,45],109:[2,325],166:[2,458],263:[2,439],336:[2,258],337:[2,101],487:[2,461],488:[2,462],560:[2,468],574:[2,17],575:[2,276],576:[2,18],577:[2,278],623:[2,376],631:[2,344],650:[2,191]},parseError:o(function(E,C){if(C.recoverable)this.trace(E);else{var R=new Error(E);throw R.hash=C,R}},"parseError"),parse:o(function(E){var C=this,R=[0],H=[],pe=[null],d=[],Qt=this.table,m="",_i=0,ka=0,hc=0,dc=2,ja=1,pc=d.slice.call(arguments,1),st=Object.create(this.lexer),Si={yy:{}};for(var La in this.yy)Object.prototype.hasOwnProperty.call(this.yy,La)&&(Si.yy[La]=this.yy[La]);st.setInput(E,Si.yy),Si.yy.lexer=st,Si.yy.parser=this,typeof st.yylloc>"u"&&(st.yylloc={});var Ps=st.yylloc;d.push(Ps);var He=st.options&&st.options.ranges;typeof Si.yy.parseError=="function"?this.parseError=Si.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function rt(wi){R.length=R.length-2*wi,pe.length=pe.length-wi,d.length=d.length-wi}o(rt,"popStack");for(var Ve=o(function(){var wi;return wi=st.lex()||ja,typeof wi!="number"&&(wi=C.symbols_[wi]||wi),wi},"lex"),Ge,fr,Gn,Or,yI,bf,Rs={},mc,Bi,pg,gc;;){if(Gn=R[R.length-1],this.defaultActions[Gn]?Or=this.defaultActions[Gn]:((Ge===null||typeof Ge>"u")&&(Ge=Ve()),Or=Qt[Gn]&&Qt[Gn][Ge]),typeof Or>"u"||!Or.length||!Or[0]){var Ef="";gc=[];for(mc in Qt[Gn])this.terminals_[mc]&&mc>dc&&gc.push("'"+this.terminals_[mc]+"'");st.showPosition?Ef="Parse error on line "+(_i+1)+`:
`+st.showPosition()+`
Expecting `+gc.join(", ")+", got '"+(this.terminals_[Ge]||Ge)+"'":Ef="Parse error on line "+(_i+1)+": Unexpected "+(Ge==ja?"end of input":"'"+(this.terminals_[Ge]||Ge)+"'"),this.parseError(Ef,{text:st.match,token:this.terminals_[Ge]||Ge,line:st.yylineno,loc:Ps,expected:gc})}if(Or[0]instanceof Array&&Or.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Gn+", token: "+Ge);switch(Or[0]){case 1:R.push(Ge),pe.push(st.yytext),d.push(st.yylloc),R.push(Or[1]),Ge=null,fr?(Ge=fr,fr=null):(ka=st.yyleng,m=st.yytext,_i=st.yylineno,Ps=st.yylloc,hc>0&&hc--);break;case 2:if(Bi=this.productions_[Or[1]][1],Rs.$=pe[pe.length-Bi],Rs._$={first_line:d[d.length-(Bi||1)].first_line,last_line:d[d.length-1].last_line,first_column:d[d.length-(Bi||1)].first_column,last_column:d[d.length-1].last_column},He&&(Rs._$.range=[d[d.length-(Bi||1)].range[0],d[d.length-1].range[1]]),bf=this.performAction.apply(Rs,[m,ka,_i,Si.yy,Or[1],pe,d].concat(pc)),typeof bf<"u")return bf;Bi&&(R=R.slice(0,-1*Bi*2),pe=pe.slice(0,-1*Bi),d=d.slice(0,-1*Bi)),R.push(this.productions_[Or[1]][0]),pe.push(Rs.$),d.push(Rs._$),pg=Qt[R[R.length-2]][R[R.length-1]],R.push(pg);break;case 3:return!0}}return!0},"parse")},uc=_p().Wildcard,lc="http://www.w3.org/1999/02/22-rdf-syntax-ns#",dw=lc+"type",pw=lc+"first",mw=lc+"rest",ig=lc+"nil",fc="http://www.w3.org/2001/XMLSchema#",ng=fc+"integer",sg=fc+"decimal",ag=fc+"double",gw=fc+"boolean",$n="",og="",cg="";function Yt(x){return x.toLowerCase()}o(Yt,"lowercase");function $i(x,E){return x.push(E),x}o($i,"appendTo");function Un(x,E){return x.push.apply(x,E),x}o(Un,"appendAllTo");function ct(x){x||(x={});for(var E=1,C=arguments.length,R;E<C&&(R=arguments[E]||{});E++)for(var H in R)x[H]=R[H];return x}o(ct,"extend");function yi(){for(var x=[],E=0,C=arguments.length;E<C;E++)x=x.concat.apply(x,arguments[E]);return x}o(yi,"unionAll");function Ia(x){if(x[0]==="<"&&(x=x.substring(1,x.length-1)),/^[a-z][a-z0-9.+-]*:/i.test(x))return x;if(!we.base)throw new Error("Cannot resolve relative IRI "+x+" because no base IRI was set.");switch($n!==we.base&&($n=we.base,og=$n.replace(/[^\/:]*$/,""),cg=$n.match(/^(?:[a-z]+:\/*)?[^\/]*/)[0]),x[0]){case void 0:return $n;case"#":return $n+x;case"?":return $n.replace(/(?:\?.*)?$/,x);case"/":return cg+x;default:return og+x}}o(Ia,"resolveIRI");function ff(x){if(x){var E=x[0];if(E==="?"||E==="$")return we.factory.variable(x.substr(1))}return x}o(ff,"toVar");function Ft(x,E){return{type:"operation",operator:x,args:E||[]}}o(Ft,"operation");function As(x,E){var C={expression:x==="*"?new uc:x};if(E)for(var R in E)C[R]=E[R];return C}o(As,"expression");function Cs(x,E){return{type:"path",pathType:x,items:E}}o(Cs,"path");function hf(x,E){for(var C=0,R=E.length,H;C<R&&(H=E[C]);C++)x=Ft(H[0],[x,H[1]]);return x}o(hf,"createOperationTree");function Bn(x,E){var C=[],R=[],H=x.length,pe,d={};if(!H)return null;for(var Qt=0;Qt<H&&(pe=x[Qt]);Qt++)(pe.named?R:C).push(pe.iri);return d[E||"from"]={default:C,named:R},d}o(Bn,"groupDatasets");function Os(x){return parseInt(x,10)}o(Os,"toInt");function df(x){return x.type==="group"&&x.patterns.length===1?x.patterns[0]:x}o(df,"degroupSingle");function vi(x,E){return E&&E.termType!=="NamedNode"&&(E=we.factory.namedNode(E)),we.factory.literal(x,E)}o(vi,"createTypedLiteral");function yw(x,E){return we.factory.literal(x,E)}o(yw,"createLangLiteral");function pf(x,E,C){if(!("termType"in E))throw new Error("Nested triples cannot contain paths");return we.factory.quad(x,E,C)}o(pf,"nestedTriple");function Ui(x,E,C,R){var H={};return x!=null&&(H.subject=x),E!=null&&(H.predicate=E),C!=null&&(H.object=C),R!=null&&(H.annotations=R),H}o(Ui,"triple");function Da(x){return typeof x=="string"?x.startsWith("e_")?we.factory.blankNode(x):we.factory.blankNode("e_"+x):we.factory.blankNode("g_"+ug++)}o(Da,"blank");var ug=0;we._resetBlanks=function(){ug=0};var vw=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\(.)/g,_w={"\\":"\\","'":"'",'"':'"',t:"	",b:"\b",n:`
`,r:"\r",f:"\f"},Sw=/[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/,mf=String.fromCharCode;function lg(x,E){x=x.substring(E,x.length-E);try{x=x.replace(vw,function(C,R,H,pe){var d;if(R){if(d=parseInt(R,16),isNaN(d))throw new Error;return mf(d)}else if(H){if(d=parseInt(H,16),isNaN(d))throw new Error;return d<65535?mf(d):mf(55296+((d-=65536)>>10),56320+(d&1023))}else{var Qt=_w[pe];if(!Qt)throw new Error;return Qt}})}catch{return""}if(Sw.exec(x))throw new Error("Invalid unicode codepoint of surrogate pair without corresponding codepoint in "+x);return x}o(lg,"unescapeString");function ww(x){var E=Da(),C=E,R=[],H,pe=[];x.forEach(function(_i){R.push(_i.entity),Un(pe,_i.triples)});for(var d=0,Qt=0,m=R.length,H=Array(m*2);d<m;)H[Qt++]=Ui(C,we.factory.namedNode(pw),R[d]),H[Qt++]=Ui(C,we.factory.namedNode(mw),C=++d<m?Da():we.factory.namedNode(ig));return{entity:E,triples:Un(H,pe)}}o(ww,"createList");function bw(x){var E=Da();return{entity:E,triples:x.map(function(C){return ct(Ui(E),C)})}}o(bw,"createAnonymousObject");function gf(x,E,C){var R=[],H=[];return E.forEach(function(pe){let d=null;pe.annotation&&(d=pe.annotation,pe=pe.object),R.push(Ui(null,x,pe.entity,d)),Un(H,pe.triples)}),yi(R,C||[],H)}o(gf,"objectListToTriples");function mI(x){for(var E=[],C,R=0,H;H=x[R];R++)switch(H.type){case"bgp":H.triples.length&&(C?Un(C.triples,H.triples):$i(E,C=H));break;default:(!H.patterns||H.patterns.length>0)&&($i(E,H),C=null)}return E}o(mI,"mergeAdjacentBGPs");function Fs(x){return x.variable?x.variable.value:x.value||x.expression.value}o(Fs,"getExpressionId");function yf(x){if(!x)return[];if(x.type==="aggregate")return[x];if(x.type==="operation"){let E=[];for(let C of x.args)E.push(...yf(C));return E}return[]}o(yf,"getAggregatesOfExpression");function Ew(x){let E=new Set,C=o(function(R){R&&(R.termType==="Variable"?E.add(R):R.type==="operation"&&R.args.forEach(C))},"visitExpression");return C(x),E}o(Ew,"getVariablesFromExpression");function vf(x,E=1,C=[]){for(let R of x)E>0&&R instanceof Array?vf(R,E-1,C):C.push(R);return C}o(vf,"flatten");function _f(x){return x.termType==="Variable"}o(_f,"isVariable");function fg(x){if(x.triples){let E=[];for(let C of x.triples)_f(C.subject)&&E.push(C.subject.value),_f(C.predicate)&&E.push(C.predicate.value),_f(C.object)&&E.push(C.object.value);return E}else if(x.patterns){let E=[];for(let C of x.patterns)E.push(...fg(C));return E}return[]}o(fg,"getBoundVarsFromGroupGraphPattern");function Tw(x){let E=x.slice().sort(),C=[];for(let R=0;R<E.length-1;R++)E[R+1]==E[R]&&C.push(E[R]);return C}o(Tw,"getDuplicatesInArray");function Na(x){if(!we.sparqlStar)throw new Error("SPARQL-star support is not enabled");return x}o(Na,"ensureSparqlStar");function hg(x,E,C){for(let R of E){let H=Ui("subject"in R?R.subject:x,R.predicate,R.object);C.push(H),R.annotations&&hg(pf(x,R.predicate,R.object),R.annotations,C)}}o(hg,"_applyAnnotations");function Sf(x){if(we.sparqlStar){let E=[];return x.forEach(C=>{let R=Ui(C.subject,C.predicate,C.object);E.push(R),C.annotations&&hg(pf(C.subject,C.predicate,C.object),C.annotations,E)}),E}return x}o(Sf,"applyAnnotations");function gI(x){if(!we.sparqlStarNestedQuads)throw new Error("Lenient SPARQL-star support with nested quads is not enabled");return x}o(gI,"ensureSparqlStarNestedQuads");function dg(x){for(let E of x){if(E.type==="graph"&&E.name.termType==="Variable")throw new Error("Detected illegal variable in GRAPH");if(E.type==="bgp"||E.type==="graph"){for(let C of E.triples)if(C.subject.termType==="Variable"||C.predicate.termType==="Variable"||C.object.termType==="Variable")throw new Error("Detected illegal variable in BGP")}}return x}o(dg,"ensureNoVariables");function wf(x){for(let E of x)if(E.type==="bgp"){for(let C of E.triples)if(C.subject.termType==="BlankNode"||C.predicate.termType==="BlankNode"||C.object.termType==="BlankNode")throw new Error("Detected illegal blank node in BGP")}return x}o(wf,"ensureNoBnodes");var xw=(function(){var x={EOF:1,parseError:o(function(C,R){if(this.yy.parser)this.yy.parser.parseError(C,R);else throw new Error(C)},"parseError"),setInput:o(function(E,C){return this.yy=C||this.yy||{},this._input=E,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},"setInput"),input:o(function(){var E=this._input[0];this.yytext+=E,this.yyleng++,this.offset++,this.match+=E,this.matched+=E;var C=E.match(/(?:\r\n?|\n).*/g);return C?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),E},"input"),unput:o(function(E){var C=E.length,R=E.split(/(?:\r\n?|\n)/g);this._input=E+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-C),this.offset-=C;var H=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),R.length-1&&(this.yylineno-=R.length-1);var pe=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:R?(R.length===H.length?this.yylloc.first_column:0)+H[H.length-R.length].length-R[0].length:this.yylloc.first_column-C},this.options.ranges&&(this.yylloc.range=[pe[0],pe[0]+this.yyleng-C]),this.yyleng=this.yytext.length,this},"unput"),more:o(function(){return this._more=!0,this},"more"),reject:o(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},"reject"),less:o(function(E){this.unput(this.match.slice(E))},"less"),pastInput:o(function(){var E=this.matched.substr(0,this.matched.length-this.match.length);return(E.length>20?"...":"")+E.substr(-20).replace(/\n/g,"")},"pastInput"),upcomingInput:o(function(){var E=this.match;return E.length<20&&(E+=this._input.substr(0,20-E.length)),(E.substr(0,20)+(E.length>20?"...":"")).replace(/\n/g,"")},"upcomingInput"),showPosition:o(function(){var E=this.pastInput(),C=new Array(E.length+1).join("-");return E+this.upcomingInput()+`
`+C+"^"},"showPosition"),test_match:o(function(E,C){var R,H,pe;if(this.options.backtrack_lexer&&(pe={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(pe.yylloc.range=this.yylloc.range.slice(0))),H=E[0].match(/(?:\r\n?|\n).*/g),H&&(this.yylineno+=H.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:H?H[H.length-1].length-H[H.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+E[0].length},this.yytext+=E[0],this.match+=E[0],this.matches=E,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(E[0].length),this.matched+=E[0],R=this.performAction.call(this,this.yy,this,C,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),R)return R;if(this._backtrack){for(var d in pe)this[d]=pe[d];return!1}return!1},"test_match"),next:o(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var E,C,R,H;this._more||(this.yytext="",this.match="");for(var pe=this._currentRules(),d=0;d<pe.length;d++)if(R=this._input.match(this.rules[pe[d]]),R&&(!C||R[0].length>C[0].length)){if(C=R,H=d,this.options.backtrack_lexer){if(E=this.test_match(R,pe[d]),E!==!1)return E;if(this._backtrack){C=!1;continue}else return!1}else if(!this.options.flex)break}return C?(E=this.test_match(C,pe[H]),E!==!1?E:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},"next"),lex:o(function(){var C=this.next();return C||this.lex()},"lex"),begin:o(function(C){this.conditionStack.push(C)},"begin"),popState:o(function(){var C=this.conditionStack.length-1;return C>0?this.conditionStack.pop():this.conditionStack[0]},"popState"),_currentRules:o(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},"_currentRules"),topState:o(function(C){return C=this.conditionStack.length-1-Math.abs(C||0),C>=0?this.conditionStack[C]:"INITIAL"},"topState"),pushState:o(function(C){this.begin(C)},"pushState"),stateStackSize:o(function(){return this.conditionStack.length},"stateStackSize"),options:{flex:!0,"case-insensitive":!0},performAction:o(function(C,R,H,pe){var d=pe;switch(H){case 0:break;case 1:return 12;case 2:return 15;case 3:return 41;case 4:return 325;case 5:return 326;case 6:return 45;case 7:return 47;case 8:return 48;case 9:return 39;case 10:return 24;case 11:return 28;case 12:return 29;case 13:return 31;case 14:return 32;case 15:return 36;case 16:return 53;case 17:return 327;case 18:return 63;case 19:return 64;case 20:return 70;case 21:return 73;case 22:return 76;case 23:return 78;case 24:return 81;case 25:return 83;case 26:return 85;case 27:return 193;case 28:return 100;case 29:return 328;case 30:return 121;case 31:return 329;case 32:return 330;case 33:return 110;case 34:return 331;case 35:return 109;case 36:return 332;case 37:return 333;case 38:return 113;case 39:return 115;case 40:return 116;case 41:return 131;case 42:return 123;case 43:return 126;case 44:return 128;case 45:return 132;case 46:return 112;case 47:return 334;case 48:return 335;case 49:return 159;case 50:return 161;case 51:return 164;case 52:return 174;case 53:return 160;case 54:return 336;case 55:return 163;case 56:return 312;case 57:return 314;case 58:return 317;case 59:return 318;case 60:return 272;case 61:return 197;case 62:return 337;case 63:return 338;case 64:return 229;case 65:return 340;case 66:return 263;case 67:return 224;case 68:return 231;case 69:return 232;case 70:return 242;case 71:return 246;case 72:return 290;case 73:return 341;case 74:return 342;case 75:return 343;case 76:return 344;case 77:return 345;case 78:return 250;case 79:return 346;case 80:return 265;case 81:return 276;case 82:return 277;case 83:return 268;case 84:return 269;case 85:return 270;case 86:return 271;case 87:return 347;case 88:return 348;case 89:return 273;case 90:return 274;case 91:return 350;case 92:return 349;case 93:return 351;case 94:return 279;case 95:return 280;case 96:return 283;case 97:return 285;case 98:return 289;case 99:return 293;case 100:return 296;case 101:return 13;case 102:return 16;case 103:return 308;case 104:return 309;case 105:return 87;case 106:return 292;case 107:return 82;case 108:return 294;case 109:return 295;case 110:return 297;case 111:return 298;case 112:return 299;case 113:return 300;case 114:return 301;case 115:return 302;case 116:return"EXPONENT";case 117:return 303;case 118:return 304;case 119:return 305;case 120:return 306;case 121:return 89;case 122:return 310;case 123:return 6;case 124:return"INVALID";case 125:console.log(R.yytext);break}},"anonymous"),rules:[/^(?:\s+|(#[^\n\r]*))/i,/^(?:BASE)/i,/^(?:PREFIX)/i,/^(?:SELECT)/i,/^(?:DISTINCT)/i,/^(?:REDUCED)/i,/^(?:\()/i,/^(?:AS)/i,/^(?:\))/i,/^(?:\*)/i,/^(?:CONSTRUCT)/i,/^(?:WHERE)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:DESCRIBE)/i,/^(?:ASK)/i,/^(?:FROM)/i,/^(?:NAMED)/i,/^(?:GROUP)/i,/^(?:BY)/i,/^(?:HAVING)/i,/^(?:ORDER)/i,/^(?:ASC)/i,/^(?:DESC)/i,/^(?:LIMIT)/i,/^(?:OFFSET)/i,/^(?:VALUES)/i,/^(?:;)/i,/^(?:LOAD)/i,/^(?:SILENT)/i,/^(?:INTO)/i,/^(?:CLEAR)/i,/^(?:DROP)/i,/^(?:CREATE)/i,/^(?:ADD)/i,/^(?:TO)/i,/^(?:MOVE)/i,/^(?:COPY)/i,/^(?:INSERT((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)WHERE)/i,/^(?:WITH)/i,/^(?:DELETE)/i,/^(?:INSERT)/i,/^(?:USING)/i,/^(?:DEFAULT)/i,/^(?:GRAPH)/i,/^(?:ALL)/i,/^(?:\.)/i,/^(?:OPTIONAL)/i,/^(?:SERVICE)/i,/^(?:BIND)/i,/^(?:UNDEF)/i,/^(?:MINUS)/i,/^(?:UNION)/i,/^(?:FILTER)/i,/^(?:<<)/i,/^(?:>>)/i,/^(?:\{\|)/i,/^(?:\|\})/i,/^(?:,)/i,/^(?:a)/i,/^(?:\|)/i,/^(?:\/)/i,/^(?:\^)/i,/^(?:\?)/i,/^(?:\+)/i,/^(?:!)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\|\|)/i,/^(?:&&)/i,/^(?:=)/i,/^(?:!=)/i,/^(?:<)/i,/^(?:>)/i,/^(?:<=)/i,/^(?:>=)/i,/^(?:IN)/i,/^(?:NOT)/i,/^(?:-)/i,/^(?:BOUND)/i,/^(?:BNODE)/i,/^(?:(RAND|NOW|UUID|STRUUID))/i,/^(?:(LANG|DATATYPE|IRI|URI|ABS|CEIL|FLOOR|ROUND|STRLEN|STR|UCASE|LCASE|ENCODE_FOR_URI|YEAR|MONTH|DAY|HOURS|MINUTES|SECONDS|TIMEZONE|TZ|MD5|SHA1|SHA256|SHA384|SHA512|isIRI|isURI|isBLANK|isLITERAL|isNUMERIC))/i,/^(?:(SUBJECT|PREDICATE|OBJECT|isTRIPLE))/i,/^(?:(LANGMATCHES|CONTAINS|STRSTARTS|STRENDS|STRBEFORE|STRAFTER|STRLANG|STRDT|sameTerm))/i,/^(?:CONCAT)/i,/^(?:COALESCE)/i,/^(?:IF)/i,/^(?:TRIPLE)/i,/^(?:REGEX)/i,/^(?:SUBSTR)/i,/^(?:REPLACE)/i,/^(?:EXISTS)/i,/^(?:COUNT)/i,/^(?:SUM|MIN|MAX|AVG|SAMPLE)/i,/^(?:GROUP_CONCAT)/i,/^(?:SEPARATOR)/i,/^(?:\^\^)/i,/^(?:true|false)/i,/^(?:(<(?:[^<>\"\{\}\|\^`\\\u0000-\u0020])*>))/i,/^(?:((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:))/i,/^(?:(((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:)((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|:|[0-9]|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(_:(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?))/i,/^(?:([\?\$]((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])*)))/i,/^(?:(@[a-zA-Z]+(?:-[a-zA-Z0-9]+)*))/i,/^(?:([0-9]+))/i,/^(?:([0-9]*\.[0-9]+))/i,/^(?:([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+)))/i,/^(?:(\+([0-9]+)))/i,/^(?:(\+([0-9]*\.[0-9]+)))/i,/^(?:(\+([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:(-([0-9]+)))/i,/^(?:(-([0-9]*\.[0-9]+)))/i,/^(?:(-([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:([eE][+-]?[0-9]+))/i,/^(?:('(?:(?:[^\u0027\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*'))/i,/^(?:("(?:(?:[^\u0022\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*"))/i,/^(?:('''(?:(?:'|'')?(?:[^'\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*'''))/i,/^(?:("""(?:(?:"|"")?(?:[^\"\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*"""))/i,/^(?:(\((\u0020|\u0009|\u000D|\u000A)*\)))/i,/^(?:(\[(\u0020|\u0009|\u000D|\u000A)*\]))/i,/^(?:$)/i,/^(?:.)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125],inclusive:!0}}};return x})();lf.lexer=xw;function we(){this.yy={}}return o(we,"Parser"),we.prototype=lf,lf.Parser=we,new we})();Y2.exports=PC});var ey=y((jj,Z2)=>{var RC="http://www.w3.org/2001/XMLSchema#integer",IC="http://www.w3.org/2001/XMLSchema#string";function Je(r){this._options=r=r||{};var e=r.prefixes||{};this._prefixByIri={};var t=[];for(var i in e){var n=e[i];ro(n)&&(this._prefixByIri[n]=i,t.push(n))}var s=t.join("|").replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&");this._prefixRegex=new RegExp("^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$"),this._usedPrefixes={},this._sparqlStar=r.sparqlStar,this._indent=ro(r.indent)?r.indent:"  ",this._newline=ro(r.newline)?r.newline:`
`,this._explicitDatatype=!!r.explicitDatatype}o(Je,"Generator");Je.prototype.toQuery=function(r){var e="";return r.queryType&&(e+=r.queryType.toUpperCase()+" "),r.reduced&&(e+="REDUCED "),r.distinct&&(e+="DISTINCT "),r.variables?e+=Tr(r.variables,void 0,function(t){return/^[?$]/.test(t)?t:Sn(t)?this.toEntity(t):"("+this.toExpression(t.expression)+" AS "+Au(t.variable)+")"},this)+" ":r.template&&(e+=this.group(r.template,!0)+this._newline),r.from&&(e+=this.graphs("FROM ",r.from.default)+this.graphs("FROM NAMED ",r.from.named)),r.where&&(e+="WHERE "+this.group(r.where,!0)+this._newline),r.updates&&(e+=Tr(r.updates,";"+this._newline,this.toUpdate,this)),r.group&&(e+="GROUP BY "+Tr(r.group,void 0,function(t){var i=Sn(t.expression)?this.toEntity(t.expression):"("+this.toExpression(t.expression)+")";return t.variable?"("+i+" AS "+Au(t.variable)+")":i},this)+this._newline),r.having&&(e+="HAVING ("+Tr(r.having,void 0,this.toExpression,this)+")"+this._newline),r.order&&(e+="ORDER BY "+Tr(r.order,void 0,function(t){var i="("+this.toExpression(t.expression)+")";return t.descending?"DESC "+i:i},this)+this._newline),r.offset&&(e+="OFFSET "+r.offset+this._newline),r.limit&&(e+="LIMIT "+r.limit+this._newline),r.values&&(e+=this.values(r)),e=this.baseAndPrefixes(r)+e,e.trim()};Je.prototype.baseAndPrefixes=function(r){var e=r.base?"BASE <"+r.base+">"+this._newline:"",t="";for(var i in r.prefixes)(this._options.allPrefixes||this._usedPrefixes[i])&&(t+="PREFIX "+i+": <"+r.prefixes[i]+">"+this._newline);return e+t};Je.prototype.toPattern=function(r){var e=r.type||r instanceof Array&&"array"||(r.subject&&r.predicate&&r.object?"triple":"");if(!(e in this))throw new Error("Unknown entry type: "+e);return this[e](r)};Je.prototype.triple=function(r){return this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+"."};Je.prototype.array=function(r){return Tr(r,this._newline,this.toPattern,this)};Je.prototype.bgp=function(r){return this.encodeTriples(r.triples)};Je.prototype.encodeTriples=function(r){if(!r.length)return"";for(var e=[],t=void 0,i=void 0,n=0;n<r.length;n++){var s=r[n];cs(s.subject,t)?cs(s.predicate,i)?e.push(","):(i=s.predicate,e.push(";"+this._newline,this._indent,this.toEntity(i))):(t&&e.push("."+this._newline),t=s.subject,i=s.predicate,e.push(this.toEntity(t)," ",this.toEntity(i))),e.push(" ",this.toEntity(s.object))}return e.push("."),e.join("")};Je.prototype.graph=function(r){return"GRAPH "+this.toEntity(r.name)+" "+this.group(r)};Je.prototype.graphs=function(r,e){return!e||e.length===0?"":Tr(e,"",function(t){return r+this.toEntity(t)+this._newline},this)};Je.prototype.group=function(r,e){return r=e!==!0?this.array(r.patterns||r.triples):this.toPattern(r.type!=="group"?r:r.patterns),r.indexOf(this._newline)===-1?"{ "+r+" }":"{"+this._newline+this.indent(r)+this._newline+"}"};Je.prototype.query=function(r){return this.toQuery(r)};Je.prototype.filter=function(r){return"FILTER("+this.toExpression(r.expression)+")"};Je.prototype.bind=function(r){return"BIND("+this.toExpression(r.expression)+" AS "+Au(r.variable)+")"};Je.prototype.optional=function(r){return"OPTIONAL "+this.group(r)};Je.prototype.union=function(r){return Tr(r.patterns,this._newline+"UNION"+this._newline,function(e){return this.group(e,!0)},this)};Je.prototype.minus=function(r){return"MINUS "+this.group(r)};Je.prototype.values=function(r){var e=Object.keys(r.values.reduce(function(n,s){for(var a in s)n[a]=!0;return n},{})),t,i;return e.length===1?t=i="":(t="(",i=")"),"VALUES "+t+e.join(" ")+i+" {"+this._newline+Tr(r.values,this._newline,function(n){return"  "+t+Tr(e,void 0,function(s){return n[s]?this.toEntity(n[s]):"UNDEF"},this)+i},this)+this._newline+"}"};Je.prototype.service=function(r){return"SERVICE "+(r.silent?"SILENT ":"")+this.toEntity(r.name)+" "+this.group(r)};Je.prototype.toExpression=function(r){if(Sn(r))return this.toEntity(r);switch(r.type.toLowerCase()){case"aggregate":return r.aggregation.toUpperCase()+"("+(r.distinct?"DISTINCT ":"")+this.toExpression(r.expression)+(typeof r.separator=="string"?'; SEPARATOR = "'+r.separator.replace(J2,X2)+'"':"")+")";case"functioncall":return this.toEntity(r.function)+"("+Tr(r.args,", ",this.toExpression,this)+")";case"operation":var e=r.operator.toUpperCase(),t=r.args||[];switch(r.operator.toLowerCase()){case"<":case">":case">=":case"<=":case"&&":case"||":case"=":case"!=":case"+":case"-":case"*":case"/":return(Sn(t[0])?this.toEntity(t[0]):"("+this.toExpression(t[0])+")")+" "+e+" "+(Sn(t[1])?this.toEntity(t[1]):"("+this.toExpression(t[1])+")");case"!":return"!("+this.toExpression(t[0])+")";case"uplus":return"+("+this.toExpression(t[0])+")";case"uminus":return"-("+this.toExpression(t[0])+")";case"notin":e="NOT IN";case"in":return this.toExpression(t[0])+" "+e+"("+(ro(t[1])?t[1]:Tr(t[1],", ",this.toExpression,this))+")";case"notexists":e="NOT EXISTS";case"exists":return e+" "+this.group(t[0],!0);default:return e+"("+Tr(t,", ",this.toExpression,this)+")"}default:throw new Error("Unknown expression type: "+r.type)}};Je.prototype.toEntity=function(r){if(Sn(r))switch(r.termType){case"Wildcard":return"*";case"Variable":return Au(r);case"BlankNode":return"_:"+r.value;case"Literal":var e=r.value||"",t=r.language||"",i=r.datatype;if(r='"'+e.replace(J2,X2)+'"',t)r+="@"+t;else if(i){if(!this._explicitDatatype)switch(i.value){case IC:return r;case RC:if(/^\d+$/.test(e))return e+" "}r+="^^"+this.encodeIRI(i.value)}return r;case"Quad":if(!this._sparqlStar)throw new Error("SPARQL* support is not enabled");return r.graph&&r.graph.termType!=="DefaultGraph"?"<< GRAPH "+this.toEntity(r.graph)+" { "+this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+" }  >>":"<< "+this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+" >>";default:return this.encodeIRI(r.value)}else{var n=r.items.map(this.toEntity,this),s=r.pathType;switch(s){case"^":case"!":return s+n[0];case"*":case"+":case"?":return"("+n[0]+s+")";default:return"("+n.join(s)+")"}}};var J2=/["\\\t\n\r\b\f]/g,X2=o(function(r){return DC[r]},"escapeReplacer"),DC={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};Je.prototype.encodeIRI=function(r){var e=this._prefixRegex.exec(r);if(e){var t=this._prefixByIri[e[1]];return this._usedPrefixes[t]=!0,t+":"+e[2]}return"<"+r+">"};Je.prototype.toUpdate=function(r){switch(r.type||r.updateType){case"load":return"LOAD"+(r.source?" "+this.toEntity(r.source):"")+(r.destination?" INTO GRAPH "+this.toEntity(r.destination):"");case"insert":return"INSERT DATA "+this.group(r.insert,!0);case"delete":return"DELETE DATA "+this.group(r.delete,!0);case"deletewhere":return"DELETE WHERE "+this.group(r.delete,!0);case"insertdelete":return(r.graph?"WITH "+this.toEntity(r.graph)+this._newline:"")+(r.delete.length?"DELETE "+this.group(r.delete,!0)+this._newline:"")+(r.insert.length?"INSERT "+this.group(r.insert,!0)+this._newline:"")+(r.using?this.graphs("USING ",r.using.default):"")+(r.using?this.graphs("USING NAMED ",r.using.named):"")+"WHERE "+this.group(r.where,!0);case"add":case"copy":case"move":return r.type.toUpperCase()+" "+(r.silent?"SILENT ":"")+(r.source.default?"DEFAULT":this.toEntity(r.source.name))+" TO "+this.toEntity(r.destination.name);case"create":case"clear":case"drop":return r.type.toUpperCase()+(r.silent?" SILENT ":" ")+(r.graph.default?"DEFAULT":r.graph.named?"NAMED":r.graph.all?"ALL":"GRAPH "+this.toEntity(r.graph.name));default:throw new Error("Unknown update query type: "+r.type)}};Je.prototype.indent=function(r){return r.replace(/^/gm,this._indent)};function Au(r){return"?"+r.value}o(Au,"variableToString");function ro(r){return typeof r=="string"}o(ro,"isString");function Sn(r){return typeof r.termType=="string"}o(Sn,"isTerm");function cs(r,e){if(!r||!Sn(r)||!e||!Sn(e)||r.termType!==e.termType)return!1;switch(r.termType){case"Literal":return r.value===e.value&&r.language===e.language&&cs(r.datatype,e.datatype);case"Quad":return cs(r.subject,e.subject)&&cs(r.predicate,e.predicate)&&cs(r.object,e.object)&&cs(r.graph,e.graph);default:return r.value===e.value}}o(cs,"equalTerms");function Tr(r,e,t,i){return r.map(t,i).join(ro(e)?e:" ")}o(Tr,"mapJoin");function NC(r={}){return{stringify:o(function(e){var t=Object.create(r);return t.prefixes=e.prefixes,new Je(t).toQuery(e)},"stringify"),createGenerator:o(function(){return new Je(r)},"createGenerator")}}o(NC,"_Generator");Z2.exports={Generator:NC}});var wp=y(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.BlankNode=void 0;var Sp=class{static{o(this,"BlankNode")}constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&e.termType==="BlankNode"&&e.value===this.value}};Cu.BlankNode=Sp});var bp=y(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.DefaultGraph=void 0;var io=class{static{o(this,"DefaultGraph")}constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&e.termType==="DefaultGraph"}};Ou.DefaultGraph=io;io.INSTANCE=new io});var Pu=y(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.NamedNode=void 0;var Ep=class{static{o(this,"NamedNode")}constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&e.termType==="NamedNode"&&e.value===this.value}};Fu.NamedNode=Ep});var Tp=y(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.Literal=void 0;var ty=Pu(),no=class r{static{o(this,"Literal")}constructor(e,t){this.termType="Literal",this.value=e,typeof t=="string"?(this.language=t,this.datatype=r.RDF_LANGUAGE_STRING):t?(this.language="",this.datatype=t):(this.language="",this.datatype=r.XSD_STRING)}equals(e){return!!e&&e.termType==="Literal"&&e.value===this.value&&e.language===this.language&&this.datatype.equals(e.datatype)}};Ru.Literal=no;no.RDF_LANGUAGE_STRING=new ty.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString");no.XSD_STRING=new ty.NamedNode("http://www.w3.org/2001/XMLSchema#string")});var Ap=y(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.Quad=void 0;var xp=class{static{o(this,"Quad")}constructor(e,t,i,n){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=i,this.graph=n}equals(e){return!!e&&(e.termType==="Quad"||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}};Iu.Quad=xp});var Op=y(Du=>{"use strict";Object.defineProperty(Du,"__esModule",{value:!0});Du.Variable=void 0;var Cp=class{static{o(this,"Variable")}constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&e.termType==="Variable"&&e.value===this.value}};Du.Variable=Cp});var iy=y(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.DataFactory=void 0;var kC=wp(),jC=bp(),ry=Tp(),LC=Pu(),MC=Ap(),VC=Op(),qC=0,Fp=class{static{o(this,"DataFactory")}constructor(e){this.blankNodeCounter=0,e=e||{},this.blankNodePrefix=e.blankNodePrefix||`df_${qC++}_`}namedNode(e){return new LC.NamedNode(e)}blankNode(e){return new kC.BlankNode(e||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new ry.Literal(e,t)}variable(e){return new VC.Variable(e)}defaultGraph(){return jC.DefaultGraph.INSTANCE}quad(e,t,i,n){return new MC.Quad(e,t,i,n||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(ry.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}};Nu.DataFactory=Fp});var ny=y(xr=>{"use strict";var $C=xr&&xr.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),us=xr&&xr.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&$C(e,r,t)};Object.defineProperty(xr,"__esModule",{value:!0});us(wp(),xr);us(iy(),xr);us(bp(),xr);us(Tp(),xr);us(Pu(),xr);us(Ap(),xr);us(Op(),xr)});var ay=y((eL,sy)=>{var{Parser:Ji}=Q2(),{Generator:UC}=ey(),{Wildcard:BC}=_p(),{DataFactory:GC}=ny();function WC({prefixes:r,baseIRI:e,factory:t,pathOnly:i,sparqlStar:n,skipValidation:s,skipUngroupedVariableCheck:a}={}){let c={};for(let f in r??{})c[f]=r[f];let u=new Ji;return u.parse=function(){return Ji.base=e||"",Ji.prefixes=Object.create(c),Ji.factory=t||new GC,Ji.sparqlStar=!!n,Ji.pathOnly=!!i,Ji.skipValidation=!!s||!!a,Ji.prototype.parse.apply(u,arguments)},u._resetBlanks=Ji._resetBlanks,u}o(WC,"_Parser");sy.exports={Parser:WC,Generator:UC,Wildcard:BC}});var Rp=y(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.CaseWhenTransformerError=Gs.CaseWhenTransformer=void 0;var Pp=class{static{o(this,"CaseWhenTransformer")}transform(e){let t=e,i,n=0,s=100;do if(i=t,t=this.transformSinglePass(t),n++,n>s)throw new Xi("Too many nested CASE expressions (max 100 iterations)");while(t!==i);return t}transformSinglePass(e){let t=this.findCasePositions(e);if(t.length===0)return e;let i=e;for(let n=t.length-1;n>=0;n--){let s=t[n],a=this.extractCaseExpression(i,s);if(a){let c=this.convertCaseToIf(a.content);i=i.substring(0,s)+c+i.substring(s+a.length)}}return i}findCasePositions(e){let t=[],i=e.toUpperCase(),n=0;for(;n<e.length;){if(e[n]==="'"||e[n]==='"'){let s=e[n];for(n++;n<e.length&&e[n]!==s;)e[n]==="\\"&&n++,n++;n++;continue}if(i.substring(n,n+4)==="CASE"&&this.isWordBoundary(e,n,4)){t.push(n),n+=4;continue}n++}return t}extractCaseExpression(e,t){let i=1,n=t+4,s=e.toUpperCase();for(;n<e.length&&i>0;){if(e[n]==="'"||e[n]==='"'){let a=e[n];for(n++;n<e.length&&e[n]!==a;)e[n]==="\\"&&n++,n++;n++;continue}if(s.substring(n,n+4)==="CASE"&&this.isWordBoundary(e,n,4)){i++,n+=4;continue}if(s.substring(n,n+3)==="END"&&this.isWordBoundary(e,n,3)){if(i--,i===0){let a=e.substring(t,n+3);return{content:a,length:a.length}}n+=3;continue}n++}if(i>0)throw new Xi(`Unclosed CASE expression at position ${t}`);return null}isWordBoundary(e,t,i){let n=t>0?e[t-1]:"",s=t===0||!/[a-zA-Z0-9_?$]/.test(n),a=t+i<e.length?e[t+i]:"",c=t+i>=e.length||!/[a-zA-Z0-9_]/.test(a);return s&&c}convertCaseToIf(e){let t=this.extractWhenClauses(e),i=this.extractElseClause(e);if(t.length===0)throw new Xi("CASE expression must have at least one WHEN clause");let n=i!==null?i:'""';for(let s=t.length-1;s>=0;s--){let{condition:a,result:c}=t[s];n=`IF(${a}, ${c}, ${n})`}return n}extractWhenClauses(e){let t=[],i=e.replace(/^\s*CASE\s+/i,"").replace(/\s*END\s*$/i,""),n=this.findKeywordPositions(i,"WHEN"),s=this.findKeywordPositions(i,"ELSE"),a=s.length>0?s[0]:i.length;for(let c=0;c<n.length;c++){let u=n[c]+4,f=c+1<n.length?n[c+1]:a,l=i.substring(u,f).trim(),h=this.parseWhenClause(l);h&&t.push(h)}return t}findKeywordPositions(e,t){let i=[],n=e.toUpperCase(),s=0,a=0;for(;s<e.length;){let c=e[s];if(c==="'"||c==='"'){let u=c;for(s++;s<e.length&&e[s]!==u;)e[s]==="\\"&&s++,s++;s++;continue}if(c==="("){a++,s++;continue}if(c===")"){a--,s++;continue}if(a===0&&n.substring(s,s+t.length)===t&&this.isWordBoundary(e,s,t.length)){i.push(s),s+=t.length;continue}s++}return i}parseWhenClause(e){let t=this.findKeywordPositions(e,"THEN");if(t.length===0)throw new Xi(`WHEN clause missing THEN keyword: ${e.substring(0,50)}...`);let i=t[0],n=e.substring(0,i).trim(),s=e.substring(i+4).trim();if(!n)throw new Xi("WHEN clause has empty condition");if(!s)throw new Xi("WHEN clause has empty result");return{condition:n,result:s}}extractElseClause(e){let t=e.replace(/^\s*CASE\s+/i,"").replace(/\s*END\s*$/i,""),i=this.findKeywordPositions(t,"ELSE");if(i.length>0){let n=i[0];return t.substring(n+4).trim()}return null}};Gs.CaseWhenTransformer=Pp;var Xi=class extends Error{static{o(this,"CaseWhenTransformerError")}constructor(e){super(`CASE WHEN transformation error: ${e}`),this.name="CaseWhenTransformerError"}};Gs.CaseWhenTransformerError=Xi});var uy=y(Nr=>{"use strict";var HC=Nr&&Nr.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),zC=Nr&&Nr.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),KC=Nr&&Nr.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var i=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[i.length]=n);return i},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i=r(e),n=0;n<i.length;n++)i[n]!=="default"&&HC(t,e,i[n]);return zC(t,e),t}})();Object.defineProperty(Nr,"__esModule",{value:!0});Nr.SPARQLParser=Nr.SPARQLParseError=void 0;var oy=KC(ay()),cy=Rp(),Ai=class extends Error{static{o(this,"SPARQLParseError")}constructor(e,t,i,n){super(e,n?{cause:n}:void 0),this.name="SPARQLParseError",this.line=t,this.column=i}};Nr.SPARQLParseError=Ai;var Ip=class{static{o(this,"SPARQLParser")}constructor(){this.parser=new oy.Parser,this.generator=new oy.Generator,this.caseWhenTransformer=new cy.CaseWhenTransformer}parse(e){try{let t=this.caseWhenTransformer.transform(e),i=this.parser.parse(t);return this.validateQuery(i),i}catch(t){if(t instanceof cy.CaseWhenTransformerError)throw new Ai(t.message);if(t instanceof Error){let i=t.message.match(/line (\d+), column (\d+)/),n=i?parseInt(i[1],10):void 0,s=i?parseInt(i[2],10):void 0;throw new Ai(`SPARQL syntax error: ${t.message}`,n,s,t)}throw t}}toString(e){try{return this.generator.stringify(e)}catch(t){throw t instanceof Error?new Ai(`Failed to serialize SPARQL query: ${t.message}`,void 0,void 0,t):t}}getQueryType(e){if("queryType"in e&&e.type==="query")return e.queryType;throw new Ai("Query does not have a valid queryType property")}isSelectQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="SELECT"}isConstructQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="CONSTRUCT"}isAskQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="ASK"}isDescribeQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="DESCRIBE"}validateQuery(e){if(!e||typeof e!="object")throw new Ai("Invalid query: not an object");if(e.type!=="query"&&e.type!=="update")throw new Ai(`Invalid type: expected "query" or "update", got "${e.type}"`);if(e.type==="query"){let t=["SELECT","CONSTRUCT","ASK","DESCRIBE"];if(!t.includes(e.queryType))throw new Ai(`Invalid query type: expected one of ${t.join(", ")}, got "${e.queryType}"`)}}};Nr.SPARQLParser=Ip});var ly=y(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.AlgebraTranslator=Ws.AlgebraTranslatorError=void 0;var be=class extends Error{static{o(this,"AlgebraTranslatorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="AlgebraTranslatorError"}};Ws.AlgebraTranslatorError=be;var Dp=class{static{o(this,"AlgebraTranslator")}constructor(){this.aggregateCounter=0}translate(e){if(e.type!=="query")throw new be("Only query operations are supported (not updates)");if(e.queryType==="SELECT")return this.translateSelect(e);if(e.queryType==="CONSTRUCT")return this.translateConstruct(e);if(e.queryType==="ASK")return this.translateAsk(e);throw new be(`Query type ${e.queryType} not yet supported`)}translateSelect(e){let t;if(!e.where||e.where.length===0)throw new be("SELECT query must have WHERE clause");t=this.translateWhere(e.where),this.aggregateCounter=0;let i=new Map,n=this.extractAggregatesWithMapping(e.variables,i),s=this.extractGroupVariables(e.group);if((n.length>0||s.length>0)&&(t={type:"group",variables:s,aggregates:n,input:t}),e.variables&&e.variables.length>0){for(let c of e.variables){let u=c;if(u.expression&&u.variable){if(u.expression.type==="aggregate")continue;let f=this.transformExpressionWithAggregateVars(u.expression,i);t={type:"extend",variable:u.variable.value,expression:f,input:t}}}let a=e.variables.filter(c=>c.termType==="Variable"||c.variable).map(c=>c.termType==="Variable"?c.value:c.variable.value);a.length>0&&(t={type:"project",variables:a,input:t})}return e.distinct&&(t={type:"distinct",input:t}),e.reduced&&(t={type:"reduced",input:t}),e.order&&e.order.length>0&&(t={type:"orderby",comparators:e.order.map(a=>this.translateOrderComparator(a)),input:t}),(e.limit!==void 0||e.offset!==void 0)&&(t={type:"slice",limit:e.limit,offset:e.offset,input:t}),t}translateConstruct(e){let t=this.translateConstructTemplate(e.template??[]);if(!e.where||e.where.length===0)throw new be("CONSTRUCT query must have WHERE clause");let i=this.translateWhere(e.where);return{type:"construct",template:t,where:i}}translateConstructTemplate(e){return!e||!Array.isArray(e)?[]:e.map(t=>this.translateTriple(t))}translateAsk(e){return{type:"ask",where:e.where&&e.where.length>0?this.translateWhere(e.where):{type:"bgp",triples:[]}}}extractAggregatesWithMapping(e,t){if(!e)return[];let i=[];for(let n of e)!n.expression||!n.variable||(n.expression.type==="aggregate"?(i.push({variable:n.variable.value,expression:this.translateAggregateExpression(n.expression)}),t.set(n.expression,n.variable.value)):this.collectNestedAggregates(n.expression,i,t));return i}collectNestedAggregates(e,t,i){if(e){if(e.type==="aggregate"){let n=`__agg${this.aggregateCounter++}`;t.push({variable:n,expression:this.translateAggregateExpression(e)}),i.set(e,n)}else if(e.type==="operation"&&e.args)for(let n of e.args)this.collectNestedAggregates(n,t,i)}}transformExpressionWithAggregateVars(e,t){if(t.has(e))return{type:"variable",name:t.get(e)};if(e.type==="operation"&&e.args){let i=e.args.map(c=>this.transformExpressionWithAggregateVars(c,t)),n=["=","!=","<",">","<=",">="],s=["&&","||","!"],a=["+","-","*","/"];return n.includes(e.operator)?{type:"comparison",operator:e.operator,left:i[0],right:i[1]}:s.includes(e.operator)?{type:"logical",operator:e.operator,operands:i}:a.includes(e.operator)?{type:"arithmetic",operator:e.operator,left:i[0],right:i[1]}:{type:"function",function:e.operator,args:i}}return this.translateExpression(e)}extractGroupVariables(e){return e?e.filter(t=>t.expression&&t.expression.termType==="Variable").map(t=>t.expression.value):[]}translateAggregateExpression(e){return{type:"aggregate",aggregation:e.aggregation.toLowerCase(),expression:e.expression?this.translateExpression(e.expression):void 0,distinct:e.distinct||!1,separator:e.separator}}translateWhere(e){if(e.length===0)throw new be("Empty WHERE clause");let t=e.filter(a=>a.type==="filter"),i=e.filter(a=>a.type==="bind"),n=e.filter(a=>a.type!=="filter"&&a.type!=="bind"),s;n.length===0?s={type:"bgp",triples:[]}:n.length===1?s=this.translatePattern(n[0]):s=n.map(c=>this.translatePattern(c)).reduce((c,u)=>({type:"join",left:c,right:u}));for(let a of i)s=this.translateBind(a,s);for(let a of t)s={type:"filter",expression:this.translateExpression(a.expression),input:s};return s}translatePattern(e){if(!e||!e.type)throw new be("Invalid pattern: missing type");switch(e.type){case"bgp":return this.translateBGP(e);case"filter":return this.translateFilter(e);case"optional":return this.translateOptional(e);case"union":return this.translateUnion(e);case"minus":return this.translateMinus(e);case"values":return this.translateValues(e);case"group":return this.translateWhere(e.patterns);case"query":return this.translateSubquery(e);case"service":return this.translateService(e);case"graph":return this.translateGraph(e);default:throw new be(`Unsupported pattern type: ${e.type}`)}}translateBGP(e){if(!e.triples||!Array.isArray(e.triples))throw new be("BGP pattern must have triples array");return{type:"bgp",triples:e.triples.map(t=>this.translateTriple(t))}}translateTriple(e){if(!e.subject||!e.predicate||!e.object)throw new be("Triple must have subject, predicate, and object");return{subject:this.translateTripleElement(e.subject),predicate:this.translatePredicate(e.predicate),object:this.translateTripleElement(e.object)}}translatePredicate(e){return e.type==="path"?this.translatePropertyPath(e):this.translateTripleElement(e)}translatePropertyPath(e){if(!e.pathType)throw new be("Property path must have pathType");if(!e.items||!Array.isArray(e.items))throw new be("Property path must have items array");let t=e.items.map(i=>this.translatePathItem(i));switch(e.pathType){case"/":return{type:"path",pathType:"/",items:t};case"|":return{type:"path",pathType:"|",items:t};case"^":if(t.length!==1)throw new be("Inverse path must have exactly one item");return{type:"path",pathType:"^",items:[t[0]]};case"+":if(t.length!==1)throw new be("OneOrMore path must have exactly one item");return{type:"path",pathType:"+",items:[t[0]]};case"*":if(t.length!==1)throw new be("ZeroOrMore path must have exactly one item");return{type:"path",pathType:"*",items:[t[0]]};case"?":if(t.length!==1)throw new be("ZeroOrOne path must have exactly one item");return{type:"path",pathType:"?",items:[t[0]]};default:throw new be(`Unsupported property path type: ${e.pathType}`)}}translatePathItem(e){if(e.type==="path")return this.translatePropertyPath(e);if(e.termType==="NamedNode")return{type:"iri",value:e.value};throw new be(`Unsupported path item type: ${e.type||e.termType}`)}translateTripleElement(e){if(!e||!e.termType)throw new be("Triple element must have termType");switch(e.termType){case"Variable":return{type:"variable",value:e.value};case"NamedNode":return{type:"iri",value:e.value};case"Literal":return{type:"literal",value:e.value,datatype:e.datatype?.value,language:e.language};case"BlankNode":return{type:"blank",value:e.value};default:throw new be(`Unsupported term type: ${e.termType}`)}}translateFilter(e){if(!e.expression)throw new be("Filter pattern must have expression");let t=e.patterns?this.translateWhere(e.patterns):{type:"bgp",triples:[]};return{type:"filter",expression:this.translateExpression(e.expression),input:t}}translateExpression(e){if(!e)throw new be("Expression cannot be null or undefined");if(e.type==="operation")return this.translateOperationExpression(e);if(e.type==="functioncall"||e.type==="functionCall")return{type:"functionCall",function:e.function,args:e.args.map(t=>this.translateExpression(t))};if(e.termType)return this.translateTermExpression(e);throw new be(`Unsupported expression structure: ${JSON.stringify(e)}`)}translateOperationExpression(e){let t=["=","!=","<",">","<=",">="],i=["&&","||","!"],n=["+","-","*","/"];return t.includes(e.operator)?{type:"comparison",operator:e.operator,left:this.translateExpression(e.args[0]),right:this.translateExpression(e.args[1])}:i.includes(e.operator)?{type:"logical",operator:e.operator,operands:e.args.map(s=>this.translateExpression(s))}:n.includes(e.operator)?{type:"arithmetic",operator:e.operator,left:this.translateExpression(e.args[0]),right:this.translateExpression(e.args[1])}:e.operator==="exists"||e.operator==="notexists"?this.translateExistsExpression(e):e.operator==="in"||e.operator==="notin"?this.translateInExpression(e):{type:"function",function:e.operator,args:e.args.map(s=>this.translateExpression(s))}}translateExistsExpression(e){if(!e.args||e.args.length!==1)throw new be("EXISTS/NOT EXISTS must have exactly one pattern argument");let t=e.args[0],i;return t.type==="group"&&t.patterns?i=this.translateWhere(t.patterns):t.type==="bgp"?i=this.translateBGP(t):i=this.translatePattern(t),{type:"exists",negated:e.operator==="notexists",pattern:i}}translateInExpression(e){if(!e.args||e.args.length!==2)throw new be("IN/NOT IN must have exactly 2 arguments (expression and list)");let t=e.args[0],i=e.args[1];if(!Array.isArray(i))throw new be("IN/NOT IN second argument must be an array of values");return{type:"in",expression:this.translateExpression(t),list:i.map(n=>this.translateExpression(n)),negated:e.operator==="notin"}}translateTermExpression(e){if(e.termType==="Variable")return{type:"variable",name:e.value};if(e.termType==="Literal"){let t=e.value;return e.datatype&&(e.datatype.value.includes("#integer")||e.datatype.value.includes("#decimal")?t=parseFloat(e.value):e.datatype.value.includes("#boolean")&&(t=e.value==="true")),{type:"literal",value:t,datatype:e.datatype?.value}}return{type:"literal",value:String(e.value||e)}}translateOptional(e){if(!e.patterns||e.patterns.length===0)throw new be("OPTIONAL pattern must have patterns");return{type:"leftjoin",left:{type:"bgp",triples:[]},right:this.translateWhere(e.patterns),expression:e.expression?this.translateExpression(e.expression):void 0}}translateUnion(e){if(!e.patterns||e.patterns.length<2)throw new be("UNION pattern must have at least 2 patterns");let t=o(n=>n.type==="graph"?this.translateGraph(n):n.type==="service"?this.translateService(n):n.patterns&&Array.isArray(n.patterns)?this.translateWhere(n.patterns):this.translateWhere([n]),"translateBranch"),i={type:"union",left:t(e.patterns[0]),right:t(e.patterns[1])};for(let n=2;n<e.patterns.length;n++)i={type:"union",left:i,right:t(e.patterns[n])};return i}translateMinus(e){if(!e.patterns||e.patterns.length===0)throw new be("MINUS pattern must have patterns");return{type:"minus",left:{type:"bgp",triples:[]},right:this.translateWhere(e.patterns)}}translateValues(e){if(!e.values||!Array.isArray(e.values))throw new be("VALUES pattern must have values array");let t=new Set;for(let n of e.values)for(let s of Object.keys(n)){let a=s.startsWith("?")?s.slice(1):s;t.add(a)}let i=e.values.map(n=>this.translateValuesBinding(n));return{type:"values",variables:Array.from(t),bindings:i}}translateValuesBinding(e){let t={};for(let[i,n]of Object.entries(e)){let s=i.startsWith("?")?i.slice(1):i,a=n;if(a.termType==="NamedNode")t[s]={type:"iri",value:a.value};else if(a.termType==="Literal")t[s]={type:"literal",value:a.value,datatype:a.datatype?.value,language:a.language||void 0};else throw new be(`Unsupported VALUES term type: ${a.termType}`)}return t}translateBind(e,t){if(!e.variable||!e.expression)throw new be("BIND pattern must have variable and expression");return{type:"extend",variable:e.variable.value,expression:this.translateExpression(e.expression),input:t}}translateOrderComparator(e){return{expression:this.translateExpression(e.expression),descending:e.descending||!1}}translateSubquery(e){if(e.queryType!=="SELECT")throw new be(`Only SELECT subqueries are supported, got: ${e.queryType}`);return{type:"subquery",query:this.translateSelect(e)}}translateService(e){if(!e.name||e.name.termType!=="NamedNode")throw new be("SERVICE pattern must have a NamedNode endpoint");if(!e.patterns||!Array.isArray(e.patterns))throw new be("SERVICE pattern must have patterns array");let t=this.translateWhere(e.patterns);return{type:"service",endpoint:e.name.value,pattern:t,silent:e.silent||!1}}translateGraph(e){if(!e.name)throw new be("GRAPH pattern must have a name (IRI or variable)");if(!e.patterns||!Array.isArray(e.patterns))throw new be("GRAPH pattern must have patterns array");let t;if(e.name.termType==="NamedNode")t={type:"iri",value:e.name.value};else if(e.name.termType==="Variable")t={type:"variable",value:e.name.value};else throw new be(`GRAPH pattern name must be NamedNode or Variable, got: ${e.name.termType}`);let i=this.translateWhere(e.patterns);return{type:"graph",name:t,pattern:i}}};Ws.AlgebraTranslator=Dp});var kp=y(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});ku.FilterContainsOptimizer=void 0;var YC=at(),QC=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,Np=class{static{o(this,"FilterContainsOptimizer")}constructor(){this.tripleStore=null,this.lastOptimizationHints=[]}setTripleStore(e){this.tripleStore=e}getLastOptimizationHints(){return this.lastOptimizationHints}clearHints(){this.lastOptimizationHints=[]}async optimize(e){return this.clearHints(),this.optimizeRecursive(e)}optimizeSync(e,t){return this.clearHints(),this.optimizeSyncRecursive(e,t)}async optimizeRecursive(e){return e.type==="filter"?this.optimizeFilter(e):e.type==="join"?{type:"join",left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="leftjoin"?{...e,left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="union"?{type:"union",left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="minus"?{...e,left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="project"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="orderby"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="slice"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="distinct"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="reduced"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="group"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="extend"?{...e,input:await this.optimizeRecursive(e.input)}:e}optimizeSyncRecursive(e,t){return e.type==="filter"?this.optimizeFilterSync(e,t):e.type==="join"?{type:"join",left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="leftjoin"?{...e,left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="union"?{type:"union",left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="minus"?{...e,left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="project"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="orderby"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="slice"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="distinct"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="reduced"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="group"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="extend"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e}async optimizeFilter(e){let t=this.detectContainsUUIDPattern(e.expression);if(!t)return{type:"filter",expression:e.expression,input:await this.optimizeRecursive(e.input)};let i=[];return this.tripleStore&&(i=await this.findSubjectsContainingUUID(t.uuid)),this.rewriteFilter(e,t,i)}optimizeFilterSync(e,t){let i=this.detectContainsUUIDPattern(e.expression);if(!i)return{type:"filter",expression:e.expression,input:this.optimizeSyncRecursive(e.input,t)};let n=t?t.filter(s=>s.includes(i.uuid)):[];return this.rewriteFilter(e,i,n)}rewriteFilter(e,t,i){if(this.lastOptimizationHints.push({type:"uuid-index-lookup",originalPattern:`FILTER(CONTAINS(STR(?${t.variable}), "${t.uuid}"))`,suggestedRewrite:i.length===1?`VALUES ?${t.variable} { <${i[0]}> }`:i.length>1?`VALUES ?${t.variable} { ${i.map(n=>`<${n}>`).join(" ")} }`:"No matching URIs found for UUID",estimatedSpeedup:i.length>0?"O(n) \u2192 O(1)":"N/A",matchedUri:i.length===1?i[0]:void 0}),i.length===0)return{type:"filter",expression:e.expression,input:this.optimizeSyncRecursive(e.input)};if(i.length===1){let n=this.injectSubjectConstraint(e.input,t.variable,i[0]);if(n!==e.input)return n}return this.createValuesJoin(e,t,i)}detectContainsUUIDPattern(e){if(e.type==="function"||e.type==="functionCall"){let t=e;if((typeof t.function=="string"?t.function.toLowerCase():t.function?.value?.toLowerCase()??"")==="contains"&&t.args.length===2)return this.analyzeContainsArgs(t.args[0],t.args[1],e)}if(e.type==="logical"&&e.operator==="&&")for(let t of e.operands){let i=this.detectContainsUUIDPattern(t);if(i)return i}return null}analyzeContainsArgs(e,t,i){let n=null;if(e.type==="function"||e.type==="functionCall"){let s=e;if((typeof s.function=="string"?s.function.toLowerCase():s.function?.value?.toLowerCase()??"")==="str"&&s.args.length===1){let c=s.args[0];c.type==="variable"&&(n=c.name)}}if(!n&&e.type==="variable"&&(n=e.name),!n)return null;if(t.type==="literal"){let c=String(t.value).match(QC);if(c)return{variable:n,uuid:c[0].toLowerCase(),originalExpression:i}}return null}async findSubjectsContainingUUID(e){if(!this.tripleStore)return[];if(this.tripleStore.findSubjectsByUUID)return(await this.tripleStore.findSubjectsByUUID(e)).map(s=>s.value);let t=await this.tripleStore.subjects(),i=[];for(let n of t)n instanceof YC.IRI&&n.value.toLowerCase().includes(e.toLowerCase())&&i.push(n.value);return i}injectSubjectConstraint(e,t,i){if(e.type==="bgp"){let n=e.triples.map(a=>a.subject.type==="variable"&&a.subject.value===t?{...a,subject:{type:"iri",value:i}}:a);if(n.some((a,c)=>a.subject!==e.triples[c].subject))return{type:"bgp",triples:n}}if(e.type==="join"){let n=this.injectSubjectConstraint(e.left,t,i),s=this.injectSubjectConstraint(e.right,t,i);if(n!==e.left||s!==e.right)return{type:"join",left:n,right:s}}if(e.type==="filter"){let n=this.injectSubjectConstraint(e.input,t,i);if(n!==e.input)return{...e,input:n}}return e}createValuesJoin(e,t,i){return{type:"join",left:{type:"values",variables:[t.variable],bindings:i.map(a=>({[t.variable]:{type:"iri",value:a}}))},right:this.optimizeSyncRecursive(e.input)}}analyzeQuery(e){let t=[];return this.analyzeRecursive(e,t),t}analyzeRecursive(e,t){if(e.type==="filter"){let i=this.detectContainsUUIDPattern(e.expression);i&&t.push({type:"uuid-index-lookup",originalPattern:`FILTER(CONTAINS(STR(?${i.variable}), "${i.uuid}"))`,suggestedRewrite:`Use --optimize flag or rewrite as VALUES ?${i.variable} { <uri-containing-uuid> }`,estimatedSpeedup:"O(n) \u2192 O(1) with UUID index lookup"}),this.analyzeRecursive(e.input,t);return}e.type==="join"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="leftjoin"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="union"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="minus"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="project"?this.analyzeRecursive(e.input,t):e.type==="orderby"?this.analyzeRecursive(e.input,t):e.type==="slice"?this.analyzeRecursive(e.input,t):e.type==="distinct"?this.analyzeRecursive(e.input,t):e.type==="reduced"?this.analyzeRecursive(e.input,t):e.type==="group"?this.analyzeRecursive(e.input,t):e.type==="extend"&&this.analyzeRecursive(e.input,t)}};ku.FilterContainsOptimizer=Np});var fy=y(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});ju.AlgebraOptimizer=void 0;var JC=kp(),jp=class{static{o(this,"AlgebraOptimizer")}constructor(){this.stats=new Map,this.tripleStore=null,this.filterContainsOptimizer=new JC.FilterContainsOptimizer}setTripleStore(e){this.tripleStore=e,this.filterContainsOptimizer.setTripleStore(e)}getOptimizationHints(){return this.filterContainsOptimizer.getLastOptimizationHints()}analyzeQuery(e){return this.filterContainsOptimizer.analyzeQuery(e)}optimize(e){let t=e;return t=this.eliminateEmptyBGPInFilterJoin(t),t=this.filterPushDown(t),t=this.joinReordering(t),t}async optimizeAsync(e){let t=e;return t=this.eliminateEmptyBGPInFilterJoin(t),this.tripleStore&&(t=await this.filterContainsOptimizer.optimize(t)),t=this.filterPushDown(t),t=this.joinReordering(t),t}optimizeWithSubjects(e,t){let i=e;return i=this.eliminateEmptyBGPInFilterJoin(i),i=this.filterContainsOptimizer.optimizeSync(i,t),i=this.filterPushDown(i),i=this.joinReordering(i),i}eliminateEmptyBGPInFilterJoin(e){if(e.type==="join"){if(e.left.type==="filter"){let t=e.left;if(t.input.type==="bgp"&&t.input.triples.length===0)return{type:"filter",expression:t.expression,input:this.eliminateEmptyBGPInFilterJoin(e.right)}}if(e.right.type==="filter"){let t=e.right;if(t.input.type==="bgp"&&t.input.triples.length===0)return{type:"filter",expression:t.expression,input:this.eliminateEmptyBGPInFilterJoin(e.left)}}return{type:"join",left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}}return e.type==="filter"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="leftjoin"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="union"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="minus"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="project"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="orderby"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="slice"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="distinct"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e}filterPushDown(e){return e.type==="filter"?this.pushDownFilter(e):e.type==="join"?{type:"join",left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="leftjoin"?{...e,left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="union"?{type:"union",left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="minus"?{...e,left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="project"?{...e,input:this.filterPushDown(e.input)}:e.type==="orderby"?{...e,input:this.filterPushDown(e.input)}:e.type==="slice"?{...e,input:this.filterPushDown(e.input)}:e.type==="distinct"?{...e,input:this.filterPushDown(e.input)}:e}pushDownFilter(e){let t=e.input;if(t.type==="join"){let i=this.getFilterVariables(e.expression),n=this.getOperationVariables(t.left),s=this.getOperationVariables(t.right),a=i.every(u=>n.has(u)),c=i.every(u=>s.has(u));return a&&!c?{type:"join",left:{type:"filter",expression:e.expression,input:this.filterPushDown(t.left)},right:this.filterPushDown(t.right)}:c&&!a?{type:"join",left:this.filterPushDown(t.left),right:{type:"filter",expression:e.expression,input:this.filterPushDown(t.right)}}:{type:"filter",expression:e.expression,input:{type:"join",left:this.filterPushDown(t.left),right:this.filterPushDown(t.right)}}}return t.type==="union"?{type:"union",left:{type:"filter",expression:e.expression,input:this.filterPushDown(t.left)},right:{type:"filter",expression:e.expression,input:this.filterPushDown(t.right)}}:{type:"filter",expression:e.expression,input:this.filterPushDown(t)}}getFilterVariables(e){let t=[];if(e.type==="variable")t.push(e.name);else if(e.type==="comparison")t.push(...this.getFilterVariables(e.left)),t.push(...this.getFilterVariables(e.right));else if(e.type==="logical")for(let i of e.operands)t.push(...this.getFilterVariables(i));else if(e.type==="function")for(let i of e.args)t.push(...this.getFilterVariables(i));return Array.from(new Set(t))}getOperationVariables(e){let t=new Set;if(e.type==="bgp")for(let i of e.triples)i.subject.type==="variable"&&t.add(i.subject.value),i.predicate.type==="variable"&&t.add(i.predicate.value),i.object.type==="variable"&&t.add(i.object.value);else if(e.type==="join"){let i=this.getOperationVariables(e.left),n=this.getOperationVariables(e.right);return new Set([...i,...n])}else{if(e.type==="filter")return this.getOperationVariables(e.input);if(e.type==="leftjoin"){let i=this.getOperationVariables(e.left),n=this.getOperationVariables(e.right);return new Set([...i,...n])}else if(e.type==="union"){let i=this.getOperationVariables(e.left),n=this.getOperationVariables(e.right);return new Set([...i,...n])}else{if(e.type==="minus")return this.getOperationVariables(e.left);if(e.type==="project")return new Set(e.variables)}}return t}joinReordering(e){return e.type==="join"?this.reorderJoin(e):e.type==="filter"?{...e,input:this.joinReordering(e.input)}:e.type==="leftjoin"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="union"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="minus"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="project"?{...e,input:this.joinReordering(e.input)}:e.type==="orderby"?{...e,input:this.joinReordering(e.input)}:e.type==="slice"?{...e,input:this.joinReordering(e.input)}:e.type==="distinct"?{...e,input:this.joinReordering(e.input)}:e}reorderJoin(e){let t=this.estimateCost(e.left);return this.estimateCost(e.right)<t?{type:"join",left:this.joinReordering(e.right),right:this.joinReordering(e.left)}:{type:"join",left:this.joinReordering(e.left),right:this.joinReordering(e.right)}}estimateCost(e){if(e.type==="bgp"){let t=e.triples.length*100;for(let i of e.triples)i.subject.type==="variable"&&(t+=10),i.predicate.type==="variable"&&(t+=20),i.object.type==="variable"&&(t+=10);return t}return e.type==="filter"?this.estimateCost(e.input)*.3:e.type==="join"?this.estimateCost(e.left)*this.estimateCost(e.right):e.type==="leftjoin"?this.estimateCost(e.left)+this.estimateCost(e.right)*.5:e.type==="union"?this.estimateCost(e.left)+this.estimateCost(e.right):e.type==="minus"?this.estimateCost(e.left)+this.estimateCost(e.right)*.3:100}setStatistics(e,t){this.stats.set(e,t)}getStatistics(e){return this.stats.get(e)}};ju.AlgebraOptimizer=jp});var hy=y(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.AlgebraSerializer=void 0;var Lp=class{static{o(this,"AlgebraSerializer")}toString(e,t=0){let i="  ".repeat(t);switch(e.type){case"bgp":return`${i}BGP [
${e.triples.map(f=>`${i}  ${this.tripleToString(f)}`).join(`
`)}
${i}]`;case"filter":return`${i}Filter(
${i}  ${this.expressionToString(e.expression)}
${this.toString(e.input,t+1)}
${i})`;case"join":return`${i}Join(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"leftjoin":let n=e.expression?` ${this.expressionToString(e.expression)}`:"";return`${i}LeftJoin(${n}
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"union":return`${i}Union(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"minus":return`${i}Minus(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"project":return`${i}Project [${e.variables.map(f=>`?${f}`).join(", ")}](
${this.toString(e.input,t+1)}
${i})`;case"orderby":let s=e.comparators.map(f=>`${this.expressionToString(f.expression)} ${f.descending?"DESC":"ASC"}`).join(", ");return`${i}OrderBy [${s}](
${this.toString(e.input,t+1)}
${i})`;case"slice":let a=[];return e.offset!==void 0&&a.push(`OFFSET ${e.offset}`),e.limit!==void 0&&a.push(`LIMIT ${e.limit}`),`${i}Slice [${a.join(", ")}](
${this.toString(e.input,t+1)}
${i})`;case"distinct":return`${i}Distinct(
${this.toString(e.input,t+1)}
${i})`;case"group":let c=e.variables.length>0?`[${e.variables.map(f=>`?${f}`).join(", ")}]`:"[]",u=e.aggregates.length>0?e.aggregates.map(f=>`?${f.variable} = ${f.expression.aggregation}(${f.expression.distinct?"DISTINCT ":""}${f.expression.expression?this.expressionToString(f.expression.expression):"*"})`).join(", "):"";return`${i}Group ${c}${u?` [${u}]`:""}(
${this.toString(e.input,t+1)}
${i})`;case"extend":return`${i}Extend (?${e.variable} = ${this.expressionToString(e.expression)})(
${this.toString(e.input,t+1)}
${i})`;case"subquery":return`${i}Subquery(
${this.toString(e.query,t+1)}
${i})`;default:return`${i}Unknown(${e.type})`}}tripleToString(e){return`${this.elementToString(e.subject)} ${this.predicateToString(e.predicate)} ${this.elementToString(e.object)}`}predicateToString(e){return this.isPropertyPath(e)?this.propertyPathToString(e):this.elementToString(e)}isPropertyPath(e){return e.type==="path"}propertyPathToString(e){let t=e.items.map(i=>i.type==="path"?`(${this.propertyPathToString(i)})`:`<${i.value}>`);switch(e.pathType){case"/":return t.join("/");case"|":return t.join("|");case"^":return`^${t[0]}`;case"+":return`${t[0]}+`;case"*":return`${t[0]}*`;case"?":return`${t[0]}?`}}elementToString(e){switch(e.type){case"variable":return`?${e.value}`;case"iri":return`<${e.value}>`;case"literal":let t=`"${e.value}"`;return e.language&&(t+=`@${e.language}`),e.datatype&&(t+=`^^<${e.datatype}>`),t;case"blank":return`_:${e.value}`;default:return String(e)}}expressionToString(e){switch(e.type){case"variable":return`?${e.name}`;case"literal":return typeof e.value=="string"?`"${e.value}"`:String(e.value);case"comparison":return`(${this.expressionToString(e.left)} ${e.operator} ${this.expressionToString(e.right)})`;case"logical":return e.operator==="!"?`!(${this.expressionToString(e.operands[0])})`:`(${e.operands.map(t=>this.expressionToString(t)).join(` ${e.operator} `)})`;case"arithmetic":return`(${this.expressionToString(e.left)} ${e.operator} ${this.expressionToString(e.right)})`;case"function":return`${e.function}(${e.args.map(t=>this.expressionToString(t)).join(", ")})`;case"exists":return`${e.negated?"NOT EXISTS":"EXISTS"} { ${this.toString(e.pattern,0)} }`;default:return"unknown"}}toJSON(e){return JSON.stringify(e,null,2)}};Lu.AlgebraSerializer=Lp});var Zi=y(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.SolutionMapping=void 0;var dy=Pt(),py=at(),my=Sr(),Mp=class r{static{o(this,"SolutionMapping")}constructor(e){this.bindings=e?new Map(e):new Map}get(e){return this.bindings.get(e)}set(e,t){this.bindings.set(e,t)}has(e){return this.bindings.has(e)}variables(){return Array.from(this.bindings.keys())}getBindings(){return new Map(this.bindings)}isCompatibleWith(e){for(let[t,i]of this.bindings.entries()){let n=e.get(t);if(n!==void 0&&!this.areEqual(i,n))return!1}return!0}merge(e){if(!this.isCompatibleWith(e))return null;let t=new r(this.bindings);for(let[i,n]of e.getBindings().entries())t.set(i,n);return t}clone(){return new r(this.bindings)}areEqual(e,t){return e instanceof dy.Literal&&t instanceof dy.Literal?e.equals(t):e instanceof py.IRI&&t instanceof py.IRI?e.value===t.value:e instanceof my.BlankNode&&t instanceof my.BlankNode?e.id===t.id:!1}toJSON(){let e={};for(let[t,i]of this.bindings.entries())e[t]=i.toString();return e}size(){return this.bindings.size}};Mu.SolutionMapping=Mp});var yy=y(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.PropertyPathExecutor=Hs.PropertyPathExecutorError=void 0;var XC=Zi(),Vu=at(),gy=Sr(),so=class extends Error{static{o(this,"PropertyPathExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="PropertyPathExecutorError"}};Hs.PropertyPathExecutorError=so;var Vp=class{static{o(this,"PropertyPathExecutor")}constructor(e){this.tripleStore=e,this.MAX_DEPTH=100}async*execute(e,t,i){let n=await this.resolveElement(e),s=this.isVariable(i)?null:await this.resolveElement(i);for(let a of n){let c=await this.evaluatePath(a,t,s);for(let u of c){let f=new XC.SolutionMapping;this.isVariable(e)&&f.set(e.value,a),this.isVariable(i)&&f.set(i.value,u),yield f}}}async*executeWithBindings(e,t){if(!this.isPropertyPath(e.predicate))throw new so("Predicate is not a property path");let i=this.instantiateElement(e.subject,t),n=this.instantiateElement(e.object,t);for await(let s of this.execute(i,e.predicate,n)){let a=t.merge(s);a!==null&&(yield a)}}async evaluatePath(e,t,i){switch(t.pathType){case"/":return this.evaluateSequencePath(e,t.items,i);case"|":return this.evaluateAlternativePath(e,t.items,i);case"^":return this.evaluateInversePath(e,t.items[0],i);case"+":return this.evaluateOneOrMorePath(e,t.items[0],i);case"*":return this.evaluateZeroOrMorePath(e,t.items[0],i);case"?":return this.evaluateZeroOrOnePath(e,t.items[0],i)}}async evaluateSequencePath(e,t,i){let n=new Set([e]);for(let s=0;s<t.length;s++){let a=t[s],c=s===t.length-1,u=new Set;for(let f of n){let l=await this.evaluatePathItem(f,a,c?i:null);for(let h of l)u.add(h)}if(n=u,n.size===0)break}return n}async evaluateAlternativePath(e,t,i){let n=new Set;for(let s of t){let a=await this.evaluatePathItem(e,s,i);for(let c of a)n.add(c)}return n}async evaluateInversePath(e,t,i){if(t.type==="iri"){let n=new Vu.IRI(t.value),s=await this.tripleStore.match(void 0,n,e),a=new Set;for(let c of s)(i===null||this.nodeInSet(c.subject,i))&&a.add(c.subject);return a}else return this.evaluatePath(e,this.invertPath(t),i)}async evaluateOneOrMorePath(e,t,i){let n=new Set,s=new Set,a=[{node:e,depth:0}];for(;a.length>0;){let{node:c,depth:u}=a.shift();if(u>=this.MAX_DEPTH)continue;let f=await this.evaluatePathItem(c,t,null);for(let l of f){let h=this.nodeToKey(l);(i===null||this.nodeInSet(l,i))&&s.add(l),n.has(h)||(n.add(h),a.push({node:l,depth:u+1}))}}return s}async evaluateZeroOrMorePath(e,t,i){let n=await this.evaluateOneOrMorePath(e,t,i);return(i===null||this.nodeInSet(e,i))&&n.add(e),n}async evaluateZeroOrOnePath(e,t,i){let n=new Set;(i===null||this.nodeInSet(e,i))&&n.add(e);let s=await this.evaluatePathItem(e,t,i);for(let a of s)n.add(a);return n}async evaluatePathItem(e,t,i){if(t.type==="iri"){let n=new Vu.IRI(t.value),s=await this.tripleStore.match(e,n,void 0),a=new Set;for(let c of s)(i===null||this.nodeInSet(c.object,i))&&a.add(c.object);return a}else return this.evaluatePath(e,t,i)}invertPath(e){switch(e.pathType){case"^":return e.items[0];case"/":return{type:"path",pathType:"/",items:[...e.items].reverse().map(i=>i.type==="iri"?{type:"path",pathType:"^",items:[i]}:this.invertPath(i))};case"|":return{type:"path",pathType:"|",items:e.items.map(i=>i.type==="iri"?{type:"path",pathType:"^",items:[i]}:this.invertPath(i))};case"+":case"*":case"?":let t=e.items[0].type==="iri"?{type:"path",pathType:"^",items:[e.items[0]]}:this.invertPath(e.items[0]);return{type:"path",pathType:e.pathType,items:[t]}}}async resolveElement(e){if(this.isVariable(e)){let i=new Set,n=await this.tripleStore.match(void 0,void 0,void 0);for(let s of n)i.add(s.subject),i.add(s.object);return i}let t=new Set;switch(e.type){case"iri":t.add(new Vu.IRI(e.value));break;case"blank":t.add(new gy.BlankNode(e.value));break;default:throw new so(`Unsupported element type in subject/object position: ${e.type}`)}return t}instantiateElement(e,t){if(this.isVariable(e)){let i=t.get(e.value);if(i){if(i instanceof Vu.IRI)return{type:"iri",value:i.value};if(i instanceof gy.BlankNode)return{type:"blank",value:i.id}}}return e}isVariable(e){return e.type==="variable"}isPropertyPath(e){return e.type==="path"}nodeToKey(e){return e.toString()}nodeInSet(e,t){let i=this.nodeToKey(e);for(let n of t)if(this.nodeToKey(n)===i)return!0;return!1}};Hs.PropertyPathExecutor=Vp});var Up=y(zs=>{"use strict";Object.defineProperty(zs,"__esModule",{value:!0});zs.BGPExecutor=zs.BGPExecutorError=void 0;var qu=Zi(),ao=at(),vy=Pt(),qp=Sr(),ZC=yy(),Zt=class extends Error{static{o(this,"BGPExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="BGPExecutorError"}};zs.BGPExecutorError=Zt;var $p=class{static{o(this,"BGPExecutor")}constructor(e){this.tripleStore=e,this.propertyPathExecutor=new ZC.PropertyPathExecutor(e)}async*execute(e){if(e.triples.length===0){yield new qu.SolutionMapping;return}let t=this.matchTriplePattern(e.triples[0]);for(let i=1;i<e.triples.length;i++)t=this.joinWithPattern(t,e.triples[i]);for await(let i of t)yield i}async executeAll(e){let t=[];for await(let i of this.execute(e))t.push(i);return t}async*executeInGraph(e,t){if(e.triples.length===0){yield new qu.SolutionMapping;return}let i=this.matchTriplePatternInGraph(e.triples[0],t);for(let n=1;n<e.triples.length;n++)i=this.joinWithPatternInGraph(i,e.triples[n],t);for await(let n of i)yield n}async*matchTriplePatternInGraph(e,t){if(this.isPropertyPath(e.predicate))throw new Zt("Property paths within named graphs are not yet supported");let i=e.predicate,n=this.isVariable(e.subject)?void 0:this.toRDFTermAsSubject(e.subject),s=this.isVariable(i)?void 0:this.toRDFTermAsPredicate(i),a=this.isVariable(e.object)?void 0:this.toRDFTerm(e.object);if(!this.tripleStore.matchInGraph)throw new Zt("Triple store does not support named graph operations");let c=await this.tripleStore.matchInGraph(n,s,a,t);for(let u of c){let f=new qu.SolutionMapping;this.isVariable(e.subject)&&f.set(e.subject.value,u.subject),this.isVariable(i)&&f.set(i.value,u.predicate),this.isVariable(e.object)&&f.set(e.object.value,u.object),yield f}}async*joinWithPatternInGraph(e,t,i){let n=[];for await(let s of e)n.push(s);for(let s of n){let a=this.instantiatePattern(t,s);for await(let c of this.matchTriplePatternInGraph(a,i)){let u=s.merge(c);u!==null&&(yield u)}}}async*matchTriplePattern(e){if(this.isPropertyPath(e.predicate)){yield*this.propertyPathExecutor.execute(e.subject,e.predicate,e.object);return}let t=e.predicate,i=this.isVariable(e.subject)?void 0:this.toRDFTermAsSubject(e.subject),n=this.isVariable(t)?void 0:this.toRDFTermAsPredicate(t),s=this.isVariable(e.object)?void 0:this.toRDFTerm(e.object),a=await this.tripleStore.match(i,n,s);for(let c of a){let u=new qu.SolutionMapping;this.isVariable(e.subject)&&u.set(e.subject.value,c.subject),this.isVariable(t)&&u.set(t.value,c.predicate),this.isVariable(e.object)&&u.set(e.object.value,c.object),yield u}}isPropertyPath(e){return e.type==="path"}async*joinWithPattern(e,t){let i=[];for await(let n of e)i.push(n);for(let n of i){let s=this.instantiatePattern(t,n);for await(let a of this.matchTriplePattern(s)){let c=n.merge(a);c!==null&&(yield c)}}}instantiatePattern(e,t){let i=this.isPropertyPath(e.predicate)?e.predicate:this.instantiateElement(e.predicate,t);return{subject:this.instantiateElement(e.subject,t),predicate:i,object:this.instantiateElement(e.object,t)}}instantiateElement(e,t){if(this.isVariable(e)){let i=t.get(e.value);if(i)return this.toAlgebraElement(i)}return e}isVariable(e){return e.type==="variable"}toRDFTermAsSubject(e){switch(e.type){case"iri":return new ao.IRI(e.value);case"blank":return new qp.BlankNode(e.value);case"literal":throw new Zt("Literals cannot appear in subject position");case"variable":throw new Zt(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Zt(`Unknown element type: ${e.type}`)}}toRDFTermAsPredicate(e){switch(e.type){case"iri":return new ao.IRI(e.value);case"literal":throw new Zt("Literals cannot appear in predicate position");case"blank":throw new Zt("Blank nodes cannot appear in predicate position");case"variable":throw new Zt(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Zt(`Unknown element type: ${e.type}`)}}toRDFTerm(e){switch(e.type){case"iri":return new ao.IRI(e.value);case"literal":return new vy.Literal(e.value,e.datatype?new ao.IRI(e.datatype):void 0,e.language);case"blank":return new qp.BlankNode(e.value);case"variable":throw new Zt(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Zt(`Unknown element type: ${e.type}`)}}toAlgebraElement(e){if(e instanceof ao.IRI)return{type:"iri",value:e.value};if(e instanceof vy.Literal)return{type:"literal",value:e.value,datatype:e.datatype?.value,language:e.language};if(e instanceof qp.BlankNode)return{type:"blank",value:e.id};throw new Zt(`Unknown RDF term type: ${e.constructor?.name||"unknown"}`)}};zs.BGPExecutor=$p});var Gp=y($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0});$u.BuiltInFunctions=void 0;var er=at(),dt=Pt(),en=Sr(),_y=Dr(),Bp=class{static{o(this,"BuiltInFunctions")}static str(e){if(e===void 0)throw new Error("STR: argument is undefined");return e instanceof er.IRI||e instanceof dt.Literal?e.value:e instanceof en.BlankNode?e.id:String(e)}static lang(e){if(e===void 0)throw new Error("LANG: argument is undefined");return e instanceof dt.Literal&&e.language?e.language:""}static langMatches(e,t){let i=e.toLowerCase(),n=t.toLowerCase();return n==="*"?i!=="":i===""?n==="":i===n?!0:i.startsWith(n+"-")}static datatype(e){if(e===void 0)throw new Error("DATATYPE: argument is undefined");if(e instanceof dt.Literal)return e.datatype?e.datatype:e.language?new er.IRI("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"):new er.IRI("http://www.w3.org/2001/XMLSchema#string");throw new Error("DATATYPE: argument must be a literal")}static bound(e){return e!==void 0}static isIRI(e){return e===void 0?!1:e instanceof er.IRI}static isBlank(e){return e===void 0?!1:e instanceof en.BlankNode}static isLiteral(e){return e===void 0?!1:e instanceof dt.Literal}static isNumeric(e){if(e===void 0||!(e instanceof dt.Literal))return!1;let t=e.datatype?.value;return t?["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float","http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedShort","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#positiveInteger"].includes(t):!1}static regex(e,t,i){try{return new RegExp(t,i).test(e)}catch(n){throw new Error(`REGEX: invalid pattern '${t}': ${n.message}`)}}static compare(e,t,i){let n=this.toComparableValue(e),s=this.toComparableValue(t);switch(i){case"=":return n===s;case"!=":return n!==s;case"<":return n<s;case">":return n>s;case"<=":return n<=s;case">=":return n>=s;default:throw new Error(`Unknown comparison operator: ${i}`)}}static toComparableValue(e){if(typeof e=="string"||typeof e=="number")return e;if(e instanceof dt.Literal){let t=e.datatype?.value;if(t?.includes("#integer")||t?.includes("#decimal")||t?.includes("#double")){let i=parseFloat(e.value);if(!isNaN(i))return i}return e.value}return e instanceof er.IRI?e.value:e instanceof en.BlankNode?e.id:String(e)}static contains(e,t){return e.includes(t)}static strStarts(e,t){return e.startsWith(t)}static strEnds(e,t){return e.endsWith(t)}static strlen(e){return e.length}static ucase(e){return e.toUpperCase()}static lcase(e){return e.toLowerCase()}static substr(e,t,i){let n=t-1;if(n<0){if(i!==void 0){let s=i+n;return s<=0?"":e.substring(0,s)}return e}return i!==void 0?e.substring(n,n+i):e.substring(n)}static strBefore(e,t){if(t==="")return"";let i=e.indexOf(t);return i===-1?"":e.substring(0,i)}static strAfter(e,t){if(t==="")return e;let i=e.indexOf(t);return i===-1?"":e.substring(i+t.length)}static concat(...e){return e.join("")}static replace(e,t,i,n){try{let s=new RegExp(t,n||"g");return e.replace(s,i)}catch(s){throw new Error(`REPLACE: invalid pattern '${t}': ${s.message}`)}}static parseDate(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`PARSEDATE: invalid date string '${e}'`);return t.getTime()}static dateBefore(e,t){let i=this.parseDate(e),n=this.parseDate(t);return i<n}static dateAfter(e,t){let i=this.parseDate(e),n=this.parseDate(t);return i>n}static dateInRange(e,t,i){let n=this.parseDate(e),s=this.parseDate(t),a=this.parseDate(i);return n>=s&&n<=a}static dateDiffMinutes(e,t){let i=this.parseDate(e),n=this.parseDate(t),s=Math.abs(n-i);return Math.round(s/(1e3*60))}static dateDiffHours(e,t){let i=this.parseDate(e),n=this.parseDate(t),s=Math.abs(n-i);return Math.round(s/(1e3*60*60)*100)/100}static logicalAnd(e){return e.every(t=>t===!0)}static logicalOr(e){return e.some(t=>t===!0)}static logicalNot(e){return!e}static year(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`YEAR: invalid date string '${e}'`);return t.getFullYear()}static month(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`MONTH: invalid date string '${e}'`);return t.getMonth()+1}static day(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`DAY: invalid date string '${e}'`);return t.getDate()}static hours(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`HOURS: invalid date string '${e}'`);return t.getHours()}static minutes(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`MINUTES: invalid date string '${e}'`);return t.getMinutes()}static seconds(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`SECONDS: invalid date string '${e}'`);return t.getSeconds()+t.getMilliseconds()/1e3}static timezone(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`TIMEZONE: invalid date string '${e}'`);if(e.endsWith("Z"))return"PT0S";let i=e.match(/([+-]\d{2}):?(\d{2})$/);if(i){let u=parseInt(i[1],10),f=parseInt(i[2],10),l=u>=0?"":"-",h=Math.abs(u);return f===0?`${l}PT${h}H`:`${l}PT${h}H${f}M`}let n=-t.getTimezoneOffset(),s=Math.floor(Math.abs(n)/60),a=Math.abs(n)%60,c=n>=0?"":"-";return a===0?`${c}PT${s}H`:`${c}PT${s}H${a}M`}static now(){return new Date().toISOString()}static msToMinutes(e){return Math.round(e/(1e3*60))}static msToHours(e){return Math.round(e/(1e3*60*60)*100)/100}static msToSeconds(e){return Math.round(e/1e3)}static abs(e){return Math.abs(e)}static round(e){return Math.round(e)}static ceil(e){return Math.ceil(e)}static floor(e){return Math.floor(e)}static rand(){return Math.random()}static coalesce(e){for(let t of e)if(t!=null)return t}static if(e,t,i){return e?t:i}static xsdDateTime(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`xsd:dateTime: invalid date string '${e}'`);return new dt.Literal(t.toISOString(),new er.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}static xsdInteger(e){let t=parseInt(e,10);if(isNaN(t))throw new Error(`xsd:integer: cannot convert '${e}' to integer`);return new dt.Literal(String(t),new er.IRI("http://www.w3.org/2001/XMLSchema#integer"))}static xsdDecimal(e){let t=parseFloat(e);if(isNaN(t))throw new Error(`xsd:decimal: cannot convert '${e}' to decimal`);return new dt.Literal(String(t),new er.IRI("http://www.w3.org/2001/XMLSchema#decimal"))}static encodeForUri(e){return encodeURIComponent(e)}static md5(e){return require("crypto").createHash("md5").update(e).digest("hex")}static sha1(e){return require("crypto").createHash("sha1").update(e).digest("hex")}static sha256(e){return require("crypto").createHash("sha256").update(e).digest("hex")}static sha384(e){return require("crypto").createHash("sha384").update(e).digest("hex")}static sha512(e){return require("crypto").createHash("sha512").update(e).digest("hex")}static sameTerm(e,t){if(e===void 0&&t===void 0)return!0;if(e===void 0||t===void 0||e.constructor!==t.constructor)return!1;if(e instanceof er.IRI&&t instanceof er.IRI)return e.value===t.value;if(e instanceof en.BlankNode&&t instanceof en.BlankNode)return e.id===t.id;if(e instanceof dt.Literal&&t instanceof dt.Literal){if(e.value!==t.value||e.language!==t.language)return!1;let i=e.datatype?.value,n=t.datatype?.value;return i===n}return!1}static iri(e){if(e===void 0)throw new Error("IRI: argument is undefined");if(e instanceof er.IRI)return e;if(e instanceof dt.Literal)return new er.IRI(e.value);throw e instanceof en.BlankNode?new Error("IRI: cannot convert blank node to IRI"):new Error("IRI: unsupported term type")}static uri(e){return this.iri(e)}static bnode(e){if(e===void 0){let t=`b${Math.random().toString(36).substring(2,11)}`;return new en.BlankNode(t)}if(e instanceof dt.Literal)return new en.BlankNode(e.value);if(e instanceof en.BlankNode)return e;throw new Error("BNODE: argument must be a string literal or omitted")}static strdt(e,t){if(e===void 0)throw new Error("STRDT: lexical form is undefined");if(t===void 0)throw new Error("STRDT: datatype IRI is undefined");let i;if(e instanceof dt.Literal){if(e.language)throw new Error("STRDT: lexical form must not have a language tag");i=e.value}else if(typeof e=="string")i=e;else throw new Error("STRDT: lexical form must be a string literal");let n;if(t instanceof er.IRI)n=t;else if(t instanceof dt.Literal)n=new er.IRI(t.value);else throw new Error("STRDT: datatype must be an IRI");return new dt.Literal(i,n)}static strlang(e,t){if(e===void 0)throw new Error("STRLANG: lexical form is undefined");if(t===void 0)throw new Error("STRLANG: language tag is undefined");let i;if(e instanceof dt.Literal){if(e.language)throw new Error("STRLANG: lexical form must not already have a language tag");i=e.value}else if(typeof e=="string")i=e;else throw new Error("STRLANG: lexical form must be a string literal");let n;if(t instanceof dt.Literal)n=t.value;else if(typeof t=="string")n=t;else throw new Error("STRLANG: language tag must be a string literal");if(n==="")throw new Error("STRLANG: language tag cannot be empty");return new dt.Literal(i,void 0,n)}static uuid(){let e=(0,_y.v4)();return new er.IRI(`urn:uuid:${e}`)}static struuid(){let e=(0,_y.v4)();return new dt.Literal(e)}};$u.BuiltInFunctions=Bp});var Bu=y(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.FilterExecutor=Ks.FilterExecutorError=void 0;var U=Gp(),Uu=Pt(),wt=class extends Error{static{o(this,"FilterExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="FilterExecutorError"}};Ks.FilterExecutorError=wt;var Wp=class{static{o(this,"FilterExecutor")}constructor(){this.existsEvaluator=null,this.tripleStore=null,this.uuidCache=new Map}setExistsEvaluator(e){this.existsEvaluator=e}setTripleStore(e){this.tripleStore=e,this.uuidCache.clear()}async*execute(e,t){let i=this.expressionContainsExists(e.expression);for await(let n of t)try{let s;i?s=await this.evaluateExpressionAsync(e.expression,n):s=this.evaluateExpression(e.expression,n),s===!0&&(yield n)}catch{continue}}expressionContainsExists(e){if(e.type==="exists")return!0;if(e.type==="logical")return e.operands.some(t=>this.expressionContainsExists(t));if(e.type==="comparison")return this.expressionContainsExists(e.left)||this.expressionContainsExists(e.right);if(e.type==="in"){let t=e;return this.expressionContainsExists(t.expression)||t.list.some(i=>this.expressionContainsExists(i))}return!1}async executeAll(e,t){let i=[];async function*n(){for(let s of t)yield s}o(n,"generator");for await(let s of this.execute(e,n()))i.push(s);return i}evaluateExpression(e,t){let i=e;if(i.termType)switch(i.termType){case"Variable":return t.get(i.value);case"Literal":return i.value;case"NamedNode":return i.value;default:throw new wt(`Unsupported termType: ${i.termType}`)}switch(e.type){case"comparison":return this.evaluateComparison(e,t);case"logical":return this.evaluateLogical(e,t);case"arithmetic":return this.evaluateArithmetic(e,t);case"function":case"functionCall":return this.evaluateFunction(e,t);case"variable":return t.get(e.name);case"literal":return e.value;case"in":return this.evaluateIn(e,t);case"exists":throw new wt("EXISTS expressions require async evaluation. Use evaluateExpressionAsync instead.");default:throw new wt(`Unsupported expression type: ${e.type}, expr.termType=${i.termType}`)}}async evaluateExpressionAsync(e,t){return e.type==="exists"?this.evaluateExists(e,t):e.type==="logical"?this.evaluateLogicalAsync(e,t):this.evaluateExpression(e,t)}async evaluateExists(e,t){if(!this.existsEvaluator)throw new wt("EXISTS evaluator not set. Call setExistsEvaluator before evaluating EXISTS expressions.");let i=await this.existsEvaluator(e.pattern,t);return e.negated?!i:i}async evaluateLogicalAsync(e,t){if(e.operator==="!"){let n=await this.evaluateExpressionAsync(e.operands[0],t);return U.BuiltInFunctions.logicalNot(n)}let i=[];for(let n of e.operands){let s=await this.evaluateExpressionAsync(n,t);i.push(s)}if(e.operator==="&&")return U.BuiltInFunctions.logicalAnd(i);if(e.operator==="||")return U.BuiltInFunctions.logicalOr(i);throw new wt(`Unknown logical operator: ${e.operator}`)}evaluateComparison(e,t){let i=this.evaluateExpression(e.left,t),n=this.evaluateExpression(e.right,t);return U.BuiltInFunctions.compare(i,n,e.operator)}evaluateLogical(e,t){if(e.operator==="!"){let n=this.evaluateExpression(e.operands[0],t);return U.BuiltInFunctions.logicalNot(n)}let i=e.operands.map(n=>this.evaluateExpression(n,t));if(e.operator==="&&")return U.BuiltInFunctions.logicalAnd(i);if(e.operator==="||")return U.BuiltInFunctions.logicalOr(i);throw new wt(`Unknown logical operator: ${e.operator}`)}evaluateIn(e,t){let i=this.evaluateExpression(e.expression,t),n=e.list.some(s=>{let a=this.evaluateExpression(s,t);return U.BuiltInFunctions.compare(i,a,"=")});return e.negated?!n:n}evaluateArithmetic(e,t){let i=this.evaluateExpression(e.left,t),n=this.evaluateExpression(e.right,t),s=this.toNumericValue(i),a=this.toNumericValue(n);if(e.operator==="-"&&this.isDateTimeValue(i)&&this.isDateTimeValue(n)){let c=this.parseDateTimeToMs(i),u=this.parseDateTimeToMs(n);return c-u}switch(e.operator){case"+":return s+a;case"-":return s-a;case"*":return s*a;case"/":if(a===0)throw new wt("Division by zero");return s/a;default:throw new wt(`Unknown arithmetic operator: ${e.operator}`)}}toNumericValue(e){if(typeof e=="number")return e;if(e instanceof Uu.Literal){let t=e.datatype?.value||"";if(t.includes("#integer")||t.includes("#decimal")||t.includes("#double")||t.includes("#float")){let n=parseFloat(e.value);if(!isNaN(n))return n}let i=parseFloat(e.value);if(!isNaN(i))return i}if(typeof e=="string"){let t=parseFloat(e);if(!isNaN(t))return t}if(e&&typeof e=="object"&&"value"in e){let t=parseFloat(String(e.value));if(!isNaN(t))return t}throw new wt(`Cannot convert to number: ${e}`)}isDateTimeValue(e){if(e instanceof Uu.Literal){let t=e.datatype?.value||"";return t.includes("#dateTime")||t.includes("#date")?!0:/^\d{4}-\d{2}-\d{2}(T|\s)/.test(e.value)}return typeof e=="string"?/^\d{4}-\d{2}-\d{2}(T|\s)/.test(e):!1}parseDateTimeToMs(e){let t;if(e instanceof Uu.Literal)t=e.value;else if(typeof e=="string")t=e;else if(e&&typeof e=="object"&&"value"in e)t=String(e.value);else throw new wt(`Cannot parse dateTime: ${e}`);let i=new Date(t);if(isNaN(i.getTime()))throw new wt(`Invalid dateTime format: ${t}`);return i.getTime()}evaluateFunction(e,t){let i;if(typeof e.function=="string")i=e.function.toLowerCase();else if(e.function&&typeof e.function=="object"&&"value"in e.function){let n=e.function.value;i=((n.includes("#")?n.split("#").pop():n.split("/").pop())||n).toLowerCase()}else throw new wt(`Unknown function format: ${e.function}`);switch(i){case"str":let n=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.str(n);case"lang":let s=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.lang(s);case"datatype":let a=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.datatype(a).value;case"bound":if(e.args[0].type==="variable"){let ge=t.get(e.args[0].name);return U.BuiltInFunctions.bound(ge)}return!0;case"isiri":case"isuri":let c=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isIRI(c);case"isblank":let u=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isBlank(u);case"isliteral":let f=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isLiteral(f);case"regex":let l=this.getStringValue(this.evaluateExpression(e.args[0],t)),h=this.getStringValue(this.evaluateExpression(e.args[1],t)),p=e.args[2]?this.getStringValue(this.evaluateExpression(e.args[2],t)):void 0;return U.BuiltInFunctions.regex(l,h,p);case"langmatches":let g=this.getStringValue(this.evaluateExpression(e.args[0],t)),S=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.langMatches(g,S);case"contains":let _=this.getStringValue(this.evaluateExpression(e.args[0],t)),A=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.contains(_,A);case"strstarts":let F=this.getStringValue(this.evaluateExpression(e.args[0],t)),P=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strStarts(F,P);case"strends":let j=this.getStringValue(this.evaluateExpression(e.args[0],t)),B=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strEnds(j,B);case"strlen":let K=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.strlen(K);case"ucase":let Ie=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.ucase(Ie);case"lcase":let Xe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.lcase(Xe);case"substr":let ot=this.getStringValue(this.evaluateExpression(e.args[0],t)),$=Number(this.evaluateExpression(e.args[1],t));if(e.args[2]){let ge=Number(this.evaluateExpression(e.args[2],t));return U.BuiltInFunctions.substr(ot,$,ge)}return U.BuiltInFunctions.substr(ot,$);case"strbefore":let ce=this.getStringValue(this.evaluateExpression(e.args[0],t)),Pe=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strBefore(ce,Pe);case"strafter":let Ze=this.getStringValue(this.evaluateExpression(e.args[0],t)),We=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.strAfter(Ze,We);case"concat":let ze=e.args.map(ge=>this.getStringValue(this.evaluateExpression(ge,t)));return U.BuiltInFunctions.concat(...ze);case"replace":let Ne=this.getStringValue(this.evaluateExpression(e.args[0],t)),ke=this.getStringValue(this.evaluateExpression(e.args[1],t)),Re=this.getStringValue(this.evaluateExpression(e.args[2],t)),W=e.args[3]?this.getStringValue(this.evaluateExpression(e.args[3],t)):void 0;return U.BuiltInFunctions.replace(Ne,ke,Re,W);case"parsedate":let D=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.parseDate(D);case"datebefore":let je=this.getStringValue(this.evaluateExpression(e.args[0],t)),$e=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateBefore(je,$e);case"dateafter":let L=this.getStringValue(this.evaluateExpression(e.args[0],t)),le=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateAfter(L,le);case"dateinrange":let Te=this.getStringValue(this.evaluateExpression(e.args[0],t)),G=this.getStringValue(this.evaluateExpression(e.args[1],t)),xe=this.getStringValue(this.evaluateExpression(e.args[2],t));return U.BuiltInFunctions.dateInRange(Te,G,xe);case"datediffminutes":let Ae=this.getStringValue(this.evaluateExpression(e.args[0],t)),ve=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateDiffMinutes(Ae,ve);case"datediffhours":let Ce=this.getStringValue(this.evaluateExpression(e.args[0],t)),ue=this.getStringValue(this.evaluateExpression(e.args[1],t));return U.BuiltInFunctions.dateDiffHours(Ce,ue);case"year":let _e=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.year(_e);case"month":let fe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.month(fe);case"day":let Se=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.day(Se);case"hours":let Oe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.hours(Oe);case"minutes":let J=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.minutes(J);case"seconds":let te=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.seconds(te);case"timezone":case"tz":let re=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.timezone(re);case"now":return U.BuiltInFunctions.now();case"datetime":case"xsd:datetime":{let ge=this.evaluateExpression(e.args[0],t);return U.BuiltInFunctions.xsdDateTime(this.getStringValue(ge))}case"integer":case"xsd:integer":{let ge=this.evaluateExpression(e.args[0],t);return U.BuiltInFunctions.xsdInteger(this.getStringValue(ge))}case"decimal":case"xsd:decimal":{let ge=this.evaluateExpression(e.args[0],t);return U.BuiltInFunctions.xsdDecimal(this.getStringValue(ge))}case"mstominutes":let X=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.msToMinutes(X);case"mstohours":let Z=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.msToHours(Z);case"mstoseconds":let ee=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.msToSeconds(ee);case"abs":let Q=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.abs(Q);case"round":let ie=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.round(ie);case"ceil":let ne=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.ceil(ne);case"floor":let se=Number(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.floor(se);case"rand":return U.BuiltInFunctions.rand();case"coalesce":for(let ge of e.args)try{let Be=this.evaluateExpression(ge,t);if(Be!=null)return Be}catch{continue}return;case"if":if(!e.args||e.args.length!==3)throw new wt("IF requires exactly 3 arguments");let ae=this.evaluateExpression(e.args[0],t);return this.toBoolean(ae)?this.evaluateExpression(e.args[1],t):this.evaluateExpression(e.args[2],t);case"encode_for_uri":let oe=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.encodeForUri(oe);case"isnumeric":let De=this.getTermFromExpression(e.args[0],t);return U.BuiltInFunctions.isNumeric(De);case"sameterm":let Fe=this.getTermFromExpression(e.args[0],t),me=this.getTermFromExpression(e.args[1],t);return U.BuiltInFunctions.sameTerm(Fe,me);case"md5":let v=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.md5(v);case"sha1":let w=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha1(w);case"sha256":let b=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha256(b);case"sha384":let O=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha384(O);case"sha512":let V=this.getStringValue(this.evaluateExpression(e.args[0],t));return U.BuiltInFunctions.sha512(V);case"byuuid":return this.evaluateByUUID(e,t);default:throw new wt(`Unknown function: ${i}`)}}getTermFromExpression(e,t){if(e.type==="variable")return t.get(e.name)}getStringValue(e){return e==null?"":typeof e=="object"&&"value"in e?String(e.value):String(e)}toBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="number")return!isNaN(e)&&e!==0;if(typeof e=="string")return e.length>0;if(e instanceof Uu.Literal){let t=e.datatype?.value||"";if(t.includes("#boolean"))return e.value==="true"||e.value==="1";if(t.includes("#integer")||t.includes("#decimal")||t.includes("#double")||t.includes("#float")){let i=parseFloat(e.value);return!isNaN(i)&&i!==0}return e.value.length>0}return!!e}evaluateByUUID(e,t){if(!e.args||e.args.length!==1)throw new wt("exo:byUUID requires exactly 1 argument (UUID string)");let i=this.evaluateExpression(e.args[0],t),n=this.getStringValue(i);if(!n)return;let s=n.toLowerCase();if(this.uuidCache.has(s))return this.uuidCache.get(s)??void 0;if(!this.tripleStore){this.uuidCache.set(s,null);return}if(this.tripleStore.findSubjectsByUUIDSync){let a=this.tripleStore.findSubjectsByUUIDSync(s);if(a.length===0){this.uuidCache.set(s,null);return}let c=a[0];return this.uuidCache.set(s,c),c}this.uuidCache.set(s,null)}cacheUUIDResult(e,t){let i=e.toLowerCase();this.uuidCache.set(i,t)}getCachedUUID(e){let t=e.toLowerCase();if(this.uuidCache.has(t))return this.uuidCache.get(t)}};Ks.FilterExecutor=Wp});var zp=y(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:!0});Gu.OptionalExecutor=void 0;var Hp=class{static{o(this,"OptionalExecutor")}async*execute(e,t){let i=[];for await(let s of e)i.push(s);let n=[];for await(let s of t)n.push(s);for(let s of i){let a=!1;for(let c of n){let u=s.merge(c);u!==null&&(yield u,a=!0)}a||(yield s)}}async executeAll(e,t){let i=[];async function*n(){for(let a of e)yield a}o(n,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(n(),s()))i.push(a);return i}};Gu.OptionalExecutor=Hp});var Yp=y(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.UnionExecutor=void 0;var Kp=class{static{o(this,"UnionExecutor")}async*execute(e,t){let i=new Set;for await(let n of e){let s=this.getSolutionKey(n);i.has(s)||(i.add(s),yield n)}for await(let n of t){let s=this.getSolutionKey(n);i.has(s)||(i.add(s),yield n)}}async executeAll(e,t){let i=[];async function*n(){for(let a of e)yield a}o(n,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(n(),s()))i.push(a);return i}getSolutionKey(e){let t=e.toJSON();return Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("|")}};Wu.UnionExecutor=Kp});var Jp=y(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.ConstructExecutor=void 0;var eO=Wn(),Sy=at(),tO=Pt(),rO=Sr(),Qp=class{static{o(this,"ConstructExecutor")}async execute(e,t){let i=[],n=new Set;for(let s of t)for(let a of e)try{let c=this.instantiateTriple(a,s),u=`${c.subject.toString()}|${c.predicate.toString()}|${c.object.toString()}`;n.has(u)||(n.add(u),i.push(c))}catch{continue}return i}instantiateTriple(e,t){if(this.isPropertyPath(e.predicate))throw new Error("Property paths are not supported in CONSTRUCT templates");let i=this.instantiateElement(e.subject,t),n=this.instantiateElement(e.predicate,t),s=this.instantiateElement(e.object,t);return new eO.Triple(i,n,s)}isPropertyPath(e){return e.type==="path"}instantiateElement(e,t){if(e.type==="variable"){let i=t.get(e.value);if(!i)throw new Error(`Unbound variable: ${e.value}`);return i}if(e.type==="iri")return new Sy.IRI(e.value);if(e.type==="literal")return new tO.Literal(e.value,e.datatype?new Sy.IRI(e.datatype):void 0,e.language);if(e.type==="blank")return new rO.BlankNode(e.value);throw new Error(`Unknown element type: ${e.type}`)}};Hu.ConstructExecutor=Qp});var wy=y(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.DescribeExecutor=void 0;var iO=at(),Xp=class{static{o(this,"DescribeExecutor")}constructor(e){this.tripleStore=e}async execute(e){let t=[],i=new Set;for(let n of e){let s=await this.describeResource(n);for(let a of s){let c=`${a.subject.toString()}|${a.predicate.toString()}|${a.object.toString()}`;i.has(c)||(i.add(c),t.push(a))}}return t}async describeResource(e){let t=[],i=await this.tripleStore.match(e,void 0,void 0);t.push(...i);let n=await this.tripleStore.match(void 0,void 0,e);return t.push(...n),t}async describeByIRI(e){let t=new iO.IRI(e);return this.execute([t])}};zu.DescribeExecutor=Xp});var by=y(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.MinusExecutor=void 0;var Zp=class{static{o(this,"MinusExecutor")}async*execute(e,t){let i=[];for await(let s of e)i.push(s);let n=[];for await(let s of t)n.push(s);for(let s of i){let a=!1;for(let c of n)if(this.areCompatible(s,c)){a=!0;break}a||(yield s)}}async executeAll(e,t){let i=[];async function*n(){for(let a of e)yield a}o(n,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(n(),s()))i.push(a);return i}areCompatible(e,t){let i=e.variables(),n=new Set(t.variables()),s=i.filter(a=>n.has(a));if(s.length===0)return!1;for(let a of s){let c=e.get(a),u=t.get(a);if(c===void 0||u===void 0||c.toString()!==u.toString())return!1}return!0}};Ku.MinusExecutor=Zp});var Ty=y(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.ValuesExecutor=Ys.ValuesExecutorError=void 0;var nO=Zi(),Ey=at(),sO=Pt(),Yu=class extends Error{static{o(this,"ValuesExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="ValuesExecutorError"}};Ys.ValuesExecutorError=Yu;var em=class{static{o(this,"ValuesExecutor")}async*execute(e){if(e.bindings.length!==0)for(let t of e.bindings)yield this.createSolutionMapping(t)}async executeAll(e){let t=[];for await(let i of this.execute(e))t.push(i);return t}createSolutionMapping(e){let t=new nO.SolutionMapping;for(let[i,n]of Object.entries(e)){let s=this.toRDFTerm(n);t.set(i,s)}return t}toRDFTerm(e){if(e.type==="iri")return new Ey.IRI(e.value);if(e.type==="literal")return new sO.Literal(e.value,e.datatype?new Ey.IRI(e.datatype):void 0,e.language);throw new Yu(`Unknown term type: ${e.type}`)}};Ys.ValuesExecutor=em});var Ay=y(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.AggregateExecutor=Qs.AggregateExecutorError=void 0;var yr=Pt(),rm=at(),aO=Bu(),xy=new rm.IRI("http://www.w3.org/2001/XMLSchema#integer"),oo=new rm.IRI("http://www.w3.org/2001/XMLSchema#decimal"),ls=new rm.IRI("http://www.w3.org/2001/XMLSchema#string"),Qu=class extends Error{static{o(this,"AggregateExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="AggregateExecutorError"}};Qs.AggregateExecutorError=Qu;var tm=class{static{o(this,"AggregateExecutor")}constructor(){this.filterExecutor=new aO.FilterExecutor}execute(e,t){let i=this.groupSolutions(t,e.variables),n=[];for(let[s,a]of i.entries()){let c=new Map;for(let l of e.variables)if(a.length>0){let h=a[0].get(l);h&&c.set(l,h)}for(let l of e.aggregates){let h=this.computeAggregate(l.expression,a);c.set(l.variable,h)}let{SolutionMapping:u}=Zi(),f=new u;for(let[l,h]of c.entries())f.set(l,h);n.push(f)}if(n.length===0&&e.aggregates.length>0){let s=this.createEmptyAggregateResult(e);s&&n.push(s)}return n}groupSolutions(e,t){let i=new Map;if(t.length===0)return i.set("",e),i;for(let n of e){let s=this.computeGroupKey(n,t),a=i.get(s);a?a.push(n):i.set(s,[n])}return i}computeGroupKey(e,t){return t.map(i=>{let n=e.get(i);return n?this.termToString(n):""}).join("|")}termToString(e){if(e&&typeof e=="object"){if("value"in e)return String(e.value);if("id"in e)return String(e.id)}return String(e)}computeAggregate(e,t){let i=this.extractValues(e,t);switch(e.aggregation){case"count":{let n=this.computeCount(i,e.distinct);return new yr.Literal(String(n),xy)}case"sum":{let n=this.computeSum(i);return new yr.Literal(String(n),oo)}case"avg":{let n=this.computeAvg(i);return new yr.Literal(String(n),oo)}case"min":{let n=this.computeMin(i);return n===void 0?new yr.Literal("",ls):typeof n=="number"?new yr.Literal(String(n),oo):new yr.Literal(String(n),ls)}case"max":{let n=this.computeMax(i);return n===void 0?new yr.Literal("",ls):typeof n=="number"?new yr.Literal(String(n),oo):new yr.Literal(String(n),ls)}case"group_concat":{let n=this.computeGroupConcat(i,e.separator||" ",e.distinct);return new yr.Literal(n||" ",ls)}default:throw new Qu(`Unknown aggregation function: ${e.aggregation}`)}}extractValues(e,t){if(!e.expression)return t.map(()=>1);let i=[];for(let n of t){let s=this.evaluateExpression(e.expression,n);s!=null&&i.push(s)}return i}evaluateExpression(e,t){if(e.type==="variable"){let i=t.get(e.name);return i==null?void 0:typeof i=="number"||typeof i=="string"||typeof i=="boolean"?i:typeof i=="object"&&"value"in i?i.value:i}if(e.type==="literal")return e.value;try{return this.filterExecutor.evaluateExpression(e,t)}catch{return}}computeCount(e,t){return t?new Set(e.map(i=>String(i))).size:e.length}computeSum(e){return e.map(i=>parseFloat(String(i))).filter(i=>!isNaN(i)).reduce((i,n)=>i+n,0)}computeAvg(e){let t=e.map(i=>parseFloat(String(i))).filter(i=>!isNaN(i));return t.length===0?0:t.reduce((i,n)=>i+n,0)/t.length}computeMin(e){if(e.length===0)return;let t=e.map(n=>parseFloat(String(n))).filter(n=>!isNaN(n));if(t.length>0)return Math.min(...t);let i=e.map(n=>String(n));return i.reduce((n,s)=>s<n?s:n,i[0])}computeMax(e){if(e.length===0)return;let t=e.map(n=>parseFloat(String(n))).filter(n=>!isNaN(n));if(t.length>0)return Math.max(...t);let i=e.map(n=>String(n));return i.reduce((n,s)=>s>n?s:n,i[0])}computeGroupConcat(e,t,i){let n=e.map(s=>String(s));return i&&(n=[...new Set(n)]),n.join(t)}createEmptyAggregateResult(e){let{SolutionMapping:t}=Zi(),i=new t;for(let n of e.aggregates)switch(n.expression.aggregation){case"count":i.set(n.variable,new yr.Literal("0",xy));break;case"sum":case"avg":i.set(n.variable,new yr.Literal("0",oo));break;case"group_concat":i.set(n.variable,new yr.Literal(" ",ls));break;default:i.set(n.variable,new yr.Literal("",ls))}return i}};Qs.AggregateExecutor=tm});var Oy=y(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.ServiceExecutor=Js.ServiceExecutorError=void 0;var oO=Zi(),Cy=at(),cO=Pt(),uO=Sr(),fs=class extends Error{static{o(this,"ServiceExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="ServiceExecutorError"}};Js.ServiceExecutorError=fs;var im=class{static{o(this,"ServiceExecutor")}constructor(e={}){this.timeout=e.timeout??3e4,this.httpClient=e.httpClient??((t,i)=>fetch(t,i)),this.maxRetries=e.maxRetries??2,this.retryDelay=e.retryDelay??1e3}async*execute(e,t){try{let i=t(e.pattern),n=await this.executeRemoteQuery(e.endpoint,i);for(let s of n)yield s}catch(i){if(e.silent)return;throw i}}async executeRemoteQuery(e,t){let i;for(let n=0;n<=this.maxRetries;n++)try{let s=new AbortController,a=setTimeout(()=>s.abort(),this.timeout);try{let c=await this.httpClient(e,{method:"POST",headers:{"Content-Type":"application/sparql-query",Accept:"application/sparql-results+json"},body:t,signal:s.signal});if(!c.ok)throw new fs(`Remote SPARQL endpoint returned ${c.status}: ${c.statusText}`);let u=await c.json();return this.parseJsonResults(u)}finally{clearTimeout(a)}}catch(s){if(i=s instanceof Error?s:new Error(String(s)),this.isRetryableError(i)&&n<this.maxRetries){await this.delay(this.retryDelay);continue}throw new fs(`Failed to query remote SPARQL endpoint ${e}: ${i.message}`,i)}throw new fs(`Failed to query remote SPARQL endpoint ${e} after ${this.maxRetries+1} attempts`,i)}parseJsonResults(e){return!e.results||!Array.isArray(e.results.bindings)?[]:e.results.bindings.map(t=>this.parseBinding(t))}parseBinding(e){let t=new oO.SolutionMapping;for(let[i,n]of Object.entries(e)){let s=this.parseRDFTerm(n);t.set(i,s)}return t}parseRDFTerm(e){switch(e.type){case"uri":return new Cy.IRI(e.value);case"literal":{let t=e.datatype?new Cy.IRI(e.datatype):void 0;return new cO.Literal(e.value,t,e["xml:lang"])}case"bnode":return new uO.BlankNode(e.value);default:throw new fs(`Unknown RDF term type: ${e.type}`)}}isRetryableError(e){let t=e.message.toLowerCase();return!!(e.name==="AbortError"||t.includes("network")||t.includes("econnreset")||t.includes("econnrefused")||t.includes("etimedout")||t.includes("returned 5"))}delay(e){return new Promise(t=>setTimeout(t,e))}};Js.ServiceExecutor=im});var Py=y(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.GraphExecutor=Xs.GraphExecutorError=void 0;var Fy=at(),Ju=class extends Error{static{o(this,"GraphExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="GraphExecutorError"}};Xs.GraphExecutorError=Ju;var nm=class{static{o(this,"GraphExecutor")}constructor(e){this.tripleStore=e}async*execute(e,t,i){let n=e.name;if(n.type==="iri")yield*this.executeWithGraph(e.pattern,n,t);else if(n.type==="variable")yield*this.executeWithGraphVariable(e,n,t,i);else throw new Ju(`Invalid graph name type: ${n.type}`)}async*executeWithGraph(e,t,i){let n=new Fy.IRI(t.value);this.tripleStore.hasGraph&&!await this.tripleStore.hasGraph(n)||(yield*i(e,n))}async*executeWithGraphVariable(e,t,i,n){if(n){let a=n.get(t.value);if(a&&a instanceof Fy.IRI){yield*this.executeWithGraph(e.pattern,{type:"iri",value:a.value},i);return}}if(!this.tripleStore.getNamedGraphs)return;let s=await this.tripleStore.getNamedGraphs();for(let a of s)for await(let c of i(e.pattern,a)){let u=c.clone();u.set(t.value,a),yield u}}};Xs.GraphExecutor=nm});var Ry=y(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.SPARQLGenerator=ea.SPARQLGeneratorError=void 0;var Zs=class extends Error{static{o(this,"SPARQLGeneratorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="SPARQLGeneratorError"}};ea.SPARQLGeneratorError=Zs;var sm=class{static{o(this,"SPARQLGenerator")}collectVariables(e){let t=new Set;return this.collectVariablesFromOperation(e,t),t}generateSelect(e){let t=this.collectVariables(e),i=t.size>0?Array.from(t).map(s=>`?${s}`).join(" "):"*",n=this.generateWhereClause(e);return`SELECT ${i} WHERE {
${n}
}`}generateWhereClause(e,t=2){let i=" ".repeat(t);switch(e.type){case"bgp":return this.generateBGP(e,t);case"filter":return`${this.generateWhereClause(e.input,t)}
${i}FILTER(${this.generateExpression(e.expression)})`;case"join":return`${this.generateWhereClause(e.left,t)}
${this.generateWhereClause(e.right,t)}`;case"leftjoin":{let n=this.generateWhereClause(e.left,t),s=this.generateWhereClause(e.right,t+2);return`${n}
${i}OPTIONAL {
${s}
${i}}`}case"union":{let n=this.generateWhereClause(e.left,t+2),s=this.generateWhereClause(e.right,t+2);return`${i}{
${n}
${i}}
${i}UNION
${i}{
${s}
${i}}`}case"values":return this.generateValues(e,t);case"extend":{let n=this.generateWhereClause(e.input,t),s=this.generateExpression(e.expression);return`${n}
${i}BIND(${s} AS ?${e.variable})`}case"project":case"distinct":case"reduced":return this.generateWhereClause(e.input,t);case"orderby":case"slice":case"group":return this.generateWhereClause(e.input,t);case"subquery":{let s=this.generateSelect(e.query).split(`
`).map(a=>i+a).join(`
`);return`${i}{
${s}
${i}}`}default:throw new Zs(`Unsupported operation type for SPARQL generation: ${e.type}`)}}generateBGP(e,t){let i=" ".repeat(t);return e.triples.map(n=>`${i}${this.generateTriple(n)} .`).join(`
`)}generateTriple(e){let t=this.generateElement(e.subject),i=this.generatePredicate(e.predicate),n=this.generateElement(e.object);return`${t} ${i} ${n}`}generatePredicate(e){return"pathType"in e?this.generatePropertyPath(e):this.generateElement(e)}generatePropertyPath(e){let t=e.items.map(i=>"pathType"in i?`(${this.generatePropertyPath(i)})`:`<${i.value}>`);switch(e.pathType){case"/":return t.join("/");case"|":return t.join("|");case"^":return`^${t[0]}`;case"+":return`${t[0]}+`;case"*":return`${t[0]}*`;case"?":return`${t[0]}?`}}generateElement(e){switch(e.type){case"variable":return`?${e.value}`;case"iri":return`<${e.value}>`;case"literal":{let i=`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`;return e.language?i+=`@${e.language}`:e.datatype&&(i+=`^^<${e.datatype}>`),i}case"blank":return`_:${e.value}`;default:throw new Zs(`Unknown element type: ${e.type}`)}}generateValues(e,t){let i=" ".repeat(t);if(e.variables.length===0||e.bindings.length===0)return"";if(e.variables.length===1){let a=e.variables[0],c=e.bindings.map(u=>{let f=u[a];return f?this.generateValuesTerm(f):"UNDEF"}).join(" ");return`${i}VALUES ?${a} { ${c} }`}let n=e.variables.map(a=>`?${a}`).join(" "),s=e.bindings.map(a=>`(${e.variables.map(u=>{let f=a[u];return f?this.generateValuesTerm(f):"UNDEF"}).join(" ")})`);return`${i}VALUES (${n}) {
${s.map(a=>`${i}  ${a}`).join(`
`)}
${i}}`}generateValuesTerm(e){if(e.type==="iri")return`<${e.value}>`;let i=`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`;return e.language?i+=`@${e.language}`:e.datatype&&(i+=`^^<${e.datatype}>`),i}generateExpression(e){switch(e.type){case"variable":return`?${e.name}`;case"literal":return typeof e.value=="string"?`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:typeof e.value=="boolean"?e.value?"true":"false":String(e.value);case"comparison":return`(${this.generateExpression(e.left)} ${e.operator} ${this.generateExpression(e.right)})`;case"logical":return e.operator==="!"?`!(${this.generateExpression(e.operands[0])})`:`(${e.operands.map(t=>this.generateExpression(t)).join(` ${e.operator} `)})`;case"arithmetic":return`(${this.generateExpression(e.left)} ${e.operator} ${this.generateExpression(e.right)})`;case"function":return`${e.function.toUpperCase()}(${e.args.map(t=>this.generateExpression(t)).join(", ")})`;case"functionCall":return`${(typeof e.function=="string"?e.function:e.function.value).toUpperCase()}(${e.args.map(i=>this.generateExpression(i)).join(", ")})`;case"exists":return`${e.negated?"NOT EXISTS":"EXISTS"} { ${this.generateWhereClause(e.pattern,0)} }`;case"in":{let t=this.generateExpression(e.expression),i=e.list.map(n=>this.generateExpression(n)).join(", ");return e.negated?`${t} NOT IN (${i})`:`${t} IN (${i})`}default:throw new Zs(`Unknown expression type: ${e.type}`)}}collectVariablesFromOperation(e,t){switch(e.type){case"bgp":for(let i of e.triples)this.collectVariablesFromTriple(i,t);break;case"filter":this.collectVariablesFromOperation(e.input,t),this.collectVariablesFromExpression(e.expression,t);break;case"join":case"leftjoin":case"union":case"minus":this.collectVariablesFromOperation(e.left,t),this.collectVariablesFromOperation(e.right,t);break;case"values":for(let i of e.variables)t.add(i);break;case"project":for(let i of e.variables)t.add(i);this.collectVariablesFromOperation(e.input,t);break;case"extend":t.add(e.variable),this.collectVariablesFromOperation(e.input,t);break;case"orderby":case"slice":case"distinct":case"reduced":this.collectVariablesFromOperation(e.input,t);break;case"group":for(let i of e.variables)t.add(i);for(let i of e.aggregates)t.add(i.variable);this.collectVariablesFromOperation(e.input,t);break;case"subquery":this.collectVariablesFromOperation(e.query,t);break}}collectVariablesFromTriple(e,t){e.subject.type==="variable"&&t.add(e.subject.value),"type"in e.predicate&&e.predicate.type==="variable"&&t.add(e.predicate.value),e.object.type==="variable"&&t.add(e.object.value)}collectVariablesFromExpression(e,t){switch(e.type){case"variable":t.add(e.name);break;case"comparison":case"arithmetic":this.collectVariablesFromExpression(e.left,t),this.collectVariablesFromExpression(e.right,t);break;case"logical":for(let i of e.operands)this.collectVariablesFromExpression(i,t);break;case"function":case"functionCall":for(let i of e.args)this.collectVariablesFromExpression(i,t);break;case"exists":this.collectVariablesFromOperation(e.pattern,t);break;case"in":this.collectVariablesFromExpression(e.expression,t);for(let i of e.list)this.collectVariablesFromExpression(i,t);break}}};ea.SPARQLGenerator=sm});var Iy=y(kr=>{"use strict";var lO=kr&&kr.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),fO=kr&&kr.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),hO=kr&&kr.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var i=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[i.length]=n);return i},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i=r(e),n=0;n<i.length;n++)i[n]!=="default"&&lO(t,e,i[n]);return fO(t,e),t}})();Object.defineProperty(kr,"__esModule",{value:!0});kr.QueryExecutor=kr.QueryExecutorError=void 0;var dO=Up(),pO=Bu(),mO=zp(),gO=Yp(),yO=by(),vO=Ty(),_O=Ay(),SO=Jp(),wO=Oy(),bO=Py(),EO=Ry(),ta=class extends Error{static{o(this,"QueryExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="QueryExecutorError"}};kr.QueryExecutorError=ta;var am=class{static{o(this,"QueryExecutor")}constructor(e,t={}){this.tripleStore=e,this.bgpExecutor=new dO.BGPExecutor(e),this.filterExecutor=new pO.FilterExecutor,this.optionalExecutor=new mO.OptionalExecutor,this.unionExecutor=new gO.UnionExecutor,this.minusExecutor=new yO.MinusExecutor,this.valuesExecutor=new vO.ValuesExecutor,this.aggregateExecutor=new _O.AggregateExecutor,this.constructExecutor=new SO.ConstructExecutor,this.serviceExecutor=new wO.ServiceExecutor(t.serviceConfig),this.graphExecutor=new bO.GraphExecutor(e),this.sparqlGenerator=new EO.SPARQLGenerator,this.filterExecutor.setExistsEvaluator(async(i,n)=>this.evaluateExistsPattern(i,n)),this.filterExecutor.setTripleStore(e)}async evaluateExistsPattern(e,t){for await(let i of this.execute(e))if(t.merge(i)!==null)return!0;return!1}async executeAll(e){let t=[];for await(let i of this.execute(e))t.push(i);return t}async*execute(e){switch(e.type){case"bgp":yield*this.executeBGP(e);break;case"filter":yield*this.executeFilter(e);break;case"join":yield*this.executeJoin(e);break;case"leftjoin":yield*this.executeLeftJoin(e);break;case"union":yield*this.executeUnion(e);break;case"minus":yield*this.executeMinus(e);break;case"values":yield*this.executeValues(e);break;case"project":yield*this.executeProject(e);break;case"orderby":yield*this.executeOrderBy(e);break;case"slice":yield*this.executeSlice(e);break;case"distinct":yield*this.executeDistinct(e);break;case"reduced":yield*this.executeReduced(e);break;case"group":yield*this.executeGroup(e);break;case"extend":yield*this.executeExtend(e);break;case"subquery":yield*this.executeSubquery(e);break;case"service":yield*this.executeService(e);break;case"graph":yield*this.executeGraph(e);break;default:throw new ta(`Unknown operation type: ${e.type}`)}}async*executeBGP(e){yield*this.bgpExecutor.execute(e)}async*executeFilter(e){let t=this.execute(e.input);yield*this.filterExecutor.execute(e,t)}async*executeJoin(e){let t=[];for await(let i of this.execute(e.left))t.push(i);for(let i of t)for await(let n of this.execute(e.right)){let s=i.merge(n);s!==null&&(yield s)}}async*executeLeftJoin(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let i=[];for await(let a of this.execute(e.right))i.push(a);async function*n(){for(let a of t)yield a}o(n,"leftGen");async function*s(){for(let a of i)yield a}o(s,"rightGen"),yield*this.optionalExecutor.execute(n(),s())}async*executeUnion(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let i=[];for await(let a of this.execute(e.right))i.push(a);async function*n(){for(let a of t)yield a}o(n,"leftGen");async function*s(){for(let a of i)yield a}o(s,"rightGen"),yield*this.unionExecutor.execute(n(),s())}async*executeMinus(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let i=[];for await(let a of this.execute(e.right))i.push(a);async function*n(){for(let a of t)yield a}o(n,"leftGen");async function*s(){for(let a of i)yield a}o(s,"rightGen"),yield*this.minusExecutor.execute(n(),s())}async*executeValues(e){yield*this.valuesExecutor.execute(e)}async*executeProject(e){for await(let t of this.execute(e.input))yield t}async*executeOrderBy(e){let t=[];for await(let i of this.execute(e.input))t.push(i);t.sort((i,n)=>{for(let s of e.comparators){let a=this.getExpressionValue(s.expression,i),c=this.getExpressionValue(s.expression,n),u=0;if(a===void 0&&c===void 0?u=0:a===void 0?u=1:c===void 0?u=-1:typeof a=="number"&&typeof c=="number"?u=a-c:u=String(a).localeCompare(String(c)),s.descending&&(u=-u),u!==0)return u}return 0});for(let i of t)yield i}async*executeSlice(e){let t=0,i=e.offset??0,n=e.limit;for await(let s of this.execute(e.input)){if(t>=i){if(n!==void 0&&t-i>=n)break;yield s}t++}}async*executeDistinct(e){let t=new Set;for await(let i of this.execute(e.input)){let n=this.getSolutionKey(i);t.has(n)||(t.add(n),yield i)}}async*executeReduced(e){let t=new Set;for await(let i of this.execute(e.input)){let n=this.getSolutionKey(i);t.has(n)||(t.add(n),yield i)}}async*executeGroup(e){let t=[];for await(let n of this.execute(e.input))t.push(n);let i=this.aggregateExecutor.execute(e,t);for(let n of i)yield n}async*executeExtend(e){for await(let t of this.execute(e.input)){let i=t.clone(),n=this.evaluateExtendExpression(e.expression,t);n!==void 0&&i.set(e.variable,n),yield i}}async*executeSubquery(e){yield*this.execute(e.query)}async*executeService(e){yield*this.serviceExecutor.execute(e,t=>this.sparqlGenerator.generateSelect(t))}async*executeGraph(e){let t=async function*(i,n){let s=this.currentGraphContext;this.currentGraphContext=n;try{i.type==="bgp"&&n&&this.tripleStore.matchInGraph?yield*this.executeBGPInGraph(i,n):yield*this.execute(i)}finally{this.currentGraphContext=s}}.bind(this);yield*this.graphExecutor.execute(e,t)}async*executeBGPInGraph(e,t){if(e.triples.length===0){let{SolutionMapping:i}=await Promise.resolve().then(()=>hO(Zi()));yield new i;return}yield*this.bgpExecutor.executeInGraph(e,t)}evaluateExtendExpression(e,t){if(e.type!=="aggregate")try{return this.filterExecutor.evaluateExpression(e,t)}catch{return}}getExpressionValue(e,t){if(e.type==="variable"){let i=t.get(e.name);return i?i.value??i.id??String(i):void 0}return e.value}getSolutionKey(e){let t=e.toJSON();return Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("|")}isConstructQuery(e){return e.type==="construct"}async executeConstruct(e){if(e.type!=="construct")throw new ta("executeConstruct requires a CONSTRUCT operation");let t=await this.executeAll(e.where);return this.constructExecutor.execute(e.template,t)}isAskQuery(e){return e.type==="ask"}async executeAsk(e){if(e.type!=="ask")throw new ta("executeAsk requires an ASK operation");for await(let t of this.execute(e.where))return!0;return!1}};kr.QueryExecutor=am});var Ny=y(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.AggregateFunctions=void 0;var om=Pt(),Dy=at(),cm=class{static{o(this,"AggregateFunctions")}static count(e,t){if(!t)return e.length;let i=0;for(let n of e)n.has(t)&&i++;return i}static countDistinct(e,t){let i=new Set;for(let n of e){let s=n.get(t);s&&i.add(s.toString())}return i.size}static sum(e,t){let i=0;for(let n of e){let s=n.get(t);if(s instanceof om.Literal){let a=this.toNumber(s);isNaN(a)||(i+=a)}}return i}static avg(e,t){let i=this.sum(e,t),n=this.count(e,t);return n>0?i/n:0}static min(e,t){let i=null;for(let n of e){let s=n.get(t);if(!s)continue;let a=this.toComparable(s);(i===null||a<i)&&(i=a)}return i}static max(e,t){let i=null;for(let n of e){let s=n.get(t);if(!s)continue;let a=this.toComparable(s);(i===null||a>i)&&(i=a)}return i}static groupConcat(e,t,i=" "){let n=[];for(let s of e){let a=s.get(t);a&&(a instanceof om.Literal||a instanceof Dy.IRI?n.push(a.value):n.push(a.toString()))}return n.join(i)}static toNumber(e){let t=e.datatype?.value;return t?.includes("#integer")||t?.includes("#decimal")||t?.includes("#double"),parseFloat(e.value)}static toComparable(e){if(e instanceof om.Literal){let t=this.toNumber(e);return isNaN(t)?e.value:t}return e instanceof Dy.IRI?e.value:String(e)}};Xu.AggregateFunctions=cm});var ky=y(Zu=>{"use strict";Object.defineProperty(Zu,"__esModule",{value:!0});Zu.QueryPlanCache=void 0;var TO=hp(),um=class{static{o(this,"QueryPlanCache")}constructor(e=100){this.hits=0,this.misses=0,this.cache=new TO.LRUCache(e)}get(e){let t=this.normalizeQuery(e),i=this.cache.get(t);return i!==void 0?this.hits++:this.misses++,i}set(e,t){let i=this.normalizeQuery(e);this.cache.set(i,t)}has(e){let t=this.normalizeQuery(e);return this.cache.get(t)!==void 0}clear(){this.cache.clear()}getStats(){let e=this.hits+this.misses;return{hits:this.hits,misses:this.misses,hitRate:e>0?this.hits/e:0,size:this.cache.size()}}resetStats(){this.hits=0,this.misses=0}normalizeQuery(e){return e.replace(/\s+/g," ").trim()}};Zu.QueryPlanCache=um});var jy=y(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.FileAlreadyExistsError=ra.FileNotFoundError=void 0;var lm=class extends Error{static{o(this,"FileNotFoundError")}constructor(e){super(`File not found: ${e}`),this.name="FileNotFoundError"}};ra.FileNotFoundError=lm;var fm=class extends Error{static{o(this,"FileAlreadyExistsError")}constructor(e){super(`File already exists: ${e}`),this.name="FileAlreadyExistsError"}};ra.FileAlreadyExistsError=fm});var Ly=y(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.container=void 0;wn.registerCoreServices=YO;wn.createChildContainer=QO;wn.getContainer=JO;wn.resetContainer=XO;xf();var co=Qe();Object.defineProperty(wn,"container",{enumerable:!0,get:o(function(){return co.container},"get")});var et=it(),xO=ld(),AO=ru(),CO=Ud(),OO=iu(),FO=Nd(),PO=hd(),RO=vd(),IO=gd(),DO=cu(),NO=uu(),kO=Od(),jO=Pd(),LO=jd(),MO=Ad(),VO=Gd(),qO=Kd(),$O=Hd(),UO=bd(),BO=Td(),GO=qd(),WO=Md(),HO=vp(),zO=Sd(),KO=Qd();function YO(r){let e=r||co.container;e.registerSingleton(et.DI_TOKENS.TaskFrontmatterGenerator,AO.TaskFrontmatterGenerator),e.registerSingleton(et.DI_TOKENS.DynamicFrontmatterGenerator,CO.DynamicFrontmatterGenerator),e.registerSingleton(et.DI_TOKENS.AlgorithmExtractor,OO.AlgorithmExtractor),e.registerSingleton(et.DI_TOKENS.EffortStatusWorkflow,DO.EffortStatusWorkflow),e.registerSingleton(et.DI_TOKENS.StatusTimestampService,NO.StatusTimestampService),e.registerSingleton(et.DI_TOKENS.TaskStatusService,IO.TaskStatusService),e.registerSingleton(et.DI_TOKENS.TaskCreationService,xO.TaskCreationService),e.registerSingleton(et.DI_TOKENS.ProjectCreationService,PO.ProjectCreationService),e.registerSingleton(et.DI_TOKENS.AreaCreationService,RO.AreaCreationService),e.registerSingleton(et.DI_TOKENS.ClassCreationService,UO.ClassCreationService),e.registerSingleton(et.DI_TOKENS.ConceptCreationService,BO.ConceptCreationService),e.registerSingleton(et.DI_TOKENS.FleetingNoteCreationService,GO.FleetingNoteCreationService),e.registerSingleton(et.DI_TOKENS.SupervisionCreationService,WO.SupervisionCreationService),e.registerSingleton(et.DI_TOKENS.PropertyCleanupService,FO.PropertyCleanupService),e.registerSingleton(et.DI_TOKENS.FolderRepairService,kO.FolderRepairService),e.registerSingleton(et.DI_TOKENS.LabelToAliasService,jO.LabelToAliasService),e.registerSingleton(et.DI_TOKENS.RenameToUidService,LO.RenameToUidService),e.registerSingleton(et.DI_TOKENS.PlanningService,VO.PlanningService),e.registerSingleton(et.DI_TOKENS.EffortVotingService,MO.EffortVotingService),e.registerSingleton(et.DI_TOKENS.SessionEventService,qO.SessionEventService),e.registerSingleton(et.DI_TOKENS.AssetConversionService,$O.AssetConversionService),e.registerSingleton(et.DI_TOKENS.NoteToRDFConverter,HO.NoteToRDFConverter),e.registerSingleton(et.DI_TOKENS.AreaHierarchyBuilder,zO.AreaHierarchyBuilder),e.registerSingleton(et.DI_TOKENS.URIConstructionService,KO.URIConstructionService)}o(YO,"registerCoreServices");function QO(){return co.container.createChildContainer()}o(QO,"createChildContainer");function JO(){return co.container}o(JO,"getContainer");function XO(){co.container.reset()}o(XO,"resetContainer")});var Ci=y(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});el.ErrorCode=void 0;var My;(function(r){r[r.INVALID_INPUT=1e3]="INVALID_INPUT",r[r.INVALID_FORMAT=1001]="INVALID_FORMAT",r[r.MISSING_REQUIRED_FIELD=1002]="MISSING_REQUIRED_FIELD",r[r.INVALID_SCHEMA=1003]="INVALID_SCHEMA",r[r.NETWORK_ERROR=2e3]="NETWORK_ERROR",r[r.REQUEST_TIMEOUT=2001]="REQUEST_TIMEOUT",r[r.CONNECTION_FAILED=2002]="CONNECTION_FAILED",r[r.FILE_READ_ERROR=2003]="FILE_READ_ERROR",r[r.FILE_WRITE_ERROR=2004]="FILE_WRITE_ERROR",r[r.INVALID_STATE=3e3]="INVALID_STATE",r[r.INVALID_TRANSITION=3001]="INVALID_TRANSITION",r[r.OPERATION_FAILED=3002]="OPERATION_FAILED",r[r.CONCURRENT_MODIFICATION=3003]="CONCURRENT_MODIFICATION",r[r.PERMISSION_DENIED=4e3]="PERMISSION_DENIED",r[r.UNAUTHORIZED=4001]="UNAUTHORIZED",r[r.FORBIDDEN=4003]="FORBIDDEN",r[r.NOT_FOUND=5e3]="NOT_FOUND",r[r.RESOURCE_EXHAUSTED=5001]="RESOURCE_EXHAUSTED",r[r.ALREADY_EXISTS=5002]="ALREADY_EXISTS",r[r.UNKNOWN_ERROR=9e3]="UNKNOWN_ERROR",r[r.INTERNAL_ERROR=9001]="INTERNAL_ERROR"})(My||(el.ErrorCode=My={}))});var Oi=y(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});tl.ApplicationError=void 0;var hm=class extends Error{static{o(this,"ApplicationError")}constructor(e,t){super(e),this.name=this.constructor.name,this.context=t,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}format(){let e=`\u274C ${this.name}: ${this.message}`;if(this.guidance&&(e+=`

\u{1F4A1} ${this.guidance}`),this.context&&Object.keys(this.context).length>0){e+=`

\u{1F4CB} Context:`;for(let[t,i]of Object.entries(this.context))e+=`
  ${t}: ${JSON.stringify(i)}`}return e}toJSON(){return{name:this.name,message:this.message,code:this.code,retriable:this.retriable,timestamp:this.timestamp.toISOString(),context:this.context,stack:this.stack}}};tl.ApplicationError=hm});var Vy=y(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});rl.ValidationError=void 0;var ZO=Oi(),e5=Ci(),dm=class extends ZO.ApplicationError{static{o(this,"ValidationError")}constructor(e,t){super(e,t),this.code=e5.ErrorCode.INVALID_INPUT,this.retriable=!1,this.guidance=`Check the input data for correctness.
Common issues:
  \u2022 Missing required fields
  \u2022 Invalid data format or type
  \u2022 Values outside allowed range
  \u2022 Schema validation failed`}};rl.ValidationError=dm});var qy=y(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});il.NetworkError=void 0;var t5=Oi(),r5=Ci(),pm=class extends t5.ApplicationError{static{o(this,"NetworkError")}constructor(e,t){super(e,t),this.code=r5.ErrorCode.NETWORK_ERROR,this.retriable=!0,this.guidance=`This is typically a transient network issue.
To resolve:
  \u2022 Check your internet connection
  \u2022 Retry the operation
  \u2022 Verify external services are available
  \u2022 Check firewall/proxy settings`}};il.NetworkError=pm});var $y=y(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});nl.StateTransitionError=void 0;var i5=Oi(),n5=Ci(),mm=class extends i5.ApplicationError{static{o(this,"StateTransitionError")}constructor(e,t){super(e,t),this.code=n5.ErrorCode.INVALID_TRANSITION,this.retriable=!1,this.guidance=`The requested state transition is not allowed.
To fix:
  \u2022 Check the current state of the resource
  \u2022 Verify the transition is valid for this workflow
  \u2022 Review state machine documentation
  \u2022 Ensure no concurrent modifications occurred`}};nl.StateTransitionError=mm});var Uy=y(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});sl.PermissionError=void 0;var s5=Oi(),a5=Ci(),gm=class extends s5.ApplicationError{static{o(this,"PermissionError")}constructor(e,t){super(e,t),this.code=a5.ErrorCode.PERMISSION_DENIED,this.retriable=!1,this.guidance=`You don't have permission to perform this operation.
To resolve:
  \u2022 Check file/directory permissions
  \u2022 Verify you're authenticated
  \u2022 Ensure you have sufficient privileges
  \u2022 Contact administrator if access is needed`}};sl.PermissionError=gm});var By=y(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});al.NotFoundError=void 0;var o5=Oi(),c5=Ci(),ym=class extends o5.ApplicationError{static{o(this,"NotFoundError")}constructor(e,t){super(e,t),this.code=c5.ErrorCode.NOT_FOUND,this.retriable=!1,this.guidance=`The requested resource could not be found.
To resolve:
  \u2022 Verify the resource path/ID is correct
  \u2022 Check the resource exists
  \u2022 Ensure proper file extension (.md for notes)
  \u2022 Verify resource hasn't been deleted`}};al.NotFoundError=ym});var Gy=y(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});ol.ResourceExhaustedError=void 0;var u5=Oi(),l5=Ci(),vm=class extends u5.ApplicationError{static{o(this,"ResourceExhaustedError")}constructor(e,t){super(e,t),this.code=l5.ErrorCode.RESOURCE_EXHAUSTED,this.retriable=!0,this.guidance=`A resource limit has been exceeded.
To resolve:
  \u2022 Free up system resources (memory, disk space)
  \u2022 Reduce the size of your request
  \u2022 Wait and retry (for rate limits)
  \u2022 Close unused files/connections
  \u2022 Paginate large queries`}};ol.ResourceExhaustedError=vm});var Wy=y(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});cl.ServiceError=void 0;var f5=Oi(),h5=Ci(),_m=class extends f5.ApplicationError{static{o(this,"ServiceError")}constructor(e,t){super(e,t),this.code=h5.ErrorCode.INTERNAL_ERROR,this.retriable=!1,this.guidance=`This is an internal service error.
To resolve:
  \u2022 Check service initialization parameters
  \u2022 Verify all required dependencies are available
  \u2022 Review service logs for detailed error information
  \u2022 Contact support if the issue persists`}};cl.ServiceError=_m});var Hy=y(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.ServiceError=pt.ResourceExhaustedError=pt.NotFoundError=pt.PermissionError=pt.StateTransitionError=pt.NetworkError=pt.ValidationError=pt.ApplicationError=pt.ErrorCode=void 0;var d5=Ci();Object.defineProperty(pt,"ErrorCode",{enumerable:!0,get:o(function(){return d5.ErrorCode},"get")});var p5=Oi();Object.defineProperty(pt,"ApplicationError",{enumerable:!0,get:o(function(){return p5.ApplicationError},"get")});var m5=Vy();Object.defineProperty(pt,"ValidationError",{enumerable:!0,get:o(function(){return m5.ValidationError},"get")});var g5=qy();Object.defineProperty(pt,"NetworkError",{enumerable:!0,get:o(function(){return g5.NetworkError},"get")});var y5=$y();Object.defineProperty(pt,"StateTransitionError",{enumerable:!0,get:o(function(){return y5.StateTransitionError},"get")});var v5=Uy();Object.defineProperty(pt,"PermissionError",{enumerable:!0,get:o(function(){return v5.PermissionError},"get")});var _5=By();Object.defineProperty(pt,"NotFoundError",{enumerable:!0,get:o(function(){return _5.NotFoundError},"get")});var S5=Gy();Object.defineProperty(pt,"ResourceExhaustedError",{enumerable:!0,get:o(function(){return S5.ResourceExhaustedError},"get")});var w5=Wy();Object.defineProperty(pt,"ServiceError",{enumerable:!0,get:o(function(){return w5.ServiceError},"get")})});var zy=y(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0});ul.ApplicationErrorHandler=void 0;var Sm=Oi(),b5=Ci(),wm=class{static{o(this,"ApplicationErrorHandler")}constructor(e={},t,i){this.logger=t,this.notifier=i,this.telemetryHooks=new Set,this.retryConfig={maxRetries:e.maxRetries??3,initialDelayMs:e.initialDelayMs??1e3,backoffMultiplier:e.backoffMultiplier??2,maxDelayMs:e.maxDelayMs??1e4}}handle(e,t){let i=this.ensureApplicationError(e,t);return this.notifier&&this.notifier.error(i.message),this.callTelemetryHooks("onError",i,t),this.formatError(i)}async executeWithRetry(e,t){let i,n=0;for(;n<=this.retryConfig.maxRetries;)try{return await e()}catch(s){if(i=this.ensureApplicationError(s,t),!i.retriable||n>=this.retryConfig.maxRetries)throw this.callTelemetryHooks("onError",i,t),n>=this.retryConfig.maxRetries&&i.retriable&&this.callTelemetryHooks("onRetryExhausted",i,n+1),i;let a=this.calculateDelay(n);this.callTelemetryHooks("onRetry",i,n+1,a),this.logger?.debug(`Retrying after ${a}ms (attempt ${n+1}/${this.retryConfig.maxRetries})`),await this.sleep(a),n++}throw i}registerTelemetryHook(e){this.telemetryHooks.add(e)}unregisterTelemetryHook(e){this.telemetryHooks.delete(e)}ensureApplicationError(e,t){if(e instanceof Sm.ApplicationError){if(t){let n=e,s={...e.context,...t};return new class extends Sm.ApplicationError{constructor(){super(...arguments),this.code=n.code,this.retriable=n.retriable,this.guidance=n.guidance}}(e.message,s)}return e}return new class extends Sm.ApplicationError{static{o(this,"UnknownError")}constructor(s,a){super(s,{originalError:a.name,...t}),this.code=b5.ErrorCode.UNKNOWN_ERROR,this.retriable=!1,this.guidance="An unexpected error occurred"}}(e.message,e)}formatError(e){let t=[];return t.push(`\u274C ${e.name}: ${e.message}`),e.guidance&&t.push(`\u{1F4A1} ${e.guidance}`),e.context&&Object.keys(e.context).length>0&&t.push(`Context: ${JSON.stringify(e.context,null,2)}`),t.join(`
`)}calculateDelay(e){let t=this.retryConfig.initialDelayMs*Math.pow(this.retryConfig.backoffMultiplier,e);return Math.min(t,this.retryConfig.maxDelayMs)}sleep(e){return new Promise(t=>setTimeout(t,e))}callTelemetryHooks(e,...t){for(let i of this.telemetryHooks)try{let n=i[e];n&&n.apply(i,t)}catch(n){console.error("Error in telemetry hook:",n)}}};ul.ApplicationErrorHandler=wm});var Ky=y(ll=>{"use strict";Object.defineProperty(ll,"__esModule",{value:!0});ll.ApplicationErrorHandler=void 0;var E5=zy();Object.defineProperty(ll,"ApplicationErrorHandler",{enumerable:!0,get:o(function(){return E5.ApplicationErrorHandler},"get")})});var bn=y(T=>{"use strict";var T5=T&&T.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),Fi=T&&T.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&T5(e,r,t)};Object.defineProperty(T,"__esModule",{value:!0});T.ConstructExecutor=T.UnionExecutor=T.OptionalExecutor=T.FilterExecutor=T.BGPExecutor=T.AlgebraSerializer=T.AlgebraOptimizer=T.AlgebraTranslator=T.SPARQLParseError=T.SPARQLParser=T.NoteToRDFConverter=T.RDFVocabularyMapper=T.InMemoryTripleStore=T.RDFSerializer=T.FilenameValidator=T.EffortSortingHelpers=T.MetadataExtractor=T.MetadataHelpers=T.WikiLinkHelpers=T.DateFormatter=T.FrontmatterService=T.URIConstructionService=T.SessionEventService=T.AssetConversionService=T.PlanningService=T.AlgorithmExtractor=T.DynamicFrontmatterGenerator=T.TaskFrontmatterGenerator=T.FleetingNoteCreationService=T.SupervisionCreationService=T.StatusTimestampService=T.RenameToUidService=T.PropertyCleanupService=T.LoggingService=T.LabelToAliasService=T.FolderRepairService=T.EffortVotingService=T.EffortStatusWorkflow=T.ConceptCreationService=T.ClassCreationService=T.AreaHierarchyBuilder=T.AreaCreationService=T.TaskStatusService=T.ProjectCreationService=T.TaskCreationService=T.extractPropertyLabel=T.uriToPropertyName=T.propertyNameToUri=T.rangeToFieldType=T.PropertyFieldType=void 0;T.container=T.resetContainer=T.getContainer=T.createChildContainer=T.registerCoreServices=T.DI_TOKENS=T.FileAlreadyExistsError=T.FileNotFoundError=T.FilterContainsOptimizer=T.CaseWhenTransformerError=T.CaseWhenTransformer=T.QueryPlanCache=T.AggregateFunctions=T.BuiltInFunctions=T.SolutionMapping=T.QueryExecutor=T.DescribeExecutor=void 0;Fi(Bf(),T);Fi(Gf(),T);Fi(Dg(),T);Fi(kg(),T);Fi(Lg(),T);Fi(Vg(),T);Fi($g(),T);Fi(r0(),T);var Yy=n0();Object.defineProperty(T,"PropertyFieldType",{enumerable:!0,get:o(function(){return Yy.PropertyFieldType},"get")});Object.defineProperty(T,"rangeToFieldType",{enumerable:!0,get:o(function(){return Yy.rangeToFieldType},"get")});var bm=a0();Object.defineProperty(T,"propertyNameToUri",{enumerable:!0,get:o(function(){return bm.propertyNameToUri},"get")});Object.defineProperty(T,"uriToPropertyName",{enumerable:!0,get:o(function(){return bm.uriToPropertyName},"get")});Object.defineProperty(T,"extractPropertyLabel",{enumerable:!0,get:o(function(){return bm.extractPropertyLabel},"get")});var x5=ld();Object.defineProperty(T,"TaskCreationService",{enumerable:!0,get:o(function(){return x5.TaskCreationService},"get")});var A5=hd();Object.defineProperty(T,"ProjectCreationService",{enumerable:!0,get:o(function(){return A5.ProjectCreationService},"get")});var C5=gd();Object.defineProperty(T,"TaskStatusService",{enumerable:!0,get:o(function(){return C5.TaskStatusService},"get")});var O5=vd();Object.defineProperty(T,"AreaCreationService",{enumerable:!0,get:o(function(){return O5.AreaCreationService},"get")});var F5=Sd();Object.defineProperty(T,"AreaHierarchyBuilder",{enumerable:!0,get:o(function(){return F5.AreaHierarchyBuilder},"get")});var P5=bd();Object.defineProperty(T,"ClassCreationService",{enumerable:!0,get:o(function(){return P5.ClassCreationService},"get")});var R5=Td();Object.defineProperty(T,"ConceptCreationService",{enumerable:!0,get:o(function(){return R5.ConceptCreationService},"get")});var I5=cu();Object.defineProperty(T,"EffortStatusWorkflow",{enumerable:!0,get:o(function(){return I5.EffortStatusWorkflow},"get")});var D5=Ad();Object.defineProperty(T,"EffortVotingService",{enumerable:!0,get:o(function(){return D5.EffortVotingService},"get")});var N5=Od();Object.defineProperty(T,"FolderRepairService",{enumerable:!0,get:o(function(){return N5.FolderRepairService},"get")});var k5=Pd();Object.defineProperty(T,"LabelToAliasService",{enumerable:!0,get:o(function(){return k5.LabelToAliasService},"get")});var j5=Rd();Object.defineProperty(T,"LoggingService",{enumerable:!0,get:o(function(){return j5.LoggingService},"get")});var L5=Nd();Object.defineProperty(T,"PropertyCleanupService",{enumerable:!0,get:o(function(){return L5.PropertyCleanupService},"get")});var M5=jd();Object.defineProperty(T,"RenameToUidService",{enumerable:!0,get:o(function(){return M5.RenameToUidService},"get")});var V5=uu();Object.defineProperty(T,"StatusTimestampService",{enumerable:!0,get:o(function(){return V5.StatusTimestampService},"get")});var q5=Md();Object.defineProperty(T,"SupervisionCreationService",{enumerable:!0,get:o(function(){return q5.SupervisionCreationService},"get")});var $5=qd();Object.defineProperty(T,"FleetingNoteCreationService",{enumerable:!0,get:o(function(){return $5.FleetingNoteCreationService},"get")});var U5=ru();Object.defineProperty(T,"TaskFrontmatterGenerator",{enumerable:!0,get:o(function(){return U5.TaskFrontmatterGenerator},"get")});var B5=Ud();Object.defineProperty(T,"DynamicFrontmatterGenerator",{enumerable:!0,get:o(function(){return B5.DynamicFrontmatterGenerator},"get")});var G5=iu();Object.defineProperty(T,"AlgorithmExtractor",{enumerable:!0,get:o(function(){return G5.AlgorithmExtractor},"get")});var W5=Gd();Object.defineProperty(T,"PlanningService",{enumerable:!0,get:o(function(){return W5.PlanningService},"get")});var H5=Hd();Object.defineProperty(T,"AssetConversionService",{enumerable:!0,get:o(function(){return H5.AssetConversionService},"get")});var z5=Kd();Object.defineProperty(T,"SessionEventService",{enumerable:!0,get:o(function(){return z5.SessionEventService},"get")});var K5=Qd();Object.defineProperty(T,"URIConstructionService",{enumerable:!0,get:o(function(){return K5.URIConstructionService},"get")});var Y5=ks();Object.defineProperty(T,"FrontmatterService",{enumerable:!0,get:o(function(){return Y5.FrontmatterService},"get")});var Q5=gr();Object.defineProperty(T,"DateFormatter",{enumerable:!0,get:o(function(){return Q5.DateFormatter},"get")});var J5=Hn();Object.defineProperty(T,"WikiLinkHelpers",{enumerable:!0,get:o(function(){return J5.WikiLinkHelpers},"get")});var X5=Ur();Object.defineProperty(T,"MetadataHelpers",{enumerable:!0,get:o(function(){return X5.MetadataHelpers},"get")});var Z5=Xa();Object.defineProperty(T,"MetadataExtractor",{enumerable:!0,get:o(function(){return Z5.MetadataExtractor},"get")});var eF=N2();Object.defineProperty(T,"EffortSortingHelpers",{enumerable:!0,get:o(function(){return eF.EffortSortingHelpers},"get")});var tF=k2();Object.defineProperty(T,"FilenameValidator",{enumerable:!0,get:o(function(){return tF.FilenameValidator},"get")});var rF=U2();Object.defineProperty(T,"RDFSerializer",{enumerable:!0,get:o(function(){return rF.RDFSerializer},"get")});var iF=G2();Object.defineProperty(T,"InMemoryTripleStore",{enumerable:!0,get:o(function(){return iF.InMemoryTripleStore},"get")});var nF=gp();Object.defineProperty(T,"RDFVocabularyMapper",{enumerable:!0,get:o(function(){return nF.RDFVocabularyMapper},"get")});var sF=vp();Object.defineProperty(T,"NoteToRDFConverter",{enumerable:!0,get:o(function(){return sF.NoteToRDFConverter},"get")});var Qy=uy();Object.defineProperty(T,"SPARQLParser",{enumerable:!0,get:o(function(){return Qy.SPARQLParser},"get")});Object.defineProperty(T,"SPARQLParseError",{enumerable:!0,get:o(function(){return Qy.SPARQLParseError},"get")});var aF=ly();Object.defineProperty(T,"AlgebraTranslator",{enumerable:!0,get:o(function(){return aF.AlgebraTranslator},"get")});var oF=fy();Object.defineProperty(T,"AlgebraOptimizer",{enumerable:!0,get:o(function(){return oF.AlgebraOptimizer},"get")});var cF=hy();Object.defineProperty(T,"AlgebraSerializer",{enumerable:!0,get:o(function(){return cF.AlgebraSerializer},"get")});var uF=Up();Object.defineProperty(T,"BGPExecutor",{enumerable:!0,get:o(function(){return uF.BGPExecutor},"get")});var lF=Bu();Object.defineProperty(T,"FilterExecutor",{enumerable:!0,get:o(function(){return lF.FilterExecutor},"get")});var fF=zp();Object.defineProperty(T,"OptionalExecutor",{enumerable:!0,get:o(function(){return fF.OptionalExecutor},"get")});var hF=Yp();Object.defineProperty(T,"UnionExecutor",{enumerable:!0,get:o(function(){return hF.UnionExecutor},"get")});var dF=Jp();Object.defineProperty(T,"ConstructExecutor",{enumerable:!0,get:o(function(){return dF.ConstructExecutor},"get")});var pF=wy();Object.defineProperty(T,"DescribeExecutor",{enumerable:!0,get:o(function(){return pF.DescribeExecutor},"get")});var mF=Iy();Object.defineProperty(T,"QueryExecutor",{enumerable:!0,get:o(function(){return mF.QueryExecutor},"get")});var gF=Zi();Object.defineProperty(T,"SolutionMapping",{enumerable:!0,get:o(function(){return gF.SolutionMapping},"get")});var yF=Gp();Object.defineProperty(T,"BuiltInFunctions",{enumerable:!0,get:o(function(){return yF.BuiltInFunctions},"get")});var vF=Ny();Object.defineProperty(T,"AggregateFunctions",{enumerable:!0,get:o(function(){return vF.AggregateFunctions},"get")});var _F=ky();Object.defineProperty(T,"QueryPlanCache",{enumerable:!0,get:o(function(){return _F.QueryPlanCache},"get")});var Jy=Rp();Object.defineProperty(T,"CaseWhenTransformer",{enumerable:!0,get:o(function(){return Jy.CaseWhenTransformer},"get")});Object.defineProperty(T,"CaseWhenTransformerError",{enumerable:!0,get:o(function(){return Jy.CaseWhenTransformerError},"get")});var SF=kp();Object.defineProperty(T,"FilterContainsOptimizer",{enumerable:!0,get:o(function(){return SF.FilterContainsOptimizer},"get")});var Xy=jy();Object.defineProperty(T,"FileNotFoundError",{enumerable:!0,get:o(function(){return Xy.FileNotFoundError},"get")});Object.defineProperty(T,"FileAlreadyExistsError",{enumerable:!0,get:o(function(){return Xy.FileAlreadyExistsError},"get")});var wF=it();Object.defineProperty(T,"DI_TOKENS",{enumerable:!0,get:o(function(){return wF.DI_TOKENS},"get")});var uo=Ly();Object.defineProperty(T,"registerCoreServices",{enumerable:!0,get:o(function(){return uo.registerCoreServices},"get")});Object.defineProperty(T,"createChildContainer",{enumerable:!0,get:o(function(){return uo.createChildContainer},"get")});Object.defineProperty(T,"getContainer",{enumerable:!0,get:o(function(){return uo.getContainer},"get")});Object.defineProperty(T,"resetContainer",{enumerable:!0,get:o(function(){return uo.resetContainer},"get")});Object.defineProperty(T,"container",{enumerable:!0,get:o(function(){return uo.container},"get")});Fi(Hy(),T);Fi(Ky(),T)});var bt=y(Em=>{"use strict";Em.fromCallback=function(r){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")r.apply(this,e);else return new Promise((t,i)=>{e.push((n,s)=>n!=null?i(n):t(s)),r.apply(this,e)})},"name",{value:r.name})};Em.fromPromise=function(r){return Object.defineProperty(function(...e){let t=e[e.length-1];if(typeof t!="function")return r.apply(this,e);e.pop(),r.apply(this,e).then(i=>t(null,i),t)},"name",{value:r.name})}});var e3=y((OM,Zy)=>{var En=require("constants"),bF=process.cwd,fl=null,EF=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return fl||(fl=bF.call(process)),fl};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Tm=process.chdir,process.chdir=function(r){fl=null,Tm.call(process,r)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Tm));var Tm;Zy.exports=TF;function TF(r){En.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(r),r.lutimes||t(r),r.chown=s(r.chown),r.fchown=s(r.fchown),r.lchown=s(r.lchown),r.chmod=i(r.chmod),r.fchmod=i(r.fchmod),r.lchmod=i(r.lchmod),r.chownSync=a(r.chownSync),r.fchownSync=a(r.fchownSync),r.lchownSync=a(r.lchownSync),r.chmodSync=n(r.chmodSync),r.fchmodSync=n(r.fchmodSync),r.lchmodSync=n(r.lchmodSync),r.stat=c(r.stat),r.fstat=c(r.fstat),r.lstat=c(r.lstat),r.statSync=u(r.statSync),r.fstatSync=u(r.fstatSync),r.lstatSync=u(r.lstatSync),r.chmod&&!r.lchmod&&(r.lchmod=function(l,h,p){p&&process.nextTick(p)},r.lchmodSync=function(){}),r.chown&&!r.lchown&&(r.lchown=function(l,h,p,g){g&&process.nextTick(g)},r.lchownSync=function(){}),EF==="win32"&&(r.rename=typeof r.rename!="function"?r.rename:(function(l){function h(p,g,S){var _=Date.now(),A=0;l(p,g,o(function F(P){if(P&&(P.code==="EACCES"||P.code==="EPERM"||P.code==="EBUSY")&&Date.now()-_<6e4){setTimeout(function(){r.stat(g,function(j,B){j&&j.code==="ENOENT"?l(p,g,F):S(P)})},A),A<100&&(A+=10);return}S&&S(P)},"CB"))}return o(h,"rename"),Object.setPrototypeOf&&Object.setPrototypeOf(h,l),h})(r.rename)),r.read=typeof r.read!="function"?r.read:(function(l){function h(p,g,S,_,A,F){var P;if(F&&typeof F=="function"){var j=0;P=o(function(B,K,Ie){if(B&&B.code==="EAGAIN"&&j<10)return j++,l.call(r,p,g,S,_,A,P);F.apply(this,arguments)},"callback")}return l.call(r,p,g,S,_,A,P)}return o(h,"read"),Object.setPrototypeOf&&Object.setPrototypeOf(h,l),h})(r.read),r.readSync=typeof r.readSync!="function"?r.readSync:(function(l){return function(h,p,g,S,_){for(var A=0;;)try{return l.call(r,h,p,g,S,_)}catch(F){if(F.code==="EAGAIN"&&A<10){A++;continue}throw F}}})(r.readSync);function e(l){l.lchmod=function(h,p,g){l.open(h,En.O_WRONLY|En.O_SYMLINK,p,function(S,_){if(S){g&&g(S);return}l.fchmod(_,p,function(A){l.close(_,function(F){g&&g(A||F)})})})},l.lchmodSync=function(h,p){var g=l.openSync(h,En.O_WRONLY|En.O_SYMLINK,p),S=!0,_;try{_=l.fchmodSync(g,p),S=!1}finally{if(S)try{l.closeSync(g)}catch{}else l.closeSync(g)}return _}}o(e,"patchLchmod");function t(l){En.hasOwnProperty("O_SYMLINK")&&l.futimes?(l.lutimes=function(h,p,g,S){l.open(h,En.O_SYMLINK,function(_,A){if(_){S&&S(_);return}l.futimes(A,p,g,function(F){l.close(A,function(P){S&&S(F||P)})})})},l.lutimesSync=function(h,p,g){var S=l.openSync(h,En.O_SYMLINK),_,A=!0;try{_=l.futimesSync(S,p,g),A=!1}finally{if(A)try{l.closeSync(S)}catch{}else l.closeSync(S)}return _}):l.futimes&&(l.lutimes=function(h,p,g,S){S&&process.nextTick(S)},l.lutimesSync=function(){})}o(t,"patchLutimes");function i(l){return l&&function(h,p,g){return l.call(r,h,p,function(S){f(S)&&(S=null),g&&g.apply(this,arguments)})}}o(i,"chmodFix");function n(l){return l&&function(h,p){try{return l.call(r,h,p)}catch(g){if(!f(g))throw g}}}o(n,"chmodFixSync");function s(l){return l&&function(h,p,g,S){return l.call(r,h,p,g,function(_){f(_)&&(_=null),S&&S.apply(this,arguments)})}}o(s,"chownFix");function a(l){return l&&function(h,p,g){try{return l.call(r,h,p,g)}catch(S){if(!f(S))throw S}}}o(a,"chownFixSync");function c(l){return l&&function(h,p,g){typeof p=="function"&&(g=p,p=null);function S(_,A){A&&(A.uid<0&&(A.uid+=4294967296),A.gid<0&&(A.gid+=4294967296)),g&&g.apply(this,arguments)}return o(S,"callback"),p?l.call(r,h,p,S):l.call(r,h,S)}}o(c,"statFix");function u(l){return l&&function(h,p){var g=p?l.call(r,h,p):l.call(r,h);return g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),g}}o(u,"statFixSync");function f(l){if(!l||l.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(l.code==="EINVAL"||l.code==="EPERM"))}o(f,"chownErOk")}o(TF,"patch")});var i3=y((PM,r3)=>{var t3=require("stream").Stream;r3.exports=xF;function xF(r){return{ReadStream:e,WriteStream:t};function e(i,n){if(!(this instanceof e))return new e(i,n);t3.call(this);var s=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var a=Object.keys(n),c=0,u=a.length;c<u;c++){var f=a[c];this[f]=n[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}r.open(this.path,this.flags,this.mode,function(l,h){if(l){s.emit("error",l),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function t(i,n){if(!(this instanceof t))return new t(i,n);t3.call(this),this.path=i,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),a=0,c=s.length;a<c;a++){var u=s[a];this[u]=n[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=r.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}o(xF,"legacy")});var s3=y((IM,n3)=>{"use strict";n3.exports=CF;var AF=Object.getPrototypeOf||function(r){return r.__proto__};function CF(r){if(r===null||typeof r!="object")return r;if(r instanceof Object)var e={__proto__:AF(r)};else var e=Object.create(null);return Object.getOwnPropertyNames(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}),e}o(CF,"clone")});var na=y((NM,Cm)=>{var nt=require("fs"),OF=e3(),FF=i3(),PF=s3(),hl=require("util"),Nt,pl;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Nt=Symbol.for("graceful-fs.queue"),pl=Symbol.for("graceful-fs.previous")):(Nt="___graceful-fs.queue",pl="___graceful-fs.previous");function RF(){}o(RF,"noop");function c3(r,e){Object.defineProperty(r,Nt,{get:o(function(){return e},"get")})}o(c3,"publishQueue");var hs=RF;hl.debuglog?hs=hl.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(hs=o(function(){var r=hl.format.apply(hl,arguments);r="GFS4: "+r.split(/\n/).join(`
GFS4: `),console.error(r)},"debug"));nt[Nt]||(a3=global[Nt]||[],c3(nt,a3),nt.close=(function(r){function e(t,i){return r.call(nt,t,function(n){n||o3(),typeof i=="function"&&i.apply(this,arguments)})}return o(e,"close"),Object.defineProperty(e,pl,{value:r}),e})(nt.close),nt.closeSync=(function(r){function e(t){r.apply(nt,arguments),o3()}return o(e,"closeSync"),Object.defineProperty(e,pl,{value:r}),e})(nt.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){hs(nt[Nt]),require("assert").equal(nt[Nt].length,0)}));var a3;global[Nt]||c3(global,nt[Nt]);Cm.exports=xm(PF(nt));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!nt.__patched&&(Cm.exports=xm(nt),nt.__patched=!0);function xm(r){OF(r),r.gracefulify=xm,r.createReadStream=K,r.createWriteStream=Ie;var e=r.readFile;r.readFile=t;function t($,ce,Pe){return typeof ce=="function"&&(Pe=ce,ce=null),Ze($,ce,Pe);function Ze(We,ze,Ne,ke){return e(We,ze,function(Re){Re&&(Re.code==="EMFILE"||Re.code==="ENFILE")?ia([Ze,[We,ze,Ne],Re,ke||Date.now(),Date.now()]):typeof Ne=="function"&&Ne.apply(this,arguments)})}o(Ze,"go$readFile")}o(t,"readFile");var i=r.writeFile;r.writeFile=n;function n($,ce,Pe,Ze){return typeof Pe=="function"&&(Ze=Pe,Pe=null),We($,ce,Pe,Ze);function We(ze,Ne,ke,Re,W){return i(ze,Ne,ke,function(D){D&&(D.code==="EMFILE"||D.code==="ENFILE")?ia([We,[ze,Ne,ke,Re],D,W||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(We,"go$writeFile")}o(n,"writeFile");var s=r.appendFile;s&&(r.appendFile=a);function a($,ce,Pe,Ze){return typeof Pe=="function"&&(Ze=Pe,Pe=null),We($,ce,Pe,Ze);function We(ze,Ne,ke,Re,W){return s(ze,Ne,ke,function(D){D&&(D.code==="EMFILE"||D.code==="ENFILE")?ia([We,[ze,Ne,ke,Re],D,W||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(We,"go$appendFile")}o(a,"appendFile");var c=r.copyFile;c&&(r.copyFile=u);function u($,ce,Pe,Ze){return typeof Pe=="function"&&(Ze=Pe,Pe=0),We($,ce,Pe,Ze);function We(ze,Ne,ke,Re,W){return c(ze,Ne,ke,function(D){D&&(D.code==="EMFILE"||D.code==="ENFILE")?ia([We,[ze,Ne,ke,Re],D,W||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(We,"go$copyFile")}o(u,"copyFile");var f=r.readdir;r.readdir=h;var l=/^v[0-5]\./;function h($,ce,Pe){typeof ce=="function"&&(Pe=ce,ce=null);var Ze=l.test(process.version)?o(function(Ne,ke,Re,W){return f(Ne,We(Ne,ke,Re,W))},"go$readdir"):o(function(Ne,ke,Re,W){return f(Ne,ke,We(Ne,ke,Re,W))},"go$readdir");return Ze($,ce,Pe);function We(ze,Ne,ke,Re){return function(W,D){W&&(W.code==="EMFILE"||W.code==="ENFILE")?ia([Ze,[ze,Ne,ke],W,Re||Date.now(),Date.now()]):(D&&D.sort&&D.sort(),typeof ke=="function"&&ke.call(this,W,D))}}}if(o(h,"readdir"),process.version.substr(0,4)==="v0.8"){var p=FF(r);F=p.ReadStream,j=p.WriteStream}var g=r.ReadStream;g&&(F.prototype=Object.create(g.prototype),F.prototype.open=P);var S=r.WriteStream;S&&(j.prototype=Object.create(S.prototype),j.prototype.open=B),Object.defineProperty(r,"ReadStream",{get:o(function(){return F},"get"),set:o(function($){F=$},"set"),enumerable:!0,configurable:!0}),Object.defineProperty(r,"WriteStream",{get:o(function(){return j},"get"),set:o(function($){j=$},"set"),enumerable:!0,configurable:!0});var _=F;Object.defineProperty(r,"FileReadStream",{get:o(function(){return _},"get"),set:o(function($){_=$},"set"),enumerable:!0,configurable:!0});var A=j;Object.defineProperty(r,"FileWriteStream",{get:o(function(){return A},"get"),set:o(function($){A=$},"set"),enumerable:!0,configurable:!0});function F($,ce){return this instanceof F?(g.apply(this,arguments),this):F.apply(Object.create(F.prototype),arguments)}o(F,"ReadStream");function P(){var $=this;ot($.path,$.flags,$.mode,function(ce,Pe){ce?($.autoClose&&$.destroy(),$.emit("error",ce)):($.fd=Pe,$.emit("open",Pe),$.read())})}o(P,"ReadStream$open");function j($,ce){return this instanceof j?(S.apply(this,arguments),this):j.apply(Object.create(j.prototype),arguments)}o(j,"WriteStream");function B(){var $=this;ot($.path,$.flags,$.mode,function(ce,Pe){ce?($.destroy(),$.emit("error",ce)):($.fd=Pe,$.emit("open",Pe))})}o(B,"WriteStream$open");function K($,ce){return new r.ReadStream($,ce)}o(K,"createReadStream");function Ie($,ce){return new r.WriteStream($,ce)}o(Ie,"createWriteStream");var Xe=r.open;r.open=ot;function ot($,ce,Pe,Ze){return typeof Pe=="function"&&(Ze=Pe,Pe=null),We($,ce,Pe,Ze);function We(ze,Ne,ke,Re,W){return Xe(ze,Ne,ke,function(D,je){D&&(D.code==="EMFILE"||D.code==="ENFILE")?ia([We,[ze,Ne,ke,Re],D,W||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(We,"go$open")}return o(ot,"open"),r}o(xm,"patch");function ia(r){hs("ENQUEUE",r[0].name,r[1]),nt[Nt].push(r),Am()}o(ia,"enqueue");var dl;function o3(){for(var r=Date.now(),e=0;e<nt[Nt].length;++e)nt[Nt][e].length>2&&(nt[Nt][e][3]=r,nt[Nt][e][4]=r);Am()}o(o3,"resetQueue");function Am(){if(clearTimeout(dl),dl=void 0,nt[Nt].length!==0){var r=nt[Nt].shift(),e=r[0],t=r[1],i=r[2],n=r[3],s=r[4];if(n===void 0)hs("RETRY",e.name,t),e.apply(null,t);else if(Date.now()-n>=6e4){hs("TIMEOUT",e.name,t);var a=t.pop();typeof a=="function"&&a.call(null,i)}else{var c=Date.now()-s,u=Math.max(s-n,1),f=Math.min(u*1.2,100);c>=f?(hs("RETRY",e.name,t),e.apply(null,t.concat([n]))):nt[Nt].push(r)}dl===void 0&&(dl=setTimeout(Am,0))}}o(Am,"retry")});var rr=y(tn=>{"use strict";var u3=bt().fromCallback,tr=na(),IF=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter(r=>typeof tr[r]=="function");Object.assign(tn,tr);IF.forEach(r=>{tn[r]=u3(tr[r])});tn.exists=function(r,e){return typeof e=="function"?tr.exists(r,e):new Promise(t=>tr.exists(r,t))};tn.read=function(r,e,t,i,n,s){return typeof s=="function"?tr.read(r,e,t,i,n,s):new Promise((a,c)=>{tr.read(r,e,t,i,n,(u,f,l)=>{if(u)return c(u);a({bytesRead:f,buffer:l})})})};tn.write=function(r,e,...t){return typeof t[t.length-1]=="function"?tr.write(r,e,...t):new Promise((i,n)=>{tr.write(r,e,...t,(s,a,c)=>{if(s)return n(s);i({bytesWritten:a,buffer:c})})})};tn.readv=function(r,e,...t){return typeof t[t.length-1]=="function"?tr.readv(r,e,...t):new Promise((i,n)=>{tr.readv(r,e,...t,(s,a,c)=>{if(s)return n(s);i({bytesRead:a,buffers:c})})})};tn.writev=function(r,e,...t){return typeof t[t.length-1]=="function"?tr.writev(r,e,...t):new Promise((i,n)=>{tr.writev(r,e,...t,(s,a,c)=>{if(s)return n(s);i({bytesWritten:a,buffers:c})})})};typeof tr.realpath.native=="function"?tn.realpath.native=u3(tr.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var f3=y((LM,l3)=>{"use strict";var DF=require("path");l3.exports.checkPath=o(function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(DF.parse(e).root,""))){let i=new Error(`Path contains invalid characters: ${e}`);throw i.code="EINVAL",i}},"checkPath")});var m3=y((VM,Om)=>{"use strict";var h3=rr(),{checkPath:d3}=f3(),p3=o(r=>{let e={mode:511};return typeof r=="number"?r:{...e,...r}.mode},"getMode");Om.exports.makeDir=async(r,e)=>(d3(r),h3.mkdir(r,{mode:p3(e),recursive:!0}));Om.exports.makeDirSync=(r,e)=>(d3(r),h3.mkdirSync(r,{mode:p3(e),recursive:!0}))});var ci=y(($M,g3)=>{"use strict";var NF=bt().fromPromise,{makeDir:kF,makeDirSync:Fm}=m3(),Pm=NF(kF);g3.exports={mkdirs:Pm,mkdirsSync:Fm,mkdirp:Pm,mkdirpSync:Fm,ensureDir:Pm,ensureDirSync:Fm}});var Tn=y((UM,v3)=>{"use strict";var jF=bt().fromPromise,y3=rr();function LF(r){return y3.access(r).then(()=>!0).catch(()=>!1)}o(LF,"pathExists");v3.exports={pathExists:jF(LF),pathExistsSync:y3.existsSync}});var Rm=y((GM,_3)=>{"use strict";var sa=rr(),MF=bt().fromPromise;async function VF(r,e,t){let i=await sa.open(r,"r+"),n=null;try{await sa.futimes(i,e,t)}finally{try{await sa.close(i)}catch(s){n=s}}if(n)throw n}o(VF,"utimesMillis");function qF(r,e,t){let i=sa.openSync(r,"r+");return sa.futimesSync(i,e,t),sa.closeSync(i)}o(qF,"utimesMillisSync");_3.exports={utimesMillis:MF(VF),utimesMillisSync:qF}});var ds=y((HM,E3)=>{"use strict";var aa=rr(),Et=require("path"),S3=bt().fromPromise;function $F(r,e,t){let i=t.dereference?n=>aa.stat(n,{bigint:!0}):n=>aa.lstat(n,{bigint:!0});return Promise.all([i(r),i(e).catch(n=>{if(n.code==="ENOENT")return null;throw n})]).then(([n,s])=>({srcStat:n,destStat:s}))}o($F,"getStats");function UF(r,e,t){let i,n=t.dereference?a=>aa.statSync(a,{bigint:!0}):a=>aa.lstatSync(a,{bigint:!0}),s=n(r);try{i=n(e)}catch(a){if(a.code==="ENOENT")return{srcStat:s,destStat:null};throw a}return{srcStat:s,destStat:i}}o(UF,"getStatsSync");async function BF(r,e,t,i){let{srcStat:n,destStat:s}=await $F(r,e,i);if(s){if(lo(n,s)){let a=Et.basename(r),c=Et.basename(e);if(t==="move"&&a!==c&&a.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${r}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${r}'.`)}if(n.isDirectory()&&Im(r,e))throw new Error(ml(r,e,t));return{srcStat:n,destStat:s}}o(BF,"checkPaths");function GF(r,e,t,i){let{srcStat:n,destStat:s}=UF(r,e,i);if(s){if(lo(n,s)){let a=Et.basename(r),c=Et.basename(e);if(t==="move"&&a!==c&&a.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${r}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${r}'.`)}if(n.isDirectory()&&Im(r,e))throw new Error(ml(r,e,t));return{srcStat:n,destStat:s}}o(GF,"checkPathsSync");async function w3(r,e,t,i){let n=Et.resolve(Et.dirname(r)),s=Et.resolve(Et.dirname(t));if(s===n||s===Et.parse(s).root)return;let a;try{a=await aa.stat(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(lo(e,a))throw new Error(ml(r,t,i));return w3(r,e,s,i)}o(w3,"checkParentPaths");function b3(r,e,t,i){let n=Et.resolve(Et.dirname(r)),s=Et.resolve(Et.dirname(t));if(s===n||s===Et.parse(s).root)return;let a;try{a=aa.statSync(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(lo(e,a))throw new Error(ml(r,t,i));return b3(r,e,s,i)}o(b3,"checkParentPathsSync");function lo(r,e){return e.ino!==void 0&&e.dev!==void 0&&e.ino===r.ino&&e.dev===r.dev}o(lo,"areIdentical");function Im(r,e){let t=Et.resolve(r).split(Et.sep).filter(n=>n),i=Et.resolve(e).split(Et.sep).filter(n=>n);return t.every((n,s)=>i[s]===n)}o(Im,"isSrcSubdir");function ml(r,e,t){return`Cannot ${t} '${r}' to a subdirectory of itself, '${e}'.`}o(ml,"errMsg");E3.exports={checkPaths:S3(BF),checkPathsSync:GF,checkParentPaths:S3(w3),checkParentPathsSync:b3,isSrcSubdir:Im,areIdentical:lo}});var x3=y((KM,T3)=>{"use strict";async function WF(r,e){let t=[];for await(let i of r)t.push(e(i).then(()=>null,n=>n??new Error("unknown error")));await Promise.all(t.map(i=>i.then(n=>{if(n!==null)throw n})))}o(WF,"asyncIteratorConcurrentProcess");T3.exports={asyncIteratorConcurrentProcess:WF}});var P3=y((QM,F3)=>{"use strict";var Ut=rr(),fo=require("path"),{mkdirs:HF}=ci(),{pathExists:zF}=Tn(),{utimesMillis:KF}=Rm(),ho=ds(),{asyncIteratorConcurrentProcess:YF}=x3();async function QF(r,e,t={}){typeof t=="function"&&(t={filter:t}),t.clobber="clobber"in t?!!t.clobber:!0,t.overwrite="overwrite"in t?!!t.overwrite:t.clobber,t.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:i,destStat:n}=await ho.checkPaths(r,e,"copy",t);if(await ho.checkParentPaths(r,i,e,"copy"),!await C3(r,e,t))return;let a=fo.dirname(e);await zF(a)||await HF(a),await O3(n,r,e,t)}o(QF,"copy");async function C3(r,e,t){return t.filter?t.filter(r,e):!0}o(C3,"runFilter");async function O3(r,e,t,i){let s=await(i.dereference?Ut.stat:Ut.lstat)(e);if(s.isDirectory())return e9(s,r,e,t,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return JF(s,r,e,t,i);if(s.isSymbolicLink())return t9(r,e,t,i);throw s.isSocket()?new Error(`Cannot copy a socket file: ${e}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}o(O3,"getStatsAndPerformCopy");async function JF(r,e,t,i,n){if(!e)return A3(r,t,i,n);if(n.overwrite)return await Ut.unlink(i),A3(r,t,i,n);if(n.errorOnExist)throw new Error(`'${i}' already exists`)}o(JF,"onFile");async function A3(r,e,t,i){if(await Ut.copyFile(e,t),i.preserveTimestamps){XF(r.mode)&&await ZF(t,r.mode);let n=await Ut.stat(e);await KF(t,n.atime,n.mtime)}return Ut.chmod(t,r.mode)}o(A3,"copyFile");function XF(r){return(r&128)===0}o(XF,"fileIsNotWritable");function ZF(r,e){return Ut.chmod(r,e|128)}o(ZF,"makeFileWritable");async function e9(r,e,t,i,n){e||await Ut.mkdir(i),await YF(await Ut.opendir(t),async s=>{let a=fo.join(t,s.name),c=fo.join(i,s.name);if(await C3(a,c,n)){let{destStat:f}=await ho.checkPaths(a,c,"copy",n);await O3(f,a,c,n)}}),e||await Ut.chmod(i,r.mode)}o(e9,"onDir");async function t9(r,e,t,i){let n=await Ut.readlink(e);if(i.dereference&&(n=fo.resolve(process.cwd(),n)),!r)return Ut.symlink(n,t);let s=null;try{s=await Ut.readlink(t)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return Ut.symlink(n,t);throw a}if(i.dereference&&(s=fo.resolve(process.cwd(),s)),ho.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(ho.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return await Ut.unlink(t),Ut.symlink(n,t)}o(t9,"onLink");F3.exports=QF});var k3=y((XM,N3)=>{"use strict";var ir=na(),po=require("path"),r9=ci().mkdirsSync,i9=Rm().utimesMillisSync,mo=ds();function n9(r,e,t){typeof t=="function"&&(t={filter:t}),t=t||{},t.clobber="clobber"in t?!!t.clobber:!0,t.overwrite="overwrite"in t?!!t.overwrite:t.clobber,t.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:i,destStat:n}=mo.checkPathsSync(r,e,"copy",t);if(mo.checkParentPathsSync(r,i,e,"copy"),t.filter&&!t.filter(r,e))return;let s=po.dirname(e);return ir.existsSync(s)||r9(s),R3(n,r,e,t)}o(n9,"copySync");function R3(r,e,t,i){let s=(i.dereference?ir.statSync:ir.lstatSync)(e);if(s.isDirectory())return f9(s,r,e,t,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return s9(s,r,e,t,i);if(s.isSymbolicLink())return p9(r,e,t,i);throw s.isSocket()?new Error(`Cannot copy a socket file: ${e}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}o(R3,"getStats");function s9(r,e,t,i,n){return e?a9(r,t,i,n):I3(r,t,i,n)}o(s9,"onFile");function a9(r,e,t,i){if(i.overwrite)return ir.unlinkSync(t),I3(r,e,t,i);if(i.errorOnExist)throw new Error(`'${t}' already exists`)}o(a9,"mayCopyFile");function I3(r,e,t,i){return ir.copyFileSync(e,t),i.preserveTimestamps&&o9(r.mode,e,t),Dm(t,r.mode)}o(I3,"copyFile");function o9(r,e,t){return c9(r)&&u9(t,r),l9(e,t)}o(o9,"handleTimestamps");function c9(r){return(r&128)===0}o(c9,"fileIsNotWritable");function u9(r,e){return Dm(r,e|128)}o(u9,"makeFileWritable");function Dm(r,e){return ir.chmodSync(r,e)}o(Dm,"setDestMode");function l9(r,e){let t=ir.statSync(r);return i9(e,t.atime,t.mtime)}o(l9,"setDestTimestamps");function f9(r,e,t,i,n){return e?D3(t,i,n):h9(r.mode,t,i,n)}o(f9,"onDir");function h9(r,e,t,i){return ir.mkdirSync(t),D3(e,t,i),Dm(t,r)}o(h9,"mkDirAndCopy");function D3(r,e,t){let i=ir.opendirSync(r);try{let n;for(;(n=i.readSync())!==null;)d9(n.name,r,e,t)}finally{i.closeSync()}}o(D3,"copyDir");function d9(r,e,t,i){let n=po.join(e,r),s=po.join(t,r);if(i.filter&&!i.filter(n,s))return;let{destStat:a}=mo.checkPathsSync(n,s,"copy",i);return R3(a,n,s,i)}o(d9,"copyDirItem");function p9(r,e,t,i){let n=ir.readlinkSync(e);if(i.dereference&&(n=po.resolve(process.cwd(),n)),r){let s;try{s=ir.readlinkSync(t)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return ir.symlinkSync(n,t);throw a}if(i.dereference&&(s=po.resolve(process.cwd(),s)),mo.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(mo.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return m9(n,t)}else return ir.symlinkSync(n,t)}o(p9,"onLink");function m9(r,e){return ir.unlinkSync(e),ir.symlinkSync(r,e)}o(m9,"copyLink");N3.exports=n9});var gl=y((eV,j3)=>{"use strict";var g9=bt().fromPromise;j3.exports={copy:g9(P3()),copySync:k3()}});var go=y((tV,M3)=>{"use strict";var L3=na(),y9=bt().fromCallback;function v9(r,e){L3.rm(r,{recursive:!0,force:!0},e)}o(v9,"remove");function _9(r){L3.rmSync(r,{recursive:!0,force:!0})}o(_9,"removeSync");M3.exports={remove:y9(v9),removeSync:_9}});var H3=y((iV,W3)=>{"use strict";var S9=bt().fromPromise,$3=rr(),U3=require("path"),B3=ci(),G3=go(),V3=S9(o(async function(e){let t;try{t=await $3.readdir(e)}catch{return B3.mkdirs(e)}return Promise.all(t.map(i=>G3.remove(U3.join(e,i))))},"emptyDir"));function q3(r){let e;try{e=$3.readdirSync(r)}catch{return B3.mkdirsSync(r)}e.forEach(t=>{t=U3.join(r,t),G3.removeSync(t)})}o(q3,"emptyDirSync");W3.exports={emptyDirSync:q3,emptydirSync:q3,emptyDir:V3,emptydir:V3}});var Q3=y((sV,Y3)=>{"use strict";var w9=bt().fromPromise,z3=require("path"),rn=rr(),K3=ci();async function b9(r){let e;try{e=await rn.stat(r)}catch{}if(e&&e.isFile())return;let t=z3.dirname(r),i=null;try{i=await rn.stat(t)}catch(n){if(n.code==="ENOENT"){await K3.mkdirs(t),await rn.writeFile(r,"");return}else throw n}i.isDirectory()?await rn.writeFile(r,""):await rn.readdir(t)}o(b9,"createFile");function E9(r){let e;try{e=rn.statSync(r)}catch{}if(e&&e.isFile())return;let t=z3.dirname(r);try{rn.statSync(t).isDirectory()||rn.readdirSync(t)}catch(i){if(i&&i.code==="ENOENT")K3.mkdirsSync(t);else throw i}rn.writeFileSync(r,"")}o(E9,"createFileSync");Y3.exports={createFile:w9(b9),createFileSync:E9}});var tv=y((oV,ev)=>{"use strict";var T9=bt().fromPromise,J3=require("path"),xn=rr(),X3=ci(),{pathExists:x9}=Tn(),{areIdentical:Z3}=ds();async function A9(r,e){let t;try{t=await xn.lstat(e)}catch{}let i;try{i=await xn.lstat(r)}catch(a){throw a.message=a.message.replace("lstat","ensureLink"),a}if(t&&Z3(i,t))return;let n=J3.dirname(e);await x9(n)||await X3.mkdirs(n),await xn.link(r,e)}o(A9,"createLink");function C9(r,e){let t;try{t=xn.lstatSync(e)}catch{}try{let s=xn.lstatSync(r);if(t&&Z3(s,t))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let i=J3.dirname(e);return xn.existsSync(i)||X3.mkdirsSync(i),xn.linkSync(r,e)}o(C9,"createLinkSync");ev.exports={createLink:T9(A9),createLinkSync:C9}});var iv=y((uV,rv)=>{"use strict";var An=require("path"),yo=rr(),{pathExists:O9}=Tn(),F9=bt().fromPromise;async function P9(r,e){if(An.isAbsolute(r)){try{await yo.lstat(r)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:r,toDst:r}}let t=An.dirname(e),i=An.join(t,r);if(await O9(i))return{toCwd:i,toDst:r};try{await yo.lstat(r)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:r,toDst:An.relative(t,r)}}o(P9,"symlinkPaths");function R9(r,e){if(An.isAbsolute(r)){if(!yo.existsSync(r))throw new Error("absolute srcpath does not exist");return{toCwd:r,toDst:r}}let t=An.dirname(e),i=An.join(t,r);if(yo.existsSync(i))return{toCwd:i,toDst:r};if(!yo.existsSync(r))throw new Error("relative srcpath does not exist");return{toCwd:r,toDst:An.relative(t,r)}}o(R9,"symlinkPathsSync");rv.exports={symlinkPaths:F9(P9),symlinkPathsSync:R9}});var av=y((fV,sv)=>{"use strict";var nv=rr(),I9=bt().fromPromise;async function D9(r,e){if(e)return e;let t;try{t=await nv.lstat(r)}catch{return"file"}return t&&t.isDirectory()?"dir":"file"}o(D9,"symlinkType");function N9(r,e){if(e)return e;let t;try{t=nv.lstatSync(r)}catch{return"file"}return t&&t.isDirectory()?"dir":"file"}o(N9,"symlinkTypeSync");sv.exports={symlinkType:I9(D9),symlinkTypeSync:N9}});var lv=y((dV,uv)=>{"use strict";var k9=bt().fromPromise,ov=require("path"),Pi=rr(),{mkdirs:j9,mkdirsSync:L9}=ci(),{symlinkPaths:M9,symlinkPathsSync:V9}=iv(),{symlinkType:q9,symlinkTypeSync:$9}=av(),{pathExists:U9}=Tn(),{areIdentical:cv}=ds();async function B9(r,e,t){let i;try{i=await Pi.lstat(e)}catch{}if(i&&i.isSymbolicLink()){let[c,u]=await Promise.all([Pi.stat(r),Pi.stat(e)]);if(cv(c,u))return}let n=await M9(r,e);r=n.toDst;let s=await q9(n.toCwd,t),a=ov.dirname(e);return await U9(a)||await j9(a),Pi.symlink(r,e,s)}o(B9,"createSymlink");function G9(r,e,t){let i;try{i=Pi.lstatSync(e)}catch{}if(i&&i.isSymbolicLink()){let c=Pi.statSync(r),u=Pi.statSync(e);if(cv(c,u))return}let n=V9(r,e);r=n.toDst,t=$9(n.toCwd,t);let s=ov.dirname(e);return Pi.existsSync(s)||L9(s),Pi.symlinkSync(r,e,t)}o(G9,"createSymlinkSync");uv.exports={createSymlink:k9(B9),createSymlinkSync:G9}});var vv=y((mV,yv)=>{"use strict";var{createFile:fv,createFileSync:hv}=Q3(),{createLink:dv,createLinkSync:pv}=tv(),{createSymlink:mv,createSymlinkSync:gv}=lv();yv.exports={createFile:fv,createFileSync:hv,ensureFile:fv,ensureFileSync:hv,createLink:dv,createLinkSync:pv,ensureLink:dv,ensureLinkSync:pv,createSymlink:mv,createSymlinkSync:gv,ensureSymlink:mv,ensureSymlinkSync:gv}});var yl=y((gV,_v)=>{function W9(r,{EOL:e=`
`,finalEOL:t=!0,replacer:i=null,spaces:n}={}){let s=t?e:"";return JSON.stringify(r,i,n).replace(/\n/g,e)+s}o(W9,"stringify");function H9(r){return Buffer.isBuffer(r)&&(r=r.toString("utf8")),r.replace(/^\uFEFF/,"")}o(H9,"stripBom");_v.exports={stringify:W9,stripBom:H9}});var Ev=y((vV,bv)=>{var oa;try{oa=na()}catch{oa=require("fs")}var vl=bt(),{stringify:Sv,stripBom:wv}=yl();async function z9(r,e={}){typeof e=="string"&&(e={encoding:e});let t=e.fs||oa,i="throws"in e?e.throws:!0,n=await vl.fromCallback(t.readFile)(r,e);n=wv(n);let s;try{s=JSON.parse(n,e?e.reviver:null)}catch(a){if(i)throw a.message=`${r}: ${a.message}`,a;return null}return s}o(z9,"_readFile");var K9=vl.fromPromise(z9);function Y9(r,e={}){typeof e=="string"&&(e={encoding:e});let t=e.fs||oa,i="throws"in e?e.throws:!0;try{let n=t.readFileSync(r,e);return n=wv(n),JSON.parse(n,e.reviver)}catch(n){if(i)throw n.message=`${r}: ${n.message}`,n;return null}}o(Y9,"readFileSync");async function Q9(r,e,t={}){let i=t.fs||oa,n=Sv(e,t);await vl.fromCallback(i.writeFile)(r,n,t)}o(Q9,"_writeFile");var J9=vl.fromPromise(Q9);function X9(r,e,t={}){let i=t.fs||oa,n=Sv(e,t);return i.writeFileSync(r,n,t)}o(X9,"writeFileSync");bv.exports={readFile:K9,readFileSync:Y9,writeFile:J9,writeFileSync:X9}});var xv=y((SV,Tv)=>{"use strict";var _l=Ev();Tv.exports={readJson:_l.readFile,readJsonSync:_l.readFileSync,writeJson:_l.writeFile,writeJsonSync:_l.writeFileSync}});var Sl=y((wV,Ov)=>{"use strict";var Z9=bt().fromPromise,Nm=rr(),Av=require("path"),Cv=ci(),eP=Tn().pathExists;async function tP(r,e,t="utf-8"){let i=Av.dirname(r);return await eP(i)||await Cv.mkdirs(i),Nm.writeFile(r,e,t)}o(tP,"outputFile");function rP(r,...e){let t=Av.dirname(r);Nm.existsSync(t)||Cv.mkdirsSync(t),Nm.writeFileSync(r,...e)}o(rP,"outputFileSync");Ov.exports={outputFile:Z9(tP),outputFileSync:rP}});var Pv=y((EV,Fv)=>{"use strict";var{stringify:iP}=yl(),{outputFile:nP}=Sl();async function sP(r,e,t={}){let i=iP(e,t);await nP(r,i,t)}o(sP,"outputJson");Fv.exports=sP});var Iv=y((xV,Rv)=>{"use strict";var{stringify:aP}=yl(),{outputFileSync:oP}=Sl();function cP(r,e,t){let i=aP(e,t);oP(r,i,t)}o(cP,"outputJsonSync");Rv.exports=cP});var Nv=y((CV,Dv)=>{"use strict";var uP=bt().fromPromise,nr=xv();nr.outputJson=uP(Pv());nr.outputJsonSync=Iv();nr.outputJSON=nr.outputJson;nr.outputJSONSync=nr.outputJsonSync;nr.writeJSON=nr.writeJson;nr.writeJSONSync=nr.writeJsonSync;nr.readJSON=nr.readJson;nr.readJSONSync=nr.readJsonSync;Dv.exports=nr});var Vv=y((OV,Mv)=>{"use strict";var lP=rr(),kv=require("path"),{copy:fP}=gl(),{remove:Lv}=go(),{mkdirp:hP}=ci(),{pathExists:dP}=Tn(),jv=ds();async function pP(r,e,t={}){let i=t.overwrite||t.clobber||!1,{srcStat:n,isChangingCase:s=!1}=await jv.checkPaths(r,e,"move",t);await jv.checkParentPaths(r,n,e,"move");let a=kv.dirname(e);return kv.parse(a).root!==a&&await hP(a),mP(r,e,i,s)}o(pP,"move");async function mP(r,e,t,i){if(!i){if(t)await Lv(e);else if(await dP(e))throw new Error("dest already exists.")}try{await lP.rename(r,e)}catch(n){if(n.code!=="EXDEV")throw n;await gP(r,e,t)}}o(mP,"doRename");async function gP(r,e,t){return await fP(r,e,{overwrite:t,errorOnExist:!0,preserveTimestamps:!0}),Lv(r)}o(gP,"moveAcrossDevice");Mv.exports=pP});var Gv=y((PV,Bv)=>{"use strict";var $v=na(),jm=require("path"),yP=gl().copySync,Uv=go().removeSync,vP=ci().mkdirpSync,qv=ds();function _P(r,e,t){t=t||{};let i=t.overwrite||t.clobber||!1,{srcStat:n,isChangingCase:s=!1}=qv.checkPathsSync(r,e,"move",t);return qv.checkParentPathsSync(r,n,e,"move"),SP(e)||vP(jm.dirname(e)),wP(r,e,i,s)}o(_P,"moveSync");function SP(r){let e=jm.dirname(r);return jm.parse(e).root===e}o(SP,"isParentRoot");function wP(r,e,t,i){if(i)return km(r,e,t);if(t)return Uv(e),km(r,e,t);if($v.existsSync(e))throw new Error("dest already exists.");return km(r,e,t)}o(wP,"doRename");function km(r,e,t){try{$v.renameSync(r,e)}catch(i){if(i.code!=="EXDEV")throw i;return bP(r,e,t)}}o(km,"rename");function bP(r,e,t){return yP(r,e,{overwrite:t,errorOnExist:!0,preserveTimestamps:!0}),Uv(r)}o(bP,"moveAcrossDevice");Bv.exports=_P});var Hv=y((IV,Wv)=>{"use strict";var EP=bt().fromPromise;Wv.exports={move:EP(Vv()),moveSync:Gv()}});var ca=y((DV,zv)=>{"use strict";zv.exports={...rr(),...gl(),...H3(),...vv(),...Nv(),...ci(),...Hv(),...Sl(),...Tn(),...go()}});var iS=y((h$,rS)=>{"use strict";rS.exports=eS;function eS(r,e,t){r instanceof RegExp&&(r=Z_(r,t)),e instanceof RegExp&&(e=Z_(e,t));var i=tS(r,e,t);return i&&{start:i[0],end:i[1],pre:t.slice(0,i[0]),body:t.slice(i[0]+r.length,i[1]),post:t.slice(i[1]+e.length)}}o(eS,"balanced");function Z_(r,e){var t=e.match(r);return t?t[0]:null}o(Z_,"maybeMatch");eS.range=tS;function tS(r,e,t){var i,n,s,a,c,u=t.indexOf(r),f=t.indexOf(e,u+1),l=u;if(u>=0&&f>0){if(r===e)return[u,f];for(i=[],s=t.length;l>=0&&!c;)l==u?(i.push(l),u=t.indexOf(r,l+1)):i.length==1?c=[i.pop(),f]:(n=i.pop(),n<s&&(s=n,a=f),f=t.indexOf(e,l+1)),l=u<f&&u>=0?u:f;i.length&&(c=[s,a])}return c}o(tS,"range")});var fS=y((p$,lS)=>{var nS=iS();lS.exports=K6;var sS="\0SLASH"+Math.random()+"\0",aS="\0OPEN"+Math.random()+"\0",Zm="\0CLOSE"+Math.random()+"\0",oS="\0COMMA"+Math.random()+"\0",cS="\0PERIOD"+Math.random()+"\0";function Xm(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}o(Xm,"numeric");function H6(r){return r.split("\\\\").join(sS).split("\\{").join(aS).split("\\}").join(Zm).split("\\,").join(oS).split("\\.").join(cS)}o(H6,"escapeBraces");function z6(r){return r.split(sS).join("\\").split(aS).join("{").split(Zm).join("}").split(oS).join(",").split(cS).join(".")}o(z6,"unescapeBraces");function uS(r){if(!r)return[""];var e=[],t=nS("{","}",r);if(!t)return r.split(",");var i=t.pre,n=t.body,s=t.post,a=i.split(",");a[a.length-1]+="{"+n+"}";var c=uS(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}o(uS,"parseCommaParts");function K6(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),Co(H6(r),!0).map(z6)):[]}o(K6,"expandTop");function Y6(r){return"{"+r+"}"}o(Y6,"embrace");function Q6(r){return/^-?0\d/.test(r)}o(Q6,"isPadded");function J6(r,e){return r<=e}o(J6,"lte");function X6(r,e){return r>=e}o(X6,"gte");function Co(r,e){var t=[],i=nS("{","}",r);if(!i)return[r];var n=i.pre,s=i.post.length?Co(i.post,!1):[""];if(/\$$/.test(i.pre))for(var a=0;a<s.length;a++){var c=n+"{"+i.body+"}"+s[a];t.push(c)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),f=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),l=u||f,h=i.body.indexOf(",")>=0;if(!l&&!h)return i.post.match(/,(?!,).*\}/)?(r=i.pre+"{"+i.body+Zm+i.post,Co(r)):[r];var p;if(l)p=i.body.split(/\.\./);else if(p=uS(i.body),p.length===1&&(p=Co(p[0],!1).map(Y6),p.length===1))return s.map(function(ce){return i.pre+p[0]+ce});var g;if(l){var S=Xm(p[0]),_=Xm(p[1]),A=Math.max(p[0].length,p[1].length),F=p.length==3?Math.abs(Xm(p[2])):1,P=J6,j=_<S;j&&(F*=-1,P=X6);var B=p.some(Q6);g=[];for(var K=S;P(K,_);K+=F){var Ie;if(f)Ie=String.fromCharCode(K),Ie==="\\"&&(Ie="");else if(Ie=String(K),B){var Xe=A-Ie.length;if(Xe>0){var ot=new Array(Xe+1).join("0");K<0?Ie="-"+ot+Ie.slice(1):Ie=ot+Ie}}g.push(Ie)}}else{g=[];for(var $=0;$<p.length;$++)g.push.apply(g,Co(p[$],!1))}for(var $=0;$<g.length;$++)for(var a=0;a<s.length;a++){var c=n+g[$]+s[a];(!e||l||c)&&t.push(c)}}return t}o(Co,"expand")});var TG=Ke(xf());var Fg=Ke(Og(),1),{program:kI,createCommand:jI,createArgument:LI,createOption:MI,CommanderError:VI,InvalidArgumentError:qI,InvalidOptionArgumentError:$I,Command:Pr,Argument:UI,Option:BI,Help:GI}=Fg.default;var Ao=require("fs"),Jm=require("path"),cr=Ke(bn());var vt=Ke(ca()),Gt=Ke(require("path"));function u_(r){return typeof r>"u"||r===null}o(u_,"isNothing");function TP(r){return typeof r=="object"&&r!==null}o(TP,"isObject");function xP(r){return Array.isArray(r)?r:u_(r)?[]:[r]}o(xP,"toArray");function AP(r,e){var t,i,n,s;if(e)for(s=Object.keys(e),t=0,i=s.length;t<i;t+=1)n=s[t],r[n]=e[n];return r}o(AP,"extend");function CP(r,e){var t="",i;for(i=0;i<e;i+=1)t+=r;return t}o(CP,"repeat");function OP(r){return r===0&&Number.NEGATIVE_INFINITY===1/r}o(OP,"isNegativeZero");var FP=u_,PP=TP,RP=xP,IP=CP,DP=OP,NP=AP,yt={isNothing:FP,isObject:PP,toArray:RP,repeat:IP,isNegativeZero:DP,extend:NP};function l_(r,e){var t="",i=r.reason||"(unknown reason)";return r.mark?(r.mark.name&&(t+='in "'+r.mark.name+'" '),t+="("+(r.mark.line+1)+":"+(r.mark.column+1)+")",!e&&r.mark.snippet&&(t+=`

`+r.mark.snippet),i+" "+t):i}o(l_,"formatError");function _o(r,e){Error.call(this),this.name="YAMLException",this.reason=r,this.mark=e,this.message=l_(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}o(_o,"YAMLException$1");_o.prototype=Object.create(Error.prototype);_o.prototype.constructor=_o;_o.prototype.toString=o(function(e){return this.name+": "+l_(this,e)},"toString");var sr=_o;function Lm(r,e,t,i,n){var s="",a="",c=Math.floor(n/2)-1;return i-e>c&&(s=" ... ",e=i-c+s.length),t-i>c&&(a=" ...",t=i+c-a.length),{str:s+r.slice(e,t).replace(/\t/g,"\u2192")+a,pos:i-e+s.length}}o(Lm,"getLine");function Mm(r,e){return yt.repeat(" ",e-r.length)+r}o(Mm,"padStart");function kP(r,e){if(e=Object.create(e||null),!r.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var t=/\r?\n|\r|\0/g,i=[0],n=[],s,a=-1;s=t.exec(r.buffer);)n.push(s.index),i.push(s.index+s[0].length),r.position<=s.index&&a<0&&(a=i.length-2);a<0&&(a=i.length-1);var c="",u,f,l=Math.min(r.line+e.linesAfter,n.length).toString().length,h=e.maxLength-(e.indent+l+3);for(u=1;u<=e.linesBefore&&!(a-u<0);u++)f=Lm(r.buffer,i[a-u],n[a-u],r.position-(i[a]-i[a-u]),h),c=yt.repeat(" ",e.indent)+Mm((r.line-u+1).toString(),l)+" | "+f.str+`
`+c;for(f=Lm(r.buffer,i[a],n[a],r.position,h),c+=yt.repeat(" ",e.indent)+Mm((r.line+1).toString(),l)+" | "+f.str+`
`,c+=yt.repeat("-",e.indent+l+3+f.pos)+`^
`,u=1;u<=e.linesAfter&&!(a+u>=n.length);u++)f=Lm(r.buffer,i[a+u],n[a+u],r.position-(i[a]-i[a+u]),h),c+=yt.repeat(" ",e.indent)+Mm((r.line+u+1).toString(),l)+" | "+f.str+`
`;return c.replace(/\n$/,"")}o(kP,"makeSnippet");var jP=kP,LP=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],MP=["scalar","sequence","mapping"];function VP(r){var e={};return r!==null&&Object.keys(r).forEach(function(t){r[t].forEach(function(i){e[String(i)]=t})}),e}o(VP,"compileStyleAliases");function qP(r,e){if(e=e||{},Object.keys(e).forEach(function(t){if(LP.indexOf(t)===-1)throw new sr('Unknown option "'+t+'" is met in definition of "'+r+'" YAML type.')}),this.options=e,this.tag=r,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=VP(e.styleAliases||null),MP.indexOf(this.kind)===-1)throw new sr('Unknown kind "'+this.kind+'" is specified for "'+r+'" YAML type.')}o(qP,"Type$1");var kt=qP;function Kv(r,e){var t=[];return r[e].forEach(function(i){var n=t.length;t.forEach(function(s,a){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(n=a)}),t[n]=i}),t}o(Kv,"compileList");function $P(){var r={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,t;function i(n){n.multi?(r.multi[n.kind].push(n),r.multi.fallback.push(n)):r[n.kind][n.tag]=r.fallback[n.tag]=n}for(o(i,"collectType"),e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return r}o($P,"compileMap");function qm(r){return this.extend(r)}o(qm,"Schema$1");qm.prototype.extend=o(function(e){var t=[],i=[];if(e instanceof kt)i.push(e);else if(Array.isArray(e))i=i.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(i=i.concat(e.explicit));else throw new sr("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(s){if(!(s instanceof kt))throw new sr("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new sr("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new sr("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof kt))throw new sr("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var n=Object.create(qm.prototype);return n.implicit=(this.implicit||[]).concat(t),n.explicit=(this.explicit||[]).concat(i),n.compiledImplicit=Kv(n,"implicit"),n.compiledExplicit=Kv(n,"explicit"),n.compiledTypeMap=$P(n.compiledImplicit,n.compiledExplicit),n},"extend");var f_=qm,h_=new kt("tag:yaml.org,2002:str",{kind:"scalar",construct:o(function(r){return r!==null?r:""},"construct")}),d_=new kt("tag:yaml.org,2002:seq",{kind:"sequence",construct:o(function(r){return r!==null?r:[]},"construct")}),p_=new kt("tag:yaml.org,2002:map",{kind:"mapping",construct:o(function(r){return r!==null?r:{}},"construct")}),m_=new f_({explicit:[h_,d_,p_]});function UP(r){if(r===null)return!0;var e=r.length;return e===1&&r==="~"||e===4&&(r==="null"||r==="Null"||r==="NULL")}o(UP,"resolveYamlNull");function BP(){return null}o(BP,"constructYamlNull");function GP(r){return r===null}o(GP,"isNull");var g_=new kt("tag:yaml.org,2002:null",{kind:"scalar",resolve:UP,construct:BP,predicate:GP,represent:{canonical:o(function(){return"~"},"canonical"),lowercase:o(function(){return"null"},"lowercase"),uppercase:o(function(){return"NULL"},"uppercase"),camelcase:o(function(){return"Null"},"camelcase"),empty:o(function(){return""},"empty")},defaultStyle:"lowercase"});function WP(r){if(r===null)return!1;var e=r.length;return e===4&&(r==="true"||r==="True"||r==="TRUE")||e===5&&(r==="false"||r==="False"||r==="FALSE")}o(WP,"resolveYamlBoolean");function HP(r){return r==="true"||r==="True"||r==="TRUE"}o(HP,"constructYamlBoolean");function zP(r){return Object.prototype.toString.call(r)==="[object Boolean]"}o(zP,"isBoolean");var y_=new kt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:WP,construct:HP,predicate:zP,represent:{lowercase:o(function(r){return r?"true":"false"},"lowercase"),uppercase:o(function(r){return r?"TRUE":"FALSE"},"uppercase"),camelcase:o(function(r){return r?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function KP(r){return 48<=r&&r<=57||65<=r&&r<=70||97<=r&&r<=102}o(KP,"isHexCode");function YP(r){return 48<=r&&r<=55}o(YP,"isOctCode");function QP(r){return 48<=r&&r<=57}o(QP,"isDecCode");function JP(r){if(r===null)return!1;var e=r.length,t=0,i=!1,n;if(!e)return!1;if(n=r[t],(n==="-"||n==="+")&&(n=r[++t]),n==="0"){if(t+1===e)return!0;if(n=r[++t],n==="b"){for(t++;t<e;t++)if(n=r[t],n!=="_"){if(n!=="0"&&n!=="1")return!1;i=!0}return i&&n!=="_"}if(n==="x"){for(t++;t<e;t++)if(n=r[t],n!=="_"){if(!KP(r.charCodeAt(t)))return!1;i=!0}return i&&n!=="_"}if(n==="o"){for(t++;t<e;t++)if(n=r[t],n!=="_"){if(!YP(r.charCodeAt(t)))return!1;i=!0}return i&&n!=="_"}}if(n==="_")return!1;for(;t<e;t++)if(n=r[t],n!=="_"){if(!QP(r.charCodeAt(t)))return!1;i=!0}return!(!i||n==="_")}o(JP,"resolveYamlInteger");function XP(r){var e=r,t=1,i;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),i=e[0],(i==="-"||i==="+")&&(i==="-"&&(t=-1),e=e.slice(1),i=e[0]),e==="0")return 0;if(i==="0"){if(e[1]==="b")return t*parseInt(e.slice(2),2);if(e[1]==="x")return t*parseInt(e.slice(2),16);if(e[1]==="o")return t*parseInt(e.slice(2),8)}return t*parseInt(e,10)}o(XP,"constructYamlInteger");function ZP(r){return Object.prototype.toString.call(r)==="[object Number]"&&r%1===0&&!yt.isNegativeZero(r)}o(ZP,"isInteger");var v_=new kt("tag:yaml.org,2002:int",{kind:"scalar",resolve:JP,construct:XP,predicate:ZP,represent:{binary:o(function(r){return r>=0?"0b"+r.toString(2):"-0b"+r.toString(2).slice(1)},"binary"),octal:o(function(r){return r>=0?"0o"+r.toString(8):"-0o"+r.toString(8).slice(1)},"octal"),decimal:o(function(r){return r.toString(10)},"decimal"),hexadecimal:o(function(r){return r>=0?"0x"+r.toString(16).toUpperCase():"-0x"+r.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),e7=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function t7(r){return!(r===null||!e7.test(r)||r[r.length-1]==="_")}o(t7,"resolveYamlFloat");function r7(r){var e,t;return e=r.replace(/_/g,"").toLowerCase(),t=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:t*parseFloat(e,10)}o(r7,"constructYamlFloat");var i7=/^[-+]?[0-9]+e/;function n7(r,e){var t;if(isNaN(r))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===r)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===r)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(yt.isNegativeZero(r))return"-0.0";return t=r.toString(10),i7.test(t)?t.replace("e",".e"):t}o(n7,"representYamlFloat");function s7(r){return Object.prototype.toString.call(r)==="[object Number]"&&(r%1!==0||yt.isNegativeZero(r))}o(s7,"isFloat");var __=new kt("tag:yaml.org,2002:float",{kind:"scalar",resolve:t7,construct:r7,predicate:s7,represent:n7,defaultStyle:"lowercase"}),S_=m_.extend({implicit:[g_,y_,v_,__]}),w_=S_,b_=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),E_=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function a7(r){return r===null?!1:b_.exec(r)!==null||E_.exec(r)!==null}o(a7,"resolveYamlTimestamp");function o7(r){var e,t,i,n,s,a,c,u=0,f=null,l,h,p;if(e=b_.exec(r),e===null&&(e=E_.exec(r)),e===null)throw new Error("Date resolve error");if(t=+e[1],i=+e[2]-1,n=+e[3],!e[4])return new Date(Date.UTC(t,i,n));if(s=+e[4],a=+e[5],c=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(l=+e[10],h=+(e[11]||0),f=(l*60+h)*6e4,e[9]==="-"&&(f=-f)),p=new Date(Date.UTC(t,i,n,s,a,c,u)),f&&p.setTime(p.getTime()-f),p}o(o7,"constructYamlTimestamp");function c7(r){return r.toISOString()}o(c7,"representYamlTimestamp");var T_=new kt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:a7,construct:o7,instanceOf:Date,represent:c7});function u7(r){return r==="<<"||r===null}o(u7,"resolveYamlMerge");var x_=new kt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:u7}),Wm=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function l7(r){if(r===null)return!1;var e,t,i=0,n=r.length,s=Wm;for(t=0;t<n;t++)if(e=s.indexOf(r.charAt(t)),!(e>64)){if(e<0)return!1;i+=6}return i%8===0}o(l7,"resolveYamlBinary");function f7(r){var e,t,i=r.replace(/[\r\n=]/g,""),n=i.length,s=Wm,a=0,c=[];for(e=0;e<n;e++)e%4===0&&e&&(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)),a=a<<6|s.indexOf(i.charAt(e));return t=n%4*6,t===0?(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)):t===18?(c.push(a>>10&255),c.push(a>>2&255)):t===12&&c.push(a>>4&255),new Uint8Array(c)}o(f7,"constructYamlBinary");function h7(r){var e="",t=0,i,n,s=r.length,a=Wm;for(i=0;i<s;i++)i%3===0&&i&&(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]),t=(t<<8)+r[i];return n=s%3,n===0?(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]):n===2?(e+=a[t>>10&63],e+=a[t>>4&63],e+=a[t<<2&63],e+=a[64]):n===1&&(e+=a[t>>2&63],e+=a[t<<4&63],e+=a[64],e+=a[64]),e}o(h7,"representYamlBinary");function d7(r){return Object.prototype.toString.call(r)==="[object Uint8Array]"}o(d7,"isBinary");var A_=new kt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:l7,construct:f7,predicate:d7,represent:h7}),p7=Object.prototype.hasOwnProperty,m7=Object.prototype.toString;function g7(r){if(r===null)return!0;var e=[],t,i,n,s,a,c=r;for(t=0,i=c.length;t<i;t+=1){if(n=c[t],a=!1,m7.call(n)!=="[object Object]")return!1;for(s in n)if(p7.call(n,s))if(!a)a=!0;else return!1;if(!a)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}o(g7,"resolveYamlOmap");function y7(r){return r!==null?r:[]}o(y7,"constructYamlOmap");var C_=new kt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:g7,construct:y7}),v7=Object.prototype.toString;function _7(r){if(r===null)return!0;var e,t,i,n,s,a=r;for(s=new Array(a.length),e=0,t=a.length;e<t;e+=1){if(i=a[e],v7.call(i)!=="[object Object]"||(n=Object.keys(i),n.length!==1))return!1;s[e]=[n[0],i[n[0]]]}return!0}o(_7,"resolveYamlPairs");function S7(r){if(r===null)return[];var e,t,i,n,s,a=r;for(s=new Array(a.length),e=0,t=a.length;e<t;e+=1)i=a[e],n=Object.keys(i),s[e]=[n[0],i[n[0]]];return s}o(S7,"constructYamlPairs");var O_=new kt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:_7,construct:S7}),w7=Object.prototype.hasOwnProperty;function b7(r){if(r===null)return!0;var e,t=r;for(e in t)if(w7.call(t,e)&&t[e]!==null)return!1;return!0}o(b7,"resolveYamlSet");function E7(r){return r!==null?r:{}}o(E7,"constructYamlSet");var F_=new kt("tag:yaml.org,2002:set",{kind:"mapping",resolve:b7,construct:E7}),Hm=w_.extend({implicit:[T_,x_],explicit:[A_,C_,O_,F_]}),On=Object.prototype.hasOwnProperty,wl=1,P_=2,R_=3,bl=4,Vm=1,T7=2,Yv=3,x7=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,A7=/[\x85\u2028\u2029]/,C7=/[,\[\]\{\}]/,I_=/^(?:!|!!|![a-z\-]+!)$/i,D_=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Qv(r){return Object.prototype.toString.call(r)}o(Qv,"_class");function Ri(r){return r===10||r===13}o(Ri,"is_EOL");function ms(r){return r===9||r===32}o(ms,"is_WHITE_SPACE");function vr(r){return r===9||r===32||r===10||r===13}o(vr,"is_WS_OR_EOL");function la(r){return r===44||r===91||r===93||r===123||r===125}o(la,"is_FLOW_INDICATOR");function O7(r){var e;return 48<=r&&r<=57?r-48:(e=r|32,97<=e&&e<=102?e-97+10:-1)}o(O7,"fromHexCode");function F7(r){return r===120?2:r===117?4:r===85?8:0}o(F7,"escapedHexLen");function P7(r){return 48<=r&&r<=57?r-48:-1}o(P7,"fromDecimalCode");function Jv(r){return r===48?"\0":r===97?"\x07":r===98?"\b":r===116||r===9?"	":r===110?`
`:r===118?"\v":r===102?"\f":r===114?"\r":r===101?"\x1B":r===32?" ":r===34?'"':r===47?"/":r===92?"\\":r===78?"\x85":r===95?"\xA0":r===76?"\u2028":r===80?"\u2029":""}o(Jv,"simpleEscapeSequence");function R7(r){return r<=65535?String.fromCharCode(r):String.fromCharCode((r-65536>>10)+55296,(r-65536&1023)+56320)}o(R7,"charFromCodepoint");function N_(r,e,t){e==="__proto__"?Object.defineProperty(r,e,{configurable:!0,enumerable:!0,writable:!0,value:t}):r[e]=t}o(N_,"setProperty");var k_=new Array(256),j_=new Array(256);for(ps=0;ps<256;ps++)k_[ps]=Jv(ps)?1:0,j_[ps]=Jv(ps);var ps;function I7(r,e){this.input=r,this.filename=e.filename||null,this.schema=e.schema||Hm,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=r.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}o(I7,"State$1");function L_(r,e){var t={name:r.filename,buffer:r.input.slice(0,-1),position:r.position,line:r.line,column:r.position-r.lineStart};return t.snippet=jP(t),new sr(e,t)}o(L_,"generateError");function z(r,e){throw L_(r,e)}o(z,"throwError");function El(r,e){r.onWarning&&r.onWarning.call(null,L_(r,e))}o(El,"throwWarning");var Xv={YAML:o(function(e,t,i){var n,s,a;e.version!==null&&z(e,"duplication of %YAML directive"),i.length!==1&&z(e,"YAML directive accepts exactly one argument"),n=/^([0-9]+)\.([0-9]+)$/.exec(i[0]),n===null&&z(e,"ill-formed argument of the YAML directive"),s=parseInt(n[1],10),a=parseInt(n[2],10),s!==1&&z(e,"unacceptable YAML version of the document"),e.version=i[0],e.checkLineBreaks=a<2,a!==1&&a!==2&&El(e,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:o(function(e,t,i){var n,s;i.length!==2&&z(e,"TAG directive accepts exactly two arguments"),n=i[0],s=i[1],I_.test(n)||z(e,"ill-formed tag handle (first argument) of the TAG directive"),On.call(e.tagMap,n)&&z(e,'there is a previously declared suffix for "'+n+'" tag handle'),D_.test(s)||z(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{z(e,"tag prefix is malformed: "+s)}e.tagMap[n]=s},"handleTagDirective")};function Cn(r,e,t,i){var n,s,a,c;if(e<t){if(c=r.input.slice(e,t),i)for(n=0,s=c.length;n<s;n+=1)a=c.charCodeAt(n),a===9||32<=a&&a<=1114111||z(r,"expected valid JSON character");else x7.test(c)&&z(r,"the stream contains non-printable characters");r.result+=c}}o(Cn,"captureSegment");function Zv(r,e,t,i){var n,s,a,c;for(yt.isObject(t)||z(r,"cannot merge mappings; the provided source object is unacceptable"),n=Object.keys(t),a=0,c=n.length;a<c;a+=1)s=n[a],On.call(e,s)||(N_(e,s,t[s]),i[s]=!0)}o(Zv,"mergeMappings");function fa(r,e,t,i,n,s,a,c,u){var f,l;if(Array.isArray(n))for(n=Array.prototype.slice.call(n),f=0,l=n.length;f<l;f+=1)Array.isArray(n[f])&&z(r,"nested arrays are not supported inside keys"),typeof n=="object"&&Qv(n[f])==="[object Object]"&&(n[f]="[object Object]");if(typeof n=="object"&&Qv(n)==="[object Object]"&&(n="[object Object]"),n=String(n),e===null&&(e={}),i==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(f=0,l=s.length;f<l;f+=1)Zv(r,e,s[f],t);else Zv(r,e,s,t);else!r.json&&!On.call(t,n)&&On.call(e,n)&&(r.line=a||r.line,r.lineStart=c||r.lineStart,r.position=u||r.position,z(r,"duplicated mapping key")),N_(e,n,s),delete t[n];return e}o(fa,"storeMappingPair");function zm(r){var e;e=r.input.charCodeAt(r.position),e===10?r.position++:e===13?(r.position++,r.input.charCodeAt(r.position)===10&&r.position++):z(r,"a line break is expected"),r.line+=1,r.lineStart=r.position,r.firstTabInLine=-1}o(zm,"readLineBreak");function mt(r,e,t){for(var i=0,n=r.input.charCodeAt(r.position);n!==0;){for(;ms(n);)n===9&&r.firstTabInLine===-1&&(r.firstTabInLine=r.position),n=r.input.charCodeAt(++r.position);if(e&&n===35)do n=r.input.charCodeAt(++r.position);while(n!==10&&n!==13&&n!==0);if(Ri(n))for(zm(r),n=r.input.charCodeAt(r.position),i++,r.lineIndent=0;n===32;)r.lineIndent++,n=r.input.charCodeAt(++r.position);else break}return t!==-1&&i!==0&&r.lineIndent<t&&El(r,"deficient indentation"),i}o(mt,"skipSeparationSpace");function Al(r){var e=r.position,t;return t=r.input.charCodeAt(e),!!((t===45||t===46)&&t===r.input.charCodeAt(e+1)&&t===r.input.charCodeAt(e+2)&&(e+=3,t=r.input.charCodeAt(e),t===0||vr(t)))}o(Al,"testDocumentSeparator");function Km(r,e){e===1?r.result+=" ":e>1&&(r.result+=yt.repeat(`
`,e-1))}o(Km,"writeFoldedLines");function D7(r,e,t){var i,n,s,a,c,u,f,l,h=r.kind,p=r.result,g;if(g=r.input.charCodeAt(r.position),vr(g)||la(g)||g===35||g===38||g===42||g===33||g===124||g===62||g===39||g===34||g===37||g===64||g===96||(g===63||g===45)&&(n=r.input.charCodeAt(r.position+1),vr(n)||t&&la(n)))return!1;for(r.kind="scalar",r.result="",s=a=r.position,c=!1;g!==0;){if(g===58){if(n=r.input.charCodeAt(r.position+1),vr(n)||t&&la(n))break}else if(g===35){if(i=r.input.charCodeAt(r.position-1),vr(i))break}else{if(r.position===r.lineStart&&Al(r)||t&&la(g))break;if(Ri(g))if(u=r.line,f=r.lineStart,l=r.lineIndent,mt(r,!1,-1),r.lineIndent>=e){c=!0,g=r.input.charCodeAt(r.position);continue}else{r.position=a,r.line=u,r.lineStart=f,r.lineIndent=l;break}}c&&(Cn(r,s,a,!1),Km(r,r.line-u),s=a=r.position,c=!1),ms(g)||(a=r.position+1),g=r.input.charCodeAt(++r.position)}return Cn(r,s,a,!1),r.result?!0:(r.kind=h,r.result=p,!1)}o(D7,"readPlainScalar");function N7(r,e){var t,i,n;if(t=r.input.charCodeAt(r.position),t!==39)return!1;for(r.kind="scalar",r.result="",r.position++,i=n=r.position;(t=r.input.charCodeAt(r.position))!==0;)if(t===39)if(Cn(r,i,r.position,!0),t=r.input.charCodeAt(++r.position),t===39)i=r.position,r.position++,n=r.position;else return!0;else Ri(t)?(Cn(r,i,n,!0),Km(r,mt(r,!1,e)),i=n=r.position):r.position===r.lineStart&&Al(r)?z(r,"unexpected end of the document within a single quoted scalar"):(r.position++,n=r.position);z(r,"unexpected end of the stream within a single quoted scalar")}o(N7,"readSingleQuotedScalar");function k7(r,e){var t,i,n,s,a,c;if(c=r.input.charCodeAt(r.position),c!==34)return!1;for(r.kind="scalar",r.result="",r.position++,t=i=r.position;(c=r.input.charCodeAt(r.position))!==0;){if(c===34)return Cn(r,t,r.position,!0),r.position++,!0;if(c===92){if(Cn(r,t,r.position,!0),c=r.input.charCodeAt(++r.position),Ri(c))mt(r,!1,e);else if(c<256&&k_[c])r.result+=j_[c],r.position++;else if((a=F7(c))>0){for(n=a,s=0;n>0;n--)c=r.input.charCodeAt(++r.position),(a=O7(c))>=0?s=(s<<4)+a:z(r,"expected hexadecimal character");r.result+=R7(s),r.position++}else z(r,"unknown escape sequence");t=i=r.position}else Ri(c)?(Cn(r,t,i,!0),Km(r,mt(r,!1,e)),t=i=r.position):r.position===r.lineStart&&Al(r)?z(r,"unexpected end of the document within a double quoted scalar"):(r.position++,i=r.position)}z(r,"unexpected end of the stream within a double quoted scalar")}o(k7,"readDoubleQuotedScalar");function j7(r,e){var t=!0,i,n,s,a=r.tag,c,u=r.anchor,f,l,h,p,g,S=Object.create(null),_,A,F,P;if(P=r.input.charCodeAt(r.position),P===91)l=93,g=!1,c=[];else if(P===123)l=125,g=!0,c={};else return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=c),P=r.input.charCodeAt(++r.position);P!==0;){if(mt(r,!0,e),P=r.input.charCodeAt(r.position),P===l)return r.position++,r.tag=a,r.anchor=u,r.kind=g?"mapping":"sequence",r.result=c,!0;t?P===44&&z(r,"expected the node content, but found ','"):z(r,"missed comma between flow collection entries"),A=_=F=null,h=p=!1,P===63&&(f=r.input.charCodeAt(r.position+1),vr(f)&&(h=p=!0,r.position++,mt(r,!0,e))),i=r.line,n=r.lineStart,s=r.position,ha(r,e,wl,!1,!0),A=r.tag,_=r.result,mt(r,!0,e),P=r.input.charCodeAt(r.position),(p||r.line===i)&&P===58&&(h=!0,P=r.input.charCodeAt(++r.position),mt(r,!0,e),ha(r,e,wl,!1,!0),F=r.result),g?fa(r,c,S,A,_,F,i,n,s):h?c.push(fa(r,null,S,A,_,F,i,n,s)):c.push(_),mt(r,!0,e),P=r.input.charCodeAt(r.position),P===44?(t=!0,P=r.input.charCodeAt(++r.position)):t=!1}z(r,"unexpected end of the stream within a flow collection")}o(j7,"readFlowCollection");function L7(r,e){var t,i,n=Vm,s=!1,a=!1,c=e,u=0,f=!1,l,h;if(h=r.input.charCodeAt(r.position),h===124)i=!1;else if(h===62)i=!0;else return!1;for(r.kind="scalar",r.result="";h!==0;)if(h=r.input.charCodeAt(++r.position),h===43||h===45)Vm===n?n=h===43?Yv:T7:z(r,"repeat of a chomping mode identifier");else if((l=P7(h))>=0)l===0?z(r,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?z(r,"repeat of an indentation width identifier"):(c=e+l-1,a=!0);else break;if(ms(h)){do h=r.input.charCodeAt(++r.position);while(ms(h));if(h===35)do h=r.input.charCodeAt(++r.position);while(!Ri(h)&&h!==0)}for(;h!==0;){for(zm(r),r.lineIndent=0,h=r.input.charCodeAt(r.position);(!a||r.lineIndent<c)&&h===32;)r.lineIndent++,h=r.input.charCodeAt(++r.position);if(!a&&r.lineIndent>c&&(c=r.lineIndent),Ri(h)){u++;continue}if(r.lineIndent<c){n===Yv?r.result+=yt.repeat(`
`,s?1+u:u):n===Vm&&s&&(r.result+=`
`);break}for(i?ms(h)?(f=!0,r.result+=yt.repeat(`
`,s?1+u:u)):f?(f=!1,r.result+=yt.repeat(`
`,u+1)):u===0?s&&(r.result+=" "):r.result+=yt.repeat(`
`,u):r.result+=yt.repeat(`
`,s?1+u:u),s=!0,a=!0,u=0,t=r.position;!Ri(h)&&h!==0;)h=r.input.charCodeAt(++r.position);Cn(r,t,r.position,!1)}return!0}o(L7,"readBlockScalar");function e_(r,e){var t,i=r.tag,n=r.anchor,s=[],a,c=!1,u;if(r.firstTabInLine!==-1)return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=s),u=r.input.charCodeAt(r.position);u!==0&&(r.firstTabInLine!==-1&&(r.position=r.firstTabInLine,z(r,"tab characters must not be used in indentation")),!(u!==45||(a=r.input.charCodeAt(r.position+1),!vr(a))));){if(c=!0,r.position++,mt(r,!0,-1)&&r.lineIndent<=e){s.push(null),u=r.input.charCodeAt(r.position);continue}if(t=r.line,ha(r,e,R_,!1,!0),s.push(r.result),mt(r,!0,-1),u=r.input.charCodeAt(r.position),(r.line===t||r.lineIndent>e)&&u!==0)z(r,"bad indentation of a sequence entry");else if(r.lineIndent<e)break}return c?(r.tag=i,r.anchor=n,r.kind="sequence",r.result=s,!0):!1}o(e_,"readBlockSequence");function M7(r,e,t){var i,n,s,a,c,u,f=r.tag,l=r.anchor,h={},p=Object.create(null),g=null,S=null,_=null,A=!1,F=!1,P;if(r.firstTabInLine!==-1)return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=h),P=r.input.charCodeAt(r.position);P!==0;){if(!A&&r.firstTabInLine!==-1&&(r.position=r.firstTabInLine,z(r,"tab characters must not be used in indentation")),i=r.input.charCodeAt(r.position+1),s=r.line,(P===63||P===58)&&vr(i))P===63?(A&&(fa(r,h,p,g,S,null,a,c,u),g=S=_=null),F=!0,A=!0,n=!0):A?(A=!1,n=!0):z(r,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),r.position+=1,P=i;else{if(a=r.line,c=r.lineStart,u=r.position,!ha(r,t,P_,!1,!0))break;if(r.line===s){for(P=r.input.charCodeAt(r.position);ms(P);)P=r.input.charCodeAt(++r.position);if(P===58)P=r.input.charCodeAt(++r.position),vr(P)||z(r,"a whitespace character is expected after the key-value separator within a block mapping"),A&&(fa(r,h,p,g,S,null,a,c,u),g=S=_=null),F=!0,A=!1,n=!1,g=r.tag,S=r.result;else if(F)z(r,"can not read an implicit mapping pair; a colon is missed");else return r.tag=f,r.anchor=l,!0}else if(F)z(r,"can not read a block mapping entry; a multiline key may not be an implicit key");else return r.tag=f,r.anchor=l,!0}if((r.line===s||r.lineIndent>e)&&(A&&(a=r.line,c=r.lineStart,u=r.position),ha(r,e,bl,!0,n)&&(A?S=r.result:_=r.result),A||(fa(r,h,p,g,S,_,a,c,u),g=S=_=null),mt(r,!0,-1),P=r.input.charCodeAt(r.position)),(r.line===s||r.lineIndent>e)&&P!==0)z(r,"bad indentation of a mapping entry");else if(r.lineIndent<e)break}return A&&fa(r,h,p,g,S,null,a,c,u),F&&(r.tag=f,r.anchor=l,r.kind="mapping",r.result=h),F}o(M7,"readBlockMapping");function V7(r){var e,t=!1,i=!1,n,s,a;if(a=r.input.charCodeAt(r.position),a!==33)return!1;if(r.tag!==null&&z(r,"duplication of a tag property"),a=r.input.charCodeAt(++r.position),a===60?(t=!0,a=r.input.charCodeAt(++r.position)):a===33?(i=!0,n="!!",a=r.input.charCodeAt(++r.position)):n="!",e=r.position,t){do a=r.input.charCodeAt(++r.position);while(a!==0&&a!==62);r.position<r.length?(s=r.input.slice(e,r.position),a=r.input.charCodeAt(++r.position)):z(r,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!vr(a);)a===33&&(i?z(r,"tag suffix cannot contain exclamation marks"):(n=r.input.slice(e-1,r.position+1),I_.test(n)||z(r,"named tag handle cannot contain such characters"),i=!0,e=r.position+1)),a=r.input.charCodeAt(++r.position);s=r.input.slice(e,r.position),C7.test(s)&&z(r,"tag suffix cannot contain flow indicator characters")}s&&!D_.test(s)&&z(r,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{z(r,"tag name is malformed: "+s)}return t?r.tag=s:On.call(r.tagMap,n)?r.tag=r.tagMap[n]+s:n==="!"?r.tag="!"+s:n==="!!"?r.tag="tag:yaml.org,2002:"+s:z(r,'undeclared tag handle "'+n+'"'),!0}o(V7,"readTagProperty");function q7(r){var e,t;if(t=r.input.charCodeAt(r.position),t!==38)return!1;for(r.anchor!==null&&z(r,"duplication of an anchor property"),t=r.input.charCodeAt(++r.position),e=r.position;t!==0&&!vr(t)&&!la(t);)t=r.input.charCodeAt(++r.position);return r.position===e&&z(r,"name of an anchor node must contain at least one character"),r.anchor=r.input.slice(e,r.position),!0}o(q7,"readAnchorProperty");function $7(r){var e,t,i;if(i=r.input.charCodeAt(r.position),i!==42)return!1;for(i=r.input.charCodeAt(++r.position),e=r.position;i!==0&&!vr(i)&&!la(i);)i=r.input.charCodeAt(++r.position);return r.position===e&&z(r,"name of an alias node must contain at least one character"),t=r.input.slice(e,r.position),On.call(r.anchorMap,t)||z(r,'unidentified alias "'+t+'"'),r.result=r.anchorMap[t],mt(r,!0,-1),!0}o($7,"readAlias");function ha(r,e,t,i,n){var s,a,c,u=1,f=!1,l=!1,h,p,g,S,_,A;if(r.listener!==null&&r.listener("open",r),r.tag=null,r.anchor=null,r.kind=null,r.result=null,s=a=c=bl===t||R_===t,i&&mt(r,!0,-1)&&(f=!0,r.lineIndent>e?u=1:r.lineIndent===e?u=0:r.lineIndent<e&&(u=-1)),u===1)for(;V7(r)||q7(r);)mt(r,!0,-1)?(f=!0,c=s,r.lineIndent>e?u=1:r.lineIndent===e?u=0:r.lineIndent<e&&(u=-1)):c=!1;if(c&&(c=f||n),(u===1||bl===t)&&(wl===t||P_===t?_=e:_=e+1,A=r.position-r.lineStart,u===1?c&&(e_(r,A)||M7(r,A,_))||j7(r,_)?l=!0:(a&&L7(r,_)||N7(r,_)||k7(r,_)?l=!0:$7(r)?(l=!0,(r.tag!==null||r.anchor!==null)&&z(r,"alias node should not have any properties")):D7(r,_,wl===t)&&(l=!0,r.tag===null&&(r.tag="?")),r.anchor!==null&&(r.anchorMap[r.anchor]=r.result)):u===0&&(l=c&&e_(r,A))),r.tag===null)r.anchor!==null&&(r.anchorMap[r.anchor]=r.result);else if(r.tag==="?"){for(r.result!==null&&r.kind!=="scalar"&&z(r,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+r.kind+'"'),h=0,p=r.implicitTypes.length;h<p;h+=1)if(S=r.implicitTypes[h],S.resolve(r.result)){r.result=S.construct(r.result),r.tag=S.tag,r.anchor!==null&&(r.anchorMap[r.anchor]=r.result);break}}else if(r.tag!=="!"){if(On.call(r.typeMap[r.kind||"fallback"],r.tag))S=r.typeMap[r.kind||"fallback"][r.tag];else for(S=null,g=r.typeMap.multi[r.kind||"fallback"],h=0,p=g.length;h<p;h+=1)if(r.tag.slice(0,g[h].tag.length)===g[h].tag){S=g[h];break}S||z(r,"unknown tag !<"+r.tag+">"),r.result!==null&&S.kind!==r.kind&&z(r,"unacceptable node kind for !<"+r.tag+'> tag; it should be "'+S.kind+'", not "'+r.kind+'"'),S.resolve(r.result,r.tag)?(r.result=S.construct(r.result,r.tag),r.anchor!==null&&(r.anchorMap[r.anchor]=r.result)):z(r,"cannot resolve a node with !<"+r.tag+"> explicit tag")}return r.listener!==null&&r.listener("close",r),r.tag!==null||r.anchor!==null||l}o(ha,"composeNode");function U7(r){var e=r.position,t,i,n,s=!1,a;for(r.version=null,r.checkLineBreaks=r.legacy,r.tagMap=Object.create(null),r.anchorMap=Object.create(null);(a=r.input.charCodeAt(r.position))!==0&&(mt(r,!0,-1),a=r.input.charCodeAt(r.position),!(r.lineIndent>0||a!==37));){for(s=!0,a=r.input.charCodeAt(++r.position),t=r.position;a!==0&&!vr(a);)a=r.input.charCodeAt(++r.position);for(i=r.input.slice(t,r.position),n=[],i.length<1&&z(r,"directive name must not be less than one character in length");a!==0;){for(;ms(a);)a=r.input.charCodeAt(++r.position);if(a===35){do a=r.input.charCodeAt(++r.position);while(a!==0&&!Ri(a));break}if(Ri(a))break;for(t=r.position;a!==0&&!vr(a);)a=r.input.charCodeAt(++r.position);n.push(r.input.slice(t,r.position))}a!==0&&zm(r),On.call(Xv,i)?Xv[i](r,i,n):El(r,'unknown document directive "'+i+'"')}if(mt(r,!0,-1),r.lineIndent===0&&r.input.charCodeAt(r.position)===45&&r.input.charCodeAt(r.position+1)===45&&r.input.charCodeAt(r.position+2)===45?(r.position+=3,mt(r,!0,-1)):s&&z(r,"directives end mark is expected"),ha(r,r.lineIndent-1,bl,!1,!0),mt(r,!0,-1),r.checkLineBreaks&&A7.test(r.input.slice(e,r.position))&&El(r,"non-ASCII line breaks are interpreted as content"),r.documents.push(r.result),r.position===r.lineStart&&Al(r)){r.input.charCodeAt(r.position)===46&&(r.position+=3,mt(r,!0,-1));return}if(r.position<r.length-1)z(r,"end of the stream or a document separator is expected");else return}o(U7,"readDocument");function M_(r,e){r=String(r),e=e||{},r.length!==0&&(r.charCodeAt(r.length-1)!==10&&r.charCodeAt(r.length-1)!==13&&(r+=`
`),r.charCodeAt(0)===65279&&(r=r.slice(1)));var t=new I7(r,e),i=r.indexOf("\0");for(i!==-1&&(t.position=i,z(t,"null byte is not allowed in input")),t.input+="\0";t.input.charCodeAt(t.position)===32;)t.lineIndent+=1,t.position+=1;for(;t.position<t.length-1;)U7(t);return t.documents}o(M_,"loadDocuments");function B7(r,e,t){e!==null&&typeof e=="object"&&typeof t>"u"&&(t=e,e=null);var i=M_(r,t);if(typeof e!="function")return i;for(var n=0,s=i.length;n<s;n+=1)e(i[n])}o(B7,"loadAll$1");function G7(r,e){var t=M_(r,e);if(t.length!==0){if(t.length===1)return t[0];throw new sr("expected a single document in the stream, but found more")}}o(G7,"load$1");var W7=B7,H7=G7,V_={loadAll:W7,load:H7},q_=Object.prototype.toString,$_=Object.prototype.hasOwnProperty,Ym=65279,z7=9,So=10,K7=13,Y7=32,Q7=33,J7=34,$m=35,X7=37,Z7=38,e6=39,t6=42,U_=44,r6=45,Tl=58,i6=61,n6=62,s6=63,a6=64,B_=91,G_=93,o6=96,W_=123,c6=124,H_=125,Bt={};Bt[0]="\\0";Bt[7]="\\a";Bt[8]="\\b";Bt[9]="\\t";Bt[10]="\\n";Bt[11]="\\v";Bt[12]="\\f";Bt[13]="\\r";Bt[27]="\\e";Bt[34]='\\"';Bt[92]="\\\\";Bt[133]="\\N";Bt[160]="\\_";Bt[8232]="\\L";Bt[8233]="\\P";var u6=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],l6=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function f6(r,e){var t,i,n,s,a,c,u;if(e===null)return{};for(t={},i=Object.keys(e),n=0,s=i.length;n<s;n+=1)a=i[n],c=String(e[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),u=r.compiledTypeMap.fallback[a],u&&$_.call(u.styleAliases,c)&&(c=u.styleAliases[c]),t[a]=c;return t}o(f6,"compileStyleMap");function h6(r){var e,t,i;if(e=r.toString(16).toUpperCase(),r<=255)t="x",i=2;else if(r<=65535)t="u",i=4;else if(r<=4294967295)t="U",i=8;else throw new sr("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+t+yt.repeat("0",i-e.length)+e}o(h6,"encodeHex");var d6=1,wo=2;function p6(r){this.schema=r.schema||Hm,this.indent=Math.max(1,r.indent||2),this.noArrayIndent=r.noArrayIndent||!1,this.skipInvalid=r.skipInvalid||!1,this.flowLevel=yt.isNothing(r.flowLevel)?-1:r.flowLevel,this.styleMap=f6(this.schema,r.styles||null),this.sortKeys=r.sortKeys||!1,this.lineWidth=r.lineWidth||80,this.noRefs=r.noRefs||!1,this.noCompatMode=r.noCompatMode||!1,this.condenseFlow=r.condenseFlow||!1,this.quotingType=r.quotingType==='"'?wo:d6,this.forceQuotes=r.forceQuotes||!1,this.replacer=typeof r.replacer=="function"?r.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}o(p6,"State");function t_(r,e){for(var t=yt.repeat(" ",e),i=0,n=-1,s="",a,c=r.length;i<c;)n=r.indexOf(`
`,i),n===-1?(a=r.slice(i),i=c):(a=r.slice(i,n+1),i=n+1),a.length&&a!==`
`&&(s+=t),s+=a;return s}o(t_,"indentString");function Um(r,e){return`
`+yt.repeat(" ",r.indent*e)}o(Um,"generateNextLine");function m6(r,e){var t,i,n;for(t=0,i=r.implicitTypes.length;t<i;t+=1)if(n=r.implicitTypes[t],n.resolve(e))return!0;return!1}o(m6,"testImplicitResolving");function xl(r){return r===Y7||r===z7}o(xl,"isWhitespace");function bo(r){return 32<=r&&r<=126||161<=r&&r<=55295&&r!==8232&&r!==8233||57344<=r&&r<=65533&&r!==Ym||65536<=r&&r<=1114111}o(bo,"isPrintable");function r_(r){return bo(r)&&r!==Ym&&r!==K7&&r!==So}o(r_,"isNsCharOrWhitespace");function i_(r,e,t){var i=r_(r),n=i&&!xl(r);return(t?i:i&&r!==U_&&r!==B_&&r!==G_&&r!==W_&&r!==H_)&&r!==$m&&!(e===Tl&&!n)||r_(e)&&!xl(e)&&r===$m||e===Tl&&n}o(i_,"isPlainSafe");function g6(r){return bo(r)&&r!==Ym&&!xl(r)&&r!==r6&&r!==s6&&r!==Tl&&r!==U_&&r!==B_&&r!==G_&&r!==W_&&r!==H_&&r!==$m&&r!==Z7&&r!==t6&&r!==Q7&&r!==c6&&r!==i6&&r!==n6&&r!==e6&&r!==J7&&r!==X7&&r!==a6&&r!==o6}o(g6,"isPlainSafeFirst");function y6(r){return!xl(r)&&r!==Tl}o(y6,"isPlainSafeLast");function vo(r,e){var t=r.charCodeAt(e),i;return t>=55296&&t<=56319&&e+1<r.length&&(i=r.charCodeAt(e+1),i>=56320&&i<=57343)?(t-55296)*1024+i-56320+65536:t}o(vo,"codePointAt");function z_(r){var e=/^\n* /;return e.test(r)}o(z_,"needIndentIndicator");var K_=1,Bm=2,Y_=3,Q_=4,ua=5;function v6(r,e,t,i,n,s,a,c){var u,f=0,l=null,h=!1,p=!1,g=i!==-1,S=-1,_=g6(vo(r,0))&&y6(vo(r,r.length-1));if(e||a)for(u=0;u<r.length;f>=65536?u+=2:u++){if(f=vo(r,u),!bo(f))return ua;_=_&&i_(f,l,c),l=f}else{for(u=0;u<r.length;f>=65536?u+=2:u++){if(f=vo(r,u),f===So)h=!0,g&&(p=p||u-S-1>i&&r[S+1]!==" ",S=u);else if(!bo(f))return ua;_=_&&i_(f,l,c),l=f}p=p||g&&u-S-1>i&&r[S+1]!==" "}return!h&&!p?_&&!a&&!n(r)?K_:s===wo?ua:Bm:t>9&&z_(r)?ua:a?s===wo?ua:Bm:p?Q_:Y_}o(v6,"chooseScalarStyle");function _6(r,e,t,i,n){r.dump=(function(){if(e.length===0)return r.quotingType===wo?'""':"''";if(!r.noCompatMode&&(u6.indexOf(e)!==-1||l6.test(e)))return r.quotingType===wo?'"'+e+'"':"'"+e+"'";var s=r.indent*Math.max(1,t),a=r.lineWidth===-1?-1:Math.max(Math.min(r.lineWidth,40),r.lineWidth-s),c=i||r.flowLevel>-1&&t>=r.flowLevel;function u(f){return m6(r,f)}switch(o(u,"testAmbiguity"),v6(e,c,r.indent,a,u,r.quotingType,r.forceQuotes&&!i,n)){case K_:return e;case Bm:return"'"+e.replace(/'/g,"''")+"'";case Y_:return"|"+n_(e,r.indent)+s_(t_(e,s));case Q_:return">"+n_(e,r.indent)+s_(t_(S6(e,a),s));case ua:return'"'+w6(e)+'"';default:throw new sr("impossible error: invalid scalar style")}})()}o(_6,"writeScalar");function n_(r,e){var t=z_(r)?String(e):"",i=r[r.length-1]===`
`,n=i&&(r[r.length-2]===`
`||r===`
`),s=n?"+":i?"":"-";return t+s+`
`}o(n_,"blockHeader");function s_(r){return r[r.length-1]===`
`?r.slice(0,-1):r}o(s_,"dropEndingNewline");function S6(r,e){for(var t=/(\n+)([^\n]*)/g,i=(function(){var f=r.indexOf(`
`);return f=f!==-1?f:r.length,t.lastIndex=f,a_(r.slice(0,f),e)})(),n=r[0]===`
`||r[0]===" ",s,a;a=t.exec(r);){var c=a[1],u=a[2];s=u[0]===" ",i+=c+(!n&&!s&&u!==""?`
`:"")+a_(u,e),n=s}return i}o(S6,"foldString");function a_(r,e){if(r===""||r[0]===" ")return r;for(var t=/ [^ ]/g,i,n=0,s,a=0,c=0,u="";i=t.exec(r);)c=i.index,c-n>e&&(s=a>n?a:c,u+=`
`+r.slice(n,s),n=s+1),a=c;return u+=`
`,r.length-n>e&&a>n?u+=r.slice(n,a)+`
`+r.slice(a+1):u+=r.slice(n),u.slice(1)}o(a_,"foldLine");function w6(r){for(var e="",t=0,i,n=0;n<r.length;t>=65536?n+=2:n++)t=vo(r,n),i=Bt[t],!i&&bo(t)?(e+=r[n],t>=65536&&(e+=r[n+1])):e+=i||h6(t);return e}o(w6,"escapeString");function b6(r,e,t){var i="",n=r.tag,s,a,c;for(s=0,a=t.length;s<a;s+=1)c=t[s],r.replacer&&(c=r.replacer.call(t,String(s),c)),(nn(r,e,c,!1,!1)||typeof c>"u"&&nn(r,e,null,!1,!1))&&(i!==""&&(i+=","+(r.condenseFlow?"":" ")),i+=r.dump);r.tag=n,r.dump="["+i+"]"}o(b6,"writeFlowSequence");function o_(r,e,t,i){var n="",s=r.tag,a,c,u;for(a=0,c=t.length;a<c;a+=1)u=t[a],r.replacer&&(u=r.replacer.call(t,String(a),u)),(nn(r,e+1,u,!0,!0,!1,!0)||typeof u>"u"&&nn(r,e+1,null,!0,!0,!1,!0))&&((!i||n!=="")&&(n+=Um(r,e)),r.dump&&So===r.dump.charCodeAt(0)?n+="-":n+="- ",n+=r.dump);r.tag=s,r.dump=n||"[]"}o(o_,"writeBlockSequence");function E6(r,e,t){var i="",n=r.tag,s=Object.keys(t),a,c,u,f,l;for(a=0,c=s.length;a<c;a+=1)l="",i!==""&&(l+=", "),r.condenseFlow&&(l+='"'),u=s[a],f=t[u],r.replacer&&(f=r.replacer.call(t,u,f)),nn(r,e,u,!1,!1)&&(r.dump.length>1024&&(l+="? "),l+=r.dump+(r.condenseFlow?'"':"")+":"+(r.condenseFlow?"":" "),nn(r,e,f,!1,!1)&&(l+=r.dump,i+=l));r.tag=n,r.dump="{"+i+"}"}o(E6,"writeFlowMapping");function T6(r,e,t,i){var n="",s=r.tag,a=Object.keys(t),c,u,f,l,h,p;if(r.sortKeys===!0)a.sort();else if(typeof r.sortKeys=="function")a.sort(r.sortKeys);else if(r.sortKeys)throw new sr("sortKeys must be a boolean or a function");for(c=0,u=a.length;c<u;c+=1)p="",(!i||n!=="")&&(p+=Um(r,e)),f=a[c],l=t[f],r.replacer&&(l=r.replacer.call(t,f,l)),nn(r,e+1,f,!0,!0,!0)&&(h=r.tag!==null&&r.tag!=="?"||r.dump&&r.dump.length>1024,h&&(r.dump&&So===r.dump.charCodeAt(0)?p+="?":p+="? "),p+=r.dump,h&&(p+=Um(r,e)),nn(r,e+1,l,!0,h)&&(r.dump&&So===r.dump.charCodeAt(0)?p+=":":p+=": ",p+=r.dump,n+=p));r.tag=s,r.dump=n||"{}"}o(T6,"writeBlockMapping");function c_(r,e,t){var i,n,s,a,c,u;for(n=t?r.explicitTypes:r.implicitTypes,s=0,a=n.length;s<a;s+=1)if(c=n[s],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof e=="object"&&e instanceof c.instanceOf)&&(!c.predicate||c.predicate(e))){if(t?c.multi&&c.representName?r.tag=c.representName(e):r.tag=c.tag:r.tag="?",c.represent){if(u=r.styleMap[c.tag]||c.defaultStyle,q_.call(c.represent)==="[object Function]")i=c.represent(e,u);else if($_.call(c.represent,u))i=c.represent[u](e,u);else throw new sr("!<"+c.tag+'> tag resolver accepts not "'+u+'" style');r.dump=i}return!0}return!1}o(c_,"detectType");function nn(r,e,t,i,n,s,a){r.tag=null,r.dump=t,c_(r,t,!1)||c_(r,t,!0);var c=q_.call(r.dump),u=i,f;i&&(i=r.flowLevel<0||r.flowLevel>e);var l=c==="[object Object]"||c==="[object Array]",h,p;if(l&&(h=r.duplicates.indexOf(t),p=h!==-1),(r.tag!==null&&r.tag!=="?"||p||r.indent!==2&&e>0)&&(n=!1),p&&r.usedDuplicates[h])r.dump="*ref_"+h;else{if(l&&p&&!r.usedDuplicates[h]&&(r.usedDuplicates[h]=!0),c==="[object Object]")i&&Object.keys(r.dump).length!==0?(T6(r,e,r.dump,n),p&&(r.dump="&ref_"+h+r.dump)):(E6(r,e,r.dump),p&&(r.dump="&ref_"+h+" "+r.dump));else if(c==="[object Array]")i&&r.dump.length!==0?(r.noArrayIndent&&!a&&e>0?o_(r,e-1,r.dump,n):o_(r,e,r.dump,n),p&&(r.dump="&ref_"+h+r.dump)):(b6(r,e,r.dump),p&&(r.dump="&ref_"+h+" "+r.dump));else if(c==="[object String]")r.tag!=="?"&&_6(r,r.dump,e,s,u);else{if(c==="[object Undefined]")return!1;if(r.skipInvalid)return!1;throw new sr("unacceptable kind of an object to dump "+c)}r.tag!==null&&r.tag!=="?"&&(f=encodeURI(r.tag[0]==="!"?r.tag.slice(1):r.tag).replace(/!/g,"%21"),r.tag[0]==="!"?f="!"+f:f.slice(0,18)==="tag:yaml.org,2002:"?f="!!"+f.slice(18):f="!<"+f+">",r.dump=f+" "+r.dump)}return!0}o(nn,"writeNode");function x6(r,e){var t=[],i=[],n,s;for(Gm(r,t,i),n=0,s=i.length;n<s;n+=1)e.duplicates.push(t[i[n]]);e.usedDuplicates=new Array(s)}o(x6,"getDuplicateReferences");function Gm(r,e,t){var i,n,s;if(r!==null&&typeof r=="object")if(n=e.indexOf(r),n!==-1)t.indexOf(n)===-1&&t.push(n);else if(e.push(r),Array.isArray(r))for(n=0,s=r.length;n<s;n+=1)Gm(r[n],e,t);else for(i=Object.keys(r),n=0,s=i.length;n<s;n+=1)Gm(r[i[n]],e,t)}o(Gm,"inspectNode");function A6(r,e){e=e||{};var t=new p6(e);t.noRefs||x6(r,t);var i=r;return t.replacer&&(i=t.replacer.call({"":i},"",i)),nn(t,0,i,!0,!0)?t.dump+`
`:""}o(A6,"dump$1");var C6=A6,O6={dump:C6};function Qm(r,e){return function(){throw new Error("Function yaml."+r+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}o(Qm,"renamed");var F6=kt,P6=f_,R6=m_,I6=S_,D6=w_,N6=Hm,k6=V_.load,j6=V_.loadAll,L6=O6.dump,M6=sr,V6={binary:A_,float:__,map:p_,null:g_,pairs:O_,set:F_,timestamp:T_,bool:y_,int:v_,merge:x_,omap:C_,seq:d_,str:h_},q6=Qm("safeLoad","load"),$6=Qm("safeLoadAll","loadAll"),U6=Qm("safeDump","dump"),Eo={Type:F6,Schema:P6,FAILSAFE_SCHEMA:R6,JSON_SCHEMA:I6,CORE_SCHEMA:D6,DEFAULT_SCHEMA:N6,load:k6,loadAll:j6,dump:L6,YAMLException:M6,types:V6,safeLoad:q6,safeLoadAll:$6,safeDump:U6};var Cl=class{constructor(e){this.rootPath=e}static{o(this,"FileSystemVaultAdapter")}async read(e){let t=this.resolvePath(e.path);if(!await vt.default.pathExists(t))throw new Error(`File not found: ${e.path}`);return vt.default.readFile(t,"utf-8")}async create(e,t){let i=this.resolvePath(e);if(await vt.default.pathExists(i))throw new Error(`File already exists: ${e}`);return await vt.default.ensureDir(Gt.default.dirname(i)),await vt.default.writeFile(i,t,"utf-8"),this.createFileObject(e)}async modify(e,t){let i=this.resolvePath(e.path);if(!await vt.default.pathExists(i))throw new Error(`File not found: ${e.path}`);await vt.default.writeFile(i,t,"utf-8")}async delete(e){let t=this.resolvePath(e.path);if(!await vt.default.pathExists(t))throw new Error(`File not found: ${e.path}`);await vt.default.remove(t)}async exists(e){let t=this.resolvePath(e);return vt.default.pathExists(t)}getAbstractFileByPath(e){let t=this.resolvePath(e);try{let i=vt.default.statSync(t);if(i.isFile())return this.createFileObject(e);if(i.isDirectory())return this.createFolderObject(e)}catch{return null}return null}getAllFiles(){let e=[];return this.walkDirectory(this.rootPath,t=>{if(t.endsWith(".md")){let i=Gt.default.relative(this.rootPath,t);e.push(this.createFileObject(i))}}),e}getFrontmatter(e){try{let t=vt.default.readFileSync(this.resolvePath(e.path),"utf-8");return this.extractFrontmatter(t)}catch{return null}}async updateFrontmatter(e,t){let i=await this.read(e),n=this.extractFrontmatter(i)||{},s=t(n),a=this.replaceFrontmatter(i,s);await this.modify(e,a)}async rename(e,t){let i=this.resolvePath(e.path),n=this.resolvePath(t);if(!await vt.default.pathExists(i))throw new Error(`File not found: ${e.path}`);await vt.default.ensureDir(Gt.default.dirname(n)),await vt.default.move(i,n)}async createFolder(e){let t=this.resolvePath(e);await vt.default.ensureDir(t)}getFirstLinkpathDest(e,t){let i=Gt.default.dirname(this.resolvePath(t)),n;if(Gt.default.isAbsolute(e)?n=this.resolvePath(e):n=Gt.default.resolve(i,e),e.endsWith(".md")||(n+=".md"),vt.default.existsSync(n)){let s=Gt.default.relative(this.rootPath,n);return this.createFileObject(s)}return null}async process(e,t){let i=await this.read(e),n=t(i);return await this.modify(e,n),n}getDefaultNewFileParent(){return{path:"",name:""}}async updateLinks(e,t,i){return Promise.resolve()}resolvePath(e){return Gt.default.isAbsolute(e)?e:Gt.default.join(this.rootPath,e)}createFileObject(e){let t=Gt.default.basename(e),i=Gt.default.basename(e,Gt.default.extname(e)),n=Gt.default.dirname(e);return{path:e,basename:t,name:i,parent:n!=="."?this.createFolderObject(n):null}}createFolderObject(e){return{path:e,name:Gt.default.basename(e)}}extractFrontmatter(e){let t=/^---\n([\s\S]*?)\n---/,i=e.match(t);if(!i)return null;try{let n=Eo.load(i[1]);return typeof n=="object"&&n!==null?n:null}catch{return null}}replaceFrontmatter(e,t){let i=Eo.dump(t,{lineWidth:-1,noRefs:!0,quotingType:'"'}),n=/^---\n([\s\S]*?)\n---/;return e.match(n)?e.replace(n,`---
${i.trim()}
---`):`---
${i.trim()}
---
${e}`}walkDirectory(e,t){let i=vt.default.readdirSync(e,{withFileTypes:!0});for(let n of i){let s=Gt.default.join(e,n.name);n.isDirectory()?this.walkDirectory(s,t):n.isFile()&&t(s)}}};var Ol=class{static{o(this,"TableFormatter")}format(e){if(e.length===0)return"No results";let t=this.getAllVariables(e),i=e.map(n=>this.solutionToRow(n,t));return this.renderTable(t,i)}getAllVariables(e){let t=new Set;for(let i of e)for(let n of i.variables())t.add(n);return Array.from(t).sort()}solutionToRow(e,t){return t.map(i=>{let n=e.get(i);return n?this.formatValue(n.toString()):""})}formatValue(e){return e.length>50?e.substring(0,47)+"...":e}renderTable(e,t){let i=e.map((s,a)=>{let c=s.length+1,u=Math.max(...t.map(f=>f[a]?.length||0));return Math.max(c,u,10)}),n=[];n.push(this.renderSeparator(i,"top")),n.push(this.renderRow(e.map(s=>`?${s}`),i)),n.push(this.renderSeparator(i,"mid"));for(let s of t)n.push(this.renderRow(s,i));return n.push(this.renderSeparator(i,"bottom")),n.join(`
`)}renderRow(e,t){return`\u2502 ${e.map((n,s)=>n.padEnd(t[s])).join(" \u2502 ")} \u2502`}renderSeparator(e,t){let i=t==="top"?"\u250C":t==="mid"?"\u251C":"\u2514",n=t==="top"?"\u2510":t==="mid"?"\u2524":"\u2518",a=t==="mid"?"\u2500\u253C\u2500":"\u2500"+(t==="mid"?"\u253C":"\u2500")+"\u2500",c=e.map(u=>"\u2500".repeat(u+2));return`${i}${c.join(a)}${n}`}};var Fl=class{static{o(this,"JsonFormatter")}format(e){let t=e.map(i=>i.toJSON());return JSON.stringify(t,null,2)}};var To=class{static{o(this,"TriplesFormatter")}formatNTriples(e){return e.map(t=>t.toString()).join(`
`)}formatTable(e){if(e.length===0)return"No triples generated.";let t=[];t.push("Subject | Predicate | Object"),t.push("------- | --------- | ------");for(let i of e){let n=this.formatNode(i.subject),s=this.formatNode(i.predicate),a=this.formatNode(i.object);t.push(`${n} | ${s} | ${a}`)}return t.join(`
`)}formatJson(e){let t=e.map(i=>({subject:this.nodeToJson(i.subject),predicate:this.nodeToJson(i.predicate),object:this.nodeToJson(i.object)}));return JSON.stringify(t,null,2)}formatNode(e){return e.value!==void 0?String(e.value):String(e)}nodeToJson(e){return"datatype"in e||"language"in e?{type:"literal",value:String(e.value),...e.datatype&&{datatype:e.datatype.value||String(e.datatype)},...e.language&&{language:e.language}}:"id"in e&&String(e.id).startsWith("_:")?{type:"bnode",value:String(e.id)}:{type:"uri",value:String(e.value)}}};function J_(r){return r.startsWith("VALIDATION_")?"validation":r.startsWith("PERMISSION_")?"permission":r.startsWith("STATE_")?"state":"internal"}o(J_,"getErrorCategory");var gt=class{static{o(this,"ResponseBuilder")}static success(e,t){return{success:!0,data:e,...t&&{meta:t}}}static error(e,t,i,n){return{success:!1,error:{code:e,category:J_(e),message:t,exitCode:i,...n?.recovery&&{recovery:n.recovery},...n?.context&&{context:n.context},...n?.stack&&{stack:n.stack}}}}};var ar=class extends Error{static{o(this,"CLIError")}constructor(e,t,i){super(e),this.name=this.constructor.name,this.context=t,this.recoveryHint=i,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}format(){let e=`\u274C ${this.name}: ${this.message}`;if(this.guidance&&(e+=`

\u{1F4A1} ${this.guidance}`),this.context&&Object.keys(this.context).length>0){e+=`

\u{1F4CB} Context:`;for(let[t,i]of Object.entries(this.context))e+=`
  ${t}: ${JSON.stringify(i)}`}return e}toStructuredResponse(e=!1){return gt.error(this.errorCode,this.message,this.exitCode,{recovery:this.recoveryHint||{message:this.guidance},context:this.context,stack:e?this.stack:void 0})}formatJson(e=!1){return JSON.stringify(this.toStructuredResponse(e),null,2)}};var Ee=class r{static{o(this,"ErrorHandler")}static{this.outputFormat="text"}static setFormat(e){r.outputFormat=e}static getFormat(){return r.outputFormat}static isDebugMode(){return!!process.env.DEBUG}static handle(e){if(e instanceof ar){if(r.outputFormat==="json"){let n=e.toStructuredResponse(r.isDebugMode());console.log(JSON.stringify(n,null,2))}else console.error(e.format()),r.isDebugMode()&&(console.error(`
\u{1F4CD} Stack trace:`),console.error(e.stack));process.exit(e.exitCode)}let{exitCode:t,errorCode:i}=r.classifyError(e);if(r.outputFormat==="json"){let n=r.buildErrorResponse(i,e.message,t,r.isDebugMode()?e.stack:void 0);console.log(JSON.stringify(n,null,2))}else console.error(`\u274C Error: ${e.message}`),r.isDebugMode()&&console.error(e.stack);process.exit(t)}static handleWithMessage(e,t=1,i="INTERNAL_UNKNOWN"){if(r.outputFormat==="json"){let n=r.buildErrorResponse(i,e,t);console.log(JSON.stringify(n,null,2))}else console.error(`\u274C Error: ${e}`);process.exit(t)}static classifyError(e){let t=e.message.toLowerCase();return t.includes("transition")?{exitCode:6,errorCode:"STATE_INVALID_TRANSITION"}:t.includes("transaction")?{exitCode:7,errorCode:"INTERNAL_TRANSACTION_FAILED"}:t.includes("concurrent")||t.includes("modified")?{exitCode:8,errorCode:"STATE_CONCURRENT_MODIFICATION"}:e.message.includes("not found")||e.message.includes("ENOENT")?{exitCode:3,errorCode:"VALIDATION_FILE_NOT_FOUND"}:e.message.includes("EACCES")||e.message.includes("permission denied")?{exitCode:4,errorCode:"PERMISSION_DENIED"}:e.message.includes("Invalid")||e.message.includes("outside vault")||e.message.includes("Not a")?{exitCode:2,errorCode:"VALIDATION_INVALID_ARGUMENTS"}:{exitCode:1,errorCode:"INTERNAL_UNKNOWN"}}static buildErrorResponse(e,t,i,n){return gt.error(e,t,i,{recovery:r.getRecoveryHint(e),stack:n})}static getRecoveryHint(e){switch(e){case"VALIDATION_FILE_NOT_FOUND":return{message:"Verify the file path is correct and the file exists",suggestion:"Check file path spelling and ensure the file is in the vault"};case"VALIDATION_VAULT_NOT_FOUND":return{message:"Verify the vault path is correct",suggestion:"Check --vault option or current directory"};case"VALIDATION_INVALID_ARGUMENTS":return{message:"Check command syntax and argument format",suggestion:"Use --help for usage information"};case"STATE_INVALID_TRANSITION":return{message:"The requested state transition is not allowed",suggestion:"Check the current asset state and valid transitions"};case"STATE_CONCURRENT_MODIFICATION":return{message:"File was modified by another process",suggestion:"Wait and retry the command"};case"PERMISSION_DENIED":return{message:"Check file permissions",suggestion:"Ensure you have write access to the vault"};case"INTERNAL_TRANSACTION_FAILED":return{message:"Transaction could not complete",suggestion:"Check for locked files and retry"};default:return{message:"An unexpected error occurred",suggestion:"Check the error details and retry"}}}};var xo=class extends ar{constructor(t,i){super(`File not found: ${t}`,{filepath:t,...i},{message:"Verify the file path is correct and the file exists",suggestion:`ls -la "${t}" or find . -name "$(basename ${t})"`});this.exitCode=3;this.errorCode="VALIDATION_FILE_NOT_FOUND";this.guidance=`Verify the file path is correct and the file exists.
Check:
  \u2022 File path spelling
  \u2022 File is in the vault directory
  \u2022 File has .md extension`}static{o(this,"FileNotFoundError")}};var tt=class extends ar{constructor(t,i,n){let s=`Check command syntax and argument format.
Use: exocortex command --help for usage information.`;super(t,n,{message:i||"Check command syntax and argument format",suggestion:"exocortex command --help"});this.exitCode=2;this.errorCode="VALIDATION_INVALID_ARGUMENTS";this.guidance=i||s}static{o(this,"InvalidArgumentsError")}};var sn=class extends ar{constructor(t,i){super(`Vault not found: ${t}`,{vaultPath:t,...i},{message:"Verify the vault path is correct and the directory exists",suggestion:`ls -la "${t}" or check --vault option`});this.exitCode=3;this.errorCode="VALIDATION_VAULT_NOT_FOUND";this.guidance=`The specified vault directory does not exist.
Check:
  \u2022 Path spelling and case sensitivity
  \u2022 Directory exists and is accessible
  \u2022 You have read permissions for the directory`}static{o(this,"VaultNotFoundError")}};function X_(){return new Pr("query").description("Execute SPARQL query against Obsidian vault").argument("<query>","SPARQL query string or path to .sparql file").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--format <type>","Output format: table|json|csv|ntriples","table").option("--output <type>","Response format: text|json (for MCP tools)","text").option("--explain","Show optimized query plan").option("--stats","Show execution statistics").option("--no-optimize","Disable query optimization").action(async(r,e)=>{let t=e.output||"text";Ee.setFormat(t);try{let i=Date.now(),n=B6(r),s=(0,Jm.resolve)(e.vault);if(!(0,Ao.existsSync)(s))throw new sn(s);t==="text"&&console.log(`\u{1F4E6} Loading vault: ${s}...`);let a=Date.now(),c=new Cl(s),f=await new cr.NoteToRDFConverter(c).convertVault(),l=new cr.InMemoryTripleStore;await l.addAll(f);let h=Date.now()-a;t==="text"&&(console.log(`\u2705 Loaded ${f.length} triples in ${h}ms
`),console.log("\u{1F50D} Parsing SPARQL query..."));let g=new cr.SPARQLParser().parse(n);t==="text"&&console.log("\u{1F504} Translating to algebra...");let _=new cr.AlgebraTranslator().translate(g);if(!e.noOptimize&&_.type!=="construct")_=new cr.AlgebraOptimizer().optimize(_);else if(!e.noOptimize&&_.type==="construct"){let P=new cr.AlgebraOptimizer,j=_;_={...j,where:P.optimize(j.where)}}if(e.explain&&t==="text"){console.log("\u{1F4CA} Query Plan:");let P=new cr.AlgebraSerializer;if(_.type==="construct"){let j=_;console.log("CONSTRUCT Template:"),console.log("  (template patterns)"),console.log("WHERE:"),console.log(P.toString(j.where))}else console.log(P.toString(_));console.log()}t==="text"&&console.log("\u{1F3AF} Executing query...");let A=Date.now(),F=new cr.QueryExecutor(l);if(F.isConstructQuery(_)){let P=await F.executeConstruct(_),j=Date.now()-A,B=Date.now()-i;if(t==="json"){let K=new To,Ie={query:n,count:P.length,triples:JSON.parse(K.formatJson(P))},Xe=gt.success(Ie,{durationMs:B,itemCount:P.length,loadDurationMs:h,execDurationMs:j,triplesScanned:f.length});console.log(JSON.stringify(Xe,null,2))}else console.log(`\u2705 Generated ${P.length} triple(s) in ${j}ms
`),P.length>0?W6(P,e.format):console.log("No triples generated."),e.stats&&(console.log(`
\u{1F4CA} Execution Statistics:`),console.log(`  Vault loading: ${h}ms`),console.log(`  Query execution: ${j}ms`),console.log(`  Total time: ${B}ms`),console.log(`  Triples scanned: ${f.length}`),console.log(`  Triples generated: ${P.length}`))}else{let P=await F.executeAll(_),j=Date.now()-A,B=Date.now()-i;if(t==="json"){let K=P.map(ot=>ot.toJSON()),Ie={query:n,count:P.length,bindings:K},Xe=gt.success(Ie,{durationMs:B,itemCount:P.length,loadDurationMs:h,execDurationMs:j,triplesScanned:f.length});console.log(JSON.stringify(Xe,null,2))}else console.log(`\u2705 Found ${P.length} result(s) in ${j}ms
`),P.length>0?G6(P,e.format):console.log("No results found."),e.stats&&(console.log(`
\u{1F4CA} Execution Statistics:`),console.log(`  Vault loading: ${h}ms`),console.log(`  Query execution: ${j}ms`),console.log(`  Total time: ${B}ms`),console.log(`  Triples scanned: ${f.length}`),console.log(`  Results returned: ${P.length}`))}}catch(i){Ee.handle(i)}})}o(X_,"sparqlQueryCommand");function B6(r){if(r.includes("SELECT")||r.includes("CONSTRUCT"))return r;let e=(0,Jm.resolve)(r);return(0,Ao.existsSync)(e)?(0,Ao.readFileSync)(e,"utf-8"):r}o(B6,"loadQuery");function G6(r,e){switch(e){case"json":let t=new Fl;console.log(t.format(r));break;case"table":default:let i=new Ol;console.log(i.format(r));break}}o(G6,"formatSelectResults");function W6(r,e){let t=new To;switch(e){case"json":console.log(t.formatJson(r));break;case"ntriples":console.log(t.formatNTriples(r));break;case"table":default:console.log(t.formatTable(r));break}}o(W6,"formatConstructResults");var nw=require("path");var _t=Ke(ca()),Dn=Ke(require("path"));var _S=Ke(fS(),1);var Oo=o(r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>65536)throw new TypeError("pattern is too long")},"assertValidPattern");var Z6={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},Fo=o(r=>r.replace(/[[\]\\-]/g,"\\$&"),"braceEscape"),eR=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regexpEscape"),hS=o(r=>r.join(""),"rangesToString"),dS=o((r,e)=>{let t=e;if(r.charAt(t)!=="[")throw new Error("not in a brace expression");let i=[],n=[],s=t+1,a=!1,c=!1,u=!1,f=!1,l=t,h="";e:for(;s<r.length;){let _=r.charAt(s);if((_==="!"||_==="^")&&s===t+1){f=!0,s++;continue}if(_==="]"&&a&&!u){l=s+1;break}if(a=!0,_==="\\"&&!u){u=!0,s++;continue}if(_==="["&&!u){for(let[A,[F,P,j]]of Object.entries(Z6))if(r.startsWith(A,s)){if(h)return["$.",!1,r.length-t,!0];s+=A.length,j?n.push(F):i.push(F),c=c||P;continue e}}if(u=!1,h){_>h?i.push(Fo(h)+"-"+Fo(_)):_===h&&i.push(Fo(_)),h="",s++;continue}if(r.startsWith("-]",s+1)){i.push(Fo(_+"-")),s+=2;continue}if(r.startsWith("-",s+1)){h=_,s+=2;continue}i.push(Fo(_)),s++}if(l<s)return["",!1,0,!1];if(!i.length&&!n.length)return["$.",!1,r.length-t,!0];if(n.length===0&&i.length===1&&/^\\?.$/.test(i[0])&&!f){let _=i[0].length===2?i[0].slice(-1):i[0];return[eR(_),!1,l-t,!1]}let p="["+(f?"^":"")+hS(i)+"]",g="["+(f?"":"^")+hS(n)+"]";return[i.length&&n.length?"("+p+"|"+g+")":i.length?p:g,c,l-t,!0]},"parseClass");var ui=o((r,{windowsPathsNoEscape:e=!1}={})=>e?r.replace(/\[([^\/\\])\]/g,"$1"):r.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),"unescape");var tR=new Set(["!","?","+","*","@"]),pS=o(r=>tR.has(r),"isExtglobType"),rR="(?!(?:^|/)\\.\\.?(?:$|/))",Pl="(?!\\.)",iR=new Set(["[","."]),nR=new Set(["..","."]),sR=new Set("().*{}+?[]^$\\!"),aR=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),e1="[^/]",mS=e1+"*?",gS=e1+"+?",da=class r{static{o(this,"AST")}type;#e;#t;#s=!1;#i=[];#a;#S;#u;#f=!1;#o;#c;#n=!1;constructor(e,t,i={}){this.type=e,e&&(this.#t=!0),this.#a=t,this.#e=this.#a?this.#a.#e:this,this.#o=this.#e===this?i:this.#e.#o,this.#u=this.#e===this?[]:this.#e.#u,e==="!"&&!this.#e.#f&&this.#u.push(this),this.#S=this.#a?this.#a.#i.length:0}get hasMagic(){if(this.#t!==void 0)return this.#t;for(let e of this.#i)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return this.#c!==void 0?this.#c:this.type?this.#c=this.type+"("+this.#i.map(e=>String(e)).join("|")+")":this.#c=this.#i.map(e=>String(e)).join("")}#g(){if(this!==this.#e)throw new Error("should only call on root");if(this.#f)return this;this.toString(),this.#f=!0;let e;for(;e=this.#u.pop();){if(e.type!=="!")continue;let t=e,i=t.#a;for(;i;){for(let n=t.#S+1;!i.type&&n<i.#i.length;n++)for(let s of e.#i){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(i.#i[n])}t=i,i=t.#a}}return this}push(...e){for(let t of e)if(t!==""){if(typeof t!="string"&&!(t instanceof r&&t.#a===this))throw new Error("invalid part: "+t);this.#i.push(t)}}toJSON(){let e=this.type===null?this.#i.slice().map(t=>typeof t=="string"?t:t.toJSON()):[this.type,...this.#i.map(t=>t.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#f&&this.#a?.type==="!")&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#a?.isStart())return!1;if(this.#S===0)return!0;let e=this.#a;for(let t=0;t<this.#S;t++){let i=e.#i[t];if(!(i instanceof r&&i.type==="!"))return!1}return!0}isEnd(){if(this.#e===this||this.#a?.type==="!")return!0;if(!this.#a?.isEnd())return!1;if(!this.type)return this.#a?.isEnd();let e=this.#a?this.#a.#i.length:0;return this.#S===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let t=new r(this.type,e);for(let i of this.#i)t.copyIn(i);return t}static#y(e,t,i,n){let s=!1,a=!1,c=-1,u=!1;if(t.type===null){let g=i,S="";for(;g<e.length;){let _=e.charAt(g++);if(s||_==="\\"){s=!s,S+=_;continue}if(a){g===c+1?(_==="^"||_==="!")&&(u=!0):_==="]"&&!(g===c+2&&u)&&(a=!1),S+=_;continue}else if(_==="["){a=!0,c=g,u=!1,S+=_;continue}if(!n.noext&&pS(_)&&e.charAt(g)==="("){t.push(S),S="";let A=new r(_,t);g=r.#y(e,A,g,n),t.push(A);continue}S+=_}return t.push(S),g}let f=i+1,l=new r(null,t),h=[],p="";for(;f<e.length;){let g=e.charAt(f++);if(s||g==="\\"){s=!s,p+=g;continue}if(a){f===c+1?(g==="^"||g==="!")&&(u=!0):g==="]"&&!(f===c+2&&u)&&(a=!1),p+=g;continue}else if(g==="["){a=!0,c=f,u=!1,p+=g;continue}if(pS(g)&&e.charAt(f)==="("){l.push(p),p="";let S=new r(g,l);l.push(S),f=r.#y(e,S,f,n);continue}if(g==="|"){l.push(p),p="",h.push(l),l=new r(null,t);continue}if(g===")")return p===""&&t.#i.length===0&&(t.#n=!0),l.push(p),p="",t.push(...h,l),f;p+=g}return t.type=null,t.#t=void 0,t.#i=[e.substring(i-1)],f}static fromGlob(e,t={}){let i=new r(null,void 0,t);return r.#y(e,i,0,t),i}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();let e=this.toString(),[t,i,n,s]=this.toRegExpSource();if(!(n||this.#t||this.#o.nocase&&!this.#o.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return i;let c=(this.#o.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${t}$`,c),{_src:t,_glob:e})}get options(){return this.#o}toRegExpSource(e){let t=e??!!this.#o.dot;if(this.#e===this&&this.#g(),!this.type){let u=this.isStart()&&this.isEnd(),f=this.#i.map(g=>{let[S,_,A,F]=typeof g=="string"?r.#h(g,this.#t,u):g.toRegExpSource(e);return this.#t=this.#t||A,this.#s=this.#s||F,S}).join(""),l="";if(this.isStart()&&typeof this.#i[0]=="string"&&!(this.#i.length===1&&nR.has(this.#i[0]))){let S=iR,_=t&&S.has(f.charAt(0))||f.startsWith("\\.")&&S.has(f.charAt(2))||f.startsWith("\\.\\.")&&S.has(f.charAt(4)),A=!t&&!e&&S.has(f.charAt(0));l=_?rR:A?Pl:""}let h="";return this.isEnd()&&this.#e.#f&&this.#a?.type==="!"&&(h="(?:$|\\/)"),[l+f+h,ui(f),this.#t=!!this.#t,this.#s]}let i=this.type==="*"||this.type==="+",n=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#d(t);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let u=this.toString();return this.#i=[u],this.type=null,this.#t=void 0,[u,ui(this.toString()),!1,!1]}let a=!i||e||t||!Pl?"":this.#d(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#n)c=(this.isStart()&&!t?Pl:"")+gS;else{let u=this.type==="!"?"))"+(this.isStart()&&!t&&!e?Pl:"")+mS+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=n+s+u}return[c,ui(s),this.#t=!!this.#t,this.#s]}#d(e){return this.#i.map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");let[i,n,s,a]=t.toRegExpSource(e);return this.#s=this.#s||a,i}).filter(t=>!(this.isStart()&&this.isEnd())||!!t).join("|")}static#h(e,t,i=!1){let n=!1,s="",a=!1;for(let c=0;c<e.length;c++){let u=e.charAt(c);if(n){n=!1,s+=(sR.has(u)?"\\":"")+u;continue}if(u==="\\"){c===e.length-1?s+="\\\\":n=!0;continue}if(u==="["){let[f,l,h,p]=dS(e,c);if(h){s+=f,a=a||l,c+=h-1,t=t||p;continue}}if(u==="*"){i&&e==="*"?s+=gS:s+=mS,t=!0;continue}if(u==="?"){s+=e1,t=!0;continue}s+=aR(u)}return[s,ui(e),!!t,a]}};var pa=o((r,{windowsPathsNoEscape:e=!1}={})=>e?r.replace(/[?*()[\]]/g,"[$&]"):r.replace(/[?*()[\]\\]/g,"\\$&"),"escape");var Lt=o((r,e,t={})=>(Oo(e),!t.nocomment&&e.charAt(0)==="#"?!1:new Ar(e,t).match(r)),"minimatch"),oR=/^\*+([^+@!?\*\[\(]*)$/,cR=o(r=>e=>!e.startsWith(".")&&e.endsWith(r),"starDotExtTest"),uR=o(r=>e=>e.endsWith(r),"starDotExtTestDot"),lR=o(r=>(r=r.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(r)),"starDotExtTestNocase"),fR=o(r=>(r=r.toLowerCase(),e=>e.toLowerCase().endsWith(r)),"starDotExtTestNocaseDot"),hR=/^\*+\.\*+$/,dR=o(r=>!r.startsWith(".")&&r.includes("."),"starDotStarTest"),pR=o(r=>r!=="."&&r!==".."&&r.includes("."),"starDotStarTestDot"),mR=/^\.\*+$/,gR=o(r=>r!=="."&&r!==".."&&r.startsWith("."),"dotStarTest"),yR=/^\*+$/,vR=o(r=>r.length!==0&&!r.startsWith("."),"starTest"),_R=o(r=>r.length!==0&&r!=="."&&r!=="..","starTestDot"),SR=/^\?+([^+@!?\*\[\(]*)?$/,wR=o(([r,e=""])=>{let t=SS([r]);return e?(e=e.toLowerCase(),i=>t(i)&&i.toLowerCase().endsWith(e)):t},"qmarksTestNocase"),bR=o(([r,e=""])=>{let t=wS([r]);return e?(e=e.toLowerCase(),i=>t(i)&&i.toLowerCase().endsWith(e)):t},"qmarksTestNocaseDot"),ER=o(([r,e=""])=>{let t=wS([r]);return e?i=>t(i)&&i.endsWith(e):t},"qmarksTestDot"),TR=o(([r,e=""])=>{let t=SS([r]);return e?i=>t(i)&&i.endsWith(e):t},"qmarksTest"),SS=o(([r])=>{let e=r.length;return t=>t.length===e&&!t.startsWith(".")},"qmarksTestNoExt"),wS=o(([r])=>{let e=r.length;return t=>t.length===e&&t!=="."&&t!==".."},"qmarksTestNoExtDot"),bS=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",yS={win32:{sep:"\\"},posix:{sep:"/"}},xR=bS==="win32"?yS.win32.sep:yS.posix.sep;Lt.sep=xR;var jt=Symbol("globstar **");Lt.GLOBSTAR=jt;var AR="[^/]",CR=AR+"*?",OR="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",FR="(?:(?!(?:\\/|^)\\.).)*?",PR=o((r,e={})=>t=>Lt(t,r,e),"filter");Lt.filter=PR;var jr=o((r,e={})=>Object.assign({},r,e),"ext"),RR=o(r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return Lt;let e=Lt;return Object.assign(o((i,n,s={})=>e(i,n,jr(r,s)),"m"),{Minimatch:class extends e.Minimatch{static{o(this,"Minimatch")}constructor(n,s={}){super(n,jr(r,s))}static defaults(n){return e.defaults(jr(r,n)).Minimatch}},AST:class extends e.AST{static{o(this,"AST")}constructor(n,s,a={}){super(n,s,jr(r,a))}static fromGlob(n,s={}){return e.AST.fromGlob(n,jr(r,s))}},unescape:o((i,n={})=>e.unescape(i,jr(r,n)),"unescape"),escape:o((i,n={})=>e.escape(i,jr(r,n)),"escape"),filter:o((i,n={})=>e.filter(i,jr(r,n)),"filter"),defaults:o(i=>e.defaults(jr(r,i)),"defaults"),makeRe:o((i,n={})=>e.makeRe(i,jr(r,n)),"makeRe"),braceExpand:o((i,n={})=>e.braceExpand(i,jr(r,n)),"braceExpand"),match:o((i,n,s={})=>e.match(i,n,jr(r,s)),"match"),sep:e.sep,GLOBSTAR:jt})},"defaults");Lt.defaults=RR;var ES=o((r,e={})=>(Oo(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:(0,_S.default)(r)),"braceExpand");Lt.braceExpand=ES;var IR=o((r,e={})=>new Ar(r,e).makeRe(),"makeRe");Lt.makeRe=IR;var DR=o((r,e,t={})=>{let i=new Ar(e,t);return r=r.filter(n=>i.match(n)),i.options.nonull&&!r.length&&r.push(e),r},"match");Lt.match=DR;var vS=/[?*]|[+@!]\(.*?\)|\[|\]/,NR=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),Ar=class{static{o(this,"Minimatch")}options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){Oo(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||bS,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let t of e)if(typeof t!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let i=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(i),this.debug(this.pattern,this.globParts);let n=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let u=s[0]===""&&s[1]===""&&(s[2]==="?"||!vS.test(s[2]))&&!vS.test(s[3]),f=/^[a-z]:/i.test(s[0]);if(u)return[...s.slice(0,4),...s.slice(4).map(l=>this.parse(l))];if(f)return[s[0],...s.slice(1).map(l=>this.parse(l))]}return s.map(u=>this.parse(u))});if(this.debug(this.pattern,n),this.set=n.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let i=0;i<e.length;i++)for(let n=0;n<e[i].length;n++)e[i][n]==="**"&&(e[i][n]="*");let{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):t>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let i=-1;for(;(i=t.indexOf("**",i+1))!==-1;){let n=i;for(;t[n+1]==="**";)n++;n!==i&&t.splice(i,n-i)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((i,n)=>{let s=i[i.length-1];return n==="**"&&s==="**"?i:n===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(i.pop(),i):(i.push(n),i)},[]),t.length===0?[""]:t))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let n=1;n<e.length-1;n++){let s=e[n];n===1&&s===""&&e[0]===""||(s==="."||s==="")&&(t=!0,e.splice(n,1),n--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(t=!0,e.pop())}let i=0;for(;(i=e.indexOf("..",i+1))!==-1;){let n=e[i-1];n&&n!=="."&&n!==".."&&n!=="**"&&(t=!0,e.splice(i-1,2),i-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let i of e){let n=-1;for(;(n=i.indexOf("**",n+1))!==-1;){let a=n;for(;i[a+1]==="**";)a++;a>n&&i.splice(n+1,a-n);let c=i[n+1],u=i[n+2],f=i[n+3];if(c!==".."||!u||u==="."||u===".."||!f||f==="."||f==="..")continue;t=!0,i.splice(n,1);let l=i.slice(0);l[n]="**",e.push(l),n--}if(!this.preserveMultipleSlashes){for(let a=1;a<i.length-1;a++){let c=i[a];a===1&&c===""&&i[0]===""||(c==="."||c==="")&&(t=!0,i.splice(a,1),a--)}i[0]==="."&&i.length===2&&(i[1]==="."||i[1]==="")&&(t=!0,i.pop())}let s=0;for(;(s=i.indexOf("..",s+1))!==-1;){let a=i[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){t=!0;let u=s===1&&i[s+1]==="**"?["."]:[];i.splice(s-1,2,...u),i.length===0&&i.push(""),s-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let i=t+1;i<e.length;i++){let n=this.partsMatch(e[t],e[i],!this.preserveMultipleSlashes);if(n){e[t]=[],e[i]=n;break}}return e.filter(t=>t.length)}partsMatch(e,t,i=!1){let n=0,s=0,a=[],c="";for(;n<e.length&&s<t.length;)if(e[n]===t[s])a.push(c==="b"?t[s]:e[n]),n++,s++;else if(i&&e[n]==="**"&&t[s]===e[n+1])a.push(e[n]),n++;else if(i&&t[s]==="**"&&e[n]===t[s+1])a.push(t[s]),s++;else if(e[n]==="*"&&t[s]&&(this.options.dot||!t[s].startsWith("."))&&t[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[n]),n++,s++}else if(t[s]==="*"&&e[n]&&(this.options.dot||!e[n].startsWith("."))&&e[n]!=="**"){if(c==="a")return!1;c="b",a.push(t[s]),n++,s++}else return!1;return e.length===t.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,t=!1,i=0;for(let n=0;n<e.length&&e.charAt(n)==="!";n++)t=!t,i++;i&&(this.pattern=e.slice(i)),this.negate=t}matchOne(e,t,i=!1){let n=this.options;if(this.isWindows){let _=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),A=!_&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),F=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),P=!F&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3]),j=A?3:_?0:void 0,B=P?3:F?0:void 0;if(typeof j=="number"&&typeof B=="number"){let[K,Ie]=[e[j],t[B]];K.toLowerCase()===Ie.toLowerCase()&&(t[B]=K,B>j?t=t.slice(B):j>B&&(e=e.slice(j)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var a=0,c=0,u=e.length,f=t.length;a<u&&c<f;a++,c++){this.debug("matchOne loop");var l=t[c],h=e[a];if(this.debug(t,l,h),l===!1)return!1;if(l===jt){this.debug("GLOBSTAR",[t,l,h]);var p=a,g=c+1;if(g===f){for(this.debug("** at the end");a<u;a++)if(e[a]==="."||e[a]===".."||!n.dot&&e[a].charAt(0)===".")return!1;return!0}for(;p<u;){var S=e[p];if(this.debug(`
globstar while`,e,p,t,g,S),this.matchOne(e.slice(p),t.slice(g),i))return this.debug("globstar found match!",p,u,S),!0;if(S==="."||S===".."||!n.dot&&S.charAt(0)==="."){this.debug("dot detected!",e,p,t,g);break}this.debug("globstar swallow a segment, and continue"),p++}return!!(i&&(this.debug(`
>>> no match, partial?`,e,p,t,g),p===u))}let _;if(typeof l=="string"?(_=h===l,this.debug("string match",l,h,_)):(_=l.test(h),this.debug("pattern match",l,h,_)),!_)return!1}if(a===u&&c===f)return!0;if(a===u)return i;if(c===f)return a===u-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return ES(this.pattern,this.options)}parse(e){Oo(e);let t=this.options;if(e==="**")return jt;if(e==="")return"";let i,n=null;(i=e.match(yR))?n=t.dot?_R:vR:(i=e.match(oR))?n=(t.nocase?t.dot?fR:lR:t.dot?uR:cR)(i[1]):(i=e.match(SR))?n=(t.nocase?t.dot?bR:wR:t.dot?ER:TR)(i):(i=e.match(hR))?n=t.dot?pR:dR:(i=e.match(mR))&&(n=gR);let s=da.fromGlob(e,this.options).toMMPattern();return n&&typeof s=="object"&&Reflect.defineProperty(s,"test",{value:n}),s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,i=t.noglobstar?CR:t.dot?OR:FR,n=new Set(t.nocase?["i"]:[]),s=e.map(u=>{let f=u.map(l=>{if(l instanceof RegExp)for(let h of l.flags.split(""))n.add(h);return typeof l=="string"?NR(l):l===jt?jt:l._src});return f.forEach((l,h)=>{let p=f[h+1],g=f[h-1];l!==jt||g===jt||(g===void 0?p!==void 0&&p!==jt?f[h+1]="(?:\\/|"+i+"\\/)?"+p:f[h]=i:p===void 0?f[h-1]=g+"(?:\\/|"+i+")?":p!==jt&&(f[h-1]=g+"(?:\\/|\\/"+i+"\\/)"+p,f[h+1]=jt))}),f.filter(l=>l!==jt).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...n].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let i=this.options;this.isWindows&&(e=e.split("\\").join("/"));let n=this.slashSplit(e);this.debug(this.pattern,"split",n);let s=this.set;this.debug(this.pattern,"set",s);let a=n[n.length-1];if(!a)for(let c=n.length-2;!a&&c>=0;c--)a=n[c];for(let c=0;c<s.length;c++){let u=s[c],f=n;if(i.matchBase&&u.length===1&&(f=[a]),this.matchOne(f,u,t))return i.flipNegate?!0:!this.negate}return i.flipNegate?!1:this.negate}static defaults(e){return Lt.defaults(e).Minimatch}};Lt.AST=da;Lt.Minimatch=Ar;Lt.escape=pa;Lt.unescape=ui;var zS=require("node:url");var ma=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,xS=new Set,t1=typeof process=="object"&&process?process:{},AS=o((r,e,t,i)=>{typeof t1.emitWarning=="function"?t1.emitWarning(r,e,t,i):console.error(`[${t}] ${e}: ${r}`)},"emitWarning"),Rl=globalThis.AbortController,TS=globalThis.AbortSignal;if(typeof Rl>"u"){TS=class{static{o(this,"AbortSignal")}onabort;_onabort=[];reason;aborted=!1;addEventListener(i,n){this._onabort.push(n)}},Rl=class{static{o(this,"AbortController")}constructor(){e()}signal=new TS;abort(i){if(!this.signal.aborted){this.signal.reason=i,this.signal.aborted=!0;for(let n of this.signal._onabort)n(i);this.signal.onabort?.(i)}}};let r=t1.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=o(()=>{r&&(r=!1,AS("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))},"warnACPolyfill")}var kR=o(r=>!xS.has(r),"shouldWarn");var Fn=o(r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),"isPosInt"),CS=o(r=>Fn(r)?r<=Math.pow(2,8)?Uint8Array:r<=Math.pow(2,16)?Uint16Array:r<=Math.pow(2,32)?Uint32Array:r<=Number.MAX_SAFE_INTEGER?ga:null:null,"getUintArray"),ga=class extends Array{static{o(this,"ZeroArray")}constructor(e){super(e),this.fill(0)}},r1=class r{static{o(this,"Stack")}heap;length;static#e=!1;static create(e){let t=CS(e);if(!t)return[];r.#e=!0;let i=new r(e,t);return r.#e=!1,i}constructor(e,t){if(!r.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},Po=class r{static{o(this,"LRUCache")}#e;#t;#s;#i;#a;#S;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#u;#f;#o;#c;#n;#g;#y;#d;#h;#E;#m;#T;#x;#_;#w;#b;#p;static unsafeExposeInternals(e){return{starts:e.#x,ttls:e.#_,sizes:e.#T,keyMap:e.#o,keyList:e.#c,valList:e.#n,next:e.#g,prev:e.#y,get head(){return e.#d},get tail(){return e.#h},free:e.#E,isBackgroundFetch:o(t=>e.#l(t),"isBackgroundFetch"),backgroundFetch:o((t,i,n,s)=>e.#M(t,i,n,s),"backgroundFetch"),moveToTail:o(t=>e.#q(t),"moveToTail"),indexes:o(t=>e.#C(t),"indexes"),rindexes:o(t=>e.#O(t),"rindexes"),isStale:o(t=>e.#v(t),"isStale")}}get max(){return this.#e}get maxSize(){return this.#t}get calculatedSize(){return this.#f}get size(){return this.#u}get fetchMethod(){return this.#a}get memoMethod(){return this.#S}get dispose(){return this.#s}get disposeAfter(){return this.#i}constructor(e){let{max:t=0,ttl:i,ttlResolution:n=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:f,disposeAfter:l,noDisposeOnSet:h,noUpdateTTL:p,maxSize:g=0,maxEntrySize:S=0,sizeCalculation:_,fetchMethod:A,memoMethod:F,noDeleteOnFetchRejection:P,noDeleteOnStaleGet:j,allowStaleOnFetchRejection:B,allowStaleOnFetchAbort:K,ignoreFetchAbort:Ie}=e;if(t!==0&&!Fn(t))throw new TypeError("max option must be a nonnegative integer");let Xe=t?CS(t):Array;if(!Xe)throw new Error("invalid max value: "+t);if(this.#e=t,this.#t=g,this.maxEntrySize=S||this.#t,this.sizeCalculation=_,this.sizeCalculation){if(!this.#t&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(F!==void 0&&typeof F!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#S=F,A!==void 0&&typeof A!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#a=A,this.#b=!!A,this.#o=new Map,this.#c=new Array(t).fill(void 0),this.#n=new Array(t).fill(void 0),this.#g=new Xe(t),this.#y=new Xe(t),this.#d=0,this.#h=0,this.#E=r1.create(t),this.#u=0,this.#f=0,typeof f=="function"&&(this.#s=f),typeof l=="function"?(this.#i=l,this.#m=[]):(this.#i=void 0,this.#m=void 0),this.#w=!!this.#s,this.#p=!!this.#i,this.noDisposeOnSet=!!h,this.noUpdateTTL=!!p,this.noDeleteOnFetchRejection=!!P,this.allowStaleOnFetchRejection=!!B,this.allowStaleOnFetchAbort=!!K,this.ignoreFetchAbort=!!Ie,this.maxEntrySize!==0){if(this.#t!==0&&!Fn(this.#t))throw new TypeError("maxSize must be a positive integer if specified");if(!Fn(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#P()}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!j,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=Fn(n)||n===0?n:1,this.ttlAutopurge=!!s,this.ttl=i||0,this.ttl){if(!Fn(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#F()}if(this.#e===0&&this.ttl===0&&this.#t===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#t){let ot="LRU_CACHE_UNBOUNDED";kR(ot)&&(xS.add(ot),AS("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",ot,r))}}getRemainingTTL(e){return this.#o.has(e)?1/0:0}#F(){let e=new ga(this.#e),t=new ga(this.#e);this.#_=e,this.#x=t,this.#I=(s,a,c=ma.now())=>{if(t[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let u=setTimeout(()=>{this.#v(s)&&this.#R(this.#c[s],"expire")},a+1);u.unref&&u.unref()}},this.#A=s=>{t[s]=e[s]!==0?ma.now():0},this.#r=(s,a)=>{if(e[a]){let c=e[a],u=t[a];if(!c||!u)return;s.ttl=c,s.start=u,s.now=i||n();let f=s.now-u;s.remainingTTL=c-f}};let i=0,n=o(()=>{let s=ma.now();if(this.ttlResolution>0){i=s;let a=setTimeout(()=>i=0,this.ttlResolution);a.unref&&a.unref()}return s},"getNow");this.getRemainingTTL=s=>{let a=this.#o.get(s);if(a===void 0)return 0;let c=e[a],u=t[a];if(!c||!u)return 1/0;let f=(i||n())-u;return c-f},this.#v=s=>{let a=t[s],c=e[s];return!!c&&!!a&&(i||n())-a>c}}#A=o(()=>{},"#updateItemAge");#r=o(()=>{},"#statusTTL");#I=o(()=>{},"#setItemTTL");#v=o(()=>!1,"#isStale");#P(){let e=new ga(this.#e);this.#f=0,this.#T=e,this.#D=t=>{this.#f-=e[t],e[t]=0},this.#k=(t,i,n,s)=>{if(this.#l(i))return 0;if(!Fn(n))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(n=s(i,t),!Fn(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return n},this.#N=(t,i,n)=>{if(e[t]=i,this.#t){let s=this.#t-e[t];for(;this.#f>s;)this.#L(!0)}this.#f+=e[t],n&&(n.entrySize=i,n.totalCalculatedSize=this.#f)}}#D=o(e=>{},"#removeItemSize");#N=o((e,t,i)=>{},"#addItemSize");#k=o((e,t,i,n)=>{if(i||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0},"#requireSize");*#C({allowStale:e=this.allowStale}={}){if(this.#u)for(let t=this.#h;!(!this.#j(t)||((e||!this.#v(t))&&(yield t),t===this.#d));)t=this.#y[t]}*#O({allowStale:e=this.allowStale}={}){if(this.#u)for(let t=this.#d;!(!this.#j(t)||((e||!this.#v(t))&&(yield t),t===this.#h));)t=this.#g[t]}#j(e){return e!==void 0&&this.#o.get(this.#c[e])===e}*entries(){for(let e of this.#C())this.#n[e]!==void 0&&this.#c[e]!==void 0&&!this.#l(this.#n[e])&&(yield[this.#c[e],this.#n[e]])}*rentries(){for(let e of this.#O())this.#n[e]!==void 0&&this.#c[e]!==void 0&&!this.#l(this.#n[e])&&(yield[this.#c[e],this.#n[e]])}*keys(){for(let e of this.#C()){let t=this.#c[e];t!==void 0&&!this.#l(this.#n[e])&&(yield t)}}*rkeys(){for(let e of this.#O()){let t=this.#c[e];t!==void 0&&!this.#l(this.#n[e])&&(yield t)}}*values(){for(let e of this.#C())this.#n[e]!==void 0&&!this.#l(this.#n[e])&&(yield this.#n[e])}*rvalues(){for(let e of this.#O())this.#n[e]!==void 0&&!this.#l(this.#n[e])&&(yield this.#n[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(let i of this.#C()){let n=this.#n[i],s=this.#l(n)?n.__staleWhileFetching:n;if(s!==void 0&&e(s,this.#c[i],this))return this.get(this.#c[i],t)}}forEach(e,t=this){for(let i of this.#C()){let n=this.#n[i],s=this.#l(n)?n.__staleWhileFetching:n;s!==void 0&&e.call(t,s,this.#c[i],this)}}rforEach(e,t=this){for(let i of this.#O()){let n=this.#n[i],s=this.#l(n)?n.__staleWhileFetching:n;s!==void 0&&e.call(t,s,this.#c[i],this)}}purgeStale(){let e=!1;for(let t of this.#O({allowStale:!0}))this.#v(t)&&(this.#R(this.#c[t],"expire"),e=!0);return e}info(e){let t=this.#o.get(e);if(t===void 0)return;let i=this.#n[t],n=this.#l(i)?i.__staleWhileFetching:i;if(n===void 0)return;let s={value:n};if(this.#_&&this.#x){let a=this.#_[t],c=this.#x[t];if(a&&c){let u=a-(ma.now()-c);s.ttl=u,s.start=Date.now()}}return this.#T&&(s.size=this.#T[t]),s}dump(){let e=[];for(let t of this.#C({allowStale:!0})){let i=this.#c[t],n=this.#n[t],s=this.#l(n)?n.__staleWhileFetching:n;if(s===void 0||i===void 0)continue;let a={value:s};if(this.#_&&this.#x){a.ttl=this.#_[t];let c=ma.now()-this.#x[t];a.start=Math.floor(Date.now()-c)}this.#T&&(a.size=this.#T[t]),e.unshift([i,a])}return e}load(e){this.clear();for(let[t,i]of e){if(i.start){let n=Date.now()-i.start;i.start=ma.now()-n}this.set(t,i.value,i)}}set(e,t,i={}){if(t===void 0)return this.delete(e),this;let{ttl:n=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=i,{noUpdateTTL:f=this.noUpdateTTL}=i,l=this.#k(e,t,i.size||0,c);if(this.maxEntrySize&&l>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.#R(e,"set"),this;let h=this.#u===0?void 0:this.#o.get(e);if(h===void 0)h=this.#u===0?this.#h:this.#E.length!==0?this.#E.pop():this.#u===this.#e?this.#L(!1):this.#u,this.#c[h]=e,this.#n[h]=t,this.#o.set(e,h),this.#g[this.#h]=h,this.#y[h]=this.#h,this.#h=h,this.#u++,this.#N(h,l,u),u&&(u.set="add"),f=!1;else{this.#q(h);let p=this.#n[h];if(t!==p){if(this.#b&&this.#l(p)){p.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:g}=p;g!==void 0&&!a&&(this.#w&&this.#s?.(g,e,"set"),this.#p&&this.#m?.push([g,e,"set"]))}else a||(this.#w&&this.#s?.(p,e,"set"),this.#p&&this.#m?.push([p,e,"set"]));if(this.#D(h),this.#N(h,l,u),this.#n[h]=t,u){u.set="replace";let g=p&&this.#l(p)?p.__staleWhileFetching:p;g!==void 0&&(u.oldValue=g)}}else u&&(u.set="update")}if(n!==0&&!this.#_&&this.#F(),this.#_&&(f||this.#I(h,n,s),u&&this.#r(u,h)),!a&&this.#p&&this.#m){let p=this.#m,g;for(;g=p?.shift();)this.#i?.(...g)}return this}pop(){try{for(;this.#u;){let e=this.#n[this.#d];if(this.#L(!0),this.#l(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#p&&this.#m){let e=this.#m,t;for(;t=e?.shift();)this.#i?.(...t)}}}#L(e){let t=this.#d,i=this.#c[t],n=this.#n[t];return this.#b&&this.#l(n)?n.__abortController.abort(new Error("evicted")):(this.#w||this.#p)&&(this.#w&&this.#s?.(n,i,"evict"),this.#p&&this.#m?.push([n,i,"evict"])),this.#D(t),e&&(this.#c[t]=void 0,this.#n[t]=void 0,this.#E.push(t)),this.#u===1?(this.#d=this.#h=0,this.#E.length=0):this.#d=this.#g[t],this.#o.delete(i),this.#u--,t}has(e,t={}){let{updateAgeOnHas:i=this.updateAgeOnHas,status:n}=t,s=this.#o.get(e);if(s!==void 0){let a=this.#n[s];if(this.#l(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#v(s))n&&(n.has="stale",this.#r(n,s));else return i&&this.#A(s),n&&(n.has="hit",this.#r(n,s)),!0}else n&&(n.has="miss");return!1}peek(e,t={}){let{allowStale:i=this.allowStale}=t,n=this.#o.get(e);if(n===void 0||!i&&this.#v(n))return;let s=this.#n[n];return this.#l(s)?s.__staleWhileFetching:s}#M(e,t,i,n){let s=t===void 0?void 0:this.#n[t];if(this.#l(s))return s;let a=new Rl,{signal:c}=i;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let u={signal:a.signal,options:i,context:n},f=o((_,A=!1)=>{let{aborted:F}=a.signal,P=i.ignoreFetchAbort&&_!==void 0;if(i.status&&(F&&!A?(i.status.fetchAborted=!0,i.status.fetchError=a.signal.reason,P&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),F&&!P&&!A)return h(a.signal.reason);let j=g;return this.#n[t]===g&&(_===void 0?j.__staleWhileFetching?this.#n[t]=j.__staleWhileFetching:this.#R(e,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(e,_,u.options))),_},"cb"),l=o(_=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=_),h(_)),"eb"),h=o(_=>{let{aborted:A}=a.signal,F=A&&i.allowStaleOnFetchAbort,P=F||i.allowStaleOnFetchRejection,j=P||i.noDeleteOnFetchRejection,B=g;if(this.#n[t]===g&&(!j||B.__staleWhileFetching===void 0?this.#R(e,"fetch"):F||(this.#n[t]=B.__staleWhileFetching)),P)return i.status&&B.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),B.__staleWhileFetching;if(B.__returned===B)throw _},"fetchFail"),p=o((_,A)=>{let F=this.#a?.(e,s,u);F&&F instanceof Promise&&F.then(P=>_(P===void 0?void 0:P),A),a.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(_(void 0),i.allowStaleOnFetchAbort&&(_=o(P=>f(P,!0),"res")))})},"pcall");i.status&&(i.status.fetchDispatched=!0);let g=new Promise(p).then(f,l),S=Object.assign(g,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return t===void 0?(this.set(e,S,{...u.options,status:void 0}),t=this.#o.get(e)):this.#n[t]=S,S}#l(e){if(!this.#b)return!1;let t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof Rl}async fetch(e,t={}){let{allowStale:i=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:f=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:p=this.allowStaleOnFetchRejection,ignoreFetchAbort:g=this.ignoreFetchAbort,allowStaleOnFetchAbort:S=this.allowStaleOnFetchAbort,context:_,forceRefresh:A=!1,status:F,signal:P}=t;if(!this.#b)return F&&(F.fetch="get"),this.get(e,{allowStale:i,updateAgeOnGet:n,noDeleteOnStaleGet:s,status:F});let j={allowStale:i,updateAgeOnGet:n,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:u,sizeCalculation:f,noUpdateTTL:l,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:p,allowStaleOnFetchAbort:S,ignoreFetchAbort:g,status:F,signal:P},B=this.#o.get(e);if(B===void 0){F&&(F.fetch="miss");let K=this.#M(e,B,j,_);return K.__returned=K}else{let K=this.#n[B];if(this.#l(K)){let ce=i&&K.__staleWhileFetching!==void 0;return F&&(F.fetch="inflight",ce&&(F.returnedStale=!0)),ce?K.__staleWhileFetching:K.__returned=K}let Ie=this.#v(B);if(!A&&!Ie)return F&&(F.fetch="hit"),this.#q(B),n&&this.#A(B),F&&this.#r(F,B),K;let Xe=this.#M(e,B,j,_),$=Xe.__staleWhileFetching!==void 0&&i;return F&&(F.fetch=Ie?"stale":"refresh",$&&Ie&&(F.returnedStale=!0)),$?Xe.__staleWhileFetching:Xe.__returned=Xe}}async forceFetch(e,t={}){let i=await this.fetch(e,t);if(i===void 0)throw new Error("fetch() returned undefined");return i}memo(e,t={}){let i=this.#S;if(!i)throw new Error("no memoMethod provided to constructor");let{context:n,forceRefresh:s,...a}=t,c=this.get(e,a);if(!s&&c!==void 0)return c;let u=i(e,c,{options:a,context:n});return this.set(e,u,a),u}get(e,t={}){let{allowStale:i=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=t,c=this.#o.get(e);if(c!==void 0){let u=this.#n[c],f=this.#l(u);return a&&this.#r(a,c),this.#v(c)?(a&&(a.get="stale"),f?(a&&i&&u.__staleWhileFetching!==void 0&&(a.returnedStale=!0),i?u.__staleWhileFetching:void 0):(s||this.#R(e,"expire"),a&&i&&(a.returnedStale=!0),i?u:void 0)):(a&&(a.get="hit"),f?u.__staleWhileFetching:(this.#q(c),n&&this.#A(c),u))}else a&&(a.get="miss")}#V(e,t){this.#y[t]=e,this.#g[e]=t}#q(e){e!==this.#h&&(e===this.#d?this.#d=this.#g[e]:this.#V(this.#y[e],this.#g[e]),this.#V(this.#h,e),this.#h=e)}delete(e){return this.#R(e,"delete")}#R(e,t){let i=!1;if(this.#u!==0){let n=this.#o.get(e);if(n!==void 0)if(i=!0,this.#u===1)this.#$(t);else{this.#D(n);let s=this.#n[n];if(this.#l(s)?s.__abortController.abort(new Error("deleted")):(this.#w||this.#p)&&(this.#w&&this.#s?.(s,e,t),this.#p&&this.#m?.push([s,e,t])),this.#o.delete(e),this.#c[n]=void 0,this.#n[n]=void 0,n===this.#h)this.#h=this.#y[n];else if(n===this.#d)this.#d=this.#g[n];else{let a=this.#y[n];this.#g[a]=this.#g[n];let c=this.#g[n];this.#y[c]=this.#y[n]}this.#u--,this.#E.push(n)}}if(this.#p&&this.#m?.length){let n=this.#m,s;for(;s=n?.shift();)this.#i?.(...s)}return i}clear(){return this.#$("delete")}#$(e){for(let t of this.#O({allowStale:!0})){let i=this.#n[t];if(this.#l(i))i.__abortController.abort(new Error("deleted"));else{let n=this.#c[t];this.#w&&this.#s?.(i,n,e),this.#p&&this.#m?.push([i,n,e])}}if(this.#o.clear(),this.#n.fill(void 0),this.#c.fill(void 0),this.#_&&this.#x&&(this.#_.fill(0),this.#x.fill(0)),this.#T&&this.#T.fill(0),this.#d=0,this.#h=0,this.#E.length=0,this.#f=0,this.#u=0,this.#p&&this.#m){let t=this.#m,i;for(;i=t?.shift();)this.#i?.(...i)}}};var _a=require("node:path"),LS=require("node:url"),ki=require("fs"),WR=Ke(require("node:fs"),1),In=require("node:fs/promises");var Ml=require("node:events"),u1=Ke(require("node:stream"),1),IS=require("node:string_decoder");var OS=typeof process=="object"&&process?process:{stdout:null,stderr:null},jR=o(r=>!!r&&typeof r=="object"&&(r instanceof Rn||r instanceof u1.default||LR(r)||MR(r)),"isStream"),LR=o(r=>!!r&&typeof r=="object"&&r instanceof Ml.EventEmitter&&typeof r.pipe=="function"&&r.pipe!==u1.default.Writable.prototype.pipe,"isReadable"),MR=o(r=>!!r&&typeof r=="object"&&r instanceof Ml.EventEmitter&&typeof r.write=="function"&&typeof r.end=="function","isWritable"),an=Symbol("EOF"),on=Symbol("maybeEmitEnd"),Pn=Symbol("emittedEnd"),Il=Symbol("emittingEnd"),Ro=Symbol("emittedError"),Dl=Symbol("closed"),FS=Symbol("read"),Nl=Symbol("flush"),PS=Symbol("flushChunk"),li=Symbol("encoding"),ya=Symbol("decoder"),Tt=Symbol("flowing"),Io=Symbol("paused"),va=Symbol("resume"),xt=Symbol("buffer"),ur=Symbol("pipes"),At=Symbol("bufferLength"),i1=Symbol("bufferPush"),kl=Symbol("bufferShift"),Wt=Symbol("objectMode"),lt=Symbol("destroyed"),n1=Symbol("error"),s1=Symbol("emitData"),RS=Symbol("emitEnd"),a1=Symbol("emitEnd2"),Di=Symbol("async"),o1=Symbol("abort"),jl=Symbol("aborted"),Do=Symbol("signal"),gs=Symbol("dataListeners"),Cr=Symbol("discarded"),No=o(r=>Promise.resolve().then(r),"defer"),VR=o(r=>r(),"nodefer"),qR=o(r=>r==="end"||r==="finish"||r==="prefinish","isEndish"),$R=o(r=>r instanceof ArrayBuffer||!!r&&typeof r=="object"&&r.constructor&&r.constructor.name==="ArrayBuffer"&&r.byteLength>=0,"isArrayBufferLike"),UR=o(r=>!Buffer.isBuffer(r)&&ArrayBuffer.isView(r),"isArrayBufferView"),Ll=class{static{o(this,"Pipe")}src;dest;opts;ondrain;constructor(e,t,i){this.src=e,this.dest=t,this.opts=i,this.ondrain=()=>e[va](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(e){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},c1=class extends Ll{static{o(this,"PipeProxyErrors")}unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,t,i){super(e,t,i),this.proxyErrors=n=>t.emit("error",n),e.on("error",this.proxyErrors)}},BR=o(r=>!!r.objectMode,"isObjectModeOptions"),GR=o(r=>!r.objectMode&&!!r.encoding&&r.encoding!=="buffer","isEncodingOptions"),Rn=class extends Ml.EventEmitter{static{o(this,"Minipass")}[Tt]=!1;[Io]=!1;[ur]=[];[xt]=[];[Wt];[li];[Di];[ya];[an]=!1;[Pn]=!1;[Il]=!1;[Dl]=!1;[Ro]=null;[At]=0;[lt]=!1;[Do];[jl]=!1;[gs]=0;[Cr]=!1;writable=!0;readable=!0;constructor(...e){let t=e[0]||{};if(super(),t.objectMode&&typeof t.encoding=="string")throw new TypeError("Encoding and objectMode may not be used together");BR(t)?(this[Wt]=!0,this[li]=null):GR(t)?(this[li]=t.encoding,this[Wt]=!1):(this[Wt]=!1,this[li]=null),this[Di]=!!t.async,this[ya]=this[li]?new IS.StringDecoder(this[li]):null,t&&t.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:o(()=>this[xt],"get")}),t&&t.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:o(()=>this[ur],"get")});let{signal:i}=t;i&&(this[Do]=i,i.aborted?this[o1]():i.addEventListener("abort",()=>this[o1]()))}get bufferLength(){return this[At]}get encoding(){return this[li]}set encoding(e){throw new Error("Encoding must be set at instantiation time")}setEncoding(e){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[Wt]}set objectMode(e){throw new Error("objectMode must be set at instantiation time")}get async(){return this[Di]}set async(e){this[Di]=this[Di]||!!e}[o1](){this[jl]=!0,this.emit("abort",this[Do]?.reason),this.destroy(this[Do]?.reason)}get aborted(){return this[jl]}set aborted(e){}write(e,t,i){if(this[jl])return!1;if(this[an])throw new Error("write after end");if(this[lt])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof t=="function"&&(i=t,t="utf8"),t||(t="utf8");let n=this[Di]?No:VR;if(!this[Wt]&&!Buffer.isBuffer(e)){if(UR(e))e=Buffer.from(e.buffer,e.byteOffset,e.byteLength);else if($R(e))e=Buffer.from(e);else if(typeof e!="string")throw new Error("Non-contiguous data written to non-objectMode stream")}return this[Wt]?(this[Tt]&&this[At]!==0&&this[Nl](!0),this[Tt]?this.emit("data",e):this[i1](e),this[At]!==0&&this.emit("readable"),i&&n(i),this[Tt]):e.length?(typeof e=="string"&&!(t===this[li]&&!this[ya]?.lastNeed)&&(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[li]&&(e=this[ya].write(e)),this[Tt]&&this[At]!==0&&this[Nl](!0),this[Tt]?this.emit("data",e):this[i1](e),this[At]!==0&&this.emit("readable"),i&&n(i),this[Tt]):(this[At]!==0&&this.emit("readable"),i&&n(i),this[Tt])}read(e){if(this[lt])return null;if(this[Cr]=!1,this[At]===0||e===0||e&&e>this[At])return this[on](),null;this[Wt]&&(e=null),this[xt].length>1&&!this[Wt]&&(this[xt]=[this[li]?this[xt].join(""):Buffer.concat(this[xt],this[At])]);let t=this[FS](e||null,this[xt][0]);return this[on](),t}[FS](e,t){if(this[Wt])this[kl]();else{let i=t;e===i.length||e===null?this[kl]():typeof i=="string"?(this[xt][0]=i.slice(e),t=i.slice(0,e),this[At]-=e):(this[xt][0]=i.subarray(e),t=i.subarray(0,e),this[At]-=e)}return this.emit("data",t),!this[xt].length&&!this[an]&&this.emit("drain"),t}end(e,t,i){return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t="utf8"),e!==void 0&&this.write(e,t),i&&this.once("end",i),this[an]=!0,this.writable=!1,(this[Tt]||!this[Io])&&this[on](),this}[va](){this[lt]||(!this[gs]&&!this[ur].length&&(this[Cr]=!0),this[Io]=!1,this[Tt]=!0,this.emit("resume"),this[xt].length?this[Nl]():this[an]?this[on]():this.emit("drain"))}resume(){return this[va]()}pause(){this[Tt]=!1,this[Io]=!0,this[Cr]=!1}get destroyed(){return this[lt]}get flowing(){return this[Tt]}get paused(){return this[Io]}[i1](e){this[Wt]?this[At]+=1:this[At]+=e.length,this[xt].push(e)}[kl](){return this[Wt]?this[At]-=1:this[At]-=this[xt][0].length,this[xt].shift()}[Nl](e=!1){do;while(this[PS](this[kl]())&&this[xt].length);!e&&!this[xt].length&&!this[an]&&this.emit("drain")}[PS](e){return this.emit("data",e),this[Tt]}pipe(e,t){if(this[lt])return e;this[Cr]=!1;let i=this[Pn];return t=t||{},e===OS.stdout||e===OS.stderr?t.end=!1:t.end=t.end!==!1,t.proxyErrors=!!t.proxyErrors,i?t.end&&e.end():(this[ur].push(t.proxyErrors?new c1(this,e,t):new Ll(this,e,t)),this[Di]?No(()=>this[va]()):this[va]()),e}unpipe(e){let t=this[ur].find(i=>i.dest===e);t&&(this[ur].length===1?(this[Tt]&&this[gs]===0&&(this[Tt]=!1),this[ur]=[]):this[ur].splice(this[ur].indexOf(t),1),t.unpipe())}addListener(e,t){return this.on(e,t)}on(e,t){let i=super.on(e,t);if(e==="data")this[Cr]=!1,this[gs]++,!this[ur].length&&!this[Tt]&&this[va]();else if(e==="readable"&&this[At]!==0)super.emit("readable");else if(qR(e)&&this[Pn])super.emit(e),this.removeAllListeners(e);else if(e==="error"&&this[Ro]){let n=t;this[Di]?No(()=>n.call(this,this[Ro])):n.call(this,this[Ro])}return i}removeListener(e,t){return this.off(e,t)}off(e,t){let i=super.off(e,t);return e==="data"&&(this[gs]=this.listeners("data").length,this[gs]===0&&!this[Cr]&&!this[ur].length&&(this[Tt]=!1)),i}removeAllListeners(e){let t=super.removeAllListeners(e);return(e==="data"||e===void 0)&&(this[gs]=0,!this[Cr]&&!this[ur].length&&(this[Tt]=!1)),t}get emittedEnd(){return this[Pn]}[on](){!this[Il]&&!this[Pn]&&!this[lt]&&this[xt].length===0&&this[an]&&(this[Il]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[Dl]&&this.emit("close"),this[Il]=!1)}emit(e,...t){let i=t[0];if(e!=="error"&&e!=="close"&&e!==lt&&this[lt])return!1;if(e==="data")return!this[Wt]&&!i?!1:this[Di]?(No(()=>this[s1](i)),!0):this[s1](i);if(e==="end")return this[RS]();if(e==="close"){if(this[Dl]=!0,!this[Pn]&&!this[lt])return!1;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[Ro]=i,super.emit(n1,i);let s=!this[Do]||this.listeners("error").length?super.emit("error",i):!1;return this[on](),s}else if(e==="resume"){let s=super.emit("resume");return this[on](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,...t);return this[on](),n}[s1](e){for(let i of this[ur])i.dest.write(e)===!1&&this.pause();let t=this[Cr]?!1:super.emit("data",e);return this[on](),t}[RS](){return this[Pn]?!1:(this[Pn]=!0,this.readable=!1,this[Di]?(No(()=>this[a1]()),!0):this[a1]())}[a1](){if(this[ya]){let t=this[ya].end();if(t){for(let i of this[ur])i.dest.write(t);this[Cr]||super.emit("data",t)}}for(let t of this[ur])t.end();let e=super.emit("end");return this.removeAllListeners("end"),e}async collect(){let e=Object.assign([],{dataLength:0});this[Wt]||(e.dataLength=0);let t=this.promise();return this.on("data",i=>{e.push(i),this[Wt]||(e.dataLength+=i.length)}),await t,e}async concat(){if(this[Wt])throw new Error("cannot concat in objectMode");let e=await this.collect();return this[li]?e.join(""):Buffer.concat(e,e.dataLength)}async promise(){return new Promise((e,t)=>{this.on(lt,()=>t(new Error("stream destroyed"))),this.on("error",i=>t(i)),this.on("end",()=>e())})}[Symbol.asyncIterator](){this[Cr]=!1;let e=!1,t=o(async()=>(this.pause(),e=!0,{value:void 0,done:!0}),"stop");return{next:o(()=>{if(e)return t();let n=this.read();if(n!==null)return Promise.resolve({done:!1,value:n});if(this[an])return t();let s,a,c=o(h=>{this.off("data",u),this.off("end",f),this.off(lt,l),t(),a(h)},"onerr"),u=o(h=>{this.off("error",c),this.off("end",f),this.off(lt,l),this.pause(),s({value:h,done:!!this[an]})},"ondata"),f=o(()=>{this.off("error",c),this.off("data",u),this.off(lt,l),t(),s({done:!0,value:void 0})},"onend"),l=o(()=>c(new Error("stream destroyed")),"ondestroy");return new Promise((h,p)=>{a=p,s=h,this.once(lt,l),this.once("error",c),this.once("end",f),this.once("data",u)})},"next"),throw:t,return:t,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[Cr]=!1;let e=!1,t=o(()=>(this.pause(),this.off(n1,t),this.off(lt,t),this.off("end",t),e=!0,{done:!0,value:void 0}),"stop"),i=o(()=>{if(e)return t();let n=this.read();return n===null?t():{done:!1,value:n}},"next");return this.once("end",t),this.once(n1,t),this.once(lt,t),{next:i,throw:t,return:t,[Symbol.iterator](){return this}}}destroy(e){if(this[lt])return e?this.emit("error",e):this.emit(lt),this;this[lt]=!0,this[Cr]=!0,this[xt].length=0,this[At]=0;let t=this;return typeof t.close=="function"&&!this[Dl]&&t.close(),e?this.emit("error",e):this.emit(lt),this}static get isStream(){return jR}};var HR=ki.realpathSync.native,jo={lstatSync:ki.lstatSync,readdir:ki.readdir,readdirSync:ki.readdirSync,readlinkSync:ki.readlinkSync,realpathSync:HR,promises:{lstat:In.lstat,readdir:In.readdir,readlink:In.readlink,realpath:In.realpath}},MS=o(r=>!r||r===jo||r===WR?jo:{...jo,...r,promises:{...jo.promises,...r.promises||{}}},"fsFromOption"),VS=/^\\\\\?\\([a-z]:)\\?$/i,zR=o(r=>r.replace(/\//g,"\\").replace(VS,"$1\\"),"uncToDrive"),KR=/[\\\/]/,Mr=0,qS=1,$S=2,Ni=4,US=6,BS=8,ys=10,GS=12,Lr=15,ko=~Lr,l1=16,DS=32,Lo=64,fi=128,Vl=256,$l=512,NS=Lo|fi|$l,YR=1023,f1=o(r=>r.isFile()?BS:r.isDirectory()?Ni:r.isSymbolicLink()?ys:r.isCharacterDevice()?$S:r.isBlockDevice()?US:r.isSocket()?GS:r.isFIFO()?qS:Mr,"entToType"),kS=new Map,Mo=o(r=>{let e=kS.get(r);if(e)return e;let t=r.normalize("NFKD");return kS.set(r,t),t},"normalize"),jS=new Map,ql=o(r=>{let e=jS.get(r);if(e)return e;let t=Mo(r.toLowerCase());return jS.set(r,t),t},"normalizeNocase"),Ul=class extends Po{static{o(this,"ResolveCache")}constructor(){super({max:256})}},h1=class extends Po{static{o(this,"ChildrenCache")}constructor(e=16*1024){super({maxSize:e,sizeCalculation:o(t=>t.length+1,"sizeCalculation")})}},WS=Symbol("PathScurry setAsCwd"),Ht=class{static{o(this,"PathBase")}name;root;roots;parent;nocase;isCWD=!1;#e;#t;get dev(){return this.#t}#s;get mode(){return this.#s}#i;get nlink(){return this.#i}#a;get uid(){return this.#a}#S;get gid(){return this.#S}#u;get rdev(){return this.#u}#f;get blksize(){return this.#f}#o;get ino(){return this.#o}#c;get size(){return this.#c}#n;get blocks(){return this.#n}#g;get atimeMs(){return this.#g}#y;get mtimeMs(){return this.#y}#d;get ctimeMs(){return this.#d}#h;get birthtimeMs(){return this.#h}#E;get atime(){return this.#E}#m;get mtime(){return this.#m}#T;get ctime(){return this.#T}#x;get birthtime(){return this.#x}#_;#w;#b;#p;#F;#A;#r;#I;#v;#P;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(e,t=Mr,i,n,s,a,c){this.name=e,this.#_=s?ql(e):Mo(e),this.#r=t&YR,this.nocase=s,this.roots=n,this.root=i||this,this.#I=a,this.#b=c.fullpath,this.#F=c.relative,this.#A=c.relativePosix,this.parent=c.parent,this.parent?this.#e=this.parent.#e:this.#e=MS(c.fs)}depth(){return this.#w!==void 0?this.#w:this.parent?this.#w=this.parent.depth()+1:this.#w=0}childrenCache(){return this.#I}resolve(e){if(!e)return this;let t=this.getRootString(e),n=e.substring(t.length).split(this.splitSep);return t?this.getRoot(t).#D(n):this.#D(n)}#D(e){let t=this;for(let i of e)t=t.child(i);return t}children(){let e=this.#I.get(this);if(e)return e;let t=Object.assign([],{provisional:0});return this.#I.set(this,t),this.#r&=~l1,t}child(e,t){if(e===""||e===".")return this;if(e==="..")return this.parent||this;let i=this.children(),n=this.nocase?ql(e):Mo(e);for(let u of i)if(u.#_===n)return u;let s=this.parent?this.sep:"",a=this.#b?this.#b+s+e:void 0,c=this.newChild(e,Mr,{...t,parent:this,fullpath:a});return this.canReaddir()||(c.#r|=fi),i.push(c),c}relative(){if(this.isCWD)return"";if(this.#F!==void 0)return this.#F;let e=this.name,t=this.parent;if(!t)return this.#F=this.name;let i=t.relative();return i+(!i||!t.parent?"":this.sep)+e}relativePosix(){if(this.sep==="/")return this.relative();if(this.isCWD)return"";if(this.#A!==void 0)return this.#A;let e=this.name,t=this.parent;if(!t)return this.#A=this.fullpathPosix();let i=t.relativePosix();return i+(!i||!t.parent?"":"/")+e}fullpath(){if(this.#b!==void 0)return this.#b;let e=this.name,t=this.parent;if(!t)return this.#b=this.name;let n=t.fullpath()+(t.parent?this.sep:"")+e;return this.#b=n}fullpathPosix(){if(this.#p!==void 0)return this.#p;if(this.sep==="/")return this.#p=this.fullpath();if(!this.parent){let n=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(n)?this.#p=`//?/${n}`:this.#p=n}let e=this.parent,t=e.fullpathPosix(),i=t+(!t||!e.parent?"":"/")+this.name;return this.#p=i}isUnknown(){return(this.#r&Lr)===Mr}isType(e){return this[`is${e}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#r&Lr)===BS}isDirectory(){return(this.#r&Lr)===Ni}isCharacterDevice(){return(this.#r&Lr)===$S}isBlockDevice(){return(this.#r&Lr)===US}isFIFO(){return(this.#r&Lr)===qS}isSocket(){return(this.#r&Lr)===GS}isSymbolicLink(){return(this.#r&ys)===ys}lstatCached(){return this.#r&DS?this:void 0}readlinkCached(){return this.#v}realpathCached(){return this.#P}readdirCached(){let e=this.children();return e.slice(0,e.provisional)}canReadlink(){if(this.#v)return!0;if(!this.parent)return!1;let e=this.#r&Lr;return!(e!==Mr&&e!==ys||this.#r&Vl||this.#r&fi)}calledReaddir(){return!!(this.#r&l1)}isENOENT(){return!!(this.#r&fi)}isNamed(e){return this.nocase?this.#_===ql(e):this.#_===Mo(e)}async readlink(){let e=this.#v;if(e)return e;if(this.canReadlink()&&this.parent)try{let t=await this.#e.promises.readlink(this.fullpath()),i=(await this.parent.realpath())?.resolve(t);if(i)return this.#v=i}catch(t){this.#l(t.code);return}}readlinkSync(){let e=this.#v;if(e)return e;if(this.canReadlink()&&this.parent)try{let t=this.#e.readlinkSync(this.fullpath()),i=this.parent.realpathSync()?.resolve(t);if(i)return this.#v=i}catch(t){this.#l(t.code);return}}#N(e){this.#r|=l1;for(let t=e.provisional;t<e.length;t++){let i=e[t];i&&i.#k()}}#k(){this.#r&fi||(this.#r=(this.#r|fi)&ko,this.#C())}#C(){let e=this.children();e.provisional=0;for(let t of e)t.#k()}#O(){this.#r|=$l,this.#j()}#j(){if(this.#r&Lo)return;let e=this.#r;(e&Lr)===Ni&&(e&=ko),this.#r=e|Lo,this.#C()}#L(e=""){e==="ENOTDIR"||e==="EPERM"?this.#j():e==="ENOENT"?this.#k():this.children().provisional=0}#M(e=""){e==="ENOTDIR"?this.parent.#j():e==="ENOENT"&&this.#k()}#l(e=""){let t=this.#r;t|=Vl,e==="ENOENT"&&(t|=fi),(e==="EINVAL"||e==="UNKNOWN")&&(t&=ko),this.#r=t,e==="ENOTDIR"&&this.parent&&this.parent.#j()}#V(e,t){return this.#R(e,t)||this.#q(e,t)}#q(e,t){let i=f1(e),n=this.newChild(e.name,i,{parent:this}),s=n.#r&Lr;return s!==Ni&&s!==ys&&s!==Mr&&(n.#r|=Lo),t.unshift(n),t.provisional++,n}#R(e,t){for(let i=t.provisional;i<t.length;i++){let n=t[i];if((this.nocase?ql(e.name):Mo(e.name))===n.#_)return this.#$(e,n,i,t)}}#$(e,t,i,n){let s=t.name;return t.#r=t.#r&ko|f1(e),s!==e.name&&(t.name=e.name),i!==n.provisional&&(i===n.length-1?n.pop():n.splice(i,1),n.unshift(t)),n.provisional++,t}async lstat(){if((this.#r&fi)===0)try{return this.#W(await this.#e.promises.lstat(this.fullpath())),this}catch(e){this.#M(e.code)}}lstatSync(){if((this.#r&fi)===0)try{return this.#W(this.#e.lstatSync(this.fullpath())),this}catch(e){this.#M(e.code)}}#W(e){let{atime:t,atimeMs:i,birthtime:n,birthtimeMs:s,blksize:a,blocks:c,ctime:u,ctimeMs:f,dev:l,gid:h,ino:p,mode:g,mtime:S,mtimeMs:_,nlink:A,rdev:F,size:P,uid:j}=e;this.#E=t,this.#g=i,this.#x=n,this.#h=s,this.#f=a,this.#n=c,this.#T=u,this.#d=f,this.#t=l,this.#S=h,this.#o=p,this.#s=g,this.#m=S,this.#y=_,this.#i=A,this.#u=F,this.#c=P,this.#a=j;let B=f1(e);this.#r=this.#r&ko|B|DS,B!==Mr&&B!==Ni&&B!==ys&&(this.#r|=Lo)}#B=[];#G=!1;#H(e){this.#G=!1;let t=this.#B.slice();this.#B.length=0,t.forEach(i=>i(null,e))}readdirCB(e,t=!1){if(!this.canReaddir()){t?e(null,[]):queueMicrotask(()=>e(null,[]));return}let i=this.children();if(this.calledReaddir()){let s=i.slice(0,i.provisional);t?e(null,s):queueMicrotask(()=>e(null,s));return}if(this.#B.push(e),this.#G)return;this.#G=!0;let n=this.fullpath();this.#e.readdir(n,{withFileTypes:!0},(s,a)=>{if(s)this.#L(s.code),i.provisional=0;else{for(let c of a)this.#V(c,i);this.#N(i)}this.#H(i.slice(0,i.provisional))})}#U;async readdir(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();if(this.#U)await this.#U;else{let i=o(()=>{},"resolve");this.#U=new Promise(n=>i=n);try{for(let n of await this.#e.promises.readdir(t,{withFileTypes:!0}))this.#V(n,e);this.#N(e)}catch(n){this.#L(n.code),e.provisional=0}this.#U=void 0,i()}return e.slice(0,e.provisional)}readdirSync(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();try{for(let i of this.#e.readdirSync(t,{withFileTypes:!0}))this.#V(i,e);this.#N(e)}catch(i){this.#L(i.code),e.provisional=0}return e.slice(0,e.provisional)}canReaddir(){if(this.#r&NS)return!1;let e=Lr&this.#r;return e===Mr||e===Ni||e===ys}shouldWalk(e,t){return(this.#r&Ni)===Ni&&!(this.#r&NS)&&!e.has(this)&&(!t||t(this))}async realpath(){if(this.#P)return this.#P;if(!(($l|Vl|fi)&this.#r))try{let e=await this.#e.promises.realpath(this.fullpath());return this.#P=this.resolve(e)}catch{this.#O()}}realpathSync(){if(this.#P)return this.#P;if(!(($l|Vl|fi)&this.#r))try{let e=this.#e.realpathSync(this.fullpath());return this.#P=this.resolve(e)}catch{this.#O()}}[WS](e){if(e===this)return;e.isCWD=!1,this.isCWD=!0;let t=new Set([]),i=[],n=this;for(;n&&n.parent;)t.add(n),n.#F=i.join(this.sep),n.#A=i.join("/"),n=n.parent,i.push("..");for(n=e;n&&n.parent&&!t.has(n);)n.#F=void 0,n.#A=void 0,n=n.parent}},Bl=class r extends Ht{static{o(this,"PathWin32")}sep="\\";splitSep=KR;constructor(e,t=Mr,i,n,s,a,c){super(e,t,i,n,s,a,c)}newChild(e,t=Mr,i={}){return new r(e,t,this.root,this.roots,this.nocase,this.childrenCache(),i)}getRootString(e){return _a.win32.parse(e).root}getRoot(e){if(e=zR(e.toUpperCase()),e===this.root.name)return this.root;for(let[t,i]of Object.entries(this.roots))if(this.sameRoot(e,t))return this.roots[e]=i;return this.roots[e]=new Sa(e,this).root}sameRoot(e,t=this.root.name){return e=e.toUpperCase().replace(/\//g,"\\").replace(VS,"$1\\"),e===t}},Gl=class r extends Ht{static{o(this,"PathPosix")}splitSep="/";sep="/";constructor(e,t=Mr,i,n,s,a,c){super(e,t,i,n,s,a,c)}getRootString(e){return e.startsWith("/")?"/":""}getRoot(e){return this.root}newChild(e,t=Mr,i={}){return new r(e,t,this.root,this.roots,this.nocase,this.childrenCache(),i)}},Wl=class{static{o(this,"PathScurryBase")}root;rootPath;roots;cwd;#e;#t;#s;nocase;#i;constructor(e=process.cwd(),t,i,{nocase:n,childrenCacheSize:s=16*1024,fs:a=jo}={}){this.#i=MS(a),(e instanceof URL||e.startsWith("file://"))&&(e=(0,LS.fileURLToPath)(e));let c=t.resolve(e);this.roots=Object.create(null),this.rootPath=this.parseRootPath(c),this.#e=new Ul,this.#t=new Ul,this.#s=new h1(s);let u=c.substring(this.rootPath.length).split(i);if(u.length===1&&!u[0]&&u.pop(),n===void 0)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=n,this.root=this.newRoot(this.#i),this.roots[this.rootPath]=this.root;let f=this.root,l=u.length-1,h=t.sep,p=this.rootPath,g=!1;for(let S of u){let _=l--;f=f.child(S,{relative:new Array(_).fill("..").join(h),relativePosix:new Array(_).fill("..").join("/"),fullpath:p+=(g?"":h)+S}),g=!0}this.cwd=f}depth(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.depth()}childrenCache(){return this.#s}resolve(...e){let t="";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(!a||a===".")&&(t=t?`${a}/${t}`:a,this.isAbsolute(a)))break}let i=this.#e.get(t);if(i!==void 0)return i;let n=this.cwd.resolve(t).fullpath();return this.#e.set(t,n),n}resolvePosix(...e){let t="";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(!a||a===".")&&(t=t?`${a}/${t}`:a,this.isAbsolute(a)))break}let i=this.#t.get(t);if(i!==void 0)return i;let n=this.cwd.resolve(t).fullpathPosix();return this.#t.set(t,n),n}relative(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.relative()}relativePosix(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.relativePosix()}basename(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.name}dirname(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),(e.parent||e).fullpath()}async readdir(e=this.cwd,t={withFileTypes:!0}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i}=t;if(e.canReaddir()){let n=await e.readdir();return i?n:n.map(s=>s.name)}else return[]}readdirSync(e=this.cwd,t={withFileTypes:!0}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i=!0}=t;return e.canReaddir()?i?e.readdirSync():e.readdirSync().map(n=>n.name):[]}async lstat(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.lstat()}lstatSync(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.lstatSync()}async readlink(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let i=await e.readlink();return t?i:i?.fullpath()}readlinkSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let i=e.readlinkSync();return t?i:i?.fullpath()}async realpath(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let i=await e.realpath();return t?i:i?.fullpath()}realpathSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e.withFileTypes,e=this.cwd);let i=e.realpathSync();return t?i:i?.fullpath()}async walk(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=[];(!s||s(e))&&c.push(i?e:e.fullpath());let u=new Set,f=o((h,p)=>{u.add(h),h.readdirCB((g,S)=>{if(g)return p(g);let _=S.length;if(!_)return p();let A=o(()=>{--_===0&&p()},"next");for(let F of S)(!s||s(F))&&c.push(i?F:F.fullpath()),n&&F.isSymbolicLink()?F.realpath().then(P=>P?.isUnknown()?P.lstat():P).then(P=>P?.shouldWalk(u,a)?f(P,A):A()):F.shouldWalk(u,a)?f(F,A):A()},!0)},"walk"),l=e;return new Promise((h,p)=>{f(l,g=>{if(g)return p(g);h(c)})})}walkSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=[];(!s||s(e))&&c.push(i?e:e.fullpath());let u=new Set([e]);for(let f of u){let l=f.readdirSync();for(let h of l){(!s||s(h))&&c.push(i?h:h.fullpath());let p=h;if(h.isSymbolicLink()){if(!(n&&(p=h.realpathSync())))continue;p.isUnknown()&&p.lstatSync()}p.shouldWalk(u,a)&&u.add(p)}}return c}[Symbol.asyncIterator](){return this.iterate()}iterate(e=this.cwd,t={}){return typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd),this.stream(e,t)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t;(!s||s(e))&&(yield i?e:e.fullpath());let c=new Set([e]);for(let u of c){let f=u.readdirSync();for(let l of f){(!s||s(l))&&(yield i?l:l.fullpath());let h=l;if(l.isSymbolicLink()){if(!(n&&(h=l.realpathSync())))continue;h.isUnknown()&&h.lstatSync()}h.shouldWalk(c,a)&&c.add(h)}}}stream(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=new Rn({objectMode:!0});(!s||s(e))&&c.write(i?e:e.fullpath());let u=new Set,f=[e],l=0,h=o(()=>{let p=!1;for(;!p;){let g=f.shift();if(!g){l===0&&c.end();return}l++,u.add(g);let S=o((A,F,P=!1)=>{if(A)return c.emit("error",A);if(n&&!P){let j=[];for(let B of F)B.isSymbolicLink()&&j.push(B.realpath().then(K=>K?.isUnknown()?K.lstat():K));if(j.length){Promise.all(j).then(()=>S(null,F,!0));return}}for(let j of F)j&&(!s||s(j))&&(c.write(i?j:j.fullpath())||(p=!0));l--;for(let j of F){let B=j.realpathCached()||j;B.shouldWalk(u,a)&&f.push(B)}p&&!c.flowing?c.once("drain",h):_||h()},"onReaddir"),_=!0;g.readdirCB(S,!0),_=!1}},"process");return h(),c}streamSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof Ht||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=new Rn({objectMode:!0}),u=new Set;(!s||s(e))&&c.write(i?e:e.fullpath());let f=[e],l=0,h=o(()=>{let p=!1;for(;!p;){let g=f.shift();if(!g){l===0&&c.end();return}l++,u.add(g);let S=g.readdirSync();for(let _ of S)(!s||s(_))&&(c.write(i?_:_.fullpath())||(p=!0));l--;for(let _ of S){let A=_;if(_.isSymbolicLink()){if(!(n&&(A=_.realpathSync())))continue;A.isUnknown()&&A.lstatSync()}A.shouldWalk(u,a)&&f.push(A)}}p&&!c.flowing&&c.once("drain",h)},"process");return h(),c}chdir(e=this.cwd){let t=this.cwd;this.cwd=typeof e=="string"?this.cwd.resolve(e):e,this.cwd[WS](t)}},Sa=class extends Wl{static{o(this,"PathScurryWin32")}sep="\\";constructor(e=process.cwd(),t={}){let{nocase:i=!0}=t;super(e,_a.win32,"\\",{...t,nocase:i}),this.nocase=i;for(let n=this.cwd;n;n=n.parent)n.nocase=this.nocase}parseRootPath(e){return _a.win32.parse(e).root.toUpperCase()}newRoot(e){return new Bl(this.rootPath,Ni,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")||e.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(e)}},wa=class extends Wl{static{o(this,"PathScurryPosix")}sep="/";constructor(e=process.cwd(),t={}){let{nocase:i=!1}=t;super(e,_a.posix,"/",{...t,nocase:i}),this.nocase=i}parseRootPath(e){return"/"}newRoot(e){return new Gl(this.rootPath,Ni,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")}},Vo=class extends wa{static{o(this,"PathScurryDarwin")}constructor(e=process.cwd(),t={}){let{nocase:i=!0}=t;super(e,{...t,nocase:i})}},z$=process.platform==="win32"?Bl:Gl,HS=process.platform==="win32"?Sa:process.platform==="darwin"?Vo:wa;var QR=o(r=>r.length>=1,"isPatternList"),JR=o(r=>r.length>=1,"isGlobList"),ba=class r{static{o(this,"Pattern")}#e;#t;#s;length;#i;#a;#S;#u;#f;#o;#c=!0;constructor(e,t,i,n){if(!QR(e))throw new TypeError("empty pattern list");if(!JR(t))throw new TypeError("empty glob list");if(t.length!==e.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=e.length,i<0||i>=this.length)throw new TypeError("index out of range");if(this.#e=e,this.#t=t,this.#s=i,this.#i=n,this.#s===0){if(this.isUNC()){let[s,a,c,u,...f]=this.#e,[l,h,p,g,...S]=this.#t;f[0]===""&&(f.shift(),S.shift());let _=[s,a,c,u,""].join("/"),A=[l,h,p,g,""].join("/");this.#e=[_,...f],this.#t=[A,...S],this.length=this.#e.length}else if(this.isDrive()||this.isAbsolute()){let[s,...a]=this.#e,[c,...u]=this.#t;a[0]===""&&(a.shift(),u.shift());let f=s+"/",l=c+"/";this.#e=[f,...a],this.#t=[l,...u],this.length=this.#e.length}}}pattern(){return this.#e[this.#s]}isString(){return typeof this.#e[this.#s]=="string"}isGlobstar(){return this.#e[this.#s]===jt}isRegExp(){return this.#e[this.#s]instanceof RegExp}globString(){return this.#S=this.#S||(this.#s===0?this.isAbsolute()?this.#t[0]+this.#t.slice(1).join("/"):this.#t.join("/"):this.#t.slice(this.#s).join("/"))}hasMore(){return this.length>this.#s+1}rest(){return this.#a!==void 0?this.#a:this.hasMore()?(this.#a=new r(this.#e,this.#t,this.#s+1,this.#i),this.#a.#o=this.#o,this.#a.#f=this.#f,this.#a.#u=this.#u,this.#a):this.#a=null}isUNC(){let e=this.#e;return this.#f!==void 0?this.#f:this.#f=this.#i==="win32"&&this.#s===0&&e[0]===""&&e[1]===""&&typeof e[2]=="string"&&!!e[2]&&typeof e[3]=="string"&&!!e[3]}isDrive(){let e=this.#e;return this.#u!==void 0?this.#u:this.#u=this.#i==="win32"&&this.#s===0&&this.length>1&&typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0])}isAbsolute(){let e=this.#e;return this.#o!==void 0?this.#o:this.#o=e[0]===""&&e.length>1||this.isDrive()||this.isUNC()}root(){let e=this.#e[0];return typeof e=="string"&&this.isAbsolute()&&this.#s===0?e:""}checkFollowGlobstar(){return!(this.#s===0||!this.isGlobstar()||!this.#c)}markFollowGlobstar(){return this.#s===0||!this.isGlobstar()||!this.#c?!1:(this.#c=!1,!0)}};var XR=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",Ea=class{static{o(this,"Ignore")}relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(e,{nobrace:t,nocase:i,noext:n,noglobstar:s,platform:a=XR}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=a,this.mmopts={dot:!0,nobrace:t,nocase:i,noext:n,noglobstar:s,optimizationLevel:2,platform:a,nocomment:!0,nonegate:!0};for(let c of e)this.add(c)}add(e){let t=new Ar(e,this.mmopts);for(let i=0;i<t.set.length;i++){let n=t.set[i],s=t.globParts[i];if(!n||!s)throw new Error("invalid pattern object");for(;n[0]==="."&&s[0]===".";)n.shift(),s.shift();let a=new ba(n,s,0,this.platform),c=new Ar(a.globString(),this.mmopts),u=s[s.length-1]==="**",f=a.isAbsolute();f?this.absolute.push(c):this.relative.push(c),u&&(f?this.absoluteChildren.push(c):this.relativeChildren.push(c))}}ignored(e){let t=e.fullpath(),i=`${t}/`,n=e.relative()||".",s=`${n}/`;for(let a of this.relative)if(a.match(n)||a.match(s))return!0;for(let a of this.absolute)if(a.match(t)||a.match(i))return!0;return!1}childrenIgnored(e){let t=e.fullpath()+"/",i=(e.relative()||".")+"/";for(let n of this.relativeChildren)if(n.match(i))return!0;for(let n of this.absoluteChildren)if(n.match(t))return!0;return!1}};var d1=class r{static{o(this,"HasWalkedCache")}store;constructor(e=new Map){this.store=e}copy(){return new r(new Map(this.store))}hasWalked(e,t){return this.store.get(e.fullpath())?.has(t.globString())}storeWalked(e,t){let i=e.fullpath(),n=this.store.get(i);n?n.add(t.globString()):this.store.set(i,new Set([t.globString()]))}},p1=class{static{o(this,"MatchRecord")}store=new Map;add(e,t,i){let n=(t?2:0)|(i?1:0),s=this.store.get(e);this.store.set(e,s===void 0?n:n&s)}entries(){return[...this.store.entries()].map(([e,t])=>[e,!!(t&2),!!(t&1)])}},m1=class{static{o(this,"SubWalks")}store=new Map;add(e,t){if(!e.canReaddir())return;let i=this.store.get(e);i?i.find(n=>n.globString()===t.globString())||i.push(t):this.store.set(e,[t])}get(e){let t=this.store.get(e);if(!t)throw new Error("attempting to walk unknown path");return t}entries(){return this.keys().map(e=>[e,this.store.get(e)])}keys(){return[...this.store.keys()].filter(e=>e.canReaddir())}},qo=class r{static{o(this,"Processor")}hasWalkedCache;matches=new p1;subwalks=new m1;patterns;follow;dot;opts;constructor(e,t){this.opts=e,this.follow=!!e.follow,this.dot=!!e.dot,this.hasWalkedCache=t?t.copy():new d1}processPatterns(e,t){this.patterns=t;let i=t.map(n=>[e,n]);for(let[n,s]of i){this.hasWalkedCache.storeWalked(n,s);let a=s.root(),c=s.isAbsolute()&&this.opts.absolute!==!1;if(a){n=n.resolve(a==="/"&&this.opts.root!==void 0?this.opts.root:a);let h=s.rest();if(h)s=h;else{this.matches.add(n,!0,!1);continue}}if(n.isENOENT())continue;let u,f,l=!1;for(;typeof(u=s.pattern())=="string"&&(f=s.rest());)n=n.resolve(u),s=f,l=!0;if(u=s.pattern(),f=s.rest(),l){if(this.hasWalkedCache.hasWalked(n,s))continue;this.hasWalkedCache.storeWalked(n,s)}if(typeof u=="string"){let h=u===".."||u===""||u===".";this.matches.add(n.resolve(u),c,h);continue}else if(u===jt){(!n.isSymbolicLink()||this.follow||s.checkFollowGlobstar())&&this.subwalks.add(n,s);let h=f?.pattern(),p=f?.rest();if(!f||(h===""||h===".")&&!p)this.matches.add(n,c,h===""||h===".");else if(h===".."){let g=n.parent||n;p?this.hasWalkedCache.hasWalked(g,p)||this.subwalks.add(g,p):this.matches.add(g,c,!0)}}else u instanceof RegExp&&this.subwalks.add(n,s)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new r(this.opts,this.hasWalkedCache)}filterEntries(e,t){let i=this.subwalks.get(e),n=this.child();for(let s of t)for(let a of i){let c=a.isAbsolute(),u=a.pattern(),f=a.rest();u===jt?n.testGlobstar(s,a,f,c):u instanceof RegExp?n.testRegExp(s,u,f,c):n.testString(s,u,f,c)}return n}testGlobstar(e,t,i,n){if((this.dot||!e.name.startsWith("."))&&(t.hasMore()||this.matches.add(e,n,!1),e.canReaddir()&&(this.follow||!e.isSymbolicLink()?this.subwalks.add(e,t):e.isSymbolicLink()&&(i&&t.checkFollowGlobstar()?this.subwalks.add(e,i):t.markFollowGlobstar()&&this.subwalks.add(e,t)))),i){let s=i.pattern();if(typeof s=="string"&&s!==".."&&s!==""&&s!==".")this.testString(e,s,i.rest(),n);else if(s===".."){let a=e.parent||e;this.subwalks.add(a,i)}else s instanceof RegExp&&this.testRegExp(e,s,i.rest(),n)}}testRegExp(e,t,i,n){t.test(e.name)&&(i?this.subwalks.add(e,i):this.matches.add(e,n,!1))}testString(e,t,i,n){e.isNamed(t)&&(i?this.subwalks.add(e,i):this.matches.add(e,n,!1))}};var ZR=o((r,e)=>typeof r=="string"?new Ea([r],e):Array.isArray(r)?new Ea(r,e):r,"makeIgnore"),Hl=class{static{o(this,"GlobUtil")}path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#e=[];#t;#s;signal;maxDepth;includeChildMatches;constructor(e,t,i){if(this.patterns=e,this.path=t,this.opts=i,this.#s=!i.posix&&i.platform==="win32"?"\\":"/",this.includeChildMatches=i.includeChildMatches!==!1,(i.ignore||!this.includeChildMatches)&&(this.#t=ZR(i.ignore??[],i),!this.includeChildMatches&&typeof this.#t.add!="function")){let n="cannot ignore child matches, ignore lacks add() method.";throw new Error(n)}this.maxDepth=i.maxDepth||1/0,i.signal&&(this.signal=i.signal,this.signal.addEventListener("abort",()=>{this.#e.length=0}))}#i(e){return this.seen.has(e)||!!this.#t?.ignored?.(e)}#a(e){return!!this.#t?.childrenIgnored?.(e)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;this.paused=!1;let e;for(;!this.paused&&(e=this.#e.shift());)e()}onResume(e){this.signal?.aborted||(this.paused?this.#e.push(e):e())}async matchCheck(e,t){if(t&&this.opts.nodir)return;let i;if(this.opts.realpath){if(i=e.realpathCached()||await e.realpath(),!i)return;e=i}let s=e.isUnknown()||this.opts.stat?await e.lstat():e;if(this.opts.follow&&this.opts.nodir&&s?.isSymbolicLink()){let a=await s.realpath();a&&(a.isUnknown()||this.opts.stat)&&await a.lstat()}return this.matchCheckTest(s,t)}matchCheckTest(e,t){return e&&(this.maxDepth===1/0||e.depth()<=this.maxDepth)&&(!t||e.canReaddir())&&(!this.opts.nodir||!e.isDirectory())&&(!this.opts.nodir||!this.opts.follow||!e.isSymbolicLink()||!e.realpathCached()?.isDirectory())&&!this.#i(e)?e:void 0}matchCheckSync(e,t){if(t&&this.opts.nodir)return;let i;if(this.opts.realpath){if(i=e.realpathCached()||e.realpathSync(),!i)return;e=i}let s=e.isUnknown()||this.opts.stat?e.lstatSync():e;if(this.opts.follow&&this.opts.nodir&&s?.isSymbolicLink()){let a=s.realpathSync();a&&(a?.isUnknown()||this.opts.stat)&&a.lstatSync()}return this.matchCheckTest(s,t)}matchFinish(e,t){if(this.#i(e))return;if(!this.includeChildMatches&&this.#t?.add){let s=`${e.relativePosix()}/**`;this.#t.add(s)}let i=this.opts.absolute===void 0?t:this.opts.absolute;this.seen.add(e);let n=this.opts.mark&&e.isDirectory()?this.#s:"";if(this.opts.withFileTypes)this.matchEmit(e);else if(i){let s=this.opts.posix?e.fullpathPosix():e.fullpath();this.matchEmit(s+n)}else{let s=this.opts.posix?e.relativePosix():e.relative(),a=this.opts.dotRelative&&!s.startsWith(".."+this.#s)?"."+this.#s:"";this.matchEmit(s?a+s+n:"."+n)}}async match(e,t,i){let n=await this.matchCheck(e,i);n&&this.matchFinish(n,t)}matchSync(e,t,i){let n=this.matchCheckSync(e,i);n&&this.matchFinish(n,t)}walkCB(e,t,i){this.signal?.aborted&&i(),this.walkCB2(e,t,new qo(this.opts),i)}walkCB2(e,t,i,n){if(this.#a(e))return n();if(this.signal?.aborted&&n(),this.paused){this.onResume(()=>this.walkCB2(e,t,i,n));return}i.processPatterns(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,f]of i.matches.entries())this.#i(c)||(s++,this.match(c,u,f).then(()=>a()));for(let c of i.subwalkTargets()){if(this.maxDepth!==1/0&&c.depth()>=this.maxDepth)continue;s++;let u=c.readdirCached();c.calledReaddir()?this.walkCB3(c,u,i,a):c.readdirCB((f,l)=>this.walkCB3(c,l,i,a),!0)}a()}walkCB3(e,t,i,n){i=i.filterEntries(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,f]of i.matches.entries())this.#i(c)||(s++,this.match(c,u,f).then(()=>a()));for(let[c,u]of i.subwalks.entries())s++,this.walkCB2(c,u,i.child(),a);a()}walkCBSync(e,t,i){this.signal?.aborted&&i(),this.walkCB2Sync(e,t,new qo(this.opts),i)}walkCB2Sync(e,t,i,n){if(this.#a(e))return n();if(this.signal?.aborted&&n(),this.paused){this.onResume(()=>this.walkCB2Sync(e,t,i,n));return}i.processPatterns(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,f]of i.matches.entries())this.#i(c)||this.matchSync(c,u,f);for(let c of i.subwalkTargets()){if(this.maxDepth!==1/0&&c.depth()>=this.maxDepth)continue;s++;let u=c.readdirSync();this.walkCB3Sync(c,u,i,a)}a()}walkCB3Sync(e,t,i,n){i=i.filterEntries(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,f]of i.matches.entries())this.#i(c)||this.matchSync(c,u,f);for(let[c,u]of i.subwalks.entries())s++,this.walkCB2Sync(c,u,i.child(),a);a()}},$o=class extends Hl{static{o(this,"GlobWalker")}matches=new Set;constructor(e,t,i){super(e,t,i)}matchEmit(e){this.matches.add(e)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((e,t)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?t(this.signal.reason):e(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},Uo=class extends Hl{static{o(this,"GlobStream")}results;constructor(e,t,i){super(e,t,i),this.results=new Rn({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(e){this.results.write(e),this.results.flowing||this.pause()}stream(){let e=this.path;return e.isUnknown()?e.lstat().then(()=>{this.walkCB(e,this.patterns,()=>this.results.end())}):this.walkCB(e,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}};var eI=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",hi=class{static{o(this,"Glob")}absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(e,t){if(!t)throw new TypeError("glob options required");if(this.withFileTypes=!!t.withFileTypes,this.signal=t.signal,this.follow=!!t.follow,this.dot=!!t.dot,this.dotRelative=!!t.dotRelative,this.nodir=!!t.nodir,this.mark=!!t.mark,t.cwd?(t.cwd instanceof URL||t.cwd.startsWith("file://"))&&(t.cwd=(0,zS.fileURLToPath)(t.cwd)):this.cwd="",this.cwd=t.cwd||"",this.root=t.root,this.magicalBraces=!!t.magicalBraces,this.nobrace=!!t.nobrace,this.noext=!!t.noext,this.realpath=!!t.realpath,this.absolute=t.absolute,this.includeChildMatches=t.includeChildMatches!==!1,this.noglobstar=!!t.noglobstar,this.matchBase=!!t.matchBase,this.maxDepth=typeof t.maxDepth=="number"?t.maxDepth:1/0,this.stat=!!t.stat,this.ignore=t.ignore,this.withFileTypes&&this.absolute!==void 0)throw new Error("cannot set absolute and withFileTypes:true");if(typeof e=="string"&&(e=[e]),this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(e=e.map(u=>u.replace(/\\/g,"/"))),this.matchBase){if(t.noglobstar)throw new TypeError("base matching requires globstar");e=e.map(u=>u.includes("/")?u:`./**/${u}`)}if(this.pattern=e,this.platform=t.platform||eI,this.opts={...t,platform:this.platform},t.scurry){if(this.scurry=t.scurry,t.nocase!==void 0&&t.nocase!==t.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{let u=t.platform==="win32"?Sa:t.platform==="darwin"?Vo:t.platform?wa:HS;this.scurry=new u(this.cwd,{nocase:t.nocase,fs:t.fs})}this.nocase=this.scurry.nocase;let i=this.platform==="darwin"||this.platform==="win32",n={...t,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:i,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},s=this.pattern.map(u=>new Ar(u,n)),[a,c]=s.reduce((u,f)=>(u[0].push(...f.set),u[1].push(...f.globParts),u),[[],[]]);this.patterns=a.map((u,f)=>{let l=c[f];if(!l)throw new Error("invalid pattern object");return new ba(u,l,0,this.platform)})}async walk(){return[...await new $o(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new $o(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new Uo(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new Uo(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};var g1=o((r,e={})=>{Array.isArray(r)||(r=[r]);for(let t of r)if(new Ar(t,e).hasMagic())return!0;return!1},"hasMagic");function Kl(r,e={}){return new hi(r,e).streamSync()}o(Kl,"globStreamSync");function YS(r,e={}){return new hi(r,e).stream()}o(YS,"globStream");function QS(r,e={}){return new hi(r,e).walkSync()}o(QS,"globSync");async function KS(r,e={}){return new hi(r,e).walk()}o(KS,"glob_");function Yl(r,e={}){return new hi(r,e).iterateSync()}o(Yl,"globIterateSync");function JS(r,e={}){return new hi(r,e).iterate()}o(JS,"globIterate");var tI=Kl,rI=Object.assign(YS,{sync:Kl}),iI=Yl,nI=Object.assign(JS,{sync:Yl}),sI=Object.assign(QS,{stream:Kl,iterate:Yl}),zl=Object.assign(KS,{glob:KS,globSync:QS,sync:sI,globStream:YS,stream:rI,globStreamSync:Kl,streamSync:tI,globIterate:JS,iterate:nI,globIterateSync:Yl,iterateSync:iI,Glob:hi,hasMagic:g1,escape:pa,unescape:ui});zl.glob=zl;var vs=Ke(bn());var Ta=class{constructor(e){this.rootPath=e}static{o(this,"NodeFsAdapter")}async readFile(e){let t=this.resolvePath(e);if(!await _t.default.pathExists(t))throw new vs.FileNotFoundError(e);return _t.default.readFile(t,"utf-8")}async fileExists(e){let t=this.resolvePath(e);return _t.default.pathExists(t)}async getFileMetadata(e){let t=await this.readFile(e);return this.extractFrontmatter(t)}async createFile(e,t){let i=this.resolvePath(e);if(await _t.default.pathExists(i))throw new vs.FileAlreadyExistsError(e);return await _t.default.ensureDir(Dn.default.dirname(i)),await _t.default.writeFile(i,t,"utf-8"),e}async updateFile(e,t){let i=this.resolvePath(e);if(!await _t.default.pathExists(i))throw new vs.FileNotFoundError(e);await _t.default.writeFile(i,t,"utf-8")}async writeFile(e,t){let i=this.resolvePath(e);await _t.default.ensureDir(Dn.default.dirname(i)),await _t.default.writeFile(i,t,"utf-8")}async deleteFile(e){let t=this.resolvePath(e);if(!await _t.default.pathExists(t))throw new vs.FileNotFoundError(e);await _t.default.remove(t)}async renameFile(e,t){let i=this.resolvePath(e),n=this.resolvePath(t);if(!await _t.default.pathExists(i))throw new vs.FileNotFoundError(e);await _t.default.ensureDir(Dn.default.dirname(n)),await _t.default.move(i,n)}async createDirectory(e){let t=this.resolvePath(e);await _t.default.ensureDir(t)}async directoryExists(e){let t=this.resolvePath(e);return await _t.default.pathExists(t)?(await _t.default.stat(t)).isDirectory():!1}async getMarkdownFiles(e){let t=e?this.resolvePath(e):this.rootPath,i=Dn.default.join(t,"**/*.md");return(await zl(i,{nodir:!0})).map(a=>Dn.default.relative(this.rootPath,a))}async findFilesByMetadata(e){let t=await this.getMarkdownFiles(),i=[];for(let n of t)try{let s=await this.getFileMetadata(n);this.matchesQuery(s,e)&&i.push(n)}catch{continue}return i}async findFileByUID(e){let t=await this.findFilesByMetadata({exo__Asset_uid:e});return t.length>0?t[0]:null}resolvePath(e){return Dn.default.isAbsolute(e)?e:Dn.default.join(this.rootPath,e)}extractFrontmatter(e){let t=/^---\n([\s\S]*?)\n---/,i=e.match(t);if(!i)return{};try{let n=Eo.load(i[1]);return typeof n=="object"&&n!==null?n:{}}catch{return{}}}matchesQuery(e,t){for(let[i,n]of Object.entries(t)){let s=e[i];if(Array.isArray(s)){if(!s.some(a=>this.normalizeValue(a)===this.normalizeValue(n)))return!1}else if(this.normalizeValue(s)!==this.normalizeValue(n))return!1}return!0}normalizeValue(e){return e==null?"":String(e).replace(/["'[\]]/g,"").trim()}};var Bo=Ke(require("path")),y1=Ke(ca());var xa=class{constructor(e){this.vaultRoot=e}static{o(this,"PathResolver")}resolve(e){if(!Bo.default.isAbsolute(e))return Bo.default.resolve(this.vaultRoot,e);let t=Bo.default.resolve(e),i=Bo.default.resolve(this.vaultRoot);if(!t.startsWith(i))throw new tt(`File path ${e} is outside vault root ${this.vaultRoot}`,"Provide a file path within the vault directory.",{filepath:e,vaultRoot:this.vaultRoot});return t}validate(e){if(!y1.default.existsSync(e))throw new xo(e);if(!y1.default.statSync(e).isFile())throw new tt(`Not a file: ${e}`,"Provide a path to a file, not a directory.",{filepath:e});if(!e.endsWith(".md"))throw new tt(`Not a Markdown file: ${e}`,"Provide a path to a .md file.",{filepath:e})}getVaultRoot(){return this.vaultRoot}};var iw=Ke(bn());var XS=Ke(bn());var di=class{static{o(this,"BaseCommandExecutor")}constructor(e){this.pathResolver=e.pathResolver,this.fsAdapter=e.fsAdapter,this.frontmatterService=e.frontmatterService,this.dryRun=e.dryRun}resolveAndValidate(e){let t=this.pathResolver.resolve(e);this.pathResolver.validate(t);let i=t.replace(this.pathResolver.getVaultRoot()+"/","");return{resolvedPath:t,relativePath:i}}getCurrentTimestamp(){return XS.DateFormatter.toLocalTimestamp(new Date)}isAssetArchived(e){if(e?.exo__Asset_isArchived===!0)return!0;let t=e?.archived;if(t==null)return!1;if(typeof t=="boolean")return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){let i=t.toLowerCase().trim();return i==="true"||i==="yes"||i==="1"}return!1}extractAliasesFromFrontmatter(e){let t=e.match(/aliases:\s*\n((?:  - .*\n?)*)/);return t?t[1].split(`
`).filter(n=>n.trim()).map(n=>n.replace(/^\s*-\s*/,"").trim()):[]}};var Go=class extends di{static{o(this,"StatusCommandExecutor")}constructor(e){super(e)}async executeStart(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_startTimestamp",n),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Started: ${e}`),console.log("   Status: Doing"),console.log(`   Start time: ${n}`),process.exit(0)}catch(t){Ee.handle(t)}}async executeComplete(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_endTimestamp",n),s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Completed: ${e}`),console.log("   Status: Done"),console.log(`   Completion time: ${n}`),process.exit(0)}catch(t){Ee.handle(t)}}async executeTrash(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Trashed: ${e}`),console.log("   Status: Trashed"),console.log(`   Resolution time: ${n}`),process.exit(0)}catch(t){Ee.handle(t)}}async executeArchive(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.frontmatterService.updateProperty(i,"archived","true");n=this.frontmatterService.removeProperty(n,"aliases"),await this.fsAdapter.updateFile(t,n),console.log(`\u2705 Archived: ${e}`),console.log("   Archived: true"),console.log("   Aliases removed"),process.exit(0)}catch(t){Ee.handle(t)}}async executeMoveToBacklog(e){try{await this.updateStatus(e,"ems__EffortStatusBacklog","Backlog"),process.exit(0)}catch(t){Ee.handle(t)}}async executeMoveToAnalysis(e){try{await this.updateStatus(e,"ems__EffortStatusAnalysis","Analysis"),process.exit(0)}catch(t){Ee.handle(t)}}async executeMoveToToDo(e){try{await this.updateStatus(e,"ems__EffortStatusToDo","ToDo"),process.exit(0)}catch(t){Ee.handle(t)}}async updateStatus(e,t,i){let{relativePath:n}=this.resolveAndValidate(e),s=await this.fsAdapter.readFile(n),a=this.frontmatterService.updateProperty(s,"ems__Effort_status",`"[[${t}]]"`);await this.fsAdapter.updateFile(n,a),console.log(`\u2705 Moved to ${i}: ${e}`),console.log(`   Status: ${i}`)}};var Mt=[];for(let r=0;r<256;++r)Mt.push((r+256).toString(16).slice(1));function ZS(r,e=0){return(Mt[r[e+0]]+Mt[r[e+1]]+Mt[r[e+2]]+Mt[r[e+3]]+"-"+Mt[r[e+4]]+Mt[r[e+5]]+"-"+Mt[r[e+6]]+Mt[r[e+7]]+"-"+Mt[r[e+8]]+Mt[r[e+9]]+"-"+Mt[r[e+10]]+Mt[r[e+11]]+Mt[r[e+12]]+Mt[r[e+13]]+Mt[r[e+14]]+Mt[r[e+15]]).toLowerCase()}o(ZS,"unsafeStringify");var ew=require("node:crypto");var Jl=new Uint8Array(256),Ql=Jl.length;function v1(){return Ql>Jl.length-16&&((0,ew.randomFillSync)(Jl),Ql=0),Jl.slice(Ql,Ql+=16)}o(v1,"rng");var tw=require("node:crypto"),_1={randomUUID:tw.randomUUID};function oI(r,e,t){r=r||{};let i=r.random??r.rng?.()??v1();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let n=0;n<16;++n)e[t+n]=i[n];return e}return ZS(i)}o(oI,"_v4");function cI(r,e,t){return _1.randomUUID&&!e&&!r?_1.randomUUID():oI(r,e,t)}o(cI,"v4");var S1=cI;var Aa=Ke(bn());var Wo=class extends di{static{o(this,"AssetCreationExecutor")}constructor(e){super(e)}async executeCreateTask(e,t,i={}){try{await this.createAsset(e,t,"ems__Task",i),process.exit(0)}catch(n){Ee.handle(n)}}async executeCreateMeeting(e,t,i={}){try{await this.createAsset(e,t,"ems__Meeting",i),process.exit(0)}catch(n){Ee.handle(n)}}async executeCreateProject(e,t,i={}){try{await this.createAsset(e,t,"ems__Project",i),process.exit(0)}catch(n){Ee.handle(n)}}async executeCreateArea(e,t,i={}){try{await this.createAsset(e,t,"ems__Area",i),process.exit(0)}catch(n){Ee.handle(n)}}async createAsset(e,t,i,n={}){if(!t||t.trim().length===0)throw new Error("Label cannot be empty");let s=t.trim(),{relativePath:a}=this.resolveAndValidate(e);if(await this.fsAdapter.fileExists(a))throw new Aa.FileAlreadyExistsError(e);let u=S1(),f=this.buildAssetFrontmatter(i,u,s,n),l=Aa.MetadataHelpers.buildFileContent(f);await this.fsAdapter.createFile(a,l),console.log(`\u2705 Created ${this.getAssetTypeName(i)}: ${e}`),console.log(`   UID: ${u}`),console.log(`   Label: ${s}`),console.log(`   Class: ${i}`)}buildAssetFrontmatter(e,t,i,n={}){let s=Aa.DateFormatter.toLocalTimestamp(new Date),a={exo__Asset_isDefinedBy:'"[[Ontology/EMS]]"',exo__Asset_uid:t,exo__Asset_label:i,exo__Asset_createdAt:s,exo__Instance_class:[`"[[${e}]]"`],aliases:[i]};return(e==="ems__Task"||e==="ems__Project"||e==="ems__Meeting")&&(a.ems__Effort_status='"[[ems__EffortStatusDraft]]"'),n.prototype&&(a.ems__Effort_prototype=`"[[${n.prototype}]]"`),n.area&&(a.ems__Effort_area=`"[[${n.area}]]"`),n.parent&&(a.ems__Effort_parent=`"[[${n.parent}]]"`),a}getAssetTypeName(e){return{ems__Task:"task",ems__Meeting:"meeting",ems__Project:"project",ems__Area:"area"}[e]||"asset"}};var w1=Ke(require("path"));var rw=Ke(bn());var Ho=class extends di{static{o(this,"PropertyCommandExecutor")}constructor(e){super(e)}async executeRenameToUid(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.getFileMetadata(t);if(!i.exo__Asset_uid)throw new Error("Asset missing exo__Asset_uid property");let n=w1.default.basename(t,".md"),s=i.exo__Asset_uid;if(n===s&&(console.log(`\u2705 Already renamed: ${e}`),console.log(`   Current filename matches UID: ${s}.md`),process.exit(0)),!i.exo__Asset_label||i.exo__Asset_label.trim()===""){let u=await this.fsAdapter.readFile(t),f=this.frontmatterService.updateProperty(u,"exo__Asset_label",n),l=this.isAssetArchived(i),h=f;l||(h=this.frontmatterService.updateProperty(f,"aliases",`
  - ${n}`)),await this.fsAdapter.updateFile(t,h),console.log(`   Updated label: "${n}"`)}let a=w1.default.dirname(t),c=a!=="."?`${a}/${s}.md`:`${s}.md`;await this.fsAdapter.renameFile(t,c),console.log("\u2705 Renamed to UID format"),console.log(`   Old: ${t}`),console.log(`   New: ${c}`),process.exit(0)}catch(t){Ee.handle(t)}}async executeUpdateLabel(e,t){try{if(!t||t.trim().length===0)throw new Error("Label cannot be empty");let i=t.trim(),{relativePath:n}=this.resolveAndValidate(e),s=await this.fsAdapter.readFile(n),a=this.frontmatterService.updateProperty(s,"exo__Asset_label",i),c=this.frontmatterService.parse(a),u=this.extractAliasesFromFrontmatter(c.content);if(u.includes(i)||(u.length===0?a=this.frontmatterService.updateProperty(a,"aliases",`
  - ${i}`):a=this.frontmatterService.updateProperty(a,"aliases",`${u.map(f=>`
  - ${f}`).join("")}
  - ${i}`)),this.dryRun){if(console.log("\u{1F50D} DRY RUN: Preview of changes (not applied)"),console.log(`   File: ${e}`),console.log("   Changes:"),console.log(`     \u2022 exo__Asset_label: "${i}"`),u.includes(i))console.log("     \u2022 aliases: unchanged (label already present)");else{let f=u.length===0?[i]:[...u,i];console.log(`     \u2022 aliases: [${f.map(l=>`"${l}"`).join(", ")}]`)}console.log(`
\u{1F4A1} Run without --dry-run to apply changes`),process.exit(0)}await this.fsAdapter.updateFile(n,a),console.log("\u2705 Updated label"),console.log(`   File: ${e}`),console.log(`   New label: "${i}"`),console.log("   Aliases synchronized"),process.exit(0)}catch(i){Ee.handle(i)}}async executeSchedule(e,t){try{await this.updatePlannedTimestamp(e,t,"ems__Effort_plannedStartTimestamp"),process.exit(0)}catch(i){Ee.handle(i)}}async executeSetDeadline(e,t){try{await this.updatePlannedTimestamp(e,t,"ems__Effort_plannedEndTimestamp"),process.exit(0)}catch(i){Ee.handle(i)}}async updatePlannedTimestamp(e,t,i){let{relativePath:n}=this.resolveAndValidate(e);if(!await this.fsAdapter.fileExists(n))throw new Error(`File not found: ${e}`);if(!/^\d{4}-\d{2}-\d{2}$/.test(t))throw new Error(`Invalid date format: ${t}. Expected YYYY-MM-DD (e.g., 2025-11-25)`);let a=rw.DateFormatter.toTimestampAtStartOfDay(t),c=await this.fsAdapter.readFile(n),u=this.frontmatterService.updateProperty(c,i,a);await this.fsAdapter.writeFile(n,u),console.log(`\u2705 ${i==="ems__Effort_plannedStartTimestamp"?"Scheduled":"Set deadline for"}: ${e}`),console.log(`   Date: ${t}`),console.log(`   Timestamp: ${a}`)}};var Nn=Ke(require("path"));var zo=class extends di{static{o(this,"FolderRepairExecutor")}constructor(e){super(e)}async executeRepairFolder(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=(await this.fsAdapter.getFileMetadata(t))?.exo__Asset_isDefinedBy;if(!n)throw new Error("Cannot determine expected folder: missing exo__Asset_isDefinedBy");let s=this.extractReference(n);if(!s)throw new Error("Cannot determine expected folder: invalid exo__Asset_isDefinedBy format");let a=await this.findReferencedFile(s,t);if(!a)throw new Error(`Cannot determine expected folder: referenced asset not found: ${s}`);let c=Nn.default.dirname(a),u=c==="."?"":c,f=Nn.default.dirname(t),l=f==="."?"":f;if(this.normalizePath(l)===this.normalizePath(u))return console.log("\u2705 Already in correct folder"),console.log(`   File: ${e}`),console.log(`   Folder: ${u||"(root)"}`),process.exit(0),{moved:!1,oldPath:t,newPath:t,expectedFolder:u};if(this.dryRun){let S=Nn.default.basename(t),_=u?`${u}/${S}`:S;return console.log("\u{1F50D} DRY RUN: Preview of changes (not applied)"),console.log(`   File: ${e}`),console.log(`   Current folder: ${l||"(root)"}`),console.log(`   Expected folder: ${u||"(root)"}`),console.log(`   Would move to: ${_}`),console.log(`
\u{1F4A1} Run without --dry-run to apply changes`),process.exit(0),{moved:!1,oldPath:t,newPath:_,expectedFolder:u}}let h=Nn.default.basename(t),p=u?`${u}/${h}`:h;if(await this.fsAdapter.fileExists(p))throw new Error(`Cannot move file: ${p} already exists`);return u&&(await this.fsAdapter.directoryExists(u)||await this.fsAdapter.createDirectory(u)),await this.fsAdapter.renameFile(t,p),console.log("\u2705 Moved to correct folder"),console.log(`   Old path: ${t}`),console.log(`   New path: ${p}`),console.log(`   Expected folder: ${u||"(root)"}`),process.exit(0),{moved:!0,oldPath:t,newPath:p,expectedFolder:u}}catch(t){Ee.handle(t)}}extractReference(e){if(typeof e!="string")return null;let t=e.trim().replace(/^["']|["']$/g,"");return t=t.replace(/^\[\[|\]\]$/g,""),t||null}async findReferencedFile(e,t){let i=e.endsWith(".md")?e:`${e}.md`;if(e.includes("/")&&await this.fsAdapter.fileExists(i))return i;let n=Nn.default.dirname(t),s=n?`${n}/${i}`:i;if(await this.fsAdapter.fileExists(s))return s;let c=await this.fsAdapter.findFileByUID(e);return c||(await this.fsAdapter.getMarkdownFiles()).find(l=>{let h=Nn.default.basename(l,".md"),p=Nn.default.basename(i,".md");return h===p})||null}normalizePath(e){return e.replace(/\\/g,"/").replace(/^\.\//,"").replace(/\/$/,"")}};var Xl=class{static{o(this,"CommandExecutor")}constructor(e,t=!1){this.context={pathResolver:new xa(e),fsAdapter:new Ta(e),frontmatterService:new iw.FrontmatterService,dryRun:t},this.statusExecutor=new Go(this.context),this.creationExecutor=new Wo(this.context),this.propertyExecutor=new Ho(this.context),this.folderRepairExecutor=new zo(this.context)}async execute(e,t,i){try{let n=this.context.pathResolver.resolve(t);this.context.pathResolver.validate(n),await this.context.fsAdapter.readFile(n.replace(this.context.pathResolver.getVaultRoot()+"/","")),console.log("\u2705 Command infrastructure verified"),console.log(`   Command: ${e}`),console.log(`   File: ${n}`),console.log(`   Vault: ${this.context.pathResolver.getVaultRoot()}`),Object.keys(i).length>0&&console.log(`   Options: ${JSON.stringify(i,null,2)}`),console.log(`
\u{1F4DD} Note: Actual command execution will be implemented in follow-up issues.`),console.log("    This PR establishes the infrastructure foundation."),process.exit(0)}catch(n){Ee.handle(n)}}getVaultRoot(){return this.context.pathResolver.getVaultRoot()}async executeStart(e){return this.statusExecutor.executeStart(e)}async executeComplete(e){return this.statusExecutor.executeComplete(e)}async executeTrash(e){return this.statusExecutor.executeTrash(e)}async executeArchive(e){return this.statusExecutor.executeArchive(e)}async executeMoveToBacklog(e){return this.statusExecutor.executeMoveToBacklog(e)}async executeMoveToAnalysis(e){return this.statusExecutor.executeMoveToAnalysis(e)}async executeMoveToToDo(e){return this.statusExecutor.executeMoveToToDo(e)}async executeCreateTask(e,t,i={}){return this.creationExecutor.executeCreateTask(e,t,i)}async executeCreateMeeting(e,t,i={}){return this.creationExecutor.executeCreateMeeting(e,t,i)}async executeCreateProject(e,t,i={}){return this.creationExecutor.executeCreateProject(e,t,i)}async executeCreateArea(e,t,i={}){return this.creationExecutor.executeCreateArea(e,t,i)}async executeRenameToUid(e){return this.propertyExecutor.executeRenameToUid(e)}async executeUpdateLabel(e,t){return this.propertyExecutor.executeUpdateLabel(e,t)}async executeSchedule(e,t){return this.propertyExecutor.executeSchedule(e,t)}async executeSetDeadline(e,t){return this.propertyExecutor.executeSetDeadline(e,t)}async executeRepairFolder(e){return this.folderRepairExecutor.executeRepairFolder(e)}};function Vt(r,e,t,i,n){if(r==="json"){let s={command:e,filepath:t,action:i,...n&&{changes:n}},a=gt.success(s);console.log(JSON.stringify(a,null,2))}else console.log(`\u2705 ${i}`)}o(Vt,"outputResult");function _s(r,e,t,i){let n=new tt(`--${e} option is required for ${t} command`,i,{command:t,missingOption:e});Ee.handle(n)}o(_s,"handleMissingOption");function sw(){return new Pr("command").description("Execute plugin command on single asset").argument("<command-name>","Command to execute (rename-to-uid, start, complete, schedule, set-deadline, etc.)").argument("<filepath>","Path to asset file (relative to vault root or absolute)").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--label <value>","Asset label (required for update-label and creation commands)").option("--prototype <uid>","Prototype UID for inheritance (creation commands)").option("--area <uid>","Area UID for effort linkage (creation commands)").option("--parent <uid>","Parent UID for effort linkage (creation commands)").option("--date <value>","Date in YYYY-MM-DD format (required for schedule and set-deadline commands)").option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").action(async(r,e,t)=>{let i=t.format||"text";Ee.setFormat(i);try{let n=(0,nw.resolve)(t.vault),s=new Xl(n,t.dryRun);switch(r){case"rename-to-uid":await s.executeRenameToUid(e),Vt(i,r,e,"Renamed file to UID-based name");break;case"update-label":t.label||_s(i,"label","update-label",'exocortex command update-label <filepath> --label "<value>"'),await s.executeUpdateLabel(e,t.label),Vt(i,r,e,`Updated label to "${t.label}"`,{label:t.label});break;case"start":await s.executeStart(e),Vt(i,r,e,"Started task");break;case"complete":await s.executeComplete(e),Vt(i,r,e,"Completed task");break;case"trash":await s.executeTrash(e),Vt(i,r,e,"Moved task to trash");break;case"archive":await s.executeArchive(e),Vt(i,r,e,"Archived task");break;case"move-to-backlog":await s.executeMoveToBacklog(e),Vt(i,r,e,"Moved task to backlog");break;case"move-to-analysis":await s.executeMoveToAnalysis(e),Vt(i,r,e,"Moved task to analysis");break;case"move-to-todo":await s.executeMoveToToDo(e),Vt(i,r,e,"Moved task to todo");break;case"create-task":t.label||_s(i,"label","create-task",'exocortex command create-task <filepath> --label "<value>"'),await s.executeCreateTask(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Vt(i,r,e,`Created task "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-meeting":t.label||_s(i,"label","create-meeting",'exocortex command create-meeting <filepath> --label "<value>"'),await s.executeCreateMeeting(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Vt(i,r,e,`Created meeting "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-project":t.label||_s(i,"label","create-project",'exocortex command create-project <filepath> --label "<value>"'),await s.executeCreateProject(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Vt(i,r,e,`Created project "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-area":t.label||_s(i,"label","create-area",'exocortex command create-area <filepath> --label "<value>"'),await s.executeCreateArea(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Vt(i,r,e,`Created area "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"schedule":t.date||_s(i,"date","schedule",'exocortex command schedule <filepath> --date "YYYY-MM-DD"'),await s.executeSchedule(e,t.date),Vt(i,r,e,`Scheduled task for ${t.date}`,{date:t.date});break;case"set-deadline":t.date||_s(i,"date","set-deadline",'exocortex command set-deadline <filepath> --date "YYYY-MM-DD"'),await s.executeSetDeadline(e,t.date),Vt(i,r,e,`Set deadline to ${t.date}`,{date:t.date});break;case"repair-folder":{let a=await s.executeRepairFolder(e);Vt(i,r,e,a.moved?`Moved to correct folder: ${a.newPath}`:"Already in correct folder",{moved:a.moved,oldPath:a.oldPath,newPath:a.newPath,expectedFolder:a.expectedFolder});break}default:await s.execute(r,e,t),Vt(i,r,e,`Executed ${r}`);break}}catch(n){Ee.handle(n)}})}o(sw,"commandCommand");var ow=require("path");var cn=Ke(require("fs")),b1=Ke(require("path")),aw=require("events");var uI={watch:cn.default.watch.bind(cn.default),existsSync:cn.default.existsSync.bind(cn.default),statSync:cn.default.statSync.bind(cn.default),readFileSync:cn.default.readFileSync.bind(cn.default)},Zl=class extends aw.EventEmitter{constructor(t,i={}){super();this.watcher=null;this.debounceTimers=new Map;this.isRunning=!1;this.vaultPath=b1.default.resolve(t),this.fsAdapter=i.fsAdapter??uI,this.options={pattern:i.pattern??"**/*.md",assetType:i.assetType??"",debounceMs:i.debounceMs??100,recursive:i.recursive??!0}}static{o(this,"FileSystemWatcher")}start(){this.isRunning||(this.watcher=this.fsAdapter.watch(this.vaultPath,{recursive:this.options.recursive},(t,i)=>{i&&this.handleFileEvent(t,i.toString())}),this.watcher.on("error",t=>{this.emit("error",t)}),this.isRunning=!0,this.emit("started"))}stop(){if(this.isRunning){for(let t of this.debounceTimers.values())clearTimeout(t);this.debounceTimers.clear(),this.watcher&&(this.watcher.close(),this.watcher=null),this.isRunning=!1,this.emit("stopped")}}isWatching(){return this.isRunning}handleFileEvent(t,i){let n=b1.default.join(this.vaultPath,i),s=i;if(!this.matchesPattern(s))return;let a=this.debounceTimers.get(n);a&&clearTimeout(a);let c=setTimeout(()=>{this.debounceTimers.delete(n),this.processFileEvent(n,s)},this.options.debounceMs);this.debounceTimers.set(n,c)}processFileEvent(t,i){let n=this.fsAdapter.existsSync(t),s;if(!n)s="delete";else{let u=this.fsAdapter.statSync(t);s=Date.now()-u.birthtimeMs<1e3?"create":"modify"}let a;if(n&&t.endsWith(".md")&&(a=this.extractAssetType(t)),this.options.assetType&&a!==this.options.assetType)return;let c={type:s,path:t,relativePath:i,timestamp:new Date().toISOString(),assetType:a};this.emit("change",c)}matchesPattern(t){return this.options.pattern?Lt(t,this.options.pattern):!0}extractAssetType(t){try{let n=this.fsAdapter.readFileSync(t,"utf-8").match(/^---\n([\s\S]*?)\n---/);if(!n)return;let a=n[1].match(/exo__Instance_class:\s*(?:\[?"?\[\[([^\]]+)\]\]"?\]?|"?\[\[([^\]]+)\]\]"?)/);return a?a[1]||a[2]:void 0}catch{return}}};var E1=Ke(require("fs"));function cw(){return new Pr("watch").description("Watch vault for file changes and emit NDJSON events").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--pattern <glob>","Glob pattern to filter files (e.g., '*.md', 'tasks/**')").option("--asset-type <type>","Filter by asset type (e.g., 'ems__Task', 'ems__Project')").option("--debounce <ms>","Debounce interval in milliseconds","100").action(async r=>{Ee.setFormat("json");try{let e=(0,ow.resolve)(r.vault);if(!E1.default.existsSync(e))throw new sn(e);if(!E1.default.statSync(e).isDirectory())throw new tt(`Vault path is not a directory: ${e}`,"Provide a path to a directory, not a file",{vaultPath:e});let t=parseInt(r.debounce?.toString()??"100",10);if(isNaN(t)||t<0)throw new tt("--debounce must be a non-negative integer","Use a positive integer value for debounce",{debounce:r.debounce});let i=new Zl(e,{pattern:r.pattern,assetType:r.assetType,debounceMs:t});i.on("change",s=>{console.log(JSON.stringify(s))}),i.on("error",s=>{let a=gt.error("INTERNAL_OPERATION_FAILED",s.message,5,{recovery:{message:"Check file permissions and vault access",suggestion:"Ensure the vault directory is accessible"}});console.log(JSON.stringify(a))});let n=o(()=>{i.stop(),process.exit(0)},"shutdown");process.on("SIGINT",n),process.on("SIGTERM",n),console.error(`Watching vault: ${e}`),r.pattern&&console.error(`  Pattern filter: ${r.pattern}`),r.assetType&&console.error(`  Asset type filter: ${r.assetType}`),console.error(`  Debounce: ${t}ms`),console.error("Press Ctrl+C to stop"),i.start()}catch(e){Ee.handle(e)}})}o(cw,"watchCommand");var x1=require("path"),A1=Ke(ca());var Ca=Ke(bn());var pi=Ke(ca()),T1=Ke(require("crypto"));var ef=class{constructor(){this.backups=new Map;this.fileHashes=new Map}static{o(this,"TransactionManager")}async begin(e){if(!pi.default.existsSync(e))throw new Error(`Cannot backup non-existent file: ${e}`);let t=await pi.default.readFile(e,"utf-8"),i=T1.default.createHash("sha256").update(t).digest("hex");this.fileHashes.set(e,i);let n=`${e}.backup.${Date.now()}`;await pi.default.writeFile(n,t,"utf-8"),this.backups.set(e,n)}async verify(e){let t=this.fileHashes.get(e);if(!t)return!0;if(!pi.default.existsSync(e))return!1;let i=await pi.default.readFile(e,"utf-8");return T1.default.createHash("sha256").update(i).digest("hex")===t}async commit(){for(let e of this.backups.values())pi.default.existsSync(e)&&await pi.default.remove(e);this.backups.clear(),this.fileHashes.clear()}async rollback(){for(let[e,t]of this.backups.entries())pi.default.existsSync(t)&&(await pi.default.copy(t,e,{overwrite:!0}),await pi.default.remove(t));this.backups.clear(),this.fileHashes.clear()}getTrackedFiles(){return Array.from(this.backups.keys())}};var Ko=class{static{o(this,"BatchExecutor")}constructor(e,t=!1){this.pathResolver=new xa(e),this.fsAdapter=new Ta(e),this.frontmatterService=new Ca.FrontmatterService,this.transactionManager=new ef,this.dryRun=t}async executeBatch(e,t=!1){let i=Date.now(),n=[],s=0,a=0,c=!1;if(e.length===0)return{success:!0,total:0,succeeded:0,failed:0,results:[],durationMs:Date.now()-i,atomic:t};if(t&&!this.dryRun)try{await this.backupAllFiles(e)}catch(f){return{success:!1,total:e.length,succeeded:0,failed:e.length,results:e.map(l=>({success:!1,command:l.command,filepath:l.filepath,error:`Backup failed: ${f.message}`})),durationMs:Date.now()-i,atomic:t}}for(let f of e){let l=await this.executeSingleOperation(f);if(n.push(l),l.success)s++;else if(a++,t&&!this.dryRun){await this.transactionManager.rollback(),c=!0;let h=n.length;for(let p=h;p<e.length;p++)n.push({success:!1,command:e[p].command,filepath:e[p].filepath,error:"Not executed due to atomic rollback"}),a++;return{success:!1,total:e.length,succeeded:0,failed:e.length,results:n,durationMs:Date.now()-i,atomic:t,rolledBack:!0}}}return t&&!this.dryRun&&!c&&await this.transactionManager.commit(),{success:a===0,total:e.length,succeeded:s,failed:a,results:n,durationMs:Date.now()-i,atomic:t,...t&&{rolledBack:c}}}static parseInput(e){try{let t=JSON.parse(e);if(!Array.isArray(t))throw new tt("Batch input must be a JSON array of operations",`exo batch --input '[{"command":"start","filepath":"task.md"}]'`);for(let i of t){if(!i.command||typeof i.command!="string")throw new tt('Each operation must have a "command" string property','{"command":"start","filepath":"task.md"}');if(!i.filepath||typeof i.filepath!="string")throw new tt('Each operation must have a "filepath" string property','{"command":"start","filepath":"task.md"}')}return t}catch(t){throw t instanceof tt?t:new tt(`Failed to parse batch input: ${t.message}`,`exo batch --input '[{"command":"start","filepath":"task.md"}]'`)}}async backupAllFiles(e){let t=new Set;for(let i of e){let n=this.pathResolver.resolve(i.filepath);t.add(n)}for(let i of t)await this.transactionManager.begin(i)}async executeSingleOperation(e){try{let t=this.pathResolver.resolve(e.filepath);this.pathResolver.validate(t);let i=t.replace(this.pathResolver.getVaultRoot()+"/",""),n=await this.fsAdapter.readFile(i);if(this.dryRun)return{success:!0,command:e.command,filepath:e.filepath,action:`Would execute ${e.command} (dry-run)`};switch(e.command){case"start":return await this.executeStart(i,e);case"complete":return await this.executeComplete(i,e);case"trash":return await this.executeTrash(i,e);case"archive":return await this.executeArchive(i,e);case"move-to-backlog":return await this.executeStatusUpdate(i,e,"ems__EffortStatusBacklog","Moved to backlog");case"move-to-analysis":return await this.executeStatusUpdate(i,e,"ems__EffortStatusAnalysis","Moved to analysis");case"move-to-todo":return await this.executeStatusUpdate(i,e,"ems__EffortStatusToDo","Moved to todo");case"update-label":return await this.executeUpdateLabel(i,e);case"schedule":return await this.executeSchedule(i,e);case"set-deadline":return await this.executeSetDeadline(i,e);default:return{success:!1,command:e.command,filepath:e.filepath,error:`Unknown command: ${e.command}`}}}catch(t){return{success:!1,command:e.command,filepath:e.filepath,error:t.message}}}getCurrentTimestamp(){return Ca.DateFormatter.toLocalTimestamp(new Date)}async executeStart(e,t){let i=await this.fsAdapter.readFile(e),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_startTimestamp",n),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Started task",changes:{status:"Doing",startTimestamp:n}}}async executeComplete(e,t){let i=await this.fsAdapter.readFile(e),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_endTimestamp",n),s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Completed task",changes:{status:"Done",endTimestamp:n,resolutionTimestamp:n}}}async executeTrash(e,t){let i=await this.fsAdapter.readFile(e),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Trashed task",changes:{status:"Trashed",resolutionTimestamp:n}}}async executeArchive(e,t){let i=await this.fsAdapter.readFile(e),n=this.frontmatterService.updateProperty(i,"archived","true");return n=this.frontmatterService.removeProperty(n,"aliases"),await this.fsAdapter.updateFile(e,n),{success:!0,command:t.command,filepath:t.filepath,action:"Archived task",changes:{archived:!0,aliasesRemoved:!0}}}async executeStatusUpdate(e,t,i,n){let s=await this.fsAdapter.readFile(e),a=this.frontmatterService.updateProperty(s,"ems__Effort_status",`"[[${i}]]"`);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:n,changes:{status:i.replace("ems__EffortStatus","")}}}async executeUpdateLabel(e,t){let i=t.options?.label;if(!i||i.trim()==="")return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "label"'};let n=i.trim(),s=await this.fsAdapter.readFile(e),a=this.frontmatterService.updateProperty(s,"exo__Asset_label",`"${n}"`);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Updated label to "${n}"`,changes:{label:n}}}async executeSchedule(e,t){let i=t.options?.date;if(!i)return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "date"'};if(!/^\d{4}-\d{2}-\d{2}$/.test(i))return{success:!1,command:t.command,filepath:t.filepath,error:`Invalid date format: ${i}. Expected YYYY-MM-DD`};let n=await this.fsAdapter.readFile(e),s=Ca.DateFormatter.toTimestampAtStartOfDay(i),a=this.frontmatterService.updateProperty(n,"ems__Effort_scheduledTimestamp",s);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Scheduled for ${i}`,changes:{scheduledTimestamp:s}}}async executeSetDeadline(e,t){let i=t.options?.date;if(!i)return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "date"'};if(!/^\d{4}-\d{2}-\d{2}$/.test(i))return{success:!1,command:t.command,filepath:t.filepath,error:`Invalid date format: ${i}. Expected YYYY-MM-DD`};let n=await this.fsAdapter.readFile(e),s=Ca.DateFormatter.toTimestampAtStartOfDay(i),a=this.frontmatterService.updateProperty(n,"ems__Effort_deadlineTimestamp",s);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Set deadline to ${i}`,changes:{deadlineTimestamp:s}}}};function lI(r,e){if(r==="json"){let t=gt.success(e,{durationMs:e.durationMs,itemCount:e.total});console.log(JSON.stringify(t,null,2))}else{if(console.log(`
\u{1F4E6} Batch Execution ${e.success?"Complete":"Failed"}`),console.log(`   Total: ${e.total} operations`),console.log(`   \u2705 Succeeded: ${e.succeeded}`),console.log(`   \u274C Failed: ${e.failed}`),console.log(`   \u23F1\uFE0F  Duration: ${e.durationMs}ms`),e.atomic&&console.log(`   \u{1F512} Atomic mode: ${e.rolledBack?"Rolled back":"Committed"}`),e.failed>0){console.log(`
\u{1F4CB} Failed Operations:`);for(let t of e.results.filter(i=>!i.success))console.log(`   \u274C ${t.command} ${t.filepath}: ${t.error}`)}if(e.succeeded>0&&r==="text"){console.log(`
\u{1F4CB} Successful Operations:`);for(let t of e.results.filter(i=>i.success))console.log(`   \u2705 ${t.command} ${t.filepath}: ${t.action}`)}}}o(lI,"outputResult");function uw(){return new Pr("batch").description("Execute multiple operations in a single CLI invocation").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--input <json>","JSON array of operations to execute").option("--file <path>","Path to JSON file containing operations").option("--atomic","All-or-nothing execution (rollback on any failure)").option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").action(async r=>{let e=r.format||"text";Ee.setFormat(e);try{let t=(0,x1.resolve)(r.vault),i;if(r.input)i=r.input;else if(r.file){let c=(0,x1.resolve)(r.file);if(!A1.default.existsSync(c))throw new tt(`Batch file not found: ${c}`,"exocortex batch --file operations.json");i=await A1.default.readFile(c,"utf-8")}else throw new tt("Either --input or --file option is required",`exocortex batch --input '[{"command":"start","filepath":"task.md"}]' or exocortex batch --file operations.json`);let n=Ko.parseInput(i);if(n.length===0)throw new tt("Batch input contains no operations",`exocortex batch --input '[{"command":"start","filepath":"task.md"}]'`);let a=await new Ko(t,r.dryRun).executeBatch(n,r.atomic);lI(e,a),process.exit(a.success?0:5)}catch(t){Ee.handle(t)}})}o(uw,"batchCommand");var tf=require("fs"),mi=require("path");function lw(){return new Pr("resolve").description("Resolve UUID to file path").argument("<uuid>","Full or partial UUID to resolve").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--format <type>","Output format: uri|path|json (default: uri)","uri").option("--output <type>","Response format: text|json (for MCP tools)","text").option("--partial","Match partial UUIDs (returns all matches)").action(async(r,e)=>{let t=e.output||"text";Ee.setFormat(t);try{let i=Date.now();if(!fI(r))throw new tt(`Invalid UUID format: ${r}`,"exocortex resolve <uuid> [--format uri|path|json] [--partial]",{uuid:r});let n=(0,mi.resolve)(e.vault);if(!(0,tf.existsSync)(n))throw new sn(n);let s=hI(n,r,e.partial??!1),a=Date.now()-i;if(s.length===0){if(t==="json"){let c=gt.error("VALIDATION_FILE_NOT_FOUND",`UUID not found: ${r}`,3,{context:{uuid:r}});console.log(JSON.stringify(c,null,2))}else console.error(`UUID not found: ${r}`);process.exit(1)}e.partial||s.length>1?pI(s,n,e.format,t,r,a):dI(s[0],n,e.format,t,r,a)}catch(i){Ee.handle(i)}})}o(lw,"resolveCommand");function fI(r){if(r.length<4)return!1;let e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,t=/^[0-9a-f-]+$/i;return e.test(r)||t.test(r)}o(fI,"isValidUuidFormat");function hI(r,e,t){let i=[],n=e.toLowerCase();function s(a){let c=(0,tf.readdirSync)(a,{withFileTypes:!0});for(let u of c){let f=(0,mi.join)(a,u.name);if(u.isDirectory())!u.name.startsWith(".")&&u.name!=="node_modules"&&s(f);else if(u.isFile()&&u.name.endsWith(".md")){let l=u.name.toLowerCase();t?l.includes(n)&&i.push(f):(l.startsWith(n+".md")||l.startsWith(n+" ")||l.startsWith(n+"-"))&&i.push(f)}}}return o(s,"walk"),s(r),i}o(hI,"findFilesWithUuid");function fw(r){return`obsidian://vault/${encodeURI(r)}`}o(fw,"pathToObsidianUri");function hw(r){let e=r.match(/^([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/i);return e?e[1]:(0,mi.basename)(r,".md")}o(hw,"extractUuidFromFilename");function dI(r,e,t,i,n,s){let a=(0,mi.relative)(e,r),c=fw(a),u=hw((0,mi.basename)(r));if(i==="json"){let f={uuid:u,path:a,absolutePath:r,uri:c},l=gt.success(f,{durationMs:s,searchUuid:n});console.log(JSON.stringify(l,null,2))}else switch(t){case"path":console.log(r);break;case"json":console.log(JSON.stringify({uuid:u,path:a,absolutePath:r,uri:c},null,2));break;case"uri":default:console.log(c);break}}o(dI,"outputSingleResult");function pI(r,e,t,i,n,s){let a=r.map(c=>{let u=(0,mi.relative)(e,c),f=fw(u);return{uuid:hw((0,mi.basename)(c)),path:u,absolutePath:c,uri:f}});if(i==="json"){let c=gt.success({matches:a,count:a.length},{durationMs:s,searchUuid:n,itemCount:a.length});console.log(JSON.stringify(c,null,2))}else switch(t){case"path":for(let c of a)console.log(c.absolutePath);break;case"json":console.log(JSON.stringify(a,null,2));break;case"uri":default:for(let c of a)console.log(c.uri);break}}o(pI,"outputMultipleResults");var Ss=new Pr;Ss.name("exocortex").description("CLI tool for Exocortex knowledge management system").version("0.1.0");Ss.command("sparql").description("SPARQL query execution").addCommand(X_());Ss.addCommand(sw());Ss.addCommand(cw());Ss.addCommand(uw());Ss.addCommand(lw());Ss.parse();
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT *)
*/
