#!/usr/bin/env node
// @kitelev/exocortex-cli v0.1.0
// CLI tool for Exocortex knowledge management system - SPARQL queries, task management, and more
// License: MIT

"use strict";var DS=Object.create;var uo=Object.defineProperty;var NS=Object.getOwnPropertyDescriptor;var kS=Object.getOwnPropertyNames;var jS=Object.getPrototypeOf,LS=Object.prototype.hasOwnProperty;var o=(r,e)=>uo(r,"name",{value:e,configurable:!0});var MS=(r,e)=>()=>(r&&(e=r(r=0)),e);var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),VS=(r,e)=>{for(var t in e)uo(r,t,{get:e[t],enumerable:!0})},d0=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of kS(e))!LS.call(r,n)&&n!==t&&uo(r,n,{get:()=>e[n],enumerable:!(i=NS(e,n))||i.enumerable});return r};var Ye=(r,e,t)=>(t=r!=null?DS(jS(r)):{},d0(e||!r||!r.__esModule?uo(t,"default",{value:r,enumerable:!0}):t,r)),nh=r=>d0(uo({},"__esModule",{value:!0}),r);var sh=y(()=>{var p0;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:c(),i=n(r);typeof t.Reflect<"u"&&(i=n(t.Reflect,i)),e(i,t),typeof t.Reflect>"u"&&(t.Reflect=r);function n(u,l){return function(f,h){Object.defineProperty(u,f,{configurable:!0,writable:!0,value:h}),l&&l(f,h)}}o(n,"makeExporter");function s(){try{return Function("return this;")()}catch{}}o(s,"functionThis");function a(){try{return(0,eval)("(function() { return this; })()")}catch{}}o(a,"indirectEvalThis");function c(){return s()||a()}o(c,"sloppyModeThis")})(function(e,t){var i=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",u={__proto__:[]}instanceof Array,l=!c&&!u,f={create:c?function(){return ve(Object.create(null))}:u?function(){return ve({__proto__:null})}:function(){return ve({})},has:l?function(_,E){return i.call(_,E)}:function(_,E){return E in _},get:l?function(_,E){return i.call(_,E)?_[E]:void 0}:function(_,E){return _[E]}},h=Object.getPrototypeOf(Function),d=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:oe(),g=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:De(),w=typeof WeakMap=="function"?WeakMap:Fe(),b=n?Symbol.for("@reflect-metadata:registry"):void 0,x=ce(),O=se(x);function F(_,E,v,C){if(M(v)){if(!Se(_))throw new TypeError;if(!Ee(E))throw new TypeError;return He(_,E)}else{if(!Se(_))throw new TypeError;if(!z(E))throw new TypeError;if(!z(C)&&!M(C)&&!he(C))throw new TypeError;return he(C)&&(C=void 0),v=le(v),Ue(_,E,v,C)}}o(F,"decorate"),e("decorate",F);function k(_,E){function v(C,U){if(!z(C))throw new TypeError;if(!M(U)&&!Pe(U))throw new TypeError;H(_,E,C,U)}return o(v,"decorator"),v}o(k,"metadata"),e("metadata",k);function G(_,E,v,C){if(!z(v))throw new TypeError;return M(C)||(C=le(C)),H(_,E,v,C)}o(G,"defineMetadata"),e("defineMetadata",G);function W(_,E,v){if(!z(E))throw new TypeError;return M(v)||(v=le(v)),Ze(_,E,v)}o(W,"hasMetadata"),e("hasMetadata",W);function Ie(_,E,v){if(!z(E))throw new TypeError;return M(v)||(v=le(v)),ke(_,E,v)}o(Ie,"hasOwnMetadata"),e("hasOwnMetadata",Ie);function Je(_,E,v){if(!z(E))throw new TypeError;return M(v)||(v=le(v)),je(_,E,v)}o(Je,"getMetadata"),e("getMetadata",Je);function ot(_,E,v){if(!z(E))throw new TypeError;return M(v)||(v=le(v)),Re(_,E,v)}o(ot,"getOwnMetadata"),e("getOwnMetadata",ot);function q(_,E){if(!z(_))throw new TypeError;return M(E)||(E=le(E)),N(_,E)}o(q,"getMetadataKeys"),e("getMetadataKeys",q);function ue(_,E){if(!z(_))throw new TypeError;return M(E)||(E=le(E)),Le(_,E)}o(ue,"getOwnMetadataKeys"),e("getOwnMetadataKeys",ue);function we(_,E,v){if(!z(E))throw new TypeError;if(M(v)||(v=le(v)),!z(E))throw new TypeError;M(v)||(v=le(v));var C=Q(E,v,!1);return M(C)?!1:C.OrdinaryDeleteMetadata(_,E,v)}o(we,"deleteMetadata"),e("deleteMetadata",we);function He(_,E){for(var v=_.length-1;v>=0;--v){var C=_[v],U=C(E);if(!M(U)&&!he(U)){if(!Ee(U))throw new TypeError;E=U}}return E}o(He,"DecorateConstructor");function Ue(_,E,v,C){for(var U=_.length-1;U>=0;--U){var Ke=_[U],it=Ke(E,v,C);if(!M(it)&&!he(it)){if(!z(it))throw new TypeError;C=it}}return C}o(Ue,"DecorateProperty");function Ze(_,E,v){var C=ke(_,E,v);if(C)return!0;var U=X(E);return he(U)?!1:Ze(_,U,v)}o(Ze,"OrdinaryHasMetadata");function ke(_,E,v){var C=Q(E,v,!1);return M(C)?!1:be(C.OrdinaryHasOwnMetadata(_,E,v))}o(ke,"OrdinaryHasOwnMetadata");function je(_,E,v){var C=ke(_,E,v);if(C)return Re(_,E,v);var U=X(E);if(!he(U))return je(_,U,v)}o(je,"OrdinaryGetMetadata");function Re(_,E,v){var C=Q(E,v,!1);if(!M(C))return C.OrdinaryGetOwnMetadata(_,E,v)}o(Re,"OrdinaryGetOwnMetadata");function H(_,E,v,C){var U=Q(v,C,!0);U.OrdinaryDefineOwnMetadata(_,E,v,C)}o(H,"OrdinaryDefineOwnMetadata");function N(_,E){var v=Le(_,E),C=X(_);if(C===null)return v;var U=N(C,E);if(U.length<=0)return v;if(v.length<=0)return U;for(var Ke=new g,it=[],_e=0,j=v;_e<j.length;_e++){var L=j[_e],V=Ke.has(L);V||(Ke.add(L),it.push(L))}for(var B=0,me=U;B<me.length;B++){var L=me[B],V=Ke.has(L);V||(Ke.add(L),it.push(L))}return it}o(N,"OrdinaryMetadataKeys");function Le(_,E){var v=Q(_,E,!1);return v?v.OrdinaryOwnMetadataKeys(_,E):[]}o(Le,"OrdinaryOwnMetadataKeys");function Ge(_){if(_===null)return 1;switch(typeof _){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return _===null?1:6;default:return 6}}o(Ge,"Type");function M(_){return _===void 0}o(M,"IsUndefined");function he(_){return _===null}o(he,"IsNull");function Ae(_){return typeof _=="symbol"}o(Ae,"IsSymbol");function z(_){return typeof _=="object"?_!==null:typeof _=="function"}o(z,"IsObject");function xe(_,E){switch(Ge(_)){case 0:return _;case 1:return _;case 2:return _;case 3:return _;case 4:return _;case 5:return _}var v=E===3?"string":E===5?"number":"default",C=re(_,s);if(C!==void 0){var U=C.call(_,v);if(z(U))throw new TypeError;return U}return Ce(_,v==="default"?"number":v)}o(xe,"ToPrimitive");function Ce(_,E){if(E==="string"){var v=_.toString;if(de(v)){var C=v.call(_);if(!z(C))return C}var U=_.valueOf;if(de(U)){var C=U.call(_);if(!z(C))return C}}else{var U=_.valueOf;if(de(U)){var C=U.call(_);if(!z(C))return C}var Ke=_.toString;if(de(Ke)){var C=Ke.call(_);if(!z(C))return C}}throw new TypeError}o(Ce,"OrdinaryToPrimitive");function be(_){return!!_}o(be,"ToBoolean");function Oe(_){return""+_}o(Oe,"ToString");function le(_){var E=xe(_,3);return Ae(E)?E:Oe(E)}o(le,"ToPropertyKey");function Se(_){return Array.isArray?Array.isArray(_):_ instanceof Object?_ instanceof Array:Object.prototype.toString.call(_)==="[object Array]"}o(Se,"IsArray");function de(_){return typeof _=="function"}o(de,"IsCallable");function Ee(_){return typeof _=="function"}o(Ee,"IsConstructor");function Pe(_){switch(Ge(_)){case 3:return!0;case 4:return!0;default:return!1}}o(Pe,"IsPropertyKey");function J(_,E){return _===E||_!==_&&E!==E}o(J,"SameValueZero");function re(_,E){var v=_[E];if(v!=null){if(!de(v))throw new TypeError;return v}}o(re,"GetMethod");function ie(_){var E=re(_,a);if(!de(E))throw new TypeError;var v=E.call(_);if(!z(v))throw new TypeError;return v}o(ie,"GetIterator");function Z(_){return _.value}o(Z,"IteratorValue");function ee(_){var E=_.next();return E.done?!1:E}o(ee,"IteratorStep");function te(_){var E=_.return;E&&E.call(_)}o(te,"IteratorClose");function X(_){var E=Object.getPrototypeOf(_);if(typeof _!="function"||_===h||E!==h)return E;var v=_.prototype,C=v&&Object.getPrototypeOf(v);if(C==null||C===Object.prototype)return E;var U=C.constructor;return typeof U!="function"||U===_?E:U}o(X,"OrdinaryGetPrototypeOf");function ne(){var _;!M(b)&&typeof t.Reflect<"u"&&!(b in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(_=ae(t.Reflect));var E,v,C,U=new w,Ke={registerProvider:it,getProvider:j,setProvider:V};return Ke;function it(B){if(!Object.isExtensible(Ke))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case _===B:break;case M(E):E=B;break;case E===B:break;case M(v):v=B;break;case v===B:break;default:C===void 0&&(C=new g),C.add(B);break}}function _e(B,me){if(!M(E)){if(E.isProviderFor(B,me))return E;if(!M(v)){if(v.isProviderFor(B,me))return E;if(!M(C))for(var Me=ie(C);;){var Ve=ee(Me);if(!Ve)return;var It=Z(Ve);if(It.isProviderFor(B,me))return te(Me),It}}}if(!M(_)&&_.isProviderFor(B,me))return _}function j(B,me){var Me=U.get(B),Ve;return M(Me)||(Ve=Me.get(me)),M(Ve)&&(Ve=_e(B,me),M(Ve)||(M(Me)&&(Me=new d,U.set(B,Me)),Me.set(me,Ve))),Ve}function L(B){if(M(B))throw new TypeError;return E===B||v===B||!M(C)&&C.has(B)}function V(B,me,Me){if(!L(Me))throw new Error("Metadata provider not registered.");var Ve=j(B,me);if(Ve!==Me){if(!M(Ve))return!1;var It=U.get(B);M(It)&&(It=new d,U.set(B,It)),It.set(me,Me)}return!0}}o(ne,"CreateMetadataRegistry");function ce(){var _;return!M(b)&&z(t.Reflect)&&Object.isExtensible(t.Reflect)&&(_=t.Reflect[b]),M(_)&&(_=ne()),!M(b)&&z(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,b,{enumerable:!1,configurable:!1,writable:!1,value:_}),_}o(ce,"GetOrCreateMetadataRegistry");function se(_){var E=new w,v={isProviderFor:o(function(L,V){var B=E.get(L);return M(B)?!1:B.has(V)},"isProviderFor"),OrdinaryDefineOwnMetadata:it,OrdinaryHasOwnMetadata:U,OrdinaryGetOwnMetadata:Ke,OrdinaryOwnMetadataKeys:_e,OrdinaryDeleteMetadata:j};return x.registerProvider(v),v;function C(L,V,B){var me=E.get(L),Me=!1;if(M(me)){if(!B)return;me=new d,E.set(L,me),Me=!0}var Ve=me.get(V);if(M(Ve)){if(!B)return;if(Ve=new d,me.set(V,Ve),!_.setProvider(L,V,v))throw me.delete(V),Me&&E.delete(L),new Error("Wrong provider for target.")}return Ve}o(C,"GetOrCreateMetadataMap");function U(L,V,B){var me=C(V,B,!1);return M(me)?!1:be(me.has(L))}o(U,"OrdinaryHasOwnMetadata");function Ke(L,V,B){var me=C(V,B,!1);if(!M(me))return me.get(L)}o(Ke,"OrdinaryGetOwnMetadata");function it(L,V,B,me){var Me=C(B,me,!0);Me.set(L,V)}o(it,"OrdinaryDefineOwnMetadata");function _e(L,V){var B=[],me=C(L,V,!1);if(M(me))return B;for(var Me=me.keys(),Ve=ie(Me),It=0;;){var yr=ee(Ve);if(!yr)return B.length=It,B;var Ar=Z(yr);try{B[It]=Ar}catch(tr){try{te(Ve)}finally{throw tr}}It++}}o(_e,"OrdinaryOwnMetadataKeys");function j(L,V,B){var me=C(V,B,!1);if(M(me)||!me.delete(L))return!1;if(me.size===0){var Me=E.get(V);M(Me)||(Me.delete(B),Me.size===0&&E.delete(Me))}return!0}o(j,"OrdinaryDeleteMetadata")}o(se,"CreateMetadataProvider");function ae(_){var E=_.defineMetadata,v=_.hasOwnMetadata,C=_.getOwnMetadata,U=_.getOwnMetadataKeys,Ke=_.deleteMetadata,it=new w,_e={isProviderFor:o(function(j,L){var V=it.get(j);return!M(V)&&V.has(L)?!0:U(j,L).length?(M(V)&&(V=new g,it.set(j,V)),V.add(L),!0):!1},"isProviderFor"),OrdinaryDefineOwnMetadata:E,OrdinaryHasOwnMetadata:v,OrdinaryGetOwnMetadata:C,OrdinaryOwnMetadataKeys:U,OrdinaryDeleteMetadata:Ke};return _e}o(ae,"CreateFallbackProvider");function Q(_,E,v){var C=x.getProvider(_,E);if(!M(C))return C;if(v){if(x.setProvider(_,E,O))return O;throw new Error("Illegal state.")}}o(Q,"GetMetadataProvider");function oe(){var _={},E=[],v=(function(){function _e(j,L,V){this._index=0,this._keys=j,this._values=L,this._selector=V}return o(_e,"MapIterator"),_e.prototype["@@iterator"]=function(){return this},_e.prototype[a]=function(){return this},_e.prototype.next=function(){var j=this._index;if(j>=0&&j<this._keys.length){var L=this._selector(this._keys[j],this._values[j]);return j+1>=this._keys.length?(this._index=-1,this._keys=E,this._values=E):this._index++,{value:L,done:!1}}return{value:void 0,done:!0}},_e.prototype.throw=function(j){throw this._index>=0&&(this._index=-1,this._keys=E,this._values=E),j},_e.prototype.return=function(j){return this._index>=0&&(this._index=-1,this._keys=E,this._values=E),{value:j,done:!0}},_e})(),C=(function(){function _e(){this._keys=[],this._values=[],this._cacheKey=_,this._cacheIndex=-2}return o(_e,"Map"),Object.defineProperty(_e.prototype,"size",{get:o(function(){return this._keys.length},"get"),enumerable:!0,configurable:!0}),_e.prototype.has=function(j){return this._find(j,!1)>=0},_e.prototype.get=function(j){var L=this._find(j,!1);return L>=0?this._values[L]:void 0},_e.prototype.set=function(j,L){var V=this._find(j,!0);return this._values[V]=L,this},_e.prototype.delete=function(j){var L=this._find(j,!1);if(L>=0){for(var V=this._keys.length,B=L+1;B<V;B++)this._keys[B-1]=this._keys[B],this._values[B-1]=this._values[B];return this._keys.length--,this._values.length--,J(j,this._cacheKey)&&(this._cacheKey=_,this._cacheIndex=-2),!0}return!1},_e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=_,this._cacheIndex=-2},_e.prototype.keys=function(){return new v(this._keys,this._values,U)},_e.prototype.values=function(){return new v(this._keys,this._values,Ke)},_e.prototype.entries=function(){return new v(this._keys,this._values,it)},_e.prototype["@@iterator"]=function(){return this.entries()},_e.prototype[a]=function(){return this.entries()},_e.prototype._find=function(j,L){if(!J(this._cacheKey,j)){this._cacheIndex=-1;for(var V=0;V<this._keys.length;V++)if(J(this._keys[V],j)){this._cacheIndex=V;break}}return this._cacheIndex<0&&L&&(this._cacheIndex=this._keys.length,this._keys.push(j),this._values.push(void 0)),this._cacheIndex},_e})();return C;function U(_e,j){return _e}function Ke(_e,j){return j}function it(_e,j){return[_e,j]}}o(oe,"CreateMapPolyfill");function De(){var _=(function(){function E(){this._map=new d}return o(E,"Set"),Object.defineProperty(E.prototype,"size",{get:o(function(){return this._map.size},"get"),enumerable:!0,configurable:!0}),E.prototype.has=function(v){return this._map.has(v)},E.prototype.add=function(v){return this._map.set(v,v),this},E.prototype.delete=function(v){return this._map.delete(v)},E.prototype.clear=function(){this._map.clear()},E.prototype.keys=function(){return this._map.keys()},E.prototype.values=function(){return this._map.keys()},E.prototype.entries=function(){return this._map.entries()},E.prototype["@@iterator"]=function(){return this.keys()},E.prototype[a]=function(){return this.keys()},E})();return _}o(De,"CreateSetPolyfill");function Fe(){var _=16,E=f.create(),v=C();return(function(){function j(){this._key=C()}return o(j,"WeakMap"),j.prototype.has=function(L){var V=U(L,!1);return V!==void 0?f.has(V,this._key):!1},j.prototype.get=function(L){var V=U(L,!1);return V!==void 0?f.get(V,this._key):void 0},j.prototype.set=function(L,V){var B=U(L,!0);return B[this._key]=V,this},j.prototype.delete=function(L){var V=U(L,!1);return V!==void 0?delete V[this._key]:!1},j.prototype.clear=function(){this._key=C()},j})();function C(){var j;do j="@@WeakMap@@"+_e();while(f.has(E,j));return E[j]=!0,j}function U(j,L){if(!i.call(j,v)){if(!L)return;Object.defineProperty(j,v,{value:f.create()})}return j[v]}function Ke(j,L){for(var V=0;V<L;++V)j[V]=Math.random()*255|0;return j}function it(j){if(typeof Uint8Array=="function"){var L=new Uint8Array(j);return typeof crypto<"u"?crypto.getRandomValues(L):typeof msCrypto<"u"?msCrypto.getRandomValues(L):Ke(L,j),L}return Ke(new Array(j),j)}function _e(){var j=it(_);j[6]=j[6]&79|64,j[8]=j[8]&191|128;for(var L="",V=0;V<_;++V){var B=j[V];(V===4||V===6||V===8)&&(L+="-"),B<16&&(L+="0"),L+=B.toString(16).toLowerCase()}return L}}o(Fe,"CreateWeakMapPolyfill");function ve(_){return _.__=void 0,delete _.__,_}o(ve,"MakeDictionary")})})(p0||(p0={}))});var lo=y(oh=>{var Uc=class extends Error{static{o(this,"CommanderError")}constructor(e,t,i){super(i),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=t,this.exitCode=e,this.nestedError=void 0}},ah=class extends Uc{static{o(this,"InvalidArgumentError")}constructor(e){super(1,"commander.invalidArgument",e),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};oh.CommanderError=Uc;oh.InvalidArgumentError=ah});var Gc=y(uh=>{var{InvalidArgumentError:$S}=lo(),ch=class{static{o(this,"Argument")}constructor(e,t){switch(this.description=t||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,e[0]){case"<":this.required=!0,this._name=e.slice(1,-1);break;case"[":this.required=!1,this._name=e.slice(1,-1);break;default:this.required=!0,this._name=e;break}this._name.endsWith("...")&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_collectValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:(t.push(e),t)}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}argParser(e){return this.parseArg=e,this}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,i)=>{if(!this.argChoices.includes(t))throw new $S(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(t,i):t},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function qS(r){let e=r.name()+(r.variadic===!0?"...":"");return r.required?"<"+e+">":"["+e+"]"}o(qS,"humanReadableArgName");uh.Argument=ch;uh.humanReadableArgName=qS});var hh=y(fh=>{var{humanReadableArgName:BS}=Gc(),lh=class{static{o(this,"Help")}constructor(){this.helpWidth=void 0,this.minWidthToWrap=40,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}prepareContext(e){this.helpWidth=this.helpWidth??e.helpWidth??80}visibleCommands(e){let t=e.commands.filter(n=>!n._hidden),i=e._getHelpCommand();return i&&!i._hidden&&t.push(i),this.sortSubcommands&&t.sort((n,s)=>n.name().localeCompare(s.name())),t}compareOptions(e,t){let i=o(n=>n.short?n.short.replace(/^-/,""):n.long.replace(/^--/,""),"getSortKey");return i(e).localeCompare(i(t))}visibleOptions(e){let t=e.options.filter(n=>!n.hidden),i=e._getHelpOption();if(i&&!i.hidden){let n=i.short&&e._findOption(i.short),s=i.long&&e._findOption(i.long);!n&&!s?t.push(i):i.long&&!s?t.push(e.createOption(i.long,i.description)):i.short&&!n&&t.push(e.createOption(i.short,i.description))}return this.sortOptions&&t.sort(this.compareOptions),t}visibleGlobalOptions(e){if(!this.showGlobalOptions)return[];let t=[];for(let i=e.parent;i;i=i.parent){let n=i.options.filter(s=>!s.hidden);t.push(...n)}return this.sortOptions&&t.sort(this.compareOptions),t}visibleArguments(e){return e._argsDescription&&e.registeredArguments.forEach(t=>{t.description=t.description||e._argsDescription[t.name()]||""}),e.registeredArguments.find(t=>t.description)?e.registeredArguments:[]}subcommandTerm(e){let t=e.registeredArguments.map(i=>BS(i)).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}argumentTerm(e){return e.name()}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleSubcommandTerm(t.subcommandTerm(n)))),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleOptionTerm(t.optionTerm(n)))),0)}longestGlobalOptionTermLength(e,t){return t.visibleGlobalOptions(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleOptionTerm(t.optionTerm(n)))),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce((i,n)=>Math.max(i,this.displayWidth(t.styleArgumentTerm(t.argumentTerm(n)))),0)}commandUsage(e){let t=e._name;e._aliases[0]&&(t=t+"|"+e._aliases[0]);let i="";for(let n=e.parent;n;n=n.parent)i=n.name()+" "+i;return i+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.summary()||e.description()}optionDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),e.defaultValue!==void 0&&(e.required||e.optional||e.isBoolean()&&typeof e.defaultValue=="boolean")&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),e.presetArg!==void 0&&e.optional&&t.push(`preset: ${JSON.stringify(e.presetArg)}`),e.envVar!==void 0&&t.push(`env: ${e.envVar}`),t.length>0){let i=`(${t.join(", ")})`;return e.description?`${e.description} ${i}`:i}return e.description}argumentDescription(e){let t=[];if(e.argChoices&&t.push(`choices: ${e.argChoices.map(i=>JSON.stringify(i)).join(", ")}`),e.defaultValue!==void 0&&t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`),t.length>0){let i=`(${t.join(", ")})`;return e.description?`${e.description} ${i}`:i}return e.description}formatItemList(e,t,i){return t.length===0?[]:[i.styleTitle(e),...t,""]}groupItems(e,t,i){let n=new Map;return e.forEach(s=>{let a=i(s);n.has(a)||n.set(a,[])}),t.forEach(s=>{let a=i(s);n.has(a)||n.set(a,[]),n.get(a).push(s)}),n}formatHelp(e,t){let i=t.padWidth(e,t),n=t.helpWidth??80;function s(h,d){return t.formatItem(h,i,d,t)}o(s,"callFormatItem");let a=[`${t.styleTitle("Usage:")} ${t.styleUsage(t.commandUsage(e))}`,""],c=t.commandDescription(e);c.length>0&&(a=a.concat([t.boxWrap(t.styleCommandDescription(c),n),""]));let u=t.visibleArguments(e).map(h=>s(t.styleArgumentTerm(t.argumentTerm(h)),t.styleArgumentDescription(t.argumentDescription(h))));if(a=a.concat(this.formatItemList("Arguments:",u,t)),this.groupItems(e.options,t.visibleOptions(e),h=>h.helpGroupHeading??"Options:").forEach((h,d)=>{let g=h.map(w=>s(t.styleOptionTerm(t.optionTerm(w)),t.styleOptionDescription(t.optionDescription(w))));a=a.concat(this.formatItemList(d,g,t))}),t.showGlobalOptions){let h=t.visibleGlobalOptions(e).map(d=>s(t.styleOptionTerm(t.optionTerm(d)),t.styleOptionDescription(t.optionDescription(d))));a=a.concat(this.formatItemList("Global Options:",h,t))}return this.groupItems(e.commands,t.visibleCommands(e),h=>h.helpGroup()||"Commands:").forEach((h,d)=>{let g=h.map(w=>s(t.styleSubcommandTerm(t.subcommandTerm(w)),t.styleSubcommandDescription(t.subcommandDescription(w))));a=a.concat(this.formatItemList(d,g,t))}),a.join(`
`)}displayWidth(e){return m0(e).length}styleTitle(e){return e}styleUsage(e){return e.split(" ").map(t=>t==="[options]"?this.styleOptionText(t):t==="[command]"?this.styleSubcommandText(t):t[0]==="["||t[0]==="<"?this.styleArgumentText(t):this.styleCommandText(t)).join(" ")}styleCommandDescription(e){return this.styleDescriptionText(e)}styleOptionDescription(e){return this.styleDescriptionText(e)}styleSubcommandDescription(e){return this.styleDescriptionText(e)}styleArgumentDescription(e){return this.styleDescriptionText(e)}styleDescriptionText(e){return e}styleOptionTerm(e){return this.styleOptionText(e)}styleSubcommandTerm(e){return e.split(" ").map(t=>t==="[options]"?this.styleOptionText(t):t[0]==="["||t[0]==="<"?this.styleArgumentText(t):this.styleSubcommandText(t)).join(" ")}styleArgumentTerm(e){return this.styleArgumentText(e)}styleOptionText(e){return e}styleArgumentText(e){return e}styleSubcommandText(e){return e}styleCommandText(e){return e}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestGlobalOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}preformatted(e){return/\n[^\S\r\n]/.test(e)}formatItem(e,t,i,n){let a=" ".repeat(2);if(!i)return a+e;let c=e.padEnd(t+e.length-n.displayWidth(e)),u=2,f=(this.helpWidth??80)-t-u-2,h;return f<this.minWidthToWrap||n.preformatted(i)?h=i:h=n.boxWrap(i,f).replace(/\n/g,`
`+" ".repeat(t+u)),a+c+" ".repeat(u)+h.replace(/\n/g,`
${a}`)}boxWrap(e,t){if(t<this.minWidthToWrap)return e;let i=e.split(/\r\n|\n/),n=/[\s]*[^\s]+/g,s=[];return i.forEach(a=>{let c=a.match(n);if(c===null){s.push("");return}let u=[c.shift()],l=this.displayWidth(u[0]);c.forEach(f=>{let h=this.displayWidth(f);if(l+h<=t){u.push(f),l+=h;return}s.push(u.join(""));let d=f.trimStart();u=[d],l=this.displayWidth(d)}),s.push(u.join(""))}),s.join(`
`)}};function m0(r){let e=/\x1b\[\d*(;\d*)*m/g;return r.replace(e,"")}o(m0,"stripColor");fh.Help=lh;fh.stripColor=m0});var gh=y(mh=>{var{InvalidArgumentError:US}=lo(),dh=class{static{o(this,"Option")}constructor(e,t){this.flags=e,this.description=t||"",this.required=e.includes("<"),this.optional=e.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(e),this.mandatory=!1;let i=GS(e);this.short=i.shortFlag,this.long=i.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0,this.helpGroupHeading=void 0}default(e,t){return this.defaultValue=e,this.defaultValueDescription=t,this}preset(e){return this.presetArg=e,this}conflicts(e){return this.conflictsWith=this.conflictsWith.concat(e),this}implies(e){let t=e;return typeof e=="string"&&(t={[e]:!0}),this.implied=Object.assign(this.implied||{},t),this}env(e){return this.envVar=e,this}argParser(e){return this.parseArg=e,this}makeOptionMandatory(e=!0){return this.mandatory=!!e,this}hideHelp(e=!0){return this.hidden=!!e,this}_collectValue(e,t){return t===this.defaultValue||!Array.isArray(t)?[e]:(t.push(e),t)}choices(e){return this.argChoices=e.slice(),this.parseArg=(t,i)=>{if(!this.argChoices.includes(t))throw new US(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._collectValue(t,i):t},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return this.negate?g0(this.name().replace(/^no-/,"")):g0(this.name())}helpGroup(e){return this.helpGroupHeading=e,this}is(e){return this.short===e||this.long===e}isBoolean(){return!this.required&&!this.optional&&!this.negate}},ph=class{static{o(this,"DualOptions")}constructor(e){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,e.forEach(t=>{t.negate?this.negativeOptions.set(t.attributeName(),t):this.positiveOptions.set(t.attributeName(),t)}),this.negativeOptions.forEach((t,i)=>{this.positiveOptions.has(i)&&this.dualOptions.add(i)})}valueFromOption(e,t){let i=t.attributeName();if(!this.dualOptions.has(i))return!0;let n=this.negativeOptions.get(i).presetArg,s=n!==void 0?n:!1;return t.negate===(s===e)}};function g0(r){return r.split("-").reduce((e,t)=>e+t[0].toUpperCase()+t.slice(1))}o(g0,"camelcase");function GS(r){let e,t,i=/^-[^-]$/,n=/^--[^-]/,s=r.split(/[ |,]+/).concat("guard");if(i.test(s[0])&&(e=s.shift()),n.test(s[0])&&(t=s.shift()),!e&&i.test(s[0])&&(e=s.shift()),!e&&n.test(s[0])&&(e=t,t=s.shift()),s[0].startsWith("-")){let a=s[0],c=`option creation failed due to '${a}' in option flags '${r}'`;throw/^-[^-][^-]/.test(a)?new Error(`${c}
- a short flag is a single dash and a single character
  - either use a single dash and a single character (for a short flag)
  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`):i.test(a)?new Error(`${c}
- too many short flags`):n.test(a)?new Error(`${c}
- too many long flags`):new Error(`${c}
- unrecognised flag format`)}if(e===void 0&&t===void 0)throw new Error(`option creation failed due to no flags found in '${r}'.`);return{shortFlag:e,longFlag:t}}o(GS,"splitOptionFlags");mh.Option=dh;mh.DualOptions=ph});var v0=y(y0=>{function WS(r,e){if(Math.abs(r.length-e.length)>3)return Math.max(r.length,e.length);let t=[];for(let i=0;i<=r.length;i++)t[i]=[i];for(let i=0;i<=e.length;i++)t[0][i]=i;for(let i=1;i<=e.length;i++)for(let n=1;n<=r.length;n++){let s=1;r[n-1]===e[i-1]?s=0:s=1,t[n][i]=Math.min(t[n-1][i]+1,t[n][i-1]+1,t[n-1][i-1]+s),n>1&&i>1&&r[n-1]===e[i-2]&&r[n-2]===e[i-1]&&(t[n][i]=Math.min(t[n][i],t[n-2][i-2]+1))}return t[r.length][e.length]}o(WS,"editDistance");function zS(r,e){if(!e||e.length===0)return"";e=Array.from(new Set(e));let t=r.startsWith("--");t&&(r=r.slice(2),e=e.map(a=>a.slice(2)));let i=[],n=3,s=.4;return e.forEach(a=>{if(a.length<=1)return;let c=WS(r,a),u=Math.max(r.length,a.length);(u-c)/u>s&&(c<n?(n=c,i=[a]):c===n&&i.push(a))}),i.sort((a,c)=>a.localeCompare(c)),t&&(i=i.map(a=>`--${a}`)),i.length>1?`
(Did you mean one of ${i.join(", ")}?)`:i.length===1?`
(Did you mean ${i[0]}?)`:""}o(zS,"suggestSimilar");y0.suggestSimilar=zS});var S0=y(bh=>{var HS=require("node:events").EventEmitter,yh=require("node:child_process"),Ji=require("node:path"),Wc=require("node:fs"),qe=require("node:process"),{Argument:KS,humanReadableArgName:QS}=Gc(),{CommanderError:vh}=lo(),{Help:YS,stripColor:XS}=hh(),{Option:_0,DualOptions:JS}=gh(),{suggestSimilar:w0}=v0(),_h=class r extends HS{static{o(this,"Command")}constructor(e){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!1,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=e||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._savedState=null,this._outputConfiguration={writeOut:o(t=>qe.stdout.write(t),"writeOut"),writeErr:o(t=>qe.stderr.write(t),"writeErr"),outputError:o((t,i)=>i(t),"outputError"),getOutHelpWidth:o(()=>qe.stdout.isTTY?qe.stdout.columns:void 0,"getOutHelpWidth"),getErrHelpWidth:o(()=>qe.stderr.isTTY?qe.stderr.columns:void 0,"getErrHelpWidth"),getOutHasColors:o(()=>wh()??(qe.stdout.isTTY&&qe.stdout.hasColors?.()),"getOutHasColors"),getErrHasColors:o(()=>wh()??(qe.stderr.isTTY&&qe.stderr.hasColors?.()),"getErrHasColors"),stripColor:o(t=>XS(t),"stripColor")},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={},this._helpGroupHeading=void 0,this._defaultCommandGroup=void 0,this._defaultOptionGroup=void 0}copyInheritedSettings(e){return this._outputConfiguration=e._outputConfiguration,this._helpOption=e._helpOption,this._helpCommand=e._helpCommand,this._helpConfiguration=e._helpConfiguration,this._exitCallback=e._exitCallback,this._storeOptionsAsProperties=e._storeOptionsAsProperties,this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue,this._allowExcessArguments=e._allowExcessArguments,this._enablePositionalOptions=e._enablePositionalOptions,this._showHelpAfterError=e._showHelpAfterError,this._showSuggestionAfterError=e._showSuggestionAfterError,this}_getCommandAndAncestors(){let e=[];for(let t=this;t;t=t.parent)e.push(t);return e}command(e,t,i){let n=t,s=i;typeof n=="object"&&n!==null&&(s=n,n=null),s=s||{};let[,a,c]=e.match(/([^ ]+) *(.*)/),u=this.createCommand(a);return n&&(u.description(n),u._executableHandler=!0),s.isDefault&&(this._defaultCommandName=u._name),u._hidden=!!(s.noHelp||s.hidden),u._executableFile=s.executableFile||null,c&&u.arguments(c),this._registerCommand(u),u.parent=this,u.copyInheritedSettings(this),n?this:u}createCommand(e){return new r(e)}createHelp(){return Object.assign(new YS,this.configureHelp())}configureHelp(e){return e===void 0?this._helpConfiguration:(this._helpConfiguration=e,this)}configureOutput(e){return e===void 0?this._outputConfiguration:(this._outputConfiguration={...this._outputConfiguration,...e},this)}showHelpAfterError(e=!0){return typeof e!="string"&&(e=!!e),this._showHelpAfterError=e,this}showSuggestionAfterError(e=!0){return this._showSuggestionAfterError=!!e,this}addCommand(e,t){if(!e._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return t=t||{},t.isDefault&&(this._defaultCommandName=e._name),(t.noHelp||t.hidden)&&(e._hidden=!0),this._registerCommand(e),e.parent=this,e._checkForBrokenPassThrough(),this}createArgument(e,t){return new KS(e,t)}argument(e,t,i,n){let s=this.createArgument(e,t);return typeof i=="function"?s.default(n).argParser(i):s.default(i),this.addArgument(s),this}arguments(e){return e.trim().split(/ +/).forEach(t=>{this.argument(t)}),this}addArgument(e){let t=this.registeredArguments.slice(-1)[0];if(t?.variadic)throw new Error(`only the last argument can be variadic '${t.name()}'`);if(e.required&&e.defaultValue!==void 0&&e.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${e.name()}'`);return this.registeredArguments.push(e),this}helpCommand(e,t){if(typeof e=="boolean")return this._addImplicitHelpCommand=e,e&&this._defaultCommandGroup&&this._initCommandGroup(this._getHelpCommand()),this;let i=e??"help [command]",[,n,s]=i.match(/([^ ]+) *(.*)/),a=t??"display help for command",c=this.createCommand(n);return c.helpOption(!1),s&&c.arguments(s),a&&c.description(a),this._addImplicitHelpCommand=!0,this._helpCommand=c,(e||t)&&this._initCommandGroup(c),this}addHelpCommand(e,t){return typeof e!="object"?(this.helpCommand(e,t),this):(this._addImplicitHelpCommand=!0,this._helpCommand=e,this._initCommandGroup(e),this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(e,t){let i=["preSubcommand","preAction","postAction"];if(!i.includes(e))throw new Error(`Unexpected value for event passed to hook : '${e}'.
Expecting one of '${i.join("', '")}'`);return this._lifeCycleHooks[e]?this._lifeCycleHooks[e].push(t):this._lifeCycleHooks[e]=[t],this}exitOverride(e){return e?this._exitCallback=e:this._exitCallback=t=>{if(t.code!=="commander.executeSubCommandAsync")throw t},this}_exit(e,t,i){this._exitCallback&&this._exitCallback(new vh(e,t,i)),qe.exit(e)}action(e){let t=o(i=>{let n=this.registeredArguments.length,s=i.slice(0,n);return this._storeOptionsAsProperties?s[n]=this:s[n]=this.opts(),s.push(this),e.apply(this,s)},"listener");return this._actionHandler=t,this}createOption(e,t){return new _0(e,t)}_callParseArg(e,t,i,n){try{return e.parseArg(t,i)}catch(s){if(s.code==="commander.invalidArgument"){let a=`${n} ${s.message}`;this.error(a,{exitCode:s.exitCode,code:s.code})}throw s}}_registerOption(e){let t=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(t){let i=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${i}'
-  already used by option '${t.flags}'`)}this._initOptionGroup(e),this.options.push(e)}_registerCommand(e){let t=o(n=>[n.name()].concat(n.aliases()),"knownBy"),i=t(e).find(n=>this._findCommand(n));if(i){let n=t(this._findCommand(i)).join("|"),s=t(e).join("|");throw new Error(`cannot add command '${s}' as already have command '${n}'`)}this._initCommandGroup(e),this.commands.push(e)}addOption(e){this._registerOption(e);let t=e.name(),i=e.attributeName();if(e.negate){let s=e.long.replace(/^--no-/,"--");this._findOption(s)||this.setOptionValueWithSource(i,e.defaultValue===void 0?!0:e.defaultValue,"default")}else e.defaultValue!==void 0&&this.setOptionValueWithSource(i,e.defaultValue,"default");let n=o((s,a,c)=>{s==null&&e.presetArg!==void 0&&(s=e.presetArg);let u=this.getOptionValue(i);s!==null&&e.parseArg?s=this._callParseArg(e,s,u,a):s!==null&&e.variadic&&(s=e._collectValue(s,u)),s==null&&(e.negate?s=!1:e.isBoolean()||e.optional?s=!0:s=""),this.setOptionValueWithSource(i,s,c)},"handleOptionValue");return this.on("option:"+t,s=>{let a=`error: option '${e.flags}' argument '${s}' is invalid.`;n(s,a,"cli")}),e.envVar&&this.on("optionEnv:"+t,s=>{let a=`error: option '${e.flags}' value '${s}' from env '${e.envVar}' is invalid.`;n(s,a,"env")}),this}_optionEx(e,t,i,n,s){if(typeof t=="object"&&t instanceof _0)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let a=this.createOption(t,i);if(a.makeOptionMandatory(!!e.mandatory),typeof n=="function")a.default(s).argParser(n);else if(n instanceof RegExp){let c=n;n=o((u,l)=>{let f=c.exec(u);return f?f[0]:l},"fn"),a.default(s).argParser(n)}else a.default(n);return this.addOption(a)}option(e,t,i,n){return this._optionEx({},e,t,i,n)}requiredOption(e,t,i,n){return this._optionEx({mandatory:!0},e,t,i,n)}combineFlagAndOptionalValue(e=!0){return this._combineFlagAndOptionalValue=!!e,this}allowUnknownOption(e=!0){return this._allowUnknownOption=!!e,this}allowExcessArguments(e=!0){return this._allowExcessArguments=!!e,this}enablePositionalOptions(e=!0){return this._enablePositionalOptions=!!e,this}passThroughOptions(e=!0){return this._passThroughOptions=!!e,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(e=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!e,this}getOptionValue(e){return this._storeOptionsAsProperties?this[e]:this._optionValues[e]}setOptionValue(e,t){return this.setOptionValueWithSource(e,t,void 0)}setOptionValueWithSource(e,t,i){return this._storeOptionsAsProperties?this[e]=t:this._optionValues[e]=t,this._optionValueSources[e]=i,this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let t;return this._getCommandAndAncestors().forEach(i=>{i.getOptionValueSource(e)!==void 0&&(t=i.getOptionValueSource(e))}),t}_prepareUserArgs(e,t){if(e!==void 0&&!Array.isArray(e))throw new Error("first parameter to parse must be array or undefined");if(t=t||{},e===void 0&&t.from===void 0){qe.versions?.electron&&(t.from="electron");let n=qe.execArgv??[];(n.includes("-e")||n.includes("--eval")||n.includes("-p")||n.includes("--print"))&&(t.from="eval")}e===void 0&&(e=qe.argv),this.rawArgs=e.slice();let i;switch(t.from){case void 0:case"node":this._scriptPath=e[1],i=e.slice(2);break;case"electron":qe.defaultApp?(this._scriptPath=e[1],i=e.slice(2)):i=e.slice(1);break;case"user":i=e.slice(0);break;case"eval":i=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",i}parse(e,t){this._prepareForParse();let i=this._prepareUserArgs(e,t);return this._parseCommand([],i),this}async parseAsync(e,t){this._prepareForParse();let i=this._prepareUserArgs(e,t);return await this._parseCommand([],i),this}_prepareForParse(){this._savedState===null?this.saveStateBeforeParse():this.restoreStateBeforeParse()}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.
- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name,this._scriptPath=null,this.rawArgs=[],this._optionValues={...this._savedState._optionValues},this._optionValueSources={...this._savedState._optionValueSources},this.args=[],this.processedArgs=[]}_checkForMissingExecutable(e,t,i){if(Wc.existsSync(e))return;let n=t?`searched for local subcommand relative to directory '${t}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",s=`'${e}' does not exist
 - if '${i}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${n}`;throw new Error(s)}_executeSubCommand(e,t){t=t.slice();let i=!1,n=[".js",".ts",".tsx",".mjs",".cjs"];function s(f,h){let d=Ji.resolve(f,h);if(Wc.existsSync(d))return d;if(n.includes(Ji.extname(h)))return;let g=n.find(w=>Wc.existsSync(`${d}${w}`));if(g)return`${d}${g}`}o(s,"findFile"),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let a=e._executableFile||`${this._name}-${e._name}`,c=this._executableDir||"";if(this._scriptPath){let f;try{f=Wc.realpathSync(this._scriptPath)}catch{f=this._scriptPath}c=Ji.resolve(Ji.dirname(f),c)}if(c){let f=s(c,a);if(!f&&!e._executableFile&&this._scriptPath){let h=Ji.basename(this._scriptPath,Ji.extname(this._scriptPath));h!==this._name&&(f=s(c,`${h}-${e._name}`))}a=f||a}i=n.includes(Ji.extname(a));let u;qe.platform!=="win32"?i?(t.unshift(a),t=b0(qe.execArgv).concat(t),u=yh.spawn(qe.argv[0],t,{stdio:"inherit"})):u=yh.spawn(a,t,{stdio:"inherit"}):(this._checkForMissingExecutable(a,c,e._name),t.unshift(a),t=b0(qe.execArgv).concat(t),u=yh.spawn(qe.execPath,t,{stdio:"inherit"})),u.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(h=>{qe.on(h,()=>{u.killed===!1&&u.exitCode===null&&u.kill(h)})});let l=this._exitCallback;u.on("close",f=>{f=f??1,l?l(new vh(f,"commander.executeSubCommandAsync","(close)")):qe.exit(f)}),u.on("error",f=>{if(f.code==="ENOENT")this._checkForMissingExecutable(a,c,e._name);else if(f.code==="EACCES")throw new Error(`'${a}' not executable`);if(!l)qe.exit(1);else{let h=new vh(1,"commander.executeSubCommandAsync","(error)");h.nestedError=f,l(h)}}),this.runningCommand=u}_dispatchSubcommand(e,t,i){let n=this._findCommand(e);n||this.help({error:!0}),n._prepareForParse();let s;return s=this._chainOrCallSubCommandHook(s,n,"preSubcommand"),s=this._chainOrCall(s,()=>{if(n._executableHandler)this._executeSubCommand(n,t.concat(i));else return n._parseCommand(t,i)}),s}_dispatchHelpCommand(e){e||this.help();let t=this._findCommand(e);return t&&!t._executableHandler&&t.help(),this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((e,t)=>{e.required&&this.args[t]==null&&this.missingArgument(e.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){let e=o((i,n,s)=>{let a=n;if(n!==null&&i.parseArg){let c=`error: command-argument value '${n}' is invalid for argument '${i.name()}'.`;a=this._callParseArg(i,n,s,c)}return a},"myParseArg");this._checkNumberOfArguments();let t=[];this.registeredArguments.forEach((i,n)=>{let s=i.defaultValue;i.variadic?n<this.args.length?(s=this.args.slice(n),i.parseArg&&(s=s.reduce((a,c)=>e(i,c,a),i.defaultValue))):s===void 0&&(s=[]):n<this.args.length&&(s=this.args[n],i.parseArg&&(s=e(i,s,i.defaultValue))),t[n]=s}),this.processedArgs=t}_chainOrCall(e,t){return e?.then&&typeof e.then=="function"?e.then(()=>t()):t()}_chainOrCallHooks(e,t){let i=e,n=[];return this._getCommandAndAncestors().reverse().filter(s=>s._lifeCycleHooks[t]!==void 0).forEach(s=>{s._lifeCycleHooks[t].forEach(a=>{n.push({hookedCommand:s,callback:a})})}),t==="postAction"&&n.reverse(),n.forEach(s=>{i=this._chainOrCall(i,()=>s.callback(s.hookedCommand,this))}),i}_chainOrCallSubCommandHook(e,t,i){let n=e;return this._lifeCycleHooks[i]!==void 0&&this._lifeCycleHooks[i].forEach(s=>{n=this._chainOrCall(n,()=>s(this,t))}),n}_parseCommand(e,t){let i=this.parseOptions(t);if(this._parseOptionsEnv(),this._parseOptionsImplied(),e=e.concat(i.operands),t=i.unknown,this.args=e.concat(t),e&&this._findCommand(e[0]))return this._dispatchSubcommand(e[0],e.slice(1),t);if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(e[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(t),this._dispatchSubcommand(this._defaultCommandName,e,t);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(i.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let n=o(()=>{i.unknown.length>0&&this.unknownOption(i.unknown[0])},"checkForUnknownOptions"),s=`command:${this.name()}`;if(this._actionHandler){n(),this._processArguments();let a;return a=this._chainOrCallHooks(a,"preAction"),a=this._chainOrCall(a,()=>this._actionHandler(this.processedArgs)),this.parent&&(a=this._chainOrCall(a,()=>{this.parent.emit(s,e,t)})),a=this._chainOrCallHooks(a,"postAction"),a}if(this.parent?.listenerCount(s))n(),this._processArguments(),this.parent.emit(s,e,t);else if(e.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",e,t);this.listenerCount("command:*")?this.emit("command:*",e,t):this.commands.length?this.unknownCommand():(n(),this._processArguments())}else this.commands.length?(n(),this.help({error:!0})):(n(),this._processArguments())}_findCommand(e){if(e)return this.commands.find(t=>t._name===e||t._aliases.includes(e))}_findOption(e){return this.options.find(t=>t.is(e))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(e=>{e.options.forEach(t=>{t.mandatory&&e.getOptionValue(t.attributeName())===void 0&&e.missingMandatoryOptionValue(t)})})}_checkForConflictingLocalOptions(){let e=this.options.filter(i=>{let n=i.attributeName();return this.getOptionValue(n)===void 0?!1:this.getOptionValueSource(n)!=="default"});e.filter(i=>i.conflictsWith.length>0).forEach(i=>{let n=e.find(s=>i.conflictsWith.includes(s.attributeName()));n&&this._conflictingOption(i,n)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(e=>{e._checkForConflictingLocalOptions()})}parseOptions(e){let t=[],i=[],n=t;function s(f){return f.length>1&&f[0]==="-"}o(s,"maybeOption");let a=o(f=>/^-(\d+|\d*\.\d+)(e[+-]?\d+)?$/.test(f)?!this._getCommandAndAncestors().some(h=>h.options.map(d=>d.short).some(d=>/^-\d$/.test(d))):!1,"negativeNumberArg"),c=null,u=null,l=0;for(;l<e.length||u;){let f=u??e[l++];if(u=null,f==="--"){n===i&&n.push(f),n.push(...e.slice(l));break}if(c&&(!s(f)||a(f))){this.emit(`option:${c.name()}`,f);continue}if(c=null,s(f)){let h=this._findOption(f);if(h){if(h.required){let d=e[l++];d===void 0&&this.optionMissingArgument(h),this.emit(`option:${h.name()}`,d)}else if(h.optional){let d=null;l<e.length&&(!s(e[l])||a(e[l]))&&(d=e[l++]),this.emit(`option:${h.name()}`,d)}else this.emit(`option:${h.name()}`);c=h.variadic?h:null;continue}}if(f.length>2&&f[0]==="-"&&f[1]!=="-"){let h=this._findOption(`-${f[1]}`);if(h){h.required||h.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${h.name()}`,f.slice(2)):(this.emit(`option:${h.name()}`),u=`-${f.slice(2)}`);continue}}if(/^--[^=]+=/.test(f)){let h=f.indexOf("="),d=this._findOption(f.slice(0,h));if(d&&(d.required||d.optional)){this.emit(`option:${d.name()}`,f.slice(h+1));continue}}if(n===t&&s(f)&&!(this.commands.length===0&&a(f))&&(n=i),(this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&i.length===0){if(this._findCommand(f)){t.push(f),i.push(...e.slice(l));break}else if(this._getHelpCommand()&&f===this._getHelpCommand().name()){t.push(f,...e.slice(l));break}else if(this._defaultCommandName){i.push(f,...e.slice(l));break}}if(this._passThroughOptions){n.push(f,...e.slice(l));break}n.push(f)}return{operands:t,unknown:i}}opts(){if(this._storeOptionsAsProperties){let e={},t=this.options.length;for(let i=0;i<t;i++){let n=this.options[i].attributeName();e[n]=n===this._versionOptionName?this._version:this[n]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((e,t)=>Object.assign(e,t.opts()),{})}error(e,t){this._outputConfiguration.outputError(`${e}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));let i=t||{},n=i.exitCode||1,s=i.code||"commander.error";this._exit(n,s,e)}_parseOptionsEnv(){this.options.forEach(e=>{if(e.envVar&&e.envVar in qe.env){let t=e.attributeName();(this.getOptionValue(t)===void 0||["default","config","env"].includes(this.getOptionValueSource(t)))&&(e.required||e.optional?this.emit(`optionEnv:${e.name()}`,qe.env[e.envVar]):this.emit(`optionEnv:${e.name()}`))}})}_parseOptionsImplied(){let e=new JS(this.options),t=o(i=>this.getOptionValue(i)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(i)),"hasCustomOptionValue");this.options.filter(i=>i.implied!==void 0&&t(i.attributeName())&&e.valueFromOption(this.getOptionValue(i.attributeName()),i)).forEach(i=>{Object.keys(i.implied).filter(n=>!t(n)).forEach(n=>{this.setOptionValueWithSource(n,i.implied[n],"implied")})})}missingArgument(e){let t=`error: missing required argument '${e}'`;this.error(t,{code:"commander.missingArgument"})}optionMissingArgument(e){let t=`error: option '${e.flags}' argument missing`;this.error(t,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){let t=`error: required option '${e.flags}' not specified`;this.error(t,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,t){let i=o(a=>{let c=a.attributeName(),u=this.getOptionValue(c),l=this.options.find(h=>h.negate&&c===h.attributeName()),f=this.options.find(h=>!h.negate&&c===h.attributeName());return l&&(l.presetArg===void 0&&u===!1||l.presetArg!==void 0&&u===l.presetArg)?l:f||a},"findBestOptionFromValue"),n=o(a=>{let c=i(a),u=c.attributeName();return this.getOptionValueSource(u)==="env"?`environment variable '${c.envVar}'`:`option '${c.flags}'`},"getErrorMessage"),s=`error: ${n(e)} cannot be used with ${n(t)}`;this.error(s,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let t="";if(e.startsWith("--")&&this._showSuggestionAfterError){let n=[],s=this;do{let a=s.createHelp().visibleOptions(s).filter(c=>c.long).map(c=>c.long);n=n.concat(a),s=s.parent}while(s&&!s._enablePositionalOptions);t=w0(e,n)}let i=`error: unknown option '${e}'${t}`;this.error(i,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;let t=this.registeredArguments.length,i=t===1?"":"s",s=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${t} argument${i} but got ${e.length}.`;this.error(s,{code:"commander.excessArguments"})}unknownCommand(){let e=this.args[0],t="";if(this._showSuggestionAfterError){let n=[];this.createHelp().visibleCommands(this).forEach(s=>{n.push(s.name()),s.alias()&&n.push(s.alias())}),t=w0(e,n)}let i=`error: unknown command '${e}'${t}`;this.error(i,{code:"commander.unknownCommand"})}version(e,t,i){if(e===void 0)return this._version;this._version=e,t=t||"-V, --version",i=i||"output the version number";let n=this.createOption(t,i);return this._versionOptionName=n.attributeName(),this._registerOption(n),this.on("option:"+n.name(),()=>{this._outputConfiguration.writeOut(`${e}
`),this._exit(0,"commander.version",e)}),this}description(e,t){return e===void 0&&t===void 0?this._description:(this._description=e,t&&(this._argsDescription=t),this)}summary(e){return e===void 0?this._summary:(this._summary=e,this)}alias(e){if(e===void 0)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(t=this.commands[this.commands.length-1]),e===t._name)throw new Error("Command alias can't be the same as its name");let i=this.parent?._findCommand(e);if(i){let n=[i.name()].concat(i.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${n}'`)}return t._aliases.push(e),this}aliases(e){return e===void 0?this._aliases:(e.forEach(t=>this.alias(t)),this)}usage(e){if(e===void 0){if(this._usage)return this._usage;let t=this.registeredArguments.map(i=>QS(i));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?t:[]).join(" ")}return this._usage=e,this}name(e){return e===void 0?this._name:(this._name=e,this)}helpGroup(e){return e===void 0?this._helpGroupHeading??"":(this._helpGroupHeading=e,this)}commandsGroup(e){return e===void 0?this._defaultCommandGroup??"":(this._defaultCommandGroup=e,this)}optionsGroup(e){return e===void 0?this._defaultOptionGroup??"":(this._defaultOptionGroup=e,this)}_initOptionGroup(e){this._defaultOptionGroup&&!e.helpGroupHeading&&e.helpGroup(this._defaultOptionGroup)}_initCommandGroup(e){this._defaultCommandGroup&&!e.helpGroup()&&e.helpGroup(this._defaultCommandGroup)}nameFromFilename(e){return this._name=Ji.basename(e,Ji.extname(e)),this}executableDir(e){return e===void 0?this._executableDir:(this._executableDir=e,this)}helpInformation(e){let t=this.createHelp(),i=this._getOutputContext(e);t.prepareContext({error:i.error,helpWidth:i.helpWidth,outputHasColors:i.hasColors});let n=t.formatHelp(this,t);return i.hasColors?n:this._outputConfiguration.stripColor(n)}_getOutputContext(e){e=e||{};let t=!!e.error,i,n,s;return t?(i=o(c=>this._outputConfiguration.writeErr(c),"baseWrite"),n=this._outputConfiguration.getErrHasColors(),s=this._outputConfiguration.getErrHelpWidth()):(i=o(c=>this._outputConfiguration.writeOut(c),"baseWrite"),n=this._outputConfiguration.getOutHasColors(),s=this._outputConfiguration.getOutHelpWidth()),{error:t,write:o(c=>(n||(c=this._outputConfiguration.stripColor(c)),i(c)),"write"),hasColors:n,helpWidth:s}}outputHelp(e){let t;typeof e=="function"&&(t=e,e=void 0);let i=this._getOutputContext(e),n={error:i.error,write:i.write,command:this};this._getCommandAndAncestors().reverse().forEach(a=>a.emit("beforeAllHelp",n)),this.emit("beforeHelp",n);let s=this.helpInformation({error:i.error});if(t&&(s=t(s),typeof s!="string"&&!Buffer.isBuffer(s)))throw new Error("outputHelp callback must return a string or a Buffer");i.write(s),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",n),this._getCommandAndAncestors().forEach(a=>a.emit("afterAllHelp",n))}helpOption(e,t){return typeof e=="boolean"?(e?(this._helpOption===null&&(this._helpOption=void 0),this._defaultOptionGroup&&this._initOptionGroup(this._getHelpOption())):this._helpOption=null,this):(this._helpOption=this.createOption(e??"-h, --help",t??"display help for command"),(e||t)&&this._initOptionGroup(this._helpOption),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(e){return this._helpOption=e,this._initOptionGroup(e),this}help(e){this.outputHelp(e);let t=Number(qe.exitCode??0);t===0&&e&&typeof e!="function"&&e.error&&(t=1),this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){let i=["beforeAll","before","after","afterAll"];if(!i.includes(e))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${i.join("', '")}'`);let n=`${e}Help`;return this.on(n,s=>{let a;typeof t=="function"?a=t({error:s.error,command:s.command}):a=t,a&&s.write(`${a}
`)}),this}_outputHelpIfRequested(e){let t=this._getHelpOption();t&&e.find(n=>t.is(n))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}};function b0(r){return r.map(e=>{if(!e.startsWith("--inspect"))return e;let t,i="127.0.0.1",n="9229",s;return(s=e.match(/^(--inspect(-brk)?)$/))!==null?t=s[1]:(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(t=s[1],/^\d+$/.test(s[3])?n=s[3]:i=s[3]):(s=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(t=s[1],i=s[3],n=s[4]),t&&n!=="0"?`${t}=${i}:${parseInt(n)+1}`:e})}o(b0,"incrementNodeInspectorPort");function wh(){if(qe.env.NO_COLOR||qe.env.FORCE_COLOR==="0"||qe.env.FORCE_COLOR==="false")return!1;if(qe.env.FORCE_COLOR||qe.env.CLICOLOR_FORCE!==void 0)return!0}o(wh,"useColor");bh.Command=_h;bh.useColor=wh});var x0=y(kr=>{var{Argument:E0}=Gc(),{Command:Sh}=S0(),{CommanderError:ZS,InvalidArgumentError:T0}=lo(),{Help:eE}=hh(),{Option:A0}=gh();kr.program=new Sh;kr.createCommand=r=>new Sh(r);kr.createOption=(r,e)=>new A0(r,e);kr.createArgument=(r,e)=>new E0(r,e);kr.Command=Sh;kr.Option=A0;kr.Argument=E0;kr.Help=eE;kr.CommanderError=ZS;kr.InvalidArgumentError=T0;kr.InvalidOptionArgumentError=T0});var Eh=y(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.AssetClass=void 0;var O0;(function(r){r.AREA="ems__Area",r.TASK="ems__Task",r.PROJECT="ems__Project",r.MEETING="ems__Meeting",r.INITIATIVE="ems__Initiative",r.TASK_PROTOTYPE="ems__TaskPrototype",r.MEETING_PROTOTYPE="ems__MeetingPrototype",r.EVENT_PROTOTYPE="exo__EventPrototype",r.PROJECT_PROTOTYPE="ems__ProjectPrototype",r.EVENT="exo__Event",r.DAILY_NOTE="pn__DailyNote",r.CONCEPT="ims__Concept",r.SESSION_START_EVENT="ems__SessionStartEvent",r.SESSION_END_EVENT="ems__SessionEndEvent",r.PROTOTYPE="exo__Prototype",r.CLASS="exo__Class"})(O0||(zc.AssetClass=O0={}))});var Th=y(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});Hc.EffortStatus=void 0;var P0;(function(r){r.DRAFT="ems__EffortStatusDraft",r.BACKLOG="ems__EffortStatusBacklog",r.ANALYSIS="ems__EffortStatusAnalysis",r.TODO="ems__EffortStatusToDo",r.DOING="ems__EffortStatusDoing",r.DONE="ems__EffortStatusDone",r.TRASHED="ems__EffortStatusTrashed"})(P0||(Hc.EffortStatus=P0={}))});var I0=y(F0=>{"use strict";Object.defineProperty(F0,"__esModule",{value:!0})});var D0=y(R0=>{"use strict";Object.defineProperty(R0,"__esModule",{value:!0})});var k0=y(N0=>{"use strict";Object.defineProperty(N0,"__esModule",{value:!0})});var L0=y(j0=>{"use strict";Object.defineProperty(j0,"__esModule",{value:!0})});var et=y(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.IRI=void 0;var Ah=class r{static{o(this,"IRI")}constructor(e){let t=e.trim();if(t.length===0)throw new Error("IRI cannot be empty");if(!r.isValidIRI(t))throw new Error("Invalid IRI format");this._value=t}get value(){return this._value}equals(e){return this._value===e._value}toString(){return this._value}static isValidIRI(e){if(!e||e.trim().length===0||/\s/.test(e)||!/^[a-z][a-z0-9+.-]*:/i.test(e))return!1;let i=["http","https","ftp","ftps","file","mailto","tel","data","ws","wss","urn","obsidian"],n=e.match(/^([a-z][a-z0-9+.-]*?):/i);if(n){let s=n[1].toLowerCase();if(!i.includes(s))return!1}try{return new URL(e),!0}catch{return/^urn:[a-z0-9][a-z0-9-]{0,31}:[^\s]+$/i.test(e)}}};Kc.IRI=Ah});var yt=y(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.Literal=void 0;ns.parseLanguageTag=M0;ns.createDirectionalLiteral=rE;ns.createLiteralFromLanguageTag=iE;var tE="http://www.w3.org/2001/XMLSchema#string",fo=class{static{o(this,"Literal")}constructor(e,t,i,n){if(e.length===0)throw new Error("Literal value cannot be empty");if(t&&i)throw new Error("Literal cannot have both datatype and language tag");if(n&&!i)throw new Error("Literal cannot have direction without language tag");if(n&&n!=="ltr"&&n!=="rtl")throw new Error('Direction must be "ltr" or "rtl"');this._value=e,this._datatype=t,this._language=i?i.toLowerCase():void 0,this._direction=n}get value(){return this._value}get datatype(){return this._datatype}get language(){return this._language}get direction(){return this._direction}hasDirection(){return this._direction!==void 0}equals(e){if(this._value!==e._value||this._language!==e._language||this._direction!==e._direction)return!1;let t=this.normalizedDatatype(),i=e.normalizedDatatype();return t===i}normalizedDatatype(){return!this._datatype||this._datatype.value===tE?null:this._datatype.value}toString(){let e=`"${this._value}"`;return this._datatype?e+=`^^<${this._datatype.value}>`:this._language&&(e+=`@${this._language}`,this._direction&&(e+=`--${this._direction}`)),e}};ns.Literal=fo;function M0(r){let t=r.lastIndexOf("--");if(t===-1)return{language:r.toLowerCase()};let i=r.substring(t+2),n=r.substring(0,t);return i==="ltr"||i==="rtl"?{language:n.toLowerCase(),direction:i}:{language:r.toLowerCase()}}o(M0,"parseLanguageTag");function rE(r,e,t){return new fo(r,void 0,e,t)}o(rE,"createDirectionalLiteral");function iE(r,e){let{language:t,direction:i}=M0(e);return new fo(r,void 0,t,i)}o(iE,"createLiteralFromLanguageTag")});var sr=y(Yc=>{"use strict";Object.defineProperty(Yc,"__esModule",{value:!0});Yc.BlankNode=void 0;var Qc=class r{static{o(this,"BlankNode")}constructor(e){let t=e.trim();if(t.length===0)throw new Error("BlankNode id cannot be empty");this._id=t}get id(){return this._id}equals(e){return this._id===e._id}toString(){return`_:${this._id}`}static generateId(){return`b${++r.counter}`}static create(){return new r(r.generateId())}};Yc.BlankNode=Qc;Qc.counter=0});var Oi=y(Xc=>{"use strict";Object.defineProperty(Xc,"__esModule",{value:!0});Xc.Namespace=void 0;var V0=et(),ar=class{static{o(this,"Namespace")}constructor(e,t){if(e.trim().length===0)throw new Error("Namespace prefix cannot be empty");this._prefix=e,this._iri=new V0.IRI(t)}get prefix(){return this._prefix}get iri(){return this._iri}term(e){return new V0.IRI(`${this._iri.value}${e}`)}expand(e){let t=e.split(":");if(t.length!==2)return null;let[i,n]=t;return i!==this._prefix?null:this.term(n)}};Xc.Namespace=ar;ar.RDF=new ar("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#");ar.RDFS=new ar("rdfs","http://www.w3.org/2000/01/rdf-schema#");ar.OWL=new ar("owl","http://www.w3.org/2002/07/owl#");ar.XSD=new ar("xsd","http://www.w3.org/2001/XMLSchema#");ar.EXO=new ar("exo","https://exocortex.my/ontology/exo#");ar.EMS=new ar("ems","https://exocortex.my/ontology/ems#")});var _n=y(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.Triple=void 0;var xh=et(),Ch=yt(),Oh=sr(),Ph=class{static{o(this,"Triple")}constructor(e,t,i){this._subject=e,this._predicate=t,this._object=i}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}equals(e){return!(!this.equalsNode(this._subject,e._subject)||!this._predicate.equals(e._predicate)||!this.equalsNode(this._object,e._object))}equalsNode(e,t){return e instanceof xh.IRI&&t instanceof xh.IRI||e instanceof Oh.BlankNode&&t instanceof Oh.BlankNode||e instanceof Ch.Literal&&t instanceof Ch.Literal||this.isQuotedTriple(e)&&this.isQuotedTriple(t)?e.equals(t):!1}isQuotedTriple(e){return typeof e=="object"&&e!==null&&"termType"in e&&e.termType==="QuotedTriple"}toString(){let e=this.nodeToString(this._subject),t=`<${this._predicate.value}>`,i=this.nodeToString(this._object);return`${e} ${t} ${i} .`}nodeToString(e){return e instanceof xh.IRI?`<${e.value}>`:e instanceof Oh.BlankNode||e instanceof Ch.Literal||this.isQuotedTriple(e)?e.toString():""}};Jc.Triple=Ph});var eu=y(Zc=>{"use strict";Object.defineProperty(Zc,"__esModule",{value:!0});Zc.QuotedTriple=void 0;var Fh=et(),Ih=yt(),Rh=sr(),Dh=class r{static{o(this,"QuotedTriple")}constructor(e,t,i){this._subject=e,this._predicate=t,this._object=i}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}equals(e){return!(!this.equalsNode(this._subject,e._subject)||!this._predicate.equals(e._predicate)||!this.equalsNode(this._object,e._object))}equalsNode(e,t){return e instanceof Fh.IRI&&t instanceof Fh.IRI||e instanceof Rh.BlankNode&&t instanceof Rh.BlankNode||e instanceof Ih.Literal&&t instanceof Ih.Literal||e instanceof r&&t instanceof r?e.equals(t):!1}get termType(){return"QuotedTriple"}toString(){let e=this.nodeToString(this._subject),t=`<${this._predicate.value}>`,i=this.nodeToString(this._object);return`<< ${e} ${t} ${i} >>`}nodeToString(e){return e instanceof Fh.IRI?`<${e.value}>`:e instanceof Rh.BlankNode||e instanceof Ih.Literal||e instanceof r?e.toString():""}};Zc.QuotedTriple=Dh});var $0=y(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.QuotedTriple=vt.Triple=vt.Namespace=vt.BlankNode=vt.createLiteralFromLanguageTag=vt.createDirectionalLiteral=vt.parseLanguageTag=vt.Literal=vt.IRI=void 0;var nE=et();Object.defineProperty(vt,"IRI",{enumerable:!0,get:o(function(){return nE.IRI},"get")});var tu=yt();Object.defineProperty(vt,"Literal",{enumerable:!0,get:o(function(){return tu.Literal},"get")});Object.defineProperty(vt,"parseLanguageTag",{enumerable:!0,get:o(function(){return tu.parseLanguageTag},"get")});Object.defineProperty(vt,"createDirectionalLiteral",{enumerable:!0,get:o(function(){return tu.createDirectionalLiteral},"get")});Object.defineProperty(vt,"createLiteralFromLanguageTag",{enumerable:!0,get:o(function(){return tu.createLiteralFromLanguageTag},"get")});var sE=sr();Object.defineProperty(vt,"BlankNode",{enumerable:!0,get:o(function(){return sE.BlankNode},"get")});var aE=Oi();Object.defineProperty(vt,"Namespace",{enumerable:!0,get:o(function(){return aE.Namespace},"get")});var oE=_n();Object.defineProperty(vt,"Triple",{enumerable:!0,get:o(function(){return oE.Triple},"get")});var cE=eu();Object.defineProperty(vt,"QuotedTriple",{enumerable:!0,get:o(function(){return cE.QuotedTriple},"get")})});var ss=y(iu=>{"use strict";Object.defineProperty(iu,"__esModule",{value:!0});iu.WikiLinkHelpers=void 0;var ru=class{static{o(this,"WikiLinkHelpers")}static normalize(e){return e?e.replace(this.WIKI_LINK_PATTERN,"").trim():""}static normalizeArray(e){return e?(Array.isArray(e)?e:[e]).map(i=>this.normalize(i)).filter(i=>i.length>0):[]}static equals(e,t){return this.normalize(e)===this.normalize(t)}static includes(e,t){let i=this.normalizeArray(e),n=this.normalize(t);return i.includes(n)}};iu.WikiLinkHelpers=ru;ru.WIKI_LINK_PATTERN=/\[\[|\]\]/g});var Wt=y(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.EffortStatus=Qs.AssetClass=void 0;var uE=Eh();Object.defineProperty(Qs,"AssetClass",{enumerable:!0,get:o(function(){return uE.AssetClass},"get")});var lE=Th();Object.defineProperty(Qs,"EffortStatus",{enumerable:!0,get:o(function(){return lE.EffortStatus},"get")})});var wn=y(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.hasClass=os;zt.isAreaOrProject=fE;zt.isEffort=hE;zt.hasStatus=dE;zt.isAssetArchived=pE;zt.hasEmptyProperties=mE;zt.needsFolderRepair=gE;zt.getTodayDateString=Nh;zt.isPlannedForToday=yE;zt.hasPlannedStartTimestamp=vE;zt.extractDailyNoteDate=_E;zt.isCurrentDateGteDay=wE;zt.inheritsFromPrototype=U0;zt.isPrototypeClass=SE;var B0=ss(),as=Wt();function os(r,e){return r?(Array.isArray(r)?r:[r]).some(i=>B0.WikiLinkHelpers.normalize(i)===e):!1}o(os,"hasClass");function fE(r){return os(r,as.AssetClass.AREA)||os(r,as.AssetClass.PROJECT)}o(fE,"isAreaOrProject");function hE(r){return os(r,as.AssetClass.TASK)||os(r,as.AssetClass.PROJECT)||os(r,as.AssetClass.MEETING)}o(hE,"isEffort");function dE(r,e){if(!r)return!1;let t=Array.isArray(r)?r[0]:r;return t?B0.WikiLinkHelpers.normalize(t)===e:!1}o(dE,"hasStatus");function pE(r){if(r===!0||r===1)return!0;if(typeof r=="string"){let e=r.toLowerCase();return e==="true"||e==="yes"}return!1}o(pE,"isAssetArchived");function mE(r){return!r||Object.keys(r).length===0?!1:Object.values(r).some(e=>!!(e==null||typeof e=="string"&&e.trim()===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length===0))}o(mE,"hasEmptyProperties");function gE(r,e){if(!e)return!1;let t=r.replace(/\/$/,""),i=e.replace(/\/$/,"");return t!==i}o(gE,"needsFolderRepair");function Nh(){let r=new Date,e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");return`${e}-${t}-${i}`}o(Nh,"getTodayDateString");function yE(r){let e=r.ems__Effort_plannedStartTimestamp;if(!e)return!1;let t=Nh();return typeof e=="string"?e.split("T")[0]===t:Array.isArray(e)&&e.length>0?String(e[0]).split("T")[0]===t:!1}o(yE,"isPlannedForToday");function vE(r){let e=r.ems__Effort_plannedStartTimestamp;return e?typeof e=="string"?e.trim().length>0:Array.isArray(e)&&e.length>0?String(e[0]).trim().length>0:!1:!1}o(vE,"hasPlannedStartTimestamp");function _E(r){let e=r.pn__DailyNote_day;if(!e)return null;if(typeof e=="string"){let t=e.match(/\[\[([^\[\]]+)\]\]/);return t?t[1]:e}if(Array.isArray(e)&&e.length>0){let t=String(e[0]),i=t.match(/\[\[([^\[\]]+)\]\]/);return i?i[1]:t}return null}o(_E,"extractDailyNoteDate");function wE(r){return Nh()>=r}o(wE,"isCurrentDateGteDay");function q0(r){return r?r.replace(/^["']|["']$/g,"").replace(/\[\[|\]\]/g,"").trim():""}o(q0,"normalizeWithQuotes");var bE=10;function U0(r,e=bE){let t=r.exo__Class_superClass;if(!t)return!1;let i=new Set,n=[],s=Array.isArray(t)?t:[t];for(let a of s){let c=q0(a);c&&n.push({className:c,depth:0})}for(;n.length>0;){let a=n.shift();if(!a)continue;let{className:c,depth:u}=a;if(u>e)continue;if(c===as.AssetClass.PROTOTYPE)return!0;if(i.has(c))continue;i.add(c);let l=`${c}__exo__Class_superClass`,f=r[l];if(f){let h=Array.isArray(f)?f:[f];for(let d of h){let g=q0(d);g&&!i.has(g)&&n.push({className:g,depth:u+1})}}}return!1}o(U0,"inheritsFromPrototype");function SE(r,e){return os(r,as.AssetClass.CLASS)?U0(e):!1}o(SE,"isPrototypeClass")});var W0=y(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.canCreateTask=EE;ho.canCreateRelatedTask=TE;ho.canConvertTaskToProject=AE;var nu=wn(),G0=Wt();function EE(r){return(0,nu.isAreaOrProject)(r.instanceClass)}o(EE,"canCreateTask");function TE(r){return!(!(0,nu.hasClass)(r.instanceClass,G0.AssetClass.TASK)||(0,nu.isAssetArchived)(r.isArchived))}o(TE,"canCreateRelatedTask");function AE(r){return(0,nu.hasClass)(r.instanceClass,G0.AssetClass.TASK)}o(AE,"canConvertTaskToProject")});var z0=y(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.canCreateProject=xE;Ys.canMoveToAnalysis=CE;Ys.canMoveToToDo=OE;Ys.canConvertProjectToTask=PE;var bn=wn(),Sn=Wt();function xE(r){return(0,bn.hasClass)(r.instanceClass,Sn.AssetClass.AREA)||(0,bn.hasClass)(r.instanceClass,Sn.AssetClass.INITIATIVE)||(0,bn.hasClass)(r.instanceClass,Sn.AssetClass.PROJECT)}o(xE,"canCreateProject");function CE(r){return(0,bn.hasClass)(r.instanceClass,Sn.AssetClass.PROJECT)?(0,bn.hasStatus)(r.currentStatus,Sn.EffortStatus.BACKLOG):!1}o(CE,"canMoveToAnalysis");function OE(r){return(0,bn.hasClass)(r.instanceClass,Sn.AssetClass.PROJECT)?(0,bn.hasStatus)(r.currentStatus,Sn.EffortStatus.ANALYSIS):!1}o(OE,"canMoveToToDo");function PE(r){return(0,bn.hasClass)(r.instanceClass,Sn.AssetClass.PROJECT)}o(PE,"canConvertProjectToTask")});var Q0=y(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.canCreateChildArea=FE;su.canSetActiveFocus=IE;var H0=wn(),K0=Wt();function FE(r){return(0,H0.hasClass)(r.instanceClass,K0.AssetClass.AREA)}o(FE,"canCreateChildArea");function IE(r){return(0,H0.hasClass)(r.instanceClass,K0.AssetClass.AREA)}o(IE,"canSetActiveFocus")});var X0=y(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.canPlanOnToday=RE;wr.canPlanForEvening=DE;wr.canShiftDayBackward=NE;wr.canShiftDayForward=kE;wr.canSetDraftStatus=jE;wr.canMoveToBacklog=LE;wr.canStartEffort=ME;wr.canMarkDone=VE;wr.canTrashEffort=$E;wr.canVoteOnEffort=qE;wr.canRollbackStatus=BE;wr.canArchiveTask=UE;var Y0=ss(),tt=wn(),xr=Wt();function RE(r){return!(!(0,tt.isEffort)(r.instanceClass)||(0,tt.isPlannedForToday)(r.metadata))}o(RE,"canPlanOnToday");function DE(r){return!(0,tt.hasClass)(r.instanceClass,xr.AssetClass.TASK)&&!(0,tt.hasClass)(r.instanceClass,xr.AssetClass.MEETING)?!1:(0,tt.hasStatus)(r.currentStatus,xr.EffortStatus.BACKLOG)}o(DE,"canPlanForEvening");function NE(r){return(0,tt.isEffort)(r.instanceClass)?(0,tt.hasPlannedStartTimestamp)(r.metadata):!1}o(NE,"canShiftDayBackward");function kE(r){return(0,tt.isEffort)(r.instanceClass)?(0,tt.hasPlannedStartTimestamp)(r.metadata):!1}o(kE,"canShiftDayForward");function jE(r){return(0,tt.isEffort)(r.instanceClass)?!r.currentStatus:!1}o(jE,"canSetDraftStatus");function LE(r){return(0,tt.isEffort)(r.instanceClass)?(0,tt.hasStatus)(r.currentStatus,xr.EffortStatus.DRAFT):!1}o(LE,"canMoveToBacklog");function ME(r){return(0,tt.isEffort)(r.instanceClass)?(0,tt.hasClass)(r.instanceClass,xr.AssetClass.TASK)||(0,tt.hasClass)(r.instanceClass,xr.AssetClass.MEETING)?(0,tt.hasStatus)(r.currentStatus,xr.EffortStatus.BACKLOG):(0,tt.hasClass)(r.instanceClass,xr.AssetClass.PROJECT)?(0,tt.hasStatus)(r.currentStatus,xr.EffortStatus.TODO):!1:!1}o(ME,"canStartEffort");function VE(r){return(0,tt.isEffort)(r.instanceClass)?(0,tt.hasStatus)(r.currentStatus,xr.EffortStatus.DOING):!1}o(VE,"canMarkDone");function $E(r){return(0,tt.isEffort)(r.instanceClass)?r.currentStatus?!(Array.isArray(r.currentStatus)?r.currentStatus:[r.currentStatus]).some(i=>{let n=Y0.WikiLinkHelpers.normalize(i);return n===xr.EffortStatus.TRASHED||n===xr.EffortStatus.DONE}):!0:!1}o($E,"canTrashEffort");function qE(r){return!(!(0,tt.isEffort)(r.instanceClass)||(0,tt.isAssetArchived)(r.isArchived))}o(qE,"canVoteOnEffort");function BE(r){if(!(0,tt.isEffort)(r.instanceClass)||(0,tt.isAssetArchived)(r.isArchived)||!r.currentStatus)return!1;let e=Array.isArray(r.currentStatus)?r.currentStatus[0]:r.currentStatus;return!(!e||Y0.WikiLinkHelpers.normalize(e)===xr.EffortStatus.TRASHED)}o(BE,"canRollbackStatus");function UE(r){return!(0,tt.isAssetArchived)(r.isArchived)}o(UE,"canArchiveTask")});var J0=y(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.canCreateEvent=GE;Ur.canCreateInstance=WE;Ur.canCleanProperties=zE;Ur.canRepairFolder=HE;Ur.canRenameToUid=KE;Ur.canCopyLabelToAliases=QE;Ur.canCreateNarrowerConcept=YE;Ur.canCreateSubclass=XE;Ur.canCreateTaskForDailyNote=JE;var br=wn(),En=Wt();function GE(r){return(0,br.isAreaOrProject)(r.instanceClass)}o(GE,"canCreateEvent");function WE(r){return(0,br.hasClass)(r.instanceClass,En.AssetClass.TASK_PROTOTYPE)||(0,br.hasClass)(r.instanceClass,En.AssetClass.MEETING_PROTOTYPE)||(0,br.hasClass)(r.instanceClass,En.AssetClass.EVENT_PROTOTYPE)||(0,br.hasClass)(r.instanceClass,En.AssetClass.PROJECT_PROTOTYPE)?!0:(0,br.isPrototypeClass)(r.instanceClass,r.metadata)}o(WE,"canCreateInstance");function zE(r){return(0,br.hasEmptyProperties)(r.metadata)}o(zE,"canCleanProperties");function HE(r){return(0,br.needsFolderRepair)(r.currentFolder,r.expectedFolder)}o(HE,"canRepairFolder");function KE(r,e){let t=r.metadata.exo__Asset_uid;return!t||(0,br.hasClass)(r.instanceClass,En.AssetClass.CONCEPT)?!1:e!==t}o(KE,"canRenameToUid");function QE(r){let e=r.metadata.exo__Asset_label;if(!e||typeof e!="string"||e.trim()==="")return!1;let t=e.trim(),i=r.metadata.aliases;return!i||!Array.isArray(i)||i.length===0?!0:!i.some(n=>typeof n!="string"?!1:n.trim()===t)}o(QE,"canCopyLabelToAliases");function YE(r){return(0,br.hasClass)(r.instanceClass,En.AssetClass.CONCEPT)}o(YE,"canCreateNarrowerConcept");function XE(r){return(0,br.hasClass)(r.instanceClass,En.AssetClass.CLASS)}o(XE,"canCreateSubclass");function JE(r){if(!(0,br.hasClass)(r.instanceClass,En.AssetClass.DAILY_NOTE)||r.isArchived)return!1;let e=(0,br.extractDailyNoteDate)(r.metadata);return e?(0,br.isCurrentDateGteDay)(e):!1}o(JE,"canCreateTaskForDailyNote")});var ey=y(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.canCreateTaskForDailyNote=R.canCreateSubclass=R.canCreateNarrowerConcept=R.canCopyLabelToAliases=R.canRenameToUid=R.canRepairFolder=R.canCleanProperties=R.canCreateInstance=R.canCreateEvent=R.canArchiveTask=R.canRollbackStatus=R.canVoteOnEffort=R.canTrashEffort=R.canMarkDone=R.canStartEffort=R.canMoveToBacklog=R.canSetDraftStatus=R.canShiftDayForward=R.canShiftDayBackward=R.canPlanForEvening=R.canPlanOnToday=R.canSetActiveFocus=R.canCreateChildArea=R.canConvertProjectToTask=R.canMoveToToDo=R.canMoveToAnalysis=R.canCreateProject=R.canConvertTaskToProject=R.canCreateRelatedTask=R.canCreateTask=R.isPrototypeClass=R.inheritsFromPrototype=R.isCurrentDateGteDay=R.extractDailyNoteDate=R.hasPlannedStartTimestamp=R.isPlannedForToday=R.getTodayDateString=R.needsFolderRepair=R.hasEmptyProperties=R.isAssetArchived=R.hasStatus=R.isEffort=R.isAreaOrProject=R.hasClass=void 0;var Sr=wn();Object.defineProperty(R,"hasClass",{enumerable:!0,get:o(function(){return Sr.hasClass},"get")});Object.defineProperty(R,"isAreaOrProject",{enumerable:!0,get:o(function(){return Sr.isAreaOrProject},"get")});Object.defineProperty(R,"isEffort",{enumerable:!0,get:o(function(){return Sr.isEffort},"get")});Object.defineProperty(R,"hasStatus",{enumerable:!0,get:o(function(){return Sr.hasStatus},"get")});Object.defineProperty(R,"isAssetArchived",{enumerable:!0,get:o(function(){return Sr.isAssetArchived},"get")});Object.defineProperty(R,"hasEmptyProperties",{enumerable:!0,get:o(function(){return Sr.hasEmptyProperties},"get")});Object.defineProperty(R,"needsFolderRepair",{enumerable:!0,get:o(function(){return Sr.needsFolderRepair},"get")});Object.defineProperty(R,"getTodayDateString",{enumerable:!0,get:o(function(){return Sr.getTodayDateString},"get")});Object.defineProperty(R,"isPlannedForToday",{enumerable:!0,get:o(function(){return Sr.isPlannedForToday},"get")});Object.defineProperty(R,"hasPlannedStartTimestamp",{enumerable:!0,get:o(function(){return Sr.hasPlannedStartTimestamp},"get")});Object.defineProperty(R,"extractDailyNoteDate",{enumerable:!0,get:o(function(){return Sr.extractDailyNoteDate},"get")});Object.defineProperty(R,"isCurrentDateGteDay",{enumerable:!0,get:o(function(){return Sr.isCurrentDateGteDay},"get")});Object.defineProperty(R,"inheritsFromPrototype",{enumerable:!0,get:o(function(){return Sr.inheritsFromPrototype},"get")});Object.defineProperty(R,"isPrototypeClass",{enumerable:!0,get:o(function(){return Sr.isPrototypeClass},"get")});var kh=W0();Object.defineProperty(R,"canCreateTask",{enumerable:!0,get:o(function(){return kh.canCreateTask},"get")});Object.defineProperty(R,"canCreateRelatedTask",{enumerable:!0,get:o(function(){return kh.canCreateRelatedTask},"get")});Object.defineProperty(R,"canConvertTaskToProject",{enumerable:!0,get:o(function(){return kh.canConvertTaskToProject},"get")});var au=z0();Object.defineProperty(R,"canCreateProject",{enumerable:!0,get:o(function(){return au.canCreateProject},"get")});Object.defineProperty(R,"canMoveToAnalysis",{enumerable:!0,get:o(function(){return au.canMoveToAnalysis},"get")});Object.defineProperty(R,"canMoveToToDo",{enumerable:!0,get:o(function(){return au.canMoveToToDo},"get")});Object.defineProperty(R,"canConvertProjectToTask",{enumerable:!0,get:o(function(){return au.canConvertProjectToTask},"get")});var Z0=Q0();Object.defineProperty(R,"canCreateChildArea",{enumerable:!0,get:o(function(){return Z0.canCreateChildArea},"get")});Object.defineProperty(R,"canSetActiveFocus",{enumerable:!0,get:o(function(){return Z0.canSetActiveFocus},"get")});var jr=X0();Object.defineProperty(R,"canPlanOnToday",{enumerable:!0,get:o(function(){return jr.canPlanOnToday},"get")});Object.defineProperty(R,"canPlanForEvening",{enumerable:!0,get:o(function(){return jr.canPlanForEvening},"get")});Object.defineProperty(R,"canShiftDayBackward",{enumerable:!0,get:o(function(){return jr.canShiftDayBackward},"get")});Object.defineProperty(R,"canShiftDayForward",{enumerable:!0,get:o(function(){return jr.canShiftDayForward},"get")});Object.defineProperty(R,"canSetDraftStatus",{enumerable:!0,get:o(function(){return jr.canSetDraftStatus},"get")});Object.defineProperty(R,"canMoveToBacklog",{enumerable:!0,get:o(function(){return jr.canMoveToBacklog},"get")});Object.defineProperty(R,"canStartEffort",{enumerable:!0,get:o(function(){return jr.canStartEffort},"get")});Object.defineProperty(R,"canMarkDone",{enumerable:!0,get:o(function(){return jr.canMarkDone},"get")});Object.defineProperty(R,"canTrashEffort",{enumerable:!0,get:o(function(){return jr.canTrashEffort},"get")});Object.defineProperty(R,"canVoteOnEffort",{enumerable:!0,get:o(function(){return jr.canVoteOnEffort},"get")});Object.defineProperty(R,"canRollbackStatus",{enumerable:!0,get:o(function(){return jr.canRollbackStatus},"get")});Object.defineProperty(R,"canArchiveTask",{enumerable:!0,get:o(function(){return jr.canArchiveTask},"get")});var Zi=J0();Object.defineProperty(R,"canCreateEvent",{enumerable:!0,get:o(function(){return Zi.canCreateEvent},"get")});Object.defineProperty(R,"canCreateInstance",{enumerable:!0,get:o(function(){return Zi.canCreateInstance},"get")});Object.defineProperty(R,"canCleanProperties",{enumerable:!0,get:o(function(){return Zi.canCleanProperties},"get")});Object.defineProperty(R,"canRepairFolder",{enumerable:!0,get:o(function(){return Zi.canRepairFolder},"get")});Object.defineProperty(R,"canRenameToUid",{enumerable:!0,get:o(function(){return Zi.canRenameToUid},"get")});Object.defineProperty(R,"canCopyLabelToAliases",{enumerable:!0,get:o(function(){return Zi.canCopyLabelToAliases},"get")});Object.defineProperty(R,"canCreateNarrowerConcept",{enumerable:!0,get:o(function(){return Zi.canCreateNarrowerConcept},"get")});Object.defineProperty(R,"canCreateSubclass",{enumerable:!0,get:o(function(){return Zi.canCreateSubclass},"get")});Object.defineProperty(R,"canCreateTaskForDailyNote",{enumerable:!0,get:o(function(){return Zi.canCreateTaskForDailyNote},"get")})});var ty=y(cs=>{"use strict";var ZE=cs&&cs.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),eT=cs&&cs.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ZE(e,r,t)};Object.defineProperty(cs,"__esModule",{value:!0});eT(ey(),cs)});var Lh=y(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.PropertyFieldType=void 0;po.rangeToFieldType=iT;var Nt;(function(r){r.Text="text",r.Number="number",r.Date="date",r.DateTime="datetime",r.Boolean="boolean",r.Reference="reference",r.Enum="enum",r.StatusSelect="status-select",r.SizeSelect="size-select",r.Wikilink="wikilink",r.Timestamp="timestamp",r.Unknown="unknown"})(Nt||(po.PropertyFieldType=Nt={}));var ry="http://www.w3.org/2001/XMLSchema#",tT="https://exocortex.my/ontology/exo#",rT="https://exocortex.my/ontology/ems#";function iT(r){if(!r)return Nt.Unknown;let e=r.trim();if(!e)return Nt.Unknown;if(e.startsWith(ry)){let t=e.substring(ry.length);return jh(t)}if(e.startsWith("xsd:")){let t=e.substring(4);return jh(t)}if(e.includes("XMLSchema#")){let t=e.indexOf("XMLSchema#"),i=e.substring(t+10);return jh(i)}return e.startsWith(rT)||e.startsWith("ems:")?nT(e):e.startsWith(tT)||e.startsWith("exo:")||sT(e)?Nt.Reference:Nt.Text}o(iT,"rangeToFieldType");function jh(r){switch(r.toLowerCase()){case"string":case"normalizedstring":case"token":case"language":case"nmtoken":case"name":case"ncname":case"anyuri":return Nt.Text;case"integer":case"int":case"long":case"short":case"byte":case"nonnegativeinteger":case"positiveinteger":case"nonpositiveinteger":case"negativeinteger":case"unsignedlong":case"unsignedint":case"unsignedshort":case"unsignedbyte":case"decimal":case"float":case"double":return Nt.Number;case"date":return Nt.Date;case"datetime":case"datetimestamp":return Nt.DateTime;case"boolean":return Nt.Boolean;case"time":return Nt.Timestamp;default:return Nt.Text}}o(jh,"xsdTypeToFieldType");function nT(r){let e=r.toLowerCase();return e.includes("effortstatus")?Nt.StatusSelect:e.includes("tasksize")?Nt.SizeSelect:Nt.Reference}o(nT,"emsTypeToFieldType");function sT(r){let e=r.toLowerCase();return e.includes("exocortex.my/ontology")?!0:["asset","task","project","area","effort","class","property","concept"].some(i=>e.includes(i))}o(sT,"isClassReference")});var ny=y(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.propertyNameToUri=aT;mo.uriToPropertyName=iy;mo.extractPropertyLabel=oT;function aT(r){return r.replace(/^([a-z]+)__/,"$1:")}o(aT,"propertyNameToUri");function iy(r){if(r.startsWith("http://")||r.startsWith("https://")){let e=r.match(/\/([a-z]+)#([A-Za-z0-9_]+)$/);if(e)return`${e[1]}__${e[2]}`;let t=r.lastIndexOf("#"),i=r.lastIndexOf("/"),n=Math.max(t,i);return n>=0?r.substring(n+1):r}return r.replace(/^([a-z]+):/,"$1__")}o(iy,"uriToPropertyName");function oT(r){let i=(r.includes(":")?iy(r):r).replace(/^[a-z]+__/,"").split("_");return(i.length>1?i.slice(1).join(" "):i[0]).replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,s=>s.toUpperCase())}o(oT,"extractPropertyLabel")});var ou={};VS(ou,{__assign:()=>Vh,__asyncDelegator:()=>wT,__asyncGenerator:()=>_T,__asyncValues:()=>bT,__await:()=>go,__awaiter:()=>dT,__classPrivateFieldGet:()=>AT,__classPrivateFieldSet:()=>xT,__createBinding:()=>mT,__decorate:()=>lT,__exportStar:()=>gT,__extends:()=>cT,__generator:()=>pT,__importDefault:()=>TT,__importStar:()=>ET,__makeTemplateObject:()=>ST,__metadata:()=>hT,__param:()=>fT,__read:()=>sy,__rest:()=>uT,__spread:()=>yT,__spreadArrays:()=>vT,__values:()=>$h});function cT(r,e){Mh(r,e);function t(){this.constructor=r}o(t,"__"),r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function uT(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(r,i[n])&&(t[i[n]]=r[i[n]]);return t}function lT(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s}function fT(r,e){return function(t,i){e(t,i,r)}}function hT(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function dT(r,e,t,i){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return o(n,"adopt"),new(t||(t=Promise))(function(s,a){function c(f){try{l(i.next(f))}catch(h){a(h)}}o(c,"fulfilled");function u(f){try{l(i.throw(f))}catch(h){a(h)}}o(u,"rejected");function l(f){f.done?s(f.value):n(f.value).then(c,u)}o(l,"step"),l((i=i.apply(r,e||[])).next())})}function pT(r,e){var t={label:0,sent:o(function(){if(s[0]&1)throw s[1];return s[1]},"sent"),trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(f){return u([l,f])}}function u(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,n=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){t.label=l[1];break}if(l[0]===6&&t.label<s[1]){t.label=s[1],s=l;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(l);break}s[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(f){l=[6,f],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function mT(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function gT(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function $h(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:o(function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}},"next")};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sy(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return s}function yT(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(sy(arguments[e]));return r}function vT(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),n=0,e=0;e<t;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function go(r){return this instanceof go?(this.v=r,this):new go(r)}function _T(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(d){i[d]&&(n[d]=function(g){return new Promise(function(w,b){s.push([d,g,w,b])>1||c(d,g)})})}function c(d,g){try{u(i[d](g))}catch(w){h(s[0][3],w)}}function u(d){d.value instanceof go?Promise.resolve(d.value.v).then(l,f):h(s[0][2],d)}function l(d){c("next",d)}function f(d){c("throw",d)}function h(d,g){d(g),s.shift(),s.length&&c(s[0][0],s[0][1])}}function wT(r){var e,t;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=r[n]?function(a){return(t=!t)?{value:go(r[n](a)),done:n==="return"}:s?s(a):a}:s}}function bT(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof $h=="function"?$h(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=r[s]&&function(a){return new Promise(function(c,u){a=r[s](a),n(c,u,a.done,a.value)})}}function n(s,a,c,u){Promise.resolve(u).then(function(l){s({value:l,done:c})},a)}}function ST(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function ET(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function TT(r){return r&&r.__esModule?r:{default:r}}function AT(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function xT(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Mh,Vh,cu=MS(()=>{Mh=o(function(r,e){return Mh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},Mh(r,e)},"extendStatics");o(cT,"__extends");Vh=o(function(){return Vh=Object.assign||o(function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},"__assign"),Vh.apply(this,arguments)},"__assign");o(uT,"__rest");o(lT,"__decorate");o(fT,"__param");o(hT,"__metadata");o(dT,"__awaiter");o(pT,"__generator");o(mT,"__createBinding");o(gT,"__exportStar");o($h,"__values");o(sy,"__read");o(yT,"__spread");o(vT,"__spreadArrays");o(go,"__await");o(_T,"__asyncGenerator");o(wT,"__asyncDelegator");o(bT,"__asyncValues");o(ST,"__makeTemplateObject");o(ET,"__importStar");o(TT,"__importDefault");o(AT,"__classPrivateFieldGet");o(xT,"__classPrivateFieldSet")});var Uh=y(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});var qh;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(qh||(qh={}));Bh.default=qh});var ay=y(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});var CT=Uh();Object.defineProperty(Gh,"Lifecycle",{enumerable:!0,get:o(function(){return CT.default},"get")})});var us=y(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.defineInjectionTokenMetadata=Gr.getParamInfo=Gr.INJECTION_TOKEN_METADATA_KEY=void 0;Gr.INJECTION_TOKEN_METADATA_KEY="injectionTokens";function OT(r){let e=Reflect.getMetadata("design:paramtypes",r)||[],t=Reflect.getOwnMetadata(Gr.INJECTION_TOKEN_METADATA_KEY,r)||{};return Object.keys(t).forEach(i=>{e[+i]=t[i]}),e}o(OT,"getParamInfo");Gr.getParamInfo=OT;function PT(r,e){return function(t,i,n){let s=Reflect.getOwnMetadata(Gr.INJECTION_TOKEN_METADATA_KEY,t)||{};s[n]=e?{token:r,transform:e.transformToken,transformArgs:e.args||[]}:r,Reflect.defineMetadata(Gr.INJECTION_TOKEN_METADATA_KEY,s,t)}}o(PT,"defineInjectionTokenMetadata");Gr.defineInjectionTokenMetadata=PT});var Wh=y(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});uu.isClassProvider=void 0;function FT(r){return!!r.useClass}o(FT,"isClassProvider");uu.isClassProvider=FT});var zh=y(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.isFactoryProvider=void 0;function IT(r){return!!r.useFactory}o(IT,"isFactoryProvider");lu.isFactoryProvider=IT});var hu=y(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.delay=Xs.DelayedConstructor=void 0;var fu=class{static{o(this,"DelayedConstructor")}constructor(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}createProxy(e){let t={},i=!1,n,s=o(()=>(i||(n=e(this.wrap()),i=!0),n),"delayedObject");return new Proxy(t,this.createHandler(s))}createHandler(e){let t={},i=o(n=>{t[n]=(...s)=>{s[0]=e();let a=Reflect[n];return a(...s)}},"install");return this.reflectMethods.forEach(i),t}};Xs.DelayedConstructor=fu;function RT(r){if(typeof r>"u")throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new fu(r)}o(RT,"delay");Xs.delay=RT});var du=y(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.isConstructorToken=Pi.isTransformDescriptor=Pi.isTokenDescriptor=Pi.isNormalToken=void 0;var DT=hu();function NT(r){return typeof r=="string"||typeof r=="symbol"}o(NT,"isNormalToken");Pi.isNormalToken=NT;function kT(r){return typeof r=="object"&&"token"in r&&"multiple"in r}o(kT,"isTokenDescriptor");Pi.isTokenDescriptor=kT;function jT(r){return typeof r=="object"&&"token"in r&&"transform"in r}o(jT,"isTransformDescriptor");Pi.isTransformDescriptor=jT;function LT(r){return typeof r=="function"||r instanceof DT.DelayedConstructor}o(LT,"isConstructorToken");Pi.isConstructorToken=LT});var Hh=y(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});pu.isTokenProvider=void 0;function MT(r){return!!r.useToken}o(MT,"isTokenProvider");pu.isTokenProvider=MT});var Kh=y(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.isValueProvider=void 0;function VT(r){return r.useValue!=null}o(VT,"isValueProvider");mu.isValueProvider=VT});var Qh=y(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});var $T=Wh();Object.defineProperty(ls,"isClassProvider",{enumerable:!0,get:o(function(){return $T.isClassProvider},"get")});var qT=zh();Object.defineProperty(ls,"isFactoryProvider",{enumerable:!0,get:o(function(){return qT.isFactoryProvider},"get")});var BT=du();Object.defineProperty(ls,"isNormalToken",{enumerable:!0,get:o(function(){return BT.isNormalToken},"get")});var UT=Hh();Object.defineProperty(ls,"isTokenProvider",{enumerable:!0,get:o(function(){return UT.isTokenProvider},"get")});var GT=Kh();Object.defineProperty(ls,"isValueProvider",{enumerable:!0,get:o(function(){return GT.isValueProvider},"get")})});var oy=y(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.isProvider=void 0;var WT=Wh(),zT=Kh(),HT=Hh(),KT=zh();function QT(r){return WT.isClassProvider(r)||zT.isValueProvider(r)||HT.isTokenProvider(r)||KT.isFactoryProvider(r)}o(QT,"isProvider");gu.isProvider=QT});var Jh=y(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});var Yh=class{static{o(this,"RegistryBase")}constructor(){this._registryMap=new Map}entries(){return this._registryMap.entries()}getAll(e){return this.ensure(e),this._registryMap.get(e)}get(e){this.ensure(e);let t=this._registryMap.get(e);return t[t.length-1]||null}set(e,t){this.ensure(e),this._registryMap.get(e).push(t)}setAll(e,t){this._registryMap.set(e,t)}has(e){return this.ensure(e),this._registryMap.get(e).length>0}clear(){this._registryMap.clear()}ensure(e){this._registryMap.has(e)||this._registryMap.set(e,[])}};Xh.default=Yh});var cy=y(ed=>{"use strict";Object.defineProperty(ed,"__esModule",{value:!0});var YT=Jh(),Zh=class extends YT.default{static{o(this,"Registry")}};ed.default=Zh});var uy=y(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});var td=class{static{o(this,"ResolutionContext")}constructor(){this.scopedResolutions=new Map}};rd.default=td});var id=y(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});yu.formatErrorCtor=void 0;function XT(r,e){return r===null?`at position #${e}`:`"${r.split(",")[e].trim()}" at position #${e}`}o(XT,"formatDependency");function JT(r,e,t="    "){return[r,...e.message.split(`
`).map(i=>t+i)].join(`
`)}o(JT,"composeErrorMessage");function ZT(r,e,t){let[,i=null]=r.toString().match(/constructor\(([\w, ]+)\)/)||[],n=XT(i,e);return JT(`Cannot inject the dependency ${n} of "${r.name}" constructor. Reason:`,t)}o(ZT,"formatErrorCtor");yu.formatErrorCtor=ZT});var ly=y(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.isDisposable=void 0;function eA(r){return!(typeof r.dispose!="function"||r.dispose.length>0)}o(eA,"isDisposable");vu.isDisposable=eA});var hy=y(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.PostResolutionInterceptors=fs.PreResolutionInterceptors=void 0;var fy=Jh(),_u=class extends fy.default{static{o(this,"PreResolutionInterceptors")}};fs.PreResolutionInterceptors=_u;var wu=class extends fy.default{static{o(this,"PostResolutionInterceptors")}};fs.PostResolutionInterceptors=wu;var nd=class{static{o(this,"Interceptors")}constructor(){this.preResolution=new _u,this.postResolution=new wu}};fs.default=nd});var Tn=y(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.instance=en.typeInfo=void 0;var tA=(cu(),nh(ou)),or=Qh(),rA=oy(),bu=du(),iA=cy(),Er=Uh(),Su=uy(),nA=id(),sA=hu(),aA=ly(),oA=hy();en.typeInfo=new Map;var sd=class r{static{o(this,"InternalDependencyContainer")}constructor(e){this.parent=e,this._registry=new iA.default,this.interceptors=new oA.default,this.disposed=!1,this.disposables=new Set}register(e,t,i={lifecycle:Er.default.Transient}){this.ensureNotDisposed();let n;if(rA.isProvider(t)?n=t:n={useClass:t},or.isTokenProvider(n)){let s=[e],a=n;for(;a!=null;){let c=a.useToken;if(s.includes(c))throw new Error(`Token registration cycle detected! ${[...s,c].join(" -> ")}`);s.push(c);let u=this._registry.get(c);u&&or.isTokenProvider(u.provider)?a=u.provider:a=null}}if((i.lifecycle===Er.default.Singleton||i.lifecycle==Er.default.ContainerScoped||i.lifecycle==Er.default.ResolutionScoped)&&(or.isValueProvider(n)||or.isFactoryProvider(n)))throw new Error(`Cannot use lifecycle "${Er.default[i.lifecycle]}" with ValueProviders or FactoryProviders`);return this._registry.set(e,{provider:n,options:i}),this}registerType(e,t){return this.ensureNotDisposed(),or.isNormalToken(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})}registerInstance(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})}registerSingleton(e,t){if(this.ensureNotDisposed(),or.isNormalToken(e)){if(or.isNormalToken(t))return this.register(e,{useToken:t},{lifecycle:Er.default.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:Er.default.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}let i=e;return t&&!or.isNormalToken(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:Er.default.Singleton})}resolve(e,t=new Su.default,i=!1){this.ensureNotDisposed();let n=this.getRegistration(e);if(!n&&or.isNormalToken(e)){if(i)return;throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"Single"),n){let s=this.resolveRegistration(n,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}if(bu.isConstructorToken(e)){let s=this.construct(e,t);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")}executePreResolutionInterceptor(e,t){if(this.interceptors.preResolution.has(e)){let i=[];for(let n of this.interceptors.preResolution.getAll(e))n.options.frequency!="Once"&&i.push(n),n.callback(e,t);this.interceptors.preResolution.setAll(e,i)}}executePostResolutionInterceptor(e,t,i){if(this.interceptors.postResolution.has(e)){let n=[];for(let s of this.interceptors.postResolution.getAll(e))s.options.frequency!="Once"&&n.push(s),s.callback(e,t,i);this.interceptors.postResolution.setAll(e,n)}}resolveRegistration(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===Er.default.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);let i=e.options.lifecycle===Er.default.Singleton,n=e.options.lifecycle===Er.default.ContainerScoped,s=i||n,a;return or.isValueProvider(e.provider)?a=e.provider.useValue:or.isTokenProvider(e.provider)?a=s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):or.isClassProvider(e.provider)?a=s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):or.isFactoryProvider(e.provider)?a=e.provider.useFactory(this):a=this.construct(e.provider,t),e.options.lifecycle===Er.default.ResolutionScoped&&t.scopedResolutions.set(e,a),a}resolveAll(e,t=new Su.default,i=!1){this.ensureNotDisposed();let n=this.getAllRegistrations(e);if(!n&&or.isNormalToken(e)){if(i)return[];throw new Error(`Attempted to resolve unregistered dependency token: "${e.toString()}"`)}if(this.executePreResolutionInterceptor(e,"All"),n){let a=n.map(c=>this.resolveRegistration(c,t));return this.executePostResolutionInterceptor(e,a,"All"),a}let s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s}isRegistered(e,t=!1){return this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)}reset(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()}clearInstances(){this.ensureNotDisposed();for(let[e,t]of this._registry.entries())this._registry.setAll(e,t.filter(i=>!or.isValueProvider(i.provider)).map(i=>(i.instance=void 0,i)))}createChildContainer(){this.ensureNotDisposed();let e=new r(this);for(let[t,i]of this._registry.entries())i.some(({options:n})=>n.lifecycle===Er.default.ContainerScoped)&&e._registry.setAll(t,i.map(n=>n.options.lifecycle===Er.default.ContainerScoped?{provider:n.provider,options:n.options}:n));return e}beforeResolution(e,t,i={frequency:"Always"}){this.interceptors.preResolution.set(e,{callback:t,options:i})}afterResolution(e,t,i={frequency:"Always"}){this.interceptors.postResolution.set(e,{callback:t,options:i})}dispose(){return tA.__awaiter(this,void 0,void 0,function*(){this.disposed=!0;let e=[];this.disposables.forEach(t=>{let i=t.dispose();i&&e.push(i)}),yield Promise.all(e)})}getRegistration(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null}getAllRegistrations(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null}construct(e,t){if(e instanceof sA.DelayedConstructor)return e.createProxy(n=>this.resolve(n,t));let i=(()=>{let n=en.typeInfo.get(e);if(!n||n.length===0){if(e.length===0)return new e;throw new Error(`TypeInfo not known for "${e.name}"`)}let s=n.map(this.resolveParams(t,e));return new e(...s)})();return aA.isDisposable(i)&&this.disposables.add(i),i}resolveParams(e,t){return(i,n)=>{try{return bu.isTokenDescriptor(i)?bu.isTransformDescriptor(i)?i.multiple?this.resolve(i.transform).transform(this.resolveAll(i.token,new Su.default,i.isOptional),...i.transformArgs):this.resolve(i.transform).transform(this.resolve(i.token,e,i.isOptional),...i.transformArgs):i.multiple?this.resolveAll(i.token,new Su.default,i.isOptional):this.resolve(i.token,e,i.isOptional):bu.isTransformDescriptor(i)?this.resolve(i.transform,e).transform(this.resolve(i.token,e),...i.transformArgs):this.resolve(i,e)}catch(s){throw new Error(nA.formatErrorCtor(t,n,s))}}}ensureNotDisposed(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")}};en.instance=new sd;en.default=en.instance});var dy=y(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});var cA=us(),tn=Tn(),ad=du(),uA=id();function lA(){return function(r){let e=cA.getParamInfo(r);return class extends r{constructor(...t){super(...t.concat(e.slice(t.length).map((i,n)=>{try{return ad.isTokenDescriptor(i)?ad.isTransformDescriptor(i)?i.multiple?tn.instance.resolve(i.transform).transform(tn.instance.resolveAll(i.token),...i.transformArgs):tn.instance.resolve(i.transform).transform(tn.instance.resolve(i.token),...i.transformArgs):i.multiple?tn.instance.resolveAll(i.token):tn.instance.resolve(i.token):ad.isTransformDescriptor(i)?tn.instance.resolve(i.transform).transform(tn.instance.resolve(i.token),...i.transformArgs):tn.instance.resolve(i)}catch(s){let a=n+t.length;throw new Error(uA.formatErrorCtor(r,a,s))}})))}}}}o(lA,"autoInjectable");od.default=lA});var py=y(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});var fA=us();function hA(r,e){let t={token:r,multiple:!1,isOptional:e&&e.isOptional};return fA.defineInjectionTokenMetadata(t)}o(hA,"inject");cd.default=hA});var Eu=y(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});var dA=us(),pA=Tn(),my=Tn();function mA(r){return function(e){pA.typeInfo.set(e,dA.getParamInfo(e)),r&&r.token&&(Array.isArray(r.token)?r.token.forEach(t=>{my.instance.register(t,e)}):my.instance.register(r.token,e))}}o(mA,"injectable");ud.default=mA});var gy=y(ld=>{"use strict";Object.defineProperty(ld,"__esModule",{value:!0});var gA=(cu(),nh(ou)),yA=Tn();function vA(r=[]){return function(e){return r.forEach(t=>{var{token:i,options:n}=t,s=gA.__rest(t,["token","options"]);return yA.instance.register(i,s,n)}),e}}o(vA,"registry");ld.default=vA});var yy=y(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});var _A=Eu(),wA=Tn();function bA(){return function(r){_A.default()(r),wA.instance.registerSingleton(r)}}o(bA,"singleton");fd.default=bA});var vy=y(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});var SA=us();function EA(r,e){let t={token:r,multiple:!0,isOptional:e&&e.isOptional};return SA.defineInjectionTokenMetadata(t)}o(EA,"injectAll");hd.default=EA});var _y=y(dd=>{"use strict";Object.defineProperty(dd,"__esModule",{value:!0});var TA=us();function AA(r,e,...t){let i={token:r,multiple:!0,transform:e,transformArgs:t};return TA.defineInjectionTokenMetadata(i)}o(AA,"injectAllWithTransform");dd.default=AA});var wy=y(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});var xA=us();function CA(r,e,...t){return xA.defineInjectionTokenMetadata(r,{transformToken:e,args:t})}o(CA,"injectWithTransform");pd.default=CA});var by=y(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});var OA=Eu(),PA=Tn();function FA(r,e){return function(t){OA.default()(t),PA.instance.register(e||t,t,{lifecycle:r})}}o(FA,"scoped");md.default=FA});var Sy=y(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});var IA=dy();Object.defineProperty(Wr,"autoInjectable",{enumerable:!0,get:o(function(){return IA.default},"get")});var RA=py();Object.defineProperty(Wr,"inject",{enumerable:!0,get:o(function(){return RA.default},"get")});var DA=Eu();Object.defineProperty(Wr,"injectable",{enumerable:!0,get:o(function(){return DA.default},"get")});var NA=gy();Object.defineProperty(Wr,"registry",{enumerable:!0,get:o(function(){return NA.default},"get")});var kA=yy();Object.defineProperty(Wr,"singleton",{enumerable:!0,get:o(function(){return kA.default},"get")});var jA=vy();Object.defineProperty(Wr,"injectAll",{enumerable:!0,get:o(function(){return jA.default},"get")});var LA=_y();Object.defineProperty(Wr,"injectAllWithTransform",{enumerable:!0,get:o(function(){return LA.default},"get")});var MA=wy();Object.defineProperty(Wr,"injectWithTransform",{enumerable:!0,get:o(function(){return MA.default},"get")});var VA=by();Object.defineProperty(Wr,"scoped",{enumerable:!0,get:o(function(){return VA.default},"get")})});var Ey=y(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});function $A(r){let e;return t=>(e==null&&(e=r(t)),e)}o($A,"instanceCachingFactory");gd.default=$A});var Ty=y(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});function qA(r){let e=new WeakMap;return t=>{let i=e.get(t);return i==null&&(i=r(t),e.set(t,i)),i}}o(qA,"instancePerContainerCachingFactory");yd.default=qA});var Ay=y(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});function BA(r,e,t,i=!0){let n,s;return a=>{let c=r(a);return(!i||s!==c)&&((s=c)?n=a.resolve(e):n=a.resolve(t)),n}}o(BA,"predicateAwareClassFactory");vd.default=BA});var xy=y(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});var UA=Ey();Object.defineProperty(yo,"instanceCachingFactory",{enumerable:!0,get:o(function(){return UA.default},"get")});var GA=Ty();Object.defineProperty(yo,"instancePerContainerCachingFactory",{enumerable:!0,get:o(function(){return GA.default},"get")});var WA=Ay();Object.defineProperty(yo,"predicateAwareClassFactory",{enumerable:!0,get:o(function(){return WA.default},"get")})});var Xe=y(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});var _d=(cu(),nh(ou));if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var zA=ay();Object.defineProperty(An,"Lifecycle",{enumerable:!0,get:o(function(){return zA.Lifecycle},"get")});_d.__exportStar(Sy(),An);_d.__exportStar(xy(),An);_d.__exportStar(Qh(),An);var HA=hu();Object.defineProperty(An,"delay",{enumerable:!0,get:o(function(){return HA.delay},"get")});var KA=Tn();Object.defineProperty(An,"container",{enumerable:!0,get:o(function(){return KA.instance},"get")})});var Cy=y(wd=>{"use strict";Object.defineProperty(wd,"__esModule",{value:!0});wd.default="ffffffff-ffff-ffff-ffff-ffffffffffff"});var Oy=y(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});bd.default="00000000-0000-0000-0000-000000000000"});var Py=y(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i});var vo=y(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});var QA=Py();function YA(r){return typeof r=="string"&&QA.default.test(r)}o(YA,"validate");Ed.default=YA});var _o=y(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});var XA=vo();function JA(r){if(!(0,XA.default)(r))throw TypeError("Invalid UUID");let e;return Uint8Array.of((e=parseInt(r.slice(0,8),16))>>>24,e>>>16&255,e>>>8&255,e&255,(e=parseInt(r.slice(9,13),16))>>>8,e&255,(e=parseInt(r.slice(14,18),16))>>>8,e&255,(e=parseInt(r.slice(19,23),16))>>>8,e&255,(e=parseInt(r.slice(24,36),16))/1099511627776&255,e/4294967296&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255)}o(JA,"parse");Td.default=JA});var rn=y(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.unsafeStringify=void 0;var ZA=vo(),kt=[];for(let r=0;r<256;++r)kt.push((r+256).toString(16).slice(1));function Fy(r,e=0){return(kt[r[e+0]]+kt[r[e+1]]+kt[r[e+2]]+kt[r[e+3]]+"-"+kt[r[e+4]]+kt[r[e+5]]+"-"+kt[r[e+6]]+kt[r[e+7]]+"-"+kt[r[e+8]]+kt[r[e+9]]+"-"+kt[r[e+10]]+kt[r[e+11]]+kt[r[e+12]]+kt[r[e+13]]+kt[r[e+14]]+kt[r[e+15]]).toLowerCase()}o(Fy,"unsafeStringify");wo.unsafeStringify=Fy;function ex(r,e=0){let t=Fy(r,e);if(!(0,ZA.default)(t))throw TypeError("Stringified UUID is invalid");return t}o(ex,"stringify");wo.default=ex});var xu=y(Ad=>{"use strict";Object.defineProperty(Ad,"__esModule",{value:!0});var tx=require("crypto"),Au=new Uint8Array(256),Tu=Au.length;function rx(){return Tu>Au.length-16&&((0,tx.randomFillSync)(Au),Tu=0),Au.slice(Tu,Tu+=16)}o(rx,"rng");Ad.default=rx});var xd=y(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.updateV1State=void 0;var Iy=xu(),ix=rn(),bo={};function nx(r,e,t){let i,n=r?._v6??!1;if(r){let s=Object.keys(r);s.length===1&&s[0]==="_v6"&&(r=void 0)}if(r)i=Ry(r.random??r.rng?.()??(0,Iy.default)(),r.msecs,r.nsecs,r.clockseq,r.node,e,t);else{let s=Date.now(),a=(0,Iy.default)();Dy(bo,s,a),i=Ry(a,bo.msecs,bo.nsecs,n?void 0:bo.clockseq,n?void 0:bo.node,e,t)}return e??(0,ix.unsafeStringify)(i)}o(nx,"v1");function Dy(r,e,t){return r.msecs??=-1/0,r.nsecs??=0,e===r.msecs?(r.nsecs++,r.nsecs>=1e4&&(r.node=void 0,r.nsecs=0)):e>r.msecs?r.nsecs=0:e<r.msecs&&(r.node=void 0),r.node||(r.node=t.slice(10,16),r.node[0]|=1,r.clockseq=(t[8]<<8|t[9])&16383),r.msecs=e,r}o(Dy,"updateV1State");So.updateV1State=Dy;function Ry(r,e,t,i,n,s,a=0){if(r.length<16)throw new Error("Random bytes length must be >= 16");if(!s)s=new Uint8Array(16),a=0;else if(a<0||a+16>s.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);e??=Date.now(),t??=0,i??=(r[8]<<8|r[9])&16383,n??=r.slice(10,16),e+=122192928e5;let c=((e&268435455)*1e4+t)%4294967296;s[a++]=c>>>24&255,s[a++]=c>>>16&255,s[a++]=c>>>8&255,s[a++]=c&255;let u=e/4294967296*1e4&268435455;s[a++]=u>>>8&255,s[a++]=u&255,s[a++]=u>>>24&15|16,s[a++]=u>>>16&255,s[a++]=i>>>8|128,s[a++]=i&255;for(let l=0;l<6;++l)s[a++]=n[l];return s}o(Ry,"v1Bytes");So.default=nx});var Od=y(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});var sx=_o(),ax=rn();function ox(r){let e=typeof r=="string"?(0,sx.default)(r):r,t=cx(e);return typeof r=="string"?(0,ax.unsafeStringify)(t):t}o(ox,"v1ToV6");Cd.default=ox;function cx(r){return Uint8Array.of((r[6]&15)<<4|r[7]>>4&15,(r[7]&15)<<4|(r[4]&240)>>4,(r[4]&15)<<4|(r[5]&240)>>4,(r[5]&15)<<4|(r[0]&240)>>4,(r[0]&15)<<4|(r[1]&240)>>4,(r[1]&15)<<4|(r[2]&240)>>4,96|r[2]&15,r[3],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}o(cx,"_v1ToV6")});var Ny=y(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});var ux=require("crypto");function lx(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),(0,ux.createHash)("md5").update(r).digest()}o(lx,"md5");Pd.default=lx});var Eo=y(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.URL=nn.DNS=nn.stringToBytes=void 0;var ky=_o(),fx=rn();function jy(r){r=unescape(encodeURIComponent(r));let e=new Uint8Array(r.length);for(let t=0;t<r.length;++t)e[t]=r.charCodeAt(t);return e}o(jy,"stringToBytes");nn.stringToBytes=jy;nn.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";nn.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function hx(r,e,t,i,n,s){let a=typeof t=="string"?jy(t):t,c=typeof i=="string"?(0,ky.default)(i):i;if(typeof i=="string"&&(i=(0,ky.default)(i)),i?.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+a.length);if(u.set(c),u.set(a,c.length),u=e(u),u[6]=u[6]&15|r,u[8]=u[8]&63|128,n){s=s||0;for(let l=0;l<16;++l)n[s+l]=u[l];return n}return(0,fx.unsafeStringify)(u)}o(hx,"v35");nn.default=hx});var My=y(hs=>{"use strict";Object.defineProperty(hs,"__esModule",{value:!0});hs.URL=hs.DNS=void 0;var dx=Ny(),Fd=Eo(),Ly=Eo();Object.defineProperty(hs,"DNS",{enumerable:!0,get:o(function(){return Ly.DNS},"get")});Object.defineProperty(hs,"URL",{enumerable:!0,get:o(function(){return Ly.URL},"get")});function Id(r,e,t,i){return(0,Fd.default)(48,dx.default,r,e,t,i)}o(Id,"v3");Id.DNS=Fd.DNS;Id.URL=Fd.URL;hs.default=Id});var Vy=y(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});var px=require("crypto");Rd.default={randomUUID:px.randomUUID}});var qy=y(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});var $y=Vy(),mx=xu(),gx=rn();function yx(r,e,t){if($y.default.randomUUID&&!e&&!r)return $y.default.randomUUID();r=r||{};let i=r.random??r.rng?.()??(0,mx.default)();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let n=0;n<16;++n)e[t+n]=i[n];return e}return(0,gx.unsafeStringify)(i)}o(yx,"v4");Dd.default=yx});var By=y(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});var vx=require("crypto");function _x(r){return Array.isArray(r)?r=Buffer.from(r):typeof r=="string"&&(r=Buffer.from(r,"utf8")),(0,vx.createHash)("sha1").update(r).digest()}o(_x,"sha1");Nd.default=_x});var Gy=y(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.URL=ds.DNS=void 0;var wx=By(),kd=Eo(),Uy=Eo();Object.defineProperty(ds,"DNS",{enumerable:!0,get:o(function(){return Uy.DNS},"get")});Object.defineProperty(ds,"URL",{enumerable:!0,get:o(function(){return Uy.URL},"get")});function jd(r,e,t,i){return(0,kd.default)(80,wx.default,r,e,t,i)}o(jd,"v5");jd.DNS=kd.DNS;jd.URL=kd.URL;ds.default=jd});var Wy=y(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});var bx=rn(),Sx=xd(),Ex=Od();function Tx(r,e,t){r??={},t??=0;let i=(0,Sx.default)({...r,_v6:!0},new Uint8Array(16));if(i=(0,Ex.default)(i),e){for(let n=0;n<16;n++)e[t+n]=i[n];return e}return(0,bx.unsafeStringify)(i)}o(Tx,"v6");Ld.default=Tx});var zy=y(Md=>{"use strict";Object.defineProperty(Md,"__esModule",{value:!0});var Ax=_o(),xx=rn();function Cx(r){let e=typeof r=="string"?(0,Ax.default)(r):r,t=Ox(e);return typeof r=="string"?(0,xx.unsafeStringify)(t):t}o(Cx,"v6ToV1");Md.default=Cx;function Ox(r){return Uint8Array.of((r[3]&15)<<4|r[4]>>4&15,(r[4]&15)<<4|(r[5]&240)>>4,(r[5]&15)<<4|r[6]&15,r[7],(r[1]&15)<<4|(r[2]&240)>>4,(r[2]&15)<<4|(r[3]&240)>>4,16|(r[0]&240)>>4,(r[0]&15)<<4|(r[1]&240)>>4,r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}o(Ox,"_v6ToV1")});var Yy=y(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.updateV7State=void 0;var Hy=xu(),Px=rn(),Vd={};function Fx(r,e,t){let i;if(r)i=Ky(r.random??r.rng?.()??(0,Hy.default)(),r.msecs,r.seq,e,t);else{let n=Date.now(),s=(0,Hy.default)();Qy(Vd,n,s),i=Ky(s,Vd.msecs,Vd.seq,e,t)}return e??(0,Px.unsafeStringify)(i)}o(Fx,"v7");function Qy(r,e,t){return r.msecs??=-1/0,r.seq??=0,e>r.msecs?(r.seq=t[6]<<23|t[7]<<16|t[8]<<8|t[9],r.msecs=e):(r.seq=r.seq+1|0,r.seq===0&&r.msecs++),r}o(Qy,"updateV7State");To.updateV7State=Qy;function Ky(r,e,t,i,n=0){if(r.length<16)throw new Error("Random bytes length must be >= 16");if(!i)i=new Uint8Array(16),n=0;else if(n<0||n+16>i.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);return e??=Date.now(),t??=r[6]*127<<24|r[7]<<16|r[8]<<8|r[9],i[n++]=e/1099511627776&255,i[n++]=e/4294967296&255,i[n++]=e/16777216&255,i[n++]=e/65536&255,i[n++]=e/256&255,i[n++]=e&255,i[n++]=112|t>>>28&15,i[n++]=t>>>20&255,i[n++]=128|t>>>14&63,i[n++]=t>>>6&255,i[n++]=t<<2&255|r[10]&3,i[n++]=r[11],i[n++]=r[12],i[n++]=r[13],i[n++]=r[14],i[n++]=r[15],i}o(Ky,"v7Bytes");To.default=Fx});var Xy=y($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});var Ix=vo();function Rx(r){if(!(0,Ix.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}o(Rx,"version");$d.default=Rx});var Cr=y(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.version=We.validate=We.v7=We.v6ToV1=We.v6=We.v5=We.v4=We.v3=We.v1ToV6=We.v1=We.stringify=We.parse=We.NIL=We.MAX=void 0;var Dx=Cy();Object.defineProperty(We,"MAX",{enumerable:!0,get:o(function(){return Dx.default},"get")});var Nx=Oy();Object.defineProperty(We,"NIL",{enumerable:!0,get:o(function(){return Nx.default},"get")});var kx=_o();Object.defineProperty(We,"parse",{enumerable:!0,get:o(function(){return kx.default},"get")});var jx=rn();Object.defineProperty(We,"stringify",{enumerable:!0,get:o(function(){return jx.default},"get")});var Lx=xd();Object.defineProperty(We,"v1",{enumerable:!0,get:o(function(){return Lx.default},"get")});var Mx=Od();Object.defineProperty(We,"v1ToV6",{enumerable:!0,get:o(function(){return Mx.default},"get")});var Vx=My();Object.defineProperty(We,"v3",{enumerable:!0,get:o(function(){return Vx.default},"get")});var $x=qy();Object.defineProperty(We,"v4",{enumerable:!0,get:o(function(){return $x.default},"get")});var qx=Gy();Object.defineProperty(We,"v5",{enumerable:!0,get:o(function(){return qx.default},"get")});var Bx=Wy();Object.defineProperty(We,"v6",{enumerable:!0,get:o(function(){return Bx.default},"get")});var Ux=zy();Object.defineProperty(We,"v6ToV1",{enumerable:!0,get:o(function(){return Ux.default},"get")});var Gx=Yy();Object.defineProperty(We,"v7",{enumerable:!0,get:o(function(){return Gx.default},"get")});var Wx=vo();Object.defineProperty(We,"validate",{enumerable:!0,get:o(function(){return Wx.default},"get")});var zx=Xy();Object.defineProperty(We,"version",{enumerable:!0,get:o(function(){return zx.default},"get")})});var Lr=y(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.MetadataHelpers=void 0;var qd=class{static{o(this,"MetadataHelpers")}static findAllReferencingProperties(e,t){let i=[];for(let[n,s]of Object.entries(e))this.containsReference(s,t)&&i.push(n);return i}static findReferencingProperty(e,t){for(let[i,n]of Object.entries(e))if(this.containsReference(n,t))return i}static containsReference(e,t){if(!e)return!1;let i=t.replace(/\.md$/,"");if(typeof e=="string"){let n=/\[\[([^\[\]]+)\]\]/g,s;for(;(s=n.exec(e))!==null;){let c=s[1].split("|")[0].trim();if(c===i||c.endsWith(`/${i}`))return!0}return!1}return Array.isArray(e)?e.some(n=>this.containsReference(n,t)):!1}static isAssetArchived(e){let t=e?.exo__Asset_isArchived;if(t!=null){if(t===!0||t===1)return!0;if(typeof t=="string"){let n=t.toLowerCase().trim();if(n==="true"||n==="yes"||n==="1")return!0}if(typeof t=="boolean")return t}let i=e?.archived;if(i==null)return!1;if(typeof i=="boolean")return i;if(typeof i=="number")return i!==0;if(typeof i=="string"){let n=i.toLowerCase().trim();return n==="true"||n==="yes"||n==="1"}return!1}static getPropertyValue(e,t){return t==="Name"||t==="title"?e.title:t==="created"?e.created:t==="modified"?e.modified:t==="path"?e.path:e.metadata?.[t]}static ensureQuoted(e){return!e||e==='""'?'""':e.startsWith('"')&&e.endsWith('"')?e:`"${e}"`}static buildFileContent(e,t){let i=Object.entries(e).map(([s,a])=>{if(Array.isArray(a)){let c=a.map(u=>`  - ${u}`).join(`
`);return`${s}:
${c}`}return`${s}: ${a}`}).join(`
`),n=t?`
${t}
`:`
`;return`---
${i}
---
${n}`}};Cu.MetadataHelpers=qd});var cr=y(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.DateFormatter=void 0;var Bd=class r{static{o(this,"DateFormatter")}static toISOTimestamp(e){return e.toISOString().replace(/\.\d{3}Z$/,"Z")}static toLocalTimestamp(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0"),c=String(e.getSeconds()).padStart(2,"0");return`${t}-${i}-${n}T${s}:${a}:${c}`}static toDateWikilink(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`"[[${t}-${i}-${n}]]"`}static getTodayWikilink(){return r.toDateWikilink(new Date)}static toDateString(e){let t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${n}`}static parseWikilink(e){let i=e.replace(/^["']|["']$/g,"").match(/\[\[(\d{4}-\d{2}-\d{2})\]\]/);return i?i[1]:null}static addDays(e,t){let i=new Date(e);return i.setDate(i.getDate()+t),i}static isSameDay(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}static getTodayStartTimestamp(){let e=new Date;return e.setHours(0,0,0,0),r.toLocalTimestamp(e)}static toTimestampAtStartOfDay(e){let t=e.split("-").map(Number);if(t.length!==3||t.some(isNaN))throw new Error(`Invalid date format: ${e}. Expected YYYY-MM-DD`);let[i,n,s]=t,a=new Date(i,n-1,s,0,0,0,0);if(isNaN(a.getTime()))throw new Error(`Invalid date values: ${e}`);return r.toLocalTimestamp(a)}static normalizeTimestamp(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e;let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`Invalid timestamp format: ${e}`);return r.toISOTimestamp(t)}static isISOTimestamp(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e)}};Ou.DateFormatter=Bd});var Ao=y(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.MetadataExtractor=void 0;var Hx=Lr(),Ud=class{static{o(this,"MetadataExtractor")}constructor(e){this.vault=e}extractMetadata(e){return e?this.vault.getFrontmatter(e)||{}:{}}extractInstanceClass(e){return e.exo__Instance_class||null}extractStatus(e){return e.ems__Effort_status||null}extractIsArchived(e){return Hx.MetadataHelpers.isAssetArchived(e)}static extractIsDefinedBy(e){let t=e.exo__Asset_isDefinedBy||'""';return Array.isArray(t)&&(t=t[0]||'""'),t}extractExpectedFolder(e){let t=e.exo__Asset_isDefinedBy;if(!t)return null;let i=Array.isArray(t)?t[0]:t;if(!i||typeof i!="string")return null;let n=i.replace(/["'[\]]/g,"").trim();if(!n)return null;let s=n.split("/");return s.pop(),s.join("/")}extractCommandVisibilityContext(e){let t=this.extractMetadata(e),i=this.extractInstanceClass(t),n=this.extractStatus(t),s=this.extractIsArchived(t),a=e.parent?.path||"",c=this.extractExpectedFolder(t);return{instanceClass:i,currentStatus:n,metadata:t,isArchived:s,currentFolder:a,expectedFolder:c}}extractCache(e){return e?this.vault.getFrontmatter(e):null}};Pu.MetadataExtractor=Ud});var Fu=y(ps=>{"use strict";var Kx=ps&&ps.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(ps,"__esModule",{value:!0});ps.TaskFrontmatterGenerator=void 0;var Qx=Xe(),Jy=Cr(),Gd=cr(),Yx=ss(),Zy=Ao(),e2=Lr(),dt=Wt(),Xx=wn(),Jx={[dt.AssetClass.AREA]:"ems__Effort_area",[dt.AssetClass.PROJECT]:"ems__Effort_parent",[dt.AssetClass.TASK_PROTOTYPE]:"exo__Asset_prototype",[dt.AssetClass.MEETING_PROTOTYPE]:"exo__Asset_prototype",[dt.AssetClass.EVENT_PROTOTYPE]:"exo__Asset_prototype",[dt.AssetClass.PROJECT_PROTOTYPE]:"exo__Asset_prototype"},Zx={[dt.AssetClass.AREA]:dt.AssetClass.TASK,[dt.AssetClass.PROJECT]:dt.AssetClass.TASK,[dt.AssetClass.TASK_PROTOTYPE]:dt.AssetClass.TASK,[dt.AssetClass.MEETING_PROTOTYPE]:dt.AssetClass.MEETING,[dt.AssetClass.EVENT_PROTOTYPE]:dt.AssetClass.EVENT,[dt.AssetClass.PROJECT_PROTOTYPE]:dt.AssetClass.PROJECT},Wd=class{static{o(this,"TaskFrontmatterGenerator")}generateTaskFrontmatter(e,t,i,n,s,a,c){let u=new Date,l=Gd.DateFormatter.toLocalTimestamp(u),f=Zy.MetadataExtractor.extractIsDefinedBy(e),h=Yx.WikiLinkHelpers.normalize(i),d=Jx[h],g=Zx[h]||dt.AssetClass.TASK,w={};w.exo__Asset_isDefinedBy=e2.MetadataHelpers.ensureQuoted(f),w.exo__Asset_uid=s||(0,Jy.v4)(),w.exo__Asset_createdAt=l,w.exo__Instance_class=[`"[[${g}]]"`],w.ems__Effort_status='"[[ems__EffortStatusDraft]]"',d?w[d]=`"[[${t}]]"`:(0,Xx.isPrototypeClass)(i,e)&&(w.exo__Asset_prototype=`"[[${t}]]"`);let b=n;if(g===dt.AssetClass.MEETING&&(!n||n.trim()==="")){let x=e.exo__Asset_label||t,O=Gd.DateFormatter.toDateString(u);b=`${x} ${O}`}if(b&&b.trim()!==""){let x=b.trim();w.exo__Asset_label=x,w.aliases=[x]}return a&&(w.ems__Task_size=a),c&&(w.ems__Effort_plannedStartTimestamp=c),w}generateRelatedTaskFrontmatter(e,t,i,n,s){let a=new Date,c=Gd.DateFormatter.toLocalTimestamp(a),u=Zy.MetadataExtractor.extractIsDefinedBy(e),l={};if(l.exo__Asset_isDefinedBy=e2.MetadataHelpers.ensureQuoted(u),l.exo__Asset_uid=n||(0,Jy.v4)(),l.exo__Asset_createdAt=c,l.exo__Instance_class=[`"[[${dt.AssetClass.TASK}]]"`],l.ems__Effort_status='"[[ems__EffortStatusDraft]]"',l.exo__Asset_relates=[`"[[${t}]]"`],i&&i.trim()!==""){let f=i.trim();l.exo__Asset_label=f,l.aliases=[f]}return s&&(l.ems__Task_size=s),l}};ps.TaskFrontmatterGenerator=Wd;ps.TaskFrontmatterGenerator=Wd=Kx([(0,Qx.injectable)()],Wd)});var Iu=y(ms=>{"use strict";var eC=ms&&ms.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(ms,"__esModule",{value:!0});ms.AlgorithmExtractor=void 0;var tC=Xe(),zd=class{static{o(this,"AlgorithmExtractor")}extractH2Section(e,t){let i=e.split(`
`),n=`## ${t}`,s=!1,a=[];for(let u of i){if(u.trim()===n){s=!0;continue}if(s){if(u.startsWith("## ")||u.startsWith("# "))break;a.push(u)}}return a.length===0?null:a.join(`
`).trim()||null}};ms.AlgorithmExtractor=zd;ms.AlgorithmExtractor=zd=eC([(0,tC.injectable)()],zd)});var r2=y(t2=>{"use strict";Object.defineProperty(t2,"__esModule",{value:!0})});var at=y(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:!0});Ru.DI_TOKENS=void 0;Ru.DI_TOKENS={IFileSystemAdapter:Symbol.for("IFileSystemAdapter"),IVaultAdapter:Symbol.for("IVaultAdapter"),IVaultContext:Symbol.for("IVaultContext"),IMultiVaultManager:Symbol.for("IMultiVaultManager"),ILogger:Symbol.for("ILogger"),IEventBus:Symbol.for("IEventBus"),IConfiguration:Symbol.for("IConfiguration"),INotificationService:Symbol.for("INotificationService"),TaskCreationService:Symbol.for("TaskCreationService"),ProjectCreationService:Symbol.for("ProjectCreationService"),AreaCreationService:Symbol.for("AreaCreationService"),ClassCreationService:Symbol.for("ClassCreationService"),ConceptCreationService:Symbol.for("ConceptCreationService"),FleetingNoteCreationService:Symbol.for("FleetingNoteCreationService"),SupervisionCreationService:Symbol.for("SupervisionCreationService"),GenericAssetCreationService:Symbol.for("GenericAssetCreationService"),TaskFrontmatterGenerator:Symbol.for("TaskFrontmatterGenerator"),DynamicFrontmatterGenerator:Symbol.for("DynamicFrontmatterGenerator"),AlgorithmExtractor:Symbol.for("AlgorithmExtractor"),TaskStatusService:Symbol.for("TaskStatusService"),EffortStatusWorkflow:Symbol.for("EffortStatusWorkflow"),StatusTimestampService:Symbol.for("StatusTimestampService"),PropertyCleanupService:Symbol.for("PropertyCleanupService"),FolderRepairService:Symbol.for("FolderRepairService"),LabelToAliasService:Symbol.for("LabelToAliasService"),RenameToUidService:Symbol.for("RenameToUidService"),PlanningService:Symbol.for("PlanningService"),EffortVotingService:Symbol.for("EffortVotingService"),SessionEventService:Symbol.for("SessionEventService"),AssetConversionService:Symbol.for("AssetConversionService"),NoteToRDFConverter:Symbol.for("NoteToRDFConverter"),AreaHierarchyBuilder:Symbol.for("AreaHierarchyBuilder"),URIConstructionService:Symbol.for("URIConstructionService")}});var Kd=y(jt=>{"use strict";var rC=jt&&jt.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),iC=jt&&jt.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),nC=jt&&jt.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},sC=jt&&jt.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var i=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[i.length]=n);return i},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i=r(e),n=0;n<i.length;n++)i[n]!=="default"&&rC(t,e,i[n]);return iC(t,e),t}})(),aC=jt&&jt.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},oC=jt&&jt.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(jt,"__esModule",{value:!0});jt.TaskCreationService=void 0;var i2=Xe(),n2=Cr(),cC=ss(),s2=Lr(),uC=Wt(),lC=Fu(),fC=Iu(),gj=sC(r2()),hC=at(),Hd=class{static{o(this,"TaskCreationService")}constructor(e,t,i){this.vault=e,this.frontmatterGenerator=t,this.algorithmExtractor=i}async createTask(e,t,i,n,s,a){let c=(0,n2.v4)(),u=`${c}.md`,l=this.frontmatterGenerator.generateTaskFrontmatter(t,e.basename,i,n,c,s,a),f="";if(cC.WikiLinkHelpers.normalize(i)===uC.AssetClass.TASK_PROTOTYPE){let x=await this.vault.read(e),O=this.algorithmExtractor.extractH2Section(x,"Algorithm");O&&(f=`## Algorithm

${O}`)}let d=s2.MetadataHelpers.buildFileContent(l,f),g=e.parent?.path||"",w=g?`${g}/${u}`:u;return await this.vault.create(w,d)}async createRelatedTask(e,t,i,n){let s=(0,n2.v4)(),a=`${s}.md`,c=this.frontmatterGenerator.generateRelatedTaskFrontmatter(t,e.basename,i,s,n),u=s2.MetadataHelpers.buildFileContent(c),l=e.parent?.path||"",f=l?`${l}/${a}`:a,h=await this.vault.create(f,u);return await this.addRelationToSourceFile(e,s),h}generateTaskFrontmatter(e,t,i,n,s,a,c){return this.frontmatterGenerator.generateTaskFrontmatter(e,t,i,n,s,a,c)}generateRelatedTaskFrontmatter(e,t,i,n,s){return this.frontmatterGenerator.generateRelatedTaskFrontmatter(e,t,i,n,s)}extractH2Section(e,t){return this.algorithmExtractor.extractH2Section(e,t)}async addRelationToSourceFile(e,t){let i=await this.vault.read(e),n=this.addRelationToFrontmatter(i,t);await this.vault.modify(e,n)}addRelationToFrontmatter(e,t){let i=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(i),s=e.includes(`\r
`)?`\r
`:`
`;if(!n)return`---${s}exo__Asset_relates:${s}  - "[[${t}]]"${s}---${s}${e}`;let c=n[1];if(c.includes("exo__Asset_relates:")){let u=c.match(/exo__Asset_relates:\r?\n((?: {2}- .*\r?\n)*)/);if(u){let l=u[1],f=`  - "[[${t}]]"${s}`;c=c.replace(/exo__Asset_relates:\r?\n((?: {2}- .*\r?\n)*)/,`exo__Asset_relates:${s}${l}${f}`)}}else c+=`${s}exo__Asset_relates:${s}  - "[[${t}]]"`;return e.replace(i,`---${s}${c}${s}---`)}};jt.TaskCreationService=Hd;jt.TaskCreationService=Hd=nC([(0,i2.injectable)(),oC(0,(0,i2.inject)(hC.DI_TOKENS.IVaultAdapter)),aC("design:paramtypes",[Object,lC.TaskFrontmatterGenerator,fC.AlgorithmExtractor])],Hd)});var Yd=y(zr=>{"use strict";var dC=zr&&zr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},pC=zr&&zr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},mC=zr&&zr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(zr,"__esModule",{value:!0});zr.ProjectCreationService=void 0;var a2=Xe(),o2=Cr(),gC=ss(),Du=Wt(),yC=cr(),vC=Ao(),c2=Lr(),_C=at(),wC={[Du.AssetClass.AREA]:"ems__Effort_area",[Du.AssetClass.INITIATIVE]:"ems__Effort_parent",[Du.AssetClass.PROJECT]:"ems__Effort_parent"},Qd=class{static{o(this,"ProjectCreationService")}constructor(e){this.vault=e}async createProject(e,t,i,n){let s=(0,o2.v4)(),a=`${s}.md`,c=this.generateProjectFrontmatter(t,e.basename,i,n,s),u=c2.MetadataHelpers.buildFileContent(c),l=e.parent?.path||"",f=l?`${l}/${a}`:a;return await this.vault.create(f,u)}generateProjectFrontmatter(e,t,i,n,s){let a=new Date,c=yC.DateFormatter.toLocalTimestamp(a),u=vC.MetadataExtractor.extractIsDefinedBy(e),l=gC.WikiLinkHelpers.normalize(i),f=wC[l]||"ems__Effort_area",h={};if(h.exo__Asset_isDefinedBy=c2.MetadataHelpers.ensureQuoted(u),h.exo__Asset_uid=s||(0,o2.v4)(),h.exo__Asset_createdAt=c,h.exo__Instance_class=[`"[[${Du.AssetClass.PROJECT}]]"`],h.ems__Effort_status='"[[ems__EffortStatusDraft]]"',h[f]=`"[[${t}]]"`,n&&n.trim()!==""){let d=n.trim();h.exo__Asset_label=d,h.aliases=[d]}return h}};zr.ProjectCreationService=Qd;zr.ProjectCreationService=Qd=dC([(0,a2.injectable)(),mC(0,(0,a2.inject)(_C.DI_TOKENS.IVaultAdapter)),pC("design:paramtypes",[Object])],Qd)});var Js=y(ku=>{"use strict";Object.defineProperty(ku,"__esModule",{value:!0});ku.FrontmatterService=void 0;var Nu=class r{static{o(this,"FrontmatterService")}parse(e){let t=e.match(r.FRONTMATTER_REGEX);return t?{exists:!0,content:t[1],originalContent:e}:{exists:!1,content:"",originalContent:e}}updateProperty(e,t,i){let n=this.parse(e);if(!n.exists)return this.createFrontmatter(e,{[t]:i});let s=n.content;if(this.hasProperty(s,t)){let a=new RegExp(`${this.escapeRegex(t)}:.*$`,"m");s=s.replace(a,`${t}: ${i}`)}else{let a=s.length>0?`
`:"";s+=`${a}${t}: ${i}`}return e.replace(r.FRONTMATTER_REGEX,`---
${s}
---`)}addProperty(e,t,i){return this.updateProperty(e,t,i)}removeProperty(e,t){let i=this.parse(e);if(!i.exists||!this.hasProperty(i.content,t))return e;let n=new RegExp(`
?${this.escapeRegex(t)}:.*(?:
 {2}- .*)*`,"gm"),s=i.content.replace(n,"");return e.replace(r.FRONTMATTER_REGEX,`---
${s}
---`)}hasProperty(e,t){return e.includes(`${t}:`)}createFrontmatter(e,t){let n=`---
${Object.entries(t).map(([a,c])=>`${a}: ${c}`).join(`
`)}
---`,s=e.startsWith(`
`)?"":`
`;return`${n}${s}${e}`}getPropertyValue(e,t){let i=new RegExp(`${this.escapeRegex(t)}:\\s*(.*)$`,"m"),n=e.match(i);return n?n[1].trim():null}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}};ku.FrontmatterService=Nu;Nu.FRONTMATTER_REGEX=/^---\n([\s\S]*?)\n---/});var ju=y(gs=>{"use strict";var bC=gs&&gs.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(gs,"__esModule",{value:!0});gs.EffortStatusWorkflow=void 0;var SC=Xe(),Or=Wt(),Xd=class{static{o(this,"EffortStatusWorkflow")}getPreviousStatus(e,t){let i=this.normalizeStatus(e);if(i===Or.EffortStatus.DRAFT)return null;if(i===Or.EffortStatus.BACKLOG)return this.wrapStatus(Or.EffortStatus.DRAFT);if(i===Or.EffortStatus.ANALYSIS)return this.wrapStatus(Or.EffortStatus.BACKLOG);if(i===Or.EffortStatus.TODO)return this.wrapStatus(Or.EffortStatus.ANALYSIS);if(i===Or.EffortStatus.DOING)return this.hasInstanceClass(t,Or.AssetClass.PROJECT)?this.wrapStatus(Or.EffortStatus.TODO):this.wrapStatus(Or.EffortStatus.BACKLOG);if(i===Or.EffortStatus.DONE)return this.wrapStatus(Or.EffortStatus.DOING)}normalizeStatus(e){return e.replace(/["'[\]]/g,"").trim()}wrapStatus(e){return`"[[${e}]]"`}hasInstanceClass(e,t){return e?(Array.isArray(e)?e:[e]).some(n=>n.replace(/["'[\]]/g,"").trim()===t):!1}};gs.EffortStatusWorkflow=Xd;gs.EffortStatusWorkflow=Xd=bC([(0,SC.injectable)()],Xd)});var Lu=y(Hr=>{"use strict";var EC=Hr&&Hr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},TC=Hr&&Hr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},AC=Hr&&Hr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.StatusTimestampService=void 0;var u2=Xe(),xC=Js(),xo=cr(),CC=at(),Jd=class{static{o(this,"StatusTimestampService")}constructor(e){this.vault=e,this.frontmatterService=new xC.FrontmatterService}async addStartTimestamp(e){let t=await this.vault.read(e),i=xo.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_startTimestamp",i);await this.vault.modify(e,n)}async addEndTimestamp(e,t){let i=await this.vault.read(e),n=t||new Date,s=xo.DateFormatter.toLocalTimestamp(n),a=this.frontmatterService.updateProperty(i,"ems__Effort_endTimestamp",s);await this.vault.modify(e,a)}async addResolutionTimestamp(e){let t=await this.vault.read(e),i=xo.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_resolutionTimestamp",i);await this.vault.modify(e,n)}async addEndAndResolutionTimestamps(e,t){let i=await this.vault.read(e),n=t||new Date,s=xo.DateFormatter.toLocalTimestamp(n),a=this.frontmatterService.updateProperty(i,"ems__Effort_endTimestamp",s);a=this.frontmatterService.updateProperty(a,"ems__Effort_resolutionTimestamp",s),await this.vault.modify(e,a)}async removeStartTimestamp(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_startTimestamp");await this.vault.modify(e,i)}async removeEndTimestamp(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_endTimestamp");await this.vault.modify(e,i)}async removeResolutionTimestamp(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_resolutionTimestamp");await this.vault.modify(e,i)}async removeEndAndResolutionTimestamps(e){let t=await this.vault.read(e),i=this.frontmatterService.removeProperty(t,"ems__Effort_endTimestamp");i=this.frontmatterService.removeProperty(i,"ems__Effort_resolutionTimestamp"),await this.vault.modify(e,i)}async shiftPlannedEndTimestamp(e,t){let i=await this.vault.read(e),n=this.frontmatterService.parse(i);if(!n.exists)return;let s=this.frontmatterService.getPropertyValue(n.content,"ems__Effort_plannedEndTimestamp");if(!s)return;let a=new Date(s.replace(/["']/g,""));if(isNaN(a.getTime()))return;let c=new Date(a.getTime()+t),u=xo.DateFormatter.toLocalTimestamp(c),l=this.frontmatterService.updateProperty(i,"ems__Effort_plannedEndTimestamp",u);await this.vault.modify(e,l)}};Hr.StatusTimestampService=Jd;Hr.StatusTimestampService=Jd=EC([(0,u2.injectable)(),AC(0,(0,u2.inject)(CC.DI_TOKENS.IVaultAdapter)),TC("design:paramtypes",[Object])],Jd)});var ep=y(Kr=>{"use strict";var OC=Kr&&Kr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},PC=Kr&&Kr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},FC=Kr&&Kr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.TaskStatusService=void 0;var l2=Xe(),IC=Js(),ys=cr(),RC=ju(),DC=Lu(),NC=at(),Zd=class{static{o(this,"TaskStatusService")}constructor(e,t,i){this.vault=e,this.workflow=t,this.timestampService=i,this.frontmatterService=new IC.FrontmatterService}async setDraftStatus(e){await this.updateStatus(e,"ems__EffortStatusDraft")}async moveToBacklog(e){await this.updateStatus(e,"ems__EffortStatusBacklog")}async moveToAnalysis(e){await this.updateStatus(e,"ems__EffortStatusAnalysis")}async moveToToDo(e){await this.updateStatus(e,"ems__EffortStatusToDo")}async startEffort(e){let t=await this.vault.read(e),i=ys.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');n=this.frontmatterService.updateProperty(n,"ems__Effort_startTimestamp",i),await this.vault.modify(e,n)}async markTaskAsDone(e){let t=await this.vault.read(e),i=ys.DateFormatter.toLocalTimestamp(new Date),n=this.frontmatterService.updateProperty(t,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');n=this.frontmatterService.updateProperty(n,"ems__Effort_endTimestamp",i),n=this.frontmatterService.updateProperty(n,"ems__Effort_resolutionTimestamp",i),await this.vault.modify(e,n)}async syncEffortEndTimestamp(e,t){await this.timestampService.addEndAndResolutionTimestamps(e,t)}async shiftPlannedEndTimestamp(e,t){await this.timestampService.shiftPlannedEndTimestamp(e,t)}async trashEffort(e,t){let i=await this.vault.read(e),n=ys.DateFormatter.toLocalTimestamp(new Date),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),t&&(s=this.appendTrashReason(s,t)),await this.vault.modify(e,s)}appendTrashReason(e,t){let i=`

## Trash Reason

${t}`;return e.trimEnd()+i}async archiveTask(e){let t=await this.vault.read(e),i=this.frontmatterService.updateProperty(t,"archived","true");i=this.frontmatterService.removeProperty(i,"aliases"),await this.vault.modify(e,i)}async planOnToday(e){let t=await this.vault.read(e),i=ys.DateFormatter.getTodayStartTimestamp(),n=this.frontmatterService.updateProperty(t,"ems__Effort_plannedStartTimestamp",i);await this.vault.modify(e,n)}async planForEvening(e){let t=await this.vault.read(e),i=new Date;i.setHours(19,0,0,0);let n=ys.DateFormatter.toLocalTimestamp(i),s=this.frontmatterService.updateProperty(t,"ems__Effort_plannedStartTimestamp",n);await this.vault.modify(e,s)}async shiftDayBackward(e){await this.shiftDay(e,-1)}async shiftDayForward(e){await this.shiftDay(e,1)}async rollbackStatus(e){let t=await this.vault.read(e),i=this.extractCurrentStatus(t),n=this.extractInstanceClass(t);if(!i)throw new Error("No current status to rollback from");let s=this.workflow.getPreviousStatus(i,n);if(s===void 0)throw new Error("Cannot rollback from current status");let a=t;s===null?a=this.frontmatterService.removeProperty(a,"ems__Effort_status"):a=this.frontmatterService.updateProperty(a,"ems__Effort_status",s);let c=this.workflow.normalizeStatus(i);c==="ems__EffortStatusDone"?(a=this.frontmatterService.removeProperty(a,"ems__Effort_endTimestamp"),a=this.frontmatterService.removeProperty(a,"ems__Effort_resolutionTimestamp")):c==="ems__EffortStatusDoing"&&(a=this.frontmatterService.removeProperty(a,"ems__Effort_startTimestamp")),await this.vault.modify(e,a)}async updateStatus(e,t){let i=await this.vault.read(e),n=this.frontmatterService.updateProperty(i,"ems__Effort_status",`"[[${t}]]"`);await this.vault.modify(e,n)}async shiftDay(e,t){let i=await this.vault.read(e),n=this.extractPlannedStartTimestamp(i);if(!n)throw new Error("ems__Effort_plannedStartTimestamp property not found");let s=this.parseDateFromTimestamp(n);if(!s)throw new Error("Invalid date format in ems__Effort_plannedStartTimestamp");let a=ys.DateFormatter.addDays(s,t);a.setHours(0,0,0,0);let c=ys.DateFormatter.toLocalTimestamp(a),u=this.frontmatterService.updateProperty(i,"ems__Effort_plannedStartTimestamp",c);await this.vault.modify(e,u)}parseDateFromTimestamp(e){let t=new Date(e);return isNaN(t.getTime())?null:t}extractPlannedStartTimestamp(e){let t=this.frontmatterService.parse(e);return t.exists?this.frontmatterService.getPropertyValue(t.content,"ems__Effort_plannedStartTimestamp"):null}extractCurrentStatus(e){let t=this.frontmatterService.parse(e);return t.exists?this.frontmatterService.getPropertyValue(t.content,"ems__Effort_status"):null}extractInstanceClass(e){let t=this.frontmatterService.parse(e);if(!t.exists)return null;let i=t.content.match(/exo__Instance_class:\s*\n((?:\s*-\s*.*\n?)+)/);return i?i[1].split(`
`).filter(s=>s.trim()).map(s=>s.replace(/^\s*-\s*/,"").trim()):this.frontmatterService.getPropertyValue(t.content,"exo__Instance_class")}};Kr.TaskStatusService=Zd;Kr.TaskStatusService=Zd=OC([(0,l2.injectable)(),FC(0,(0,l2.inject)(NC.DI_TOKENS.IVaultAdapter)),PC("design:paramtypes",[Object,RC.EffortStatusWorkflow,DC.StatusTimestampService])],Zd)});var rp=y(Qr=>{"use strict";var kC=Qr&&Qr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},jC=Qr&&Qr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},LC=Qr&&Qr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.AreaCreationService=void 0;var f2=Xe(),h2=Cr(),MC=Wt(),VC=cr(),$C=Ao(),d2=Lr(),qC=at(),tp=class{static{o(this,"AreaCreationService")}constructor(e){this.vault=e}async createChildArea(e,t,i){let n=(0,h2.v4)(),s=`${n}.md`,a=this.generateChildAreaFrontmatter(t,e.basename,i,n),c=d2.MetadataHelpers.buildFileContent(a),u=e.parent?.path||"",l=u?`${u}/${s}`:s;return await this.vault.create(l,c)}generateChildAreaFrontmatter(e,t,i,n){let s=new Date,a=VC.DateFormatter.toLocalTimestamp(s),c=$C.MetadataExtractor.extractIsDefinedBy(e),u={};if(u.exo__Asset_isDefinedBy=d2.MetadataHelpers.ensureQuoted(c),u.exo__Asset_uid=n||(0,h2.v4)(),u.exo__Asset_createdAt=a,u.exo__Instance_class=[`"[[${MC.AssetClass.AREA}]]"`],u.ems__Area_parent=`"[[${t}]]"`,i&&i.trim()!==""){let l=i.trim();u.exo__Asset_label=l,u.aliases=[l]}return u}};Qr.AreaCreationService=tp;Qr.AreaCreationService=tp=kC([(0,f2.injectable)(),LC(0,(0,f2.inject)(qC.DI_TOKENS.IVaultAdapter)),jC("design:paramtypes",[Object])],tp)});var np=y(Yr=>{"use strict";var BC=Yr&&Yr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},UC=Yr&&Yr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},GC=Yr&&Yr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.AreaHierarchyBuilder=void 0;var p2=Xe(),m2=Wt(),WC=at(),ip=class{static{o(this,"AreaHierarchyBuilder")}constructor(e){this.vault=e}buildHierarchy(e,t){let i=this.vault.getAbstractFileByPath(e);if(!this.isFile(i))return null;let n=this.vault.getFrontmatter(i)||{};if(this.extractInstanceClass(n)!==m2.AssetClass.AREA)return null;let a=this.collectAllAreasFromVault(),c=new Set;return this.buildTree(e,a,c,0)}isFile(e){return e&&typeof e=="object"&&"basename"in e&&"path"in e}extractInstanceClass(e){let t=e.exo__Instance_class||"";return Array.isArray(t)?this.cleanWikiLink(t[0]||""):this.cleanWikiLink(t)}cleanWikiLink(e){return typeof e!="string"?"":e.replace(/^\[\[|\]\]$/g,"").trim()}collectAllAreasFromVault(){let e=new Map,t=new Map,i=this.vault.getAllFiles();for(let n of i){let s=this.vault.getFrontmatter(n)||{};if(this.extractInstanceClass(s)===m2.AssetClass.AREA){let c=this.extractParentPath(s);e.set(n.path,{path:n.path,title:n.basename,label:s.exo__Asset_label||void 0,isArchived:this.isArchived(s),depth:0,parentPath:c||void 0}),t.set(n.basename,n.path)}}for(let[,n]of e.entries())n.parentPath&&t.has(n.parentPath)&&(n.parentPath=t.get(n.parentPath));return e}extractParentPath(e){let t=e.ems__Area_parent;if(!t)return null;if(Array.isArray(t)){let i=t[0]||"";return this.cleanWikiLink(i)}return this.cleanWikiLink(t)}isArchived(e){let t=e.exo__Asset_archived;if(t===!0||t==="true")return!0;if(Array.isArray(t)&&t.length>0){let i=t[0];return i===!0||i==="true"}return!1}buildTree(e,t,i,n){if(i.has(e))return null;i.add(e);let s=t.get(e);if(!s)return null;let a=[];for(let[c,u]of t.entries())if(u.parentPath===e){let l=this.buildTree(c,t,i,n+1);l&&a.push(l)}return a.sort((c,u)=>{let l=c.label||c.title,f=u.label||u.title;return l.localeCompare(f)}),{path:s.path,title:s.title,label:s.label,isArchived:s.isArchived,depth:n,parentPath:s.parentPath,children:a}}};Yr.AreaHierarchyBuilder=ip;Yr.AreaHierarchyBuilder=ip=BC([(0,p2.injectable)(),GC(0,(0,p2.inject)(WC.DI_TOKENS.IVaultAdapter)),UC("design:paramtypes",[Object])],ip)});var ap=y(Xr=>{"use strict";var zC=Xr&&Xr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},HC=Xr&&Xr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},KC=Xr&&Xr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.ClassCreationService=void 0;var g2=Xe(),QC=Cr(),YC=cr(),XC=Lr(),JC=at(),sp=class{static{o(this,"ClassCreationService")}constructor(e){this.vault=e}async createSubclass(e,t,i){let n=(0,QC.v4)(),s=this.generateFileName(t),a=s.endsWith(".md")?s:`${s}.md`,c=this.generateClassFrontmatter(e.basename,t,n,i),u=XC.MetadataHelpers.buildFileContent(c),l="classes",f=`${l}/${a}`;return this.vault.getAbstractFileByPath(l)||await this.vault.createFolder(l),await this.vault.create(f,u)}generateFileName(e){let t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-");for(;t.startsWith("-");)t=t.slice(1);for(;t.endsWith("-");)t=t.slice(0,-1);return t}generateClassFrontmatter(e,t,i,n){let s=new Date,a=YC.DateFormatter.toLocalTimestamp(s),c={};c.exo__Asset_uid=i,c.exo__Asset_label=t,c.exo__Asset_createdAt=a,c.exo__Instance_class=['"[[exo__Class]]"'],c.exo__Class_superClass=`"[[${e}]]"`;let u=n.exo__Asset_isDefinedBy||'"[[Ontology/EXO]]"';return c.exo__Asset_isDefinedBy=u,c.aliases=[t],c}};Xr.ClassCreationService=sp;Xr.ClassCreationService=sp=zC([(0,g2.injectable)(),KC(0,(0,g2.inject)(JC.DI_TOKENS.IVaultAdapter)),HC("design:paramtypes",[Object])],sp)});var cp=y(Jr=>{"use strict";var ZC=Jr&&Jr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},eO=Jr&&Jr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},tO=Jr&&Jr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.ConceptCreationService=void 0;var y2=Xe(),rO=Cr(),iO=cr(),nO=Lr(),sO=Wt(),aO=at(),op=class{static{o(this,"ConceptCreationService")}constructor(e){this.vault=e}async createNarrowerConcept(e,t,i,n){let s=(0,rO.v4)(),a=t.endsWith(".md")?t:`${t}.md`,c=this.generateConceptFrontmatter(e.basename,i,n,s),u=nO.MetadataHelpers.buildFileContent(c),l="concepts",f=`${l}/${a}`;return this.vault.getAbstractFileByPath(l)||await this.vault.createFolder(l),await this.vault.create(f,u)}generateConceptFrontmatter(e,t,i,n){let s=new Date,a=iO.DateFormatter.toLocalTimestamp(s),c={};return c.exo__Asset_isDefinedBy='"[[!concepts]]"',c.exo__Asset_uid=n,c.exo__Asset_createdAt=a,c.exo__Instance_class=[`"[[${sO.AssetClass.CONCEPT}]]"`],c.ims__Concept_broader=`"[[${e}]]"`,c.ims__Concept_definition=t,i.length>0&&(c.aliases=i),c}};Jr.ConceptCreationService=op;Jr.ConceptCreationService=op=ZC([(0,y2.injectable)(),tO(0,(0,y2.inject)(aO.DI_TOKENS.IVaultAdapter)),eO("design:paramtypes",[Object])],op)});var lp=y(Zr=>{"use strict";var oO=Zr&&Zr.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},cO=Zr&&Zr.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},uO=Zr&&Zr.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.EffortVotingService=void 0;var v2=Xe(),lO=at(),up=class{static{o(this,"EffortVotingService")}constructor(e){this.vault=e}async incrementEffortVotes(e){let t=await this.vault.read(e),n=this.extractVoteCount(t)+1,s=this.updateFrontmatterWithVotes(t,n);return await this.vault.modify(e,s),n}extractVoteCount(e){let t=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(t);if(!i)return 0;let s=i[1].match(/ems__Effort_votes:\s*(\d+)/);return s&&s[1]?parseInt(s[1],10):0}updateFrontmatterWithVotes(e,t){let i=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(i),s=e.includes(`\r
`)?`\r
`:`
`;if(!n)return`---${s}ems__Effort_votes: ${t}${s}---${s}${e}`;let c=n[1];return c.includes("ems__Effort_votes:")?c=c.replace(/ems__Effort_votes:.*$/m,`ems__Effort_votes: ${t}`):c+=`${s}ems__Effort_votes: ${t}`,e.replace(i,`---${s}${c}${s}---`)}};Zr.EffortVotingService=up;Zr.EffortVotingService=up=oO([(0,v2.injectable)(),uO(0,(0,v2.inject)(lO.DI_TOKENS.IVaultAdapter)),cO("design:paramtypes",[Object])],up)});var hp=y(ei=>{"use strict";var fO=ei&&ei.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},hO=ei&&ei.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},dO=ei&&ei.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ei,"__esModule",{value:!0});ei.FolderRepairService=void 0;var _2=Xe(),pO=at(),fp=class{static{o(this,"FolderRepairService")}constructor(e){this.vault=e}async getExpectedFolder(e,t){let i=t?.exo__Asset_isDefinedBy;if(!i)return null;let n=this.extractReference(i);if(!n)return null;let s=this.vault.getFirstLinkpathDest(n,e.path);return s?this.getFileFolder(s):null}async repairFolder(e,t){let i=`${t}/${e.name}`;if(this.vault.getAbstractFileByPath(i))throw new Error(`Cannot move file: ${i} already exists`);await this.ensureFolderExists(t),await this.vault.rename(e,i)}getFileFolder(e){return e.parent?.path||""}extractReference(e){if(typeof e!="string")return null;let t=e.trim().replace(/^["']|["']$/g,"");return t=t.replace(/^\[\[|\]\]$/g,""),t||null}async ensureFolderExists(e){if(!e)return;let t=this.vault.getAbstractFileByPath(e);if(!(t&&"children"in t))try{await this.vault.createFolder(e)}catch(i){if(i instanceof Error&&i.message.includes("Folder already exists"))return;throw i}}};ei.FolderRepairService=fp;ei.FolderRepairService=fp=fO([(0,_2.injectable)(),dO(0,(0,_2.inject)(pO.DI_TOKENS.IVaultAdapter)),hO("design:paramtypes",[Object])],fp)});var pp=y(ti=>{"use strict";var mO=ti&&ti.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},gO=ti&&ti.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},yO=ti&&ti.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ti,"__esModule",{value:!0});ti.LabelToAliasService=void 0;var w2=Xe(),vO=at(),dp=class{static{o(this,"LabelToAliasService")}constructor(e){this.vault=e}async copyLabelToAliases(e){let t=await this.vault.read(e),i=this.extractLabel(t);if(!i)throw new Error("No exo__Asset_label found in file");let n=this.addLabelToAliases(t,i);await this.vault.modify(e,n)}extractLabel(e){let t=/^---\r?\n([\s\S]*?)\r?\n---/,i=e.match(t);if(!i)return null;let s=i[1].match(/exo__Asset_label:\s*["']?([^"'\r\n]+)["']?/);return s&&s[1]?s[1].trim():null}addLabelToAliases(e,t){let i=/^---\r?\n([\s\S]*?)\r?\n---/,n=e.match(i),s=e.includes(`\r
`)?`\r
`:`
`;if(!n)return`---${s}aliases:${s}  - "${t}"${s}---${s}${e}`;let c=n[1];return c.includes("aliases:")?c.match(/(aliases:\r?\n(?: {2}- .*\r?\n)*)/)&&(c=c.replace(/(aliases:\r?\n(?: {2}- .*\r?\n)*)/,`$1  - "${t}"${s}`)):c+=`${s}aliases:${s}  - "${t}"`,e.replace(i,`---${s}${c}${s}---`)}};ti.LabelToAliasService=dp;ti.LabelToAliasService=dp=mO([(0,w2.injectable)(),yO(0,(0,w2.inject)(vO.DI_TOKENS.IVaultAdapter)),gO("design:paramtypes",[Object])],dp)});var mp=y(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.LoggingService=void 0;var Co=class{static{o(this,"LoggingService")}static setVerbose(e){this.isVerbose=e}static setDevelopmentMode(e){this.isDevelopment=e}static checkIsDevelopment(){return this.isDevelopment!==void 0?this.isDevelopment:typeof process<"u"?(this.isDevelopment=!1,this.isDevelopment):(this.isDevelopment=!1,this.isDevelopment)}static debug(e,t){this.isVerbose&&console.debug(`[Exocortex] ${e}`,t??"")}static info(e,t){console.log(`[Exocortex] ${e}`,t??"")}static warn(e,t){console.warn(`[Exocortex] ${e}`,t??"")}static error(e,t,i){let n=this.checkIsDevelopment(),s=i?` [${i}]`:"";n?(console.error(`[Exocortex ERROR]${s} ${e}`,t??""),t?.stack&&console.error(`  Stack trace:
${t.stack}`)):(console.error(`[Exocortex ERROR]${s} ${e}`),t?.message&&console.error(`  Details: ${t.message}`))}};Mu.LoggingService=Co;Co.isVerbose=!1;Co.isDevelopment=void 0});var vp=y(ri=>{"use strict";var _O=ri&&ri.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},wO=ri&&ri.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},b2=ri&&ri.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ri,"__esModule",{value:!0});ri.PropertyCleanupService=void 0;var gp=Xe(),S2=at(),yp=class{static{o(this,"PropertyCleanupService")}constructor(e,t){this.vault=e,this.logger=t,this.logger.debug("PropertyCleanupService initialized")}async cleanEmptyProperties(e){this.logger.debug("Cleaning empty properties",{path:e.path});let t=await this.vault.read(e),i=this.removeEmptyPropertiesFromContent(t);await this.vault.modify(e,i),this.logger.info("Empty properties cleaned",{path:e.path})}removeEmptyPropertiesFromContent(e){let t=/^---\n([\s\S]*?)\n---/,i=e.match(t);if(!i)return e;let s=i[1].split(`
`),a=[],c=0;for(;c<s.length;){let l=s[c],f=l.trim();if(f===""){a.push(l),c++;continue}let h=f.match(/^([^:]+):\s*(.*)$/);if(h){let d=h[2];if(d===""&&c+1<s.length&&s[c+1].match(/^\s+- /)){let w=[],b=c+1;for(;b<s.length&&s[b].match(/^\s+- /);)w.push(s[b]),b++;if(w.every(O=>{let F=O.replace(/^\s+- /,"").trim();return this.isEmptyValue(F)})){c=b;continue}else{a.push(l);for(let O=c+1;O<b;O++)a.push(s[O]);c=b;continue}}if(this.isEmptyValue(d)){c++;continue}a.push(l),c++}else f.match(/^\s*- /)||a.push(l),c++}let u=a.join(`
`);return e.replace(t,`---
${u}
---`)}isEmptyValue(e){let t=e.trim();return t===""||t==="null"||t==="undefined"||t==="[]"||t==="{}"||t==='""'||t==="''"}};ri.PropertyCleanupService=yp;ri.PropertyCleanupService=yp=_O([(0,gp.injectable)(),b2(0,(0,gp.inject)(S2.DI_TOKENS.IVaultAdapter)),b2(1,(0,gp.inject)(S2.DI_TOKENS.ILogger)),wO("design:paramtypes",[Object,Object])],yp)});var wp=y(ii=>{"use strict";var bO=ii&&ii.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},SO=ii&&ii.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},EO=ii&&ii.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ii,"__esModule",{value:!0});ii.RenameToUidService=void 0;var E2=Xe(),TO=at(),_p=class{static{o(this,"RenameToUidService")}constructor(e){this.vault=e}async renameToUid(e,t){let i=t.exo__Asset_uid;if(!i)throw new Error("Asset has no exo__Asset_uid property");let n=e.basename,s=i;if(n===s)throw new Error("File is already named according to UID");let a=t.exo__Asset_label;if(!a||a.trim()===""){let f=this.isAssetArchived(t);await this.updateLabel(e,n,f)}let u=e.parent?.path||"",l=u?`${u}/${s}.md`:`${s}.md`;await this.vault.updateLinks(e.path,l,n),await this.vault.rename(e,l)}async updateLabel(e,t,i){await this.vault.process(e,n=>{let s=/^---\n([\s\S]*?)\n---/,a=n.match(s);if(!a)return n;let c=a[1],u=i?`${c}
exo__Asset_label: ${t}`:`${c}
exo__Asset_label: ${t}
aliases:
  - ${t}`;return n.replace(s,`---
${u}
---`)})}isAssetArchived(e){if(e?.exo__Asset_isArchived===!0)return!0;let t=e?.archived;if(t==null)return!1;if(typeof t=="boolean")return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){let i=t.toLowerCase().trim();return i==="true"||i==="yes"||i==="1"}return!1}};ii.RenameToUidService=_p;ii.RenameToUidService=_p=bO([(0,E2.injectable)(),EO(0,(0,E2.inject)(TO.DI_TOKENS.IVaultAdapter)),SO("design:paramtypes",[Object])],_p)});var Sp=y(ni=>{"use strict";var AO=ni&&ni.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},xO=ni&&ni.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},CO=ni&&ni.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ni,"__esModule",{value:!0});ni.SupervisionCreationService=void 0;var T2=Xe(),OO=Cr(),PO=cr(),FO=at(),bp=class{static{o(this,"SupervisionCreationService")}constructor(e){this.vault=e}async createSupervision(e){let t=(0,OO.v4)(),i=`${t}.md`,n=this.generateFrontmatter(t),s=this.generateBody(e),a=this.buildFileContent(n,s),c=`01 Inbox/${i}`;return await this.vault.create(c,a)}generateFrontmatter(e){let t=new Date,i=PO.DateFormatter.toLocalTimestamp(t);return{exo__Asset_isDefinedBy:'"[[!kitelev]]"',exo__Asset_uid:e,exo__Asset_createdAt:i,exo__Instance_class:['"[[ztlk__FleetingNote]]"'],ztlk__FleetingNote_type:'"[[CBT-Diary Record]]"'}}generateBody(e){return[{label:"\u0421\u0438\u0442\u0443\u0430\u0446\u0438\u044F/\u0442\u0440\u0438\u0433\u0433\u0435\u0440",value:e.situation},{label:"\u042D\u043C\u043E\u0446\u0438\u0438",value:e.emotions},{label:"\u041C\u044B\u0441\u043B\u0438",value:e.thoughts},{label:"\u041F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u0435",value:e.behavior},{label:"\u041A\u0440\u0430\u0442\u043A\u043E\u0441\u0440\u043E\u0447\u043D\u044B\u0435 \u043F\u043E\u0441\u043B\u0435\u0434\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F",value:e.shortTermConsequences},{label:"\u0414\u043E\u043B\u0433\u043E\u0441\u0440\u043E\u0447\u043D\u044B\u0435 \u043F\u043E\u0441\u043B\u0435\u0434\u0441\u0442\u0432\u0438\u044F \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F",value:e.longTermConsequences}].map(i=>`- ${i.label}: ${i.value}`).join(`
`)}buildFileContent(e,t){return`---
${Object.entries(e).map(([n,s])=>{if(Array.isArray(s)){let a=s.map(c=>`  - ${c}`).join(`
`);return`${n}:
${a}`}return`${n}: ${s}`}).join(`
`)}
---

${t}
`}};ni.SupervisionCreationService=bp;ni.SupervisionCreationService=bp=AO([(0,T2.injectable)(),CO(0,(0,T2.inject)(FO.DI_TOKENS.IVaultAdapter)),xO("design:paramtypes",[Object])],bp)});var Tp=y(si=>{"use strict";var IO=si&&si.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},RO=si&&si.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},DO=si&&si.__param||function(r,e){return function(t,i){e(t,i,r)}},Ep;Object.defineProperty(si,"__esModule",{value:!0});si.FleetingNoteCreationService=void 0;var A2=Xe(),NO=Cr(),kO=cr(),jO=Lr(),LO=at(),Vu=Ep=class{static{o(this,"FleetingNoteCreationService")}constructor(e){this.vault=e}async createFleetingNote(e){let t=(0,NO.v4)(),i=`${t}.md`,n=this.generateFrontmatter(t,e),s=jO.MetadataHelpers.buildFileContent(n),a=`${Ep.INBOX_FOLDER}/${i}`;return await this.vault.create(a,s)}generateFrontmatter(e,t){let i=new Date,n=kO.DateFormatter.toLocalTimestamp(i),s=t.trim();return{exo__Asset_isDefinedBy:'"[[!kitelev]]"',exo__Asset_uid:e,exo__Asset_createdAt:n,exo__Instance_class:['"[[ztlk__FleetingNote]]"'],exo__Asset_label:s,aliases:[s]}}};si.FleetingNoteCreationService=Vu;Vu.INBOX_FOLDER="01 Inbox";si.FleetingNoteCreationService=Vu=Ep=IO([(0,A2.injectable)(),DO(0,(0,A2.inject)(LO.DI_TOKENS.IVaultAdapter)),RO("design:paramtypes",[Object])],Vu)});var xp=y(vs=>{"use strict";var MO=vs&&vs.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};Object.defineProperty(vs,"__esModule",{value:!0});vs.DynamicFrontmatterGenerator=void 0;var VO=Xe(),$O=Cr(),Oo=cr(),Ap=class{static{o(this,"DynamicFrontmatterGenerator")}generate(e,t,i,n){let s={},a=new Date;n?.isDefinedBy&&(s.exo__Asset_isDefinedBy=this.ensureQuoted(n.isDefinedBy)),s.exo__Asset_uid=n?.uid||(0,$O.v4)(),s.exo__Asset_createdAt=n?.createdAt||Oo.DateFormatter.toLocalTimestamp(a),s.exo__Instance_class=[this.formatWikilink(e)];let c=new Map;for(let l of i)c.set(l.name,l.type);for(let[l,f]of Object.entries(t)){if(f==null||l==="exo__Asset_uid"||l==="exo__Asset_createdAt"||l==="exo__Instance_class"||l==="exo__Asset_isDefinedBy")continue;let h=c.get(l);s[l]=this.formatValue(f,h)}let u=t.exo__Asset_label;if(u&&typeof u=="string"&&u.trim()!==""){let l=u.trim();s.exo__Asset_label=l,s.aliases=[l]}return s}formatValue(e,t){if(e==null)return null;if(!t)return this.formatInferredValue(e);switch(t){case"text":return this.formatText(e);case"wikilink":return this.formatWikilink(e);case"status-select":case"size-select":return this.formatWikilink(e);case"number":return this.formatNumber(e);case"boolean":return this.formatBoolean(e);case"timestamp":return this.formatTimestamp(e);default:return this.formatText(e)}}formatText(e){return typeof e=="string"?e:String(e)}formatWikilink(e){let t=String(e);return t.startsWith('"[[')&&t.endsWith(']]"')?t:t.startsWith("[[")&&t.endsWith("]]")?`"${t}"`:`"[[${t}]]"`}formatNumber(e){if(typeof e=="number")return e;let t=Number(e);return isNaN(t)?0:t}formatBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){let t=e.toLowerCase().trim();return t==="true"||t==="yes"||t==="1"}return typeof e=="number"?e!==0:!!e}formatTimestamp(e){if(e instanceof Date)return Oo.DateFormatter.toLocalTimestamp(e);if(typeof e=="string"){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e.replace("Z","");let t=new Date(e);return isNaN(t.getTime())?e:Oo.DateFormatter.toLocalTimestamp(t)}if(typeof e=="number"){let t=new Date(e);if(!isNaN(t.getTime()))return Oo.DateFormatter.toLocalTimestamp(t)}return String(e)}formatInferredValue(e){return typeof e=="boolean"||typeof e=="number"?e:e instanceof Date?Oo.DateFormatter.toLocalTimestamp(e):typeof e=="string"?e.startsWith("[[")||e.startsWith('"[[')?this.formatWikilink(e):e:String(e)}ensureQuoted(e){return!e||e==='""'?'""':e.startsWith('"')&&e.endsWith('"')?e:`"${e}"`}generateYAML(e,t,i,n){let s=this.generate(e,t,i,n);return this.toYAML(s)}toYAML(e){return`---
${Object.entries(e).map(([i,n])=>{if(Array.isArray(n)){let s=n.map(a=>`  - ${a}`).join(`
`);return`${i}:
${s}`}return`${i}: ${n}`}).join(`
`)}
---`}};vs.DynamicFrontmatterGenerator=Ap;vs.DynamicFrontmatterGenerator=Ap=MO([(0,VO.injectable)()],Ap)});var Op=y(ai=>{"use strict";var qO=ai&&ai.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},BO=ai&&ai.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},UO=ai&&ai.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ai,"__esModule",{value:!0});ai.PlanningService=void 0;var x2=Xe(),GO=Js(),WO=cr(),zO=at(),Cp=class{static{o(this,"PlanningService")}constructor(e){this.vault=e,this.frontmatterService=new GO.FrontmatterService}async planOnToday(e){let t=this.vault.getAbstractFileByPath(e);if(!t||!this.isFile(t))throw new Error(`File not found: ${e}`);let i=await this.vault.read(t),n=WO.DateFormatter.getTodayStartTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_plannedStartTimestamp",n);await this.vault.modify(t,s)}isFile(e){return"basename"in e}};ai.PlanningService=Cp;ai.PlanningService=Cp=qO([(0,x2.injectable)(),UO(0,(0,x2.inject)(zO.DI_TOKENS.IVaultAdapter)),BO("design:paramtypes",[Object])],Cp)});var Fp=y(oi=>{"use strict";var HO=oi&&oi.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},KO=oi&&oi.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},QO=oi&&oi.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(oi,"__esModule",{value:!0});oi.AssetConversionService=void 0;var C2=Xe(),O2=Wt(),YO=Js(),$u=mp(),XO=at(),Pp=class{static{o(this,"AssetConversionService")}constructor(e){this.vault=e,this.frontmatterService=new YO.FrontmatterService}async convertTaskToProject(e){try{let t=await this.vault.read(e),i=this.removeInstanceClassProperty(t);return i=this.frontmatterService.updateProperty(i,"exo__Instance_class",`["[[${O2.AssetClass.PROJECT}]]"]`),await this.vault.modify(e,i),$u.LoggingService.info(`Converted Task to Project: ${e.basename} (${e.path})`),e}catch(t){let i=`Failed to convert Task to Project: ${e.path}`;throw $u.LoggingService.error(i,t instanceof Error?t:void 0),new Error(i)}}async convertProjectToTask(e){try{let t=await this.vault.read(e),i=this.removeInstanceClassProperty(t);return i=this.frontmatterService.updateProperty(i,"exo__Instance_class",`["[[${O2.AssetClass.TASK}]]"]`),await this.vault.modify(e,i),$u.LoggingService.info(`Converted Project to Task: ${e.basename} (${e.path})`),e}catch(t){let i=`Failed to convert Project to Task: ${e.path}`;throw $u.LoggingService.error(i,t instanceof Error?t:void 0),new Error(i)}}removeInstanceClassProperty(e){let t=this.frontmatterService.parse(e);if(!t.exists)return e;let i=/^exo__Instance_class:.*$(\n  -.*$)*/gm,n=t.content.replace(i,"").replace(/\n\n+/g,`
`).trim();return e.replace(/^---\n[\s\S]*?\n---/,`---
${n}
---`)}};oi.AssetConversionService=Pp;oi.AssetConversionService=Pp=HO([(0,C2.injectable)(),QO(0,(0,C2.inject)(XO.DI_TOKENS.IVaultAdapter)),KO("design:paramtypes",[Object])],Pp)});var Rp=y(ci=>{"use strict";var JO=ci&&ci.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ZO=ci&&ci.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},e4=ci&&ci.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ci,"__esModule",{value:!0});ci.SessionEventService=void 0;var P2=Xe(),t4=Cr(),F2=Wt(),r4=cr(),i4=Lr(),n4=at(),Ip=class{static{o(this,"SessionEventService")}constructor(e){this.vault=e,this.folderPathCache=null,this.defaultOntologyAsset=null}setDefaultOntologyAsset(e){this.defaultOntologyAsset=e,this.folderPathCache=null}async createSessionStartEvent(e){return this.createSessionEvent(e,F2.AssetClass.SESSION_START_EVENT)}async createSessionEndEvent(e){return this.createSessionEvent(e,F2.AssetClass.SESSION_END_EVENT)}async getOntologyAssetFolder(){if(this.folderPathCache!==null)return this.folderPathCache;if(!this.defaultOntologyAsset){let i=this.vault.getDefaultNewFileParent();return this.folderPathCache=i?.path||"",this.folderPathCache}let e=this.vault.getAllFiles();for(let i of e)if(i.basename===this.defaultOntologyAsset){let n=i.parent?.path||"";return this.folderPathCache=n,this.folderPathCache}let t=this.vault.getDefaultNewFileParent();return this.folderPathCache=t?.path||"",this.folderPathCache}async createSessionEvent(e,t){let i=(0,t4.v4)(),n=r4.DateFormatter.toLocalTimestamp(new Date),s=this.defaultOntologyAsset?`"[[${this.defaultOntologyAsset}]]"`:'"[[!kitelev]]"',a={exo__Asset_uid:i,exo__Asset_createdAt:n,exo__Asset_isDefinedBy:s,exo__Instance_class:[`"[[${t}]]"`],ems__SessionEvent_timestamp:n,ems__Session_area:`"[[${e}]]"`},c=i4.MetadataHelpers.buildFileContent(a),u=await this.getOntologyAssetFolder();u&&!await this.vault.exists(u)&&await this.vault.createFolder(u);let l=u?`${u}/${i}.md`:`${i}.md`;return await this.vault.create(l,c)}};ci.SessionEventService=Ip;ci.SessionEventService=Ip=JO([(0,P2.injectable)(),e4(0,(0,P2.inject)(n4.DI_TOKENS.IVaultAdapter)),ZO("design:paramtypes",[Object])],Ip)});var Np=y(ui=>{"use strict";var s4=ui&&ui.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},a4=ui&&ui.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},o4=ui&&ui.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(ui,"__esModule",{value:!0});ui.URIConstructionService=void 0;var I2=Xe(),c4=at(),Dp=class{static{o(this,"URIConstructionService")}constructor(e){this.fileSystem=e,this.defaultOntologyURL="https://exocortex.my/default/",this.strictValidation=!0}configure(e){e?.defaultOntologyURL&&(this.defaultOntologyURL=e.defaultOntologyURL),e?.strictValidation!==void 0&&(this.strictValidation=e.strictValidation)}async constructAssetURI(e){let t=this.extractUID(e);if(!t){if(this.strictValidation)throw new Error(`Asset missing exo__Asset_uid: ${e.path}`);return console.warn(`Asset ${e.path} missing UID, using filename fallback`),this.constructFallbackURI(e)}let i=await this.resolveOntologyURL(e);if(!this.validateOntologyURL(i))throw new Error(`Invalid ontology URL: ${i}`);return`${i.endsWith("/")?i:`${i}/`}${t}`}validateOntologyURL(e){if(!e)return!1;try{let t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}async resolveOntologyURL(e){let t=e.frontmatter?.exo__Asset_isDefinedBy;if(!t)return this.defaultOntologyURL;let i=this.extractWikiLink(t),n=i,s=await this.fileSystem.fileExists(i);return!s&&!i.endsWith(".md")&&(n=`${i}.md`,s=await this.fileSystem.fileExists(n)),s?(await this.fileSystem.getFileMetadata(n))?.exo__Ontology_url||this.defaultOntologyURL:(console.warn(`Ontology file not found: ${i}, using default`),this.defaultOntologyURL)}extractUID(e){return e.frontmatter?.exo__Asset_uid||null}extractWikiLink(e){return e.replace(/^\[\[|\]\]$/g,"")}constructFallbackURI(e){let t=e.path.split("/").pop()?.replace(".md","")||"unknown";return`${this.defaultOntologyURL}${t}`}};ui.URIConstructionService=Dp;ui.URIConstructionService=Dp=s4([(0,I2.injectable)(),o4(0,(0,I2.inject)(c4.DI_TOKENS.IFileSystemAdapter)),a4("design:paramtypes",[Object])],Dp)});var jp=y(li=>{"use strict";var u4=li&&li.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},l4=li&&li.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},f4=li&&li.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(li,"__esModule",{value:!0});li.GenericAssetCreationService=void 0;var R2=Xe(),h4=Cr(),Po=cr(),d4=Lr(),p4=at(),Fi=Lh(),kp=class{static{o(this,"GenericAssetCreationService")}constructor(e){this.vault=e}async createAsset(e,t){let i=(0,h4.v4)(),n=`${i}.md`,s=this.generateFrontmatter(e,t||[],i),a=d4.MetadataHelpers.buildFileContent(s),c=e.folderPath||this.getDefaultFolderPath(e);this.vault.getAbstractFileByPath(c)||await this.vault.createFolder(c);let l=c?`${c}/${n}`:n;return await this.vault.create(l,a)}generateFrontmatter(e,t,i){let n=new Date,s={},a=new Map;for(let c of t)a.set(c.name,c.fieldType);if(s.exo__Asset_uid=i,s.exo__Asset_createdAt=Po.DateFormatter.toLocalTimestamp(n),s.exo__Instance_class=[this.formatWikilink(e.className)],e.label&&e.label.trim()!==""){let c=e.label.trim();s.exo__Asset_label=c,s.aliases=[c]}if(e.parentFile&&e.parentMetadata&&this.inheritParentContext(s,e),e.propertyValues)for(let[c,u]of Object.entries(e.propertyValues)){if(c==="exo__Asset_uid"||c==="exo__Asset_createdAt"||c==="exo__Instance_class"||c==="exo__Asset_label"||c==="aliases"||u==null)continue;let l=a.get(c);s[c]=this.formatValue(u,l)}return s}inheritParentContext(e,t){let i=t.parentMetadata||{},n=t.parentFile?.basename;if((t.className==="ems__Task"||t.className.startsWith("ems__Task"))&&(e.ems__Effort_parent=n?this.formatWikilink(n):null),t.className==="ems__Project"||t.className.startsWith("ems__Project")){let s=i.exo__Instance_class;this.isAreaClass(s)&&(e.ems__Project_area=n?this.formatWikilink(n):null)}i.exo__Asset_isDefinedBy&&(e.exo__Asset_isDefinedBy=i.exo__Asset_isDefinedBy)}isAreaClass(e){return e?(Array.isArray(e)?e:[e]).some(i=>String(i).includes("Area")||String(i).includes("ems__Area")):!1}getDefaultFolderPath(e){if(e.parentFile?.parent?.path)return e.parentFile.parent.path;let t={ems__Task:"tasks",ems__Project:"projects",ems__Area:"areas",ems__Meeting:"meetings",exo__Event:"events",ims__Concept:"concepts"};if(t[e.className])return t[e.className];for(let[i,n]of Object.entries(t))if(e.className.startsWith(i))return n;return"assets"}formatValue(e,t){if(e==null)return null;if(!t)return this.formatInferredValue(e);switch(t){case Fi.PropertyFieldType.Text:return String(e);case Fi.PropertyFieldType.Wikilink:case Fi.PropertyFieldType.Reference:case Fi.PropertyFieldType.StatusSelect:case Fi.PropertyFieldType.SizeSelect:return this.formatWikilink(String(e));case Fi.PropertyFieldType.Number:return typeof e=="number"?e:Number(e)||0;case Fi.PropertyFieldType.Boolean:return this.formatBoolean(e);case Fi.PropertyFieldType.Date:case Fi.PropertyFieldType.DateTime:case Fi.PropertyFieldType.Timestamp:return this.formatTimestamp(e);default:return String(e)}}formatInferredValue(e){return typeof e=="boolean"||typeof e=="number"?e:e instanceof Date?Po.DateFormatter.toLocalTimestamp(e):typeof e=="string"?e.startsWith("[[")||e.startsWith('"[[')?this.formatWikilink(e):e:String(e)}formatWikilink(e){return e.startsWith('"[[')&&e.endsWith(']]"')?e:e.startsWith("[[")&&e.endsWith("]]")?`"${e}"`:`"[[${e}]]"`}formatBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){let t=e.toLowerCase().trim();return t==="true"||t==="yes"||t==="1"}return typeof e=="number"?e!==0:!!e}formatTimestamp(e){if(e instanceof Date)return Po.DateFormatter.toLocalTimestamp(e);if(typeof e=="string"){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(e))return e.replace("Z","");let t=new Date(e);return isNaN(t.getTime())?e:Po.DateFormatter.toLocalTimestamp(t)}if(typeof e=="number"){let t=new Date(e);if(!isNaN(t.getTime()))return Po.DateFormatter.toLocalTimestamp(t)}return String(e)}};li.GenericAssetCreationService=kp;li.GenericAssetCreationService=kp=u4([(0,R2.injectable)(),f4(0,(0,R2.inject)(p4.DI_TOKENS.IVaultAdapter)),l4("design:paramtypes",[Object])],kp)});var D2=y(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});qu.EffortSortingHelpers=void 0;var Lp=class r{static{o(this,"EffortSortingHelpers")}static getTimeFromTimestamp(e){if(!e)return"00:00:00";let t=new Date(e);if(isNaN(t.getTime()))return"00:00:00";let i=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return`${i}:${n}:${s}`}static sortByStartTime(e,t){let i=r.getTimeFromTimestamp(e.startTimestamp),n=r.getTimeFromTimestamp(t.startTimestamp),s=i==="00:00:00",a=n==="00:00:00";return s&&!a?1:!s&&a?-1:i.localeCompare(n)}static sortByPriority(e,t){if(e.isTrashed!==t.isTrashed)return e.isTrashed?1:-1;if(e.isDone!==t.isDone)return e.isDone?1:-1;let i=typeof e.metadata.ems__Effort_votes=="number"?e.metadata.ems__Effort_votes:0,n=typeof t.metadata.ems__Effort_votes=="number"?t.metadata.ems__Effort_votes:0;return i!==n?n-i:e.startTime&&t.startTime?e.startTime.localeCompare(t.startTime):e.startTime?-1:t.startTime?1:0}};qu.EffortSortingHelpers=Lp});var N2=y(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.FilenameValidator=void 0;var _s=class{static{o(this,"FilenameValidator")}static validate(e,t={}){let{maxLength:i=this.DEFAULT_MAX_LENGTH,replacementChar:n=this.DEFAULT_REPLACEMENT,allowEmpty:s=!1}=t,a=[];if(!e||e.trim().length===0)return s||a.push("Filename cannot be empty"),{valid:a.length===0,sanitized:"",errors:a};e.endsWith(" ")&&a.push("Filename should not end with a space");let c=e.trim();this.INVALID_CHARS_PATTERN.test(c)&&a.push('Filename contains invalid characters: / \\ : * ? " < > |');let u=this.getBaseName(c);return this.RESERVED_NAMES.has(u.toUpperCase())&&a.push(`"${u}" is a reserved filename on Windows`),c.length>i&&a.push(`Filename exceeds maximum length of ${i} characters`),c.startsWith(".")&&a.push("Filename should not start with a dot"),c.endsWith(".")&&a.push("Filename should not end with a dot"),c=this.sanitize(e,{maxLength:i,replacementChar:n}),{valid:a.length===0,sanitized:c,errors:a}}static sanitize(e,t={}){let{maxLength:i=this.DEFAULT_MAX_LENGTH,replacementChar:n=this.DEFAULT_REPLACEMENT}=t;if(!e||e.trim().length===0)return"";let s=e.trim();for(s=s.replace(this.INVALID_CHARS_PATTERN,n);s.startsWith(".")&&s.length>1;)s=s.substring(1);for(;s.length>0&&(s.endsWith(".")||s.endsWith(" "));)s=s.slice(0,-1);for(s.includes(n)&&(s=s.split(n).filter(l=>l!=="").join(n));s.startsWith(n);)s=s.slice(n.length);for(;s.endsWith(n);)s=s.slice(0,-n.length);let a=this.getBaseName(s);if(this.RESERVED_NAMES.has(a.toUpperCase())){let c=this.getExtension(s);s=a+n+c}if(s.length>i)for(s=s.slice(0,i);s.endsWith(n);)s=s.slice(0,-n.length);return s}static hasInvalidChars(e){return this.INVALID_CHARS_PATTERN.test(e)}static getInvalidChars(e){let t=e.match(this.INVALID_CHARS_PATTERN);return t?[...new Set(t)]:[]}static getBaseName(e){let t=e.lastIndexOf(".");return t===-1||t===0?e:e.substring(0,t)}static getExtension(e){let t=e.lastIndexOf(".");return t===-1||t===0?"":e.substring(t)}};Bu.FilenameValidator=_s;_s.INVALID_CHARS_PATTERN=/[/\\:*?"<>|\x00-\x1F]/g;_s.RESERVED_NAMES=new Set(["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"]);_s.DEFAULT_MAX_LENGTH=200;_s.DEFAULT_REPLACEMENT="_"});var Vp=y(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.NTriplesSerializer=void 0;var Mp=class{static{o(this,"NTriplesSerializer")}serialize(e,t={}){let i=t.newline??`
`;return e.length===0?"":e.map(n=>n.toString()).join(i)+i}serializeChunk(e,t){return e.length===0?"":e.map(i=>i.toString()).join(t)+t}};Uu.NTriplesSerializer=Mp});var k2=y(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:!0});Gu.TurtleSerializer=void 0;var Zs=Oi(),m4=Vp(),g4={rdf:Zs.Namespace.RDF.iri.value,rdfs:Zs.Namespace.RDFS.iri.value,owl:Zs.Namespace.OWL.iri.value,xsd:Zs.Namespace.XSD.iri.value,exo:Zs.Namespace.EXO.iri.value,ems:Zs.Namespace.EMS.iri.value},$p=class{static{o(this,"TurtleSerializer")}constructor(){this.nTriplesSerializer=new m4.NTriplesSerializer}serialize(e,t={}){let i=t.newline??`
`,n=this.composePrefixes(t),s=this.serializePrefixes(n,i),a=this.nTriplesSerializer.serialize(e,{newline:i}).trimEnd();return s?a?`${s}${i}${i}${a}${i}`:`${s}${i}`:a?`${a}${i}`:""}serializePrefixes(e,t){let i=Object.entries(e);return i.length===0?"":i.map(([n,s])=>`@prefix ${n}: <${s}> .`).join(t)}composePrefixes(e){return e.includeDefaultPrefixes??!0?{...g4,...e.prefixes??{}}:{...e.prefixes??{}}}serializeTriplesOnly(e,t){return this.nTriplesSerializer.serializeChunk(e,t).trimEnd()}};Gu.TurtleSerializer=$p});var M2=y(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.JSONLDSerializer=void 0;var j2=et(),L2=sr(),y4=yt(),ea=Oi(),v4={rdf:ea.Namespace.RDF.iri.value,rdfs:ea.Namespace.RDFS.iri.value,owl:ea.Namespace.OWL.iri.value,xsd:ea.Namespace.XSD.iri.value,exo:ea.Namespace.EXO.iri.value,ems:ea.Namespace.EMS.iri.value},qp=class{static{o(this,"JSONLDSerializer")}toDocument(e,t={}){let i={...v4,...t.context??{}},n=new Map;for(let s of e){let a=this.subjectToId(s.subject),c=this.compactIri(s.predicate.value,i),u=this.objectToJSONLD(s.object,i),l=n.get(a)??{"@id":a},f=l[c];f===void 0?l[c]=u:Array.isArray(f)?f.push(u):l[c]=[f,u],n.set(a,l)}return{"@context":i,"@graph":Array.from(n.values())}}serialize(e,t={}){let i=this.toDocument(e,t),n=t.pretty?t.indent??2:void 0;return JSON.stringify(i,null,n)}subjectToId(e){return e instanceof j2.IRI?e.value:e instanceof L2.BlankNode?`_:${e.id}`:String(e)}compactIri(e,t){for(let[i,n]of Object.entries(t))if(e.startsWith(n)){let s=e.slice(n.length);if(s.length>0)return`${i}:${s}`}return e}objectToJSONLD(e,t){if(e instanceof j2.IRI)return{"@id":e.value};if(e instanceof L2.BlankNode)return{"@id":`_:${e.id}`};if(e instanceof y4.Literal){let i={"@value":e.value};return e.datatype?i["@type"]=this.compactIri(e.datatype.value,t):e.language&&(i["@language"]=e.language),i}return e}};Wu.JSONLDSerializer=qp});var Gp=y(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.NTriplesParser=void 0;var _4=_n(),V2=et(),Bp=yt(),w4=sr(),ta=Oi(),b4={rdf:ta.Namespace.RDF.iri.value,rdfs:ta.Namespace.RDFS.iri.value,owl:ta.Namespace.OWL.iri.value,xsd:ta.Namespace.XSD.iri.value,exo:ta.Namespace.EXO.iri.value,ems:ta.Namespace.EMS.iri.value},Up=class{static{o(this,"NTriplesParser")}parse(e,t={}){let i={prefixes:{...b4,...t.prefixes??{}},strict:t.strict??!1},n=[];return e.split(/\r?\n/).forEach((a,c)=>{let u=a.trim();!u||u.startsWith("#")||n.push(this.parseLine(u,c+1,i))}),n}parseLine(e,t,i){if(!e.endsWith("."))throw new Error(`Invalid RDF statement at line ${t}: missing '.' terminator`);let s=e.slice(0,-1).trim(),a=this.parseSubject(s,t,i);s=a.rest.trim();let c=this.parsePredicate(s,t,i);s=c.rest.trim();let u=this.parseObject(s,t,i);if(s=u.rest.trim(),s.length>0)throw new Error(`Unexpected tokens after object at line ${t}`);return new _4.Triple(a.node,c.node,u.node)}parseSubject(e,t,i){return e.startsWith("<")?this.consumeIRI(e,t,i):e.startsWith("_:")?this.consumeBlankNode(e,t):this.consumePrefixedName(e,t,i)}parsePredicate(e,t,i){return e.startsWith("<")?this.consumeIRI(e,t,i):this.consumePrefixedName(e,t,i)}parseObject(e,t,i){return e.startsWith("<")?this.consumeIRI(e,t,i):e.startsWith("_:")?this.consumeBlankNode(e,t):e.startsWith('"')?this.consumeLiteral(e,t,i):this.consumePrefixedName(e,t,i)}consumePrefixedName(e,t,i){let n=e.match(/^([a-zA-Z_][\w-]*):([^\s]+)(?:\s+(.*))?$/);if(!n)throw new Error(`Invalid token at line ${t}: ${e}`);let[,s,a,c]=n,u=i.prefixes[s];if(!u)throw new Error(`Unknown prefix "${s}" at line ${t}`);return{node:new V2.IRI(`${u}${a}`),rest:(c??"").trimStart()}}consumeIRI(e,t,i){let n=this.findClosingBracket(e,"<",">");if(n===-1)throw new Error(`Invalid IRI at line ${t}`);let s=e.slice(1,n),a=new V2.IRI(s),c=e.slice(n+1).trimStart();return{node:a,rest:c}}consumeBlankNode(e,t){let i=e.match(/^_:(\w+)(?:\s+(.*))?$/);if(!i)throw new Error(`Invalid blank node identifier at line ${t}`);let[,n,s]=i;return{node:new w4.BlankNode(n),rest:(s??"").trimStart()}}consumeLiteral(e,t,i){let{value:n,rest:s}=this.consumeQuotedString(e,t),a=s.trimStart();if(a.startsWith("^^")){a=a.slice(2).trimStart();let c=a.startsWith("<")?this.consumeIRI(a,t,i):this.consumePrefixedName(a,t,i);return{node:new Bp.Literal(n,c.node),rest:c.rest}}if(a.startsWith("@")){let c=a.match(/^@([a-zA-Z-]+)(?:\s+(.*))?$/);if(!c)throw new Error(`Invalid language tag at line ${t}`);let[,u,l]=c;return{node:new Bp.Literal(n,void 0,u),rest:(l??"").trimStart()}}return{node:new Bp.Literal(n),rest:a}}consumeQuotedString(e,t){if(!e.startsWith('"'))throw new Error(`Expected quoted string at line ${t}`);let i="";for(let n=1;n<e.length;n++){let s=e[n];if(s==="\\"){if(n+1>=e.length)throw new Error(`Invalid escape sequence at line ${t}`);let a=e[n+1];switch(a){case"t":i+="	",n+=1;break;case"b":i+="\b",n+=1;break;case"n":i+=`
`,n+=1;break;case"r":i+="\r",n+=1;break;case"f":i+="\f",n+=1;break;case'"':i+='"',n+=1;break;case"\\":i+="\\",n+=1;break;case"u":{let c=e.slice(n+2,n+6);if(c.length!==4||!/^[0-9a-fA-F]{4}$/.test(c))throw new Error(`Invalid \\u escape at line ${t}`);i+=String.fromCharCode(parseInt(c,16)),n+=5;break}case"U":{let c=e.slice(n+2,n+10);if(c.length!==8||!/^[0-9a-fA-F]{8}$/.test(c))throw new Error(`Invalid \\U escape at line ${t}`);i+=String.fromCodePoint(parseInt(c,16)),n+=9;break}default:throw new Error(`Unknown escape sequence \\${a} at line ${t}`)}continue}if(s==='"'){let a=e.slice(n+1);return{value:i,rest:a}}i+=s}throw new Error(`Unterminated string literal at line ${t}`)}findClosingBracket(e,t,i){let n=0;for(let s=0;s<e.length;s++){let a=e[s];if(a===t){n++;continue}if(a===i&&(n--,n===0))return s}return-1}};zu.NTriplesParser=Up});var $2=y(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.TurtleParser=void 0;var ra=Oi(),S4=Gp(),E4={rdf:ra.Namespace.RDF.iri.value,rdfs:ra.Namespace.RDFS.iri.value,owl:ra.Namespace.OWL.iri.value,xsd:ra.Namespace.XSD.iri.value,exo:ra.Namespace.EXO.iri.value,ems:ra.Namespace.EMS.iri.value},T4=/^@prefix\s+([a-zA-Z_][\w-]*):\s*<([^>]+)>\s*\.$/,Wp=class{static{o(this,"TurtleParser")}constructor(){this.nTriplesParser=new S4.NTriplesParser}parse(e,t={}){let i={...E4,...t.prefixes??{}},n=this.collectStatements(e),s=[];return n.forEach(({statement:a,lineNumber:c})=>{if(this.isPrefixStatement(a)){let l=a.match(T4);if(!l)throw new Error(`Invalid prefix declaration at line ${c}`);let[,f,h]=l;i[f]=h;return}if(a.includes(";")||a.includes(","))throw new Error(`Complex Turtle statements with ';' or ',' are not supported (line ${c})`);let u=this.normalizeShortcuts(a);s.push(this.nTriplesParser.parseLine(u,c,{prefixes:i,strict:!1}))}),s}collectStatements(e){let t=e.split(/\r?\n/),i=[],n="",s=0;if(t.forEach((a,c)=>{let u=a.trim();!u||u.startsWith("#")||(n||(s=c+1),n=n?`${n} ${u}`:u,u.endsWith(".")&&(i.push({statement:n,lineNumber:s}),n=""))}),n)throw new Error(`Unterminated Turtle statement near line ${s}`);return i}isPrefixStatement(e){return e.startsWith("@prefix")}normalizeShortcuts(e){return e.includes(" a ")?e.replace(/\sa\s/g," rdf:type "):e}};Hu.TurtleParser=Wp});var q2=y(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.RDFSerializer=void 0;var ia=_n(),ws=et(),na=yt(),zp=sr(),Ii=Oi(),A4=k2(),x4=Vp(),C4=M2(),O4=$2(),P4=Gp(),F4=1024,I4=`
`,R4={rdf:Ii.Namespace.RDF.iri.value,rdfs:Ii.Namespace.RDFS.iri.value,owl:Ii.Namespace.OWL.iri.value,xsd:Ii.Namespace.XSD.iri.value,exo:Ii.Namespace.EXO.iri.value,ems:Ii.Namespace.EMS.iri.value},Hp=class{static{o(this,"RDFSerializer")}constructor(e){this.store=e,this.turtleSerializer=new A4.TurtleSerializer,this.nTriplesSerializer=new x4.NTriplesSerializer,this.jsonldSerializer=new C4.JSONLDSerializer,this.turtleParser=new O4.TurtleParser,this.nTriplesParser=new P4.NTriplesParser}async serialize(e,t={}){let i=await this.store.match();return this.serializeTriples(i,e,t)}serializeTriples(e,t,i={}){switch(t){case"turtle":return this.turtleSerializer.serialize(e,{prefixes:i.prefixes,includeDefaultPrefixes:i.includeDefaultPrefixes,newline:i.newline});case"n-triples":return this.nTriplesSerializer.serialize(e,{newline:i.newline});case"json-ld":return this.jsonldSerializer.serialize(e,{context:i.prefixes,pretty:i.pretty,indent:i.indent});default:throw new Error(`Unsupported serialization format: ${t}`)}}stream(e,t={}){let i=t.newline??I4,n=t.batchSize??F4,s=t.includeDefaultPrefixes,a=t.prefixes,c=this,u=!1,l=[],f=[],h=0,d=o(async()=>{if(!u){if(f=await c.store.match(),e==="json-ld"){let w=c.jsonldSerializer.toDocument(f,{context:a,pretty:!1});l.push(...c.buildJsonLdChunks(w))}else if(e==="turtle"){let w=c.turtleSerializer.serializePrefixes(c.composePrefixes(a,s),i);w&&l.push(`${w}${i}${i}`)}u=!0}},"ensureInitialized");return{async next(){if(await d(),l.length>0)return{value:l.shift(),done:!1};if(e==="json-ld")return{value:void 0,done:!0};if(h>=f.length)return{value:void 0,done:!0};let w=f.slice(h,h+n);h+=w.length;let b="";if(e==="turtle"){let x=c.turtleSerializer.serializeTriplesOnly(w,i);x&&(b=`${x}${i}`)}else e==="n-triples"&&(b=c.nTriplesSerializer.serializeChunk(w,i));return b?{value:b,done:!1}:this.next()},async return(){return l=[],f=[],h=0,{value:void 0,done:!0}},[Symbol.asyncIterator](){return this}}}async load(e,t,i={}){let n=this.parse(e,t,i);return i.mode!=="append"&&await this.store.clear(),await this.store.addAll(n),n.length}parse(e,t,i={}){switch(t){case"turtle":return this.turtleParser.parse(e,this.buildTurtleParseOptions(i));case"n-triples":return this.nTriplesParser.parse(e,this.buildNTriplesParseOptions(i));case"json-ld":return this.parseJsonLd(e,i);default:throw new Error(`Unsupported serialization format: ${t}`)}}buildTurtleParseOptions(e){return{prefixes:this.composePrefixes(e.prefixes,!0),strict:e.strict}}buildNTriplesParseOptions(e){return{prefixes:this.composePrefixes(e.prefixes,!0),strict:e.strict}}composePrefixes(e,t){return t??!0?{...R4,...e??{}}:{...e??{}}}parseJsonLd(e,t){let i;try{i=JSON.parse(e)}catch(l){throw new Error(`Invalid JSON-LD document: ${l.message}`)}let n=this.composePrefixes(t.prefixes,!0),s=this.extractContext(i),a={...n,...s},c=this.extractGraph(i),u=[];return c.forEach((l,f)=>{if(!l||typeof l!="object"||Array.isArray(l))throw new Error(`Invalid JSON-LD node at index ${f}`);let h=this.parseSubjectFromNode(l,a,f),d=Object.entries(l);for(let[g,w]of d){if(g==="@id"||g==="@context")continue;if(g==="@type"){this.collectTypeTriples(h,w,u,a);continue}let b=this.expandTerm(g,a),x=new ws.IRI(b);this.collectTriplesForValue(h,x,w,u,a)}}),u}extractContext(e){if(!e||typeof e!="object"||Array.isArray(e))return{};let t=e["@context"];if(!t||typeof t!="object"||Array.isArray(t))return{};let i={};return Object.entries(t).forEach(([n,s])=>{typeof s=="string"&&(i[n]=s)}),i}extractGraph(e){if(Array.isArray(e))return e;if(!e||typeof e!="object")return[];let t=e["@graph"];return Array.isArray(t)?t:[e]}parseSubjectFromNode(e,t,i){let n=e["@id"];if(typeof n=="string"){if(n.startsWith("_:"))return new zp.BlankNode(n.slice(2));if(this.isAbsoluteIri(n))return new ws.IRI(n);let s=this.expandTerm(n,t);return new ws.IRI(s)}return new zp.BlankNode(`jsonld_${i}`)}collectTypeTriples(e,t,i,n){let s=Ii.Namespace.RDF.term("type");(Array.isArray(t)?t:[t]).forEach(c=>{if(typeof c!="string")throw new Error("Invalid @type value in JSON-LD node");let u=this.expandTerm(c,n);i.push(new ia.Triple(e,s,new ws.IRI(u)))})}collectTriplesForValue(e,t,i,n,s){if(i!=null){if(Array.isArray(i)){i.forEach(a=>this.collectTriplesForValue(e,t,a,n,s));return}if(typeof i=="object"){let a=i;if(typeof a["@id"]=="string"){let c=this.parseIdNode(a["@id"],s);n.push(new ia.Triple(e,t,c));return}if(a["@value"]!==void 0){let c=this.parseLiteralObject(a,s);n.push(new ia.Triple(e,t,c));return}}if(typeof i=="string"){n.push(new ia.Triple(e,t,new na.Literal(i)));return}if(typeof i=="number"){let a=Number.isInteger(i)?Ii.Namespace.XSD.term("integer"):Ii.Namespace.XSD.term("decimal");n.push(new ia.Triple(e,t,new na.Literal(i.toString(),a)));return}if(typeof i=="boolean"){let a=Ii.Namespace.XSD.term("boolean");n.push(new ia.Triple(e,t,new na.Literal(i.toString(),a)));return}throw new Error("Unsupported JSON-LD value encountered")}}parseIdNode(e,t){if(e.startsWith("_:"))return new zp.BlankNode(e.slice(2));if(this.isAbsoluteIri(e))return new ws.IRI(e);let i=this.expandTerm(e,t);return new ws.IRI(i)}parseLiteralObject(e,t){let i=e["@value"];if(typeof i!="string")throw new Error("JSON-LD literal values must be strings");if(typeof e["@language"]=="string")return new na.Literal(i,void 0,e["@language"]);if(typeof e["@type"]=="string"){let n=this.expandTerm(e["@type"],t);return new na.Literal(i,new ws.IRI(n))}return new na.Literal(i)}expandTerm(e,t){if(this.isAbsoluteIri(e))return e;let i=e.indexOf(":");if(i>0){let s=e.slice(0,i),a=e.slice(i+1),c=t[s];if(!c)throw new Error(`Unknown prefix "${s}" in JSON-LD document`);return`${c}${a}`}let n=t["@vocab"];if(n)return`${n}${e}`;throw new Error(`Unable to expand JSON-LD term "${e}"`)}isAbsoluteIri(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)}buildJsonLdChunks(e){let t=[],i=JSON.stringify(e["@context"]);return t.push(`{"@context":${i},"@graph":[`),e["@graph"].forEach((n,s)=>{let a=JSON.stringify(n);s>0?t.push(`,${a}`):t.push(a)}),t.push(`]}
`),t}};Ku.RDFSerializer=Hp});var B2=y(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.TransactionError=xn.TripleNotFoundError=xn.TripleAlreadyExistsError=void 0;var Kp=class extends Error{static{o(this,"TripleAlreadyExistsError")}constructor(e){super(`Triple already exists: ${e.toString()}`),this.name="TripleAlreadyExistsError"}};xn.TripleAlreadyExistsError=Kp;var Qp=class extends Error{static{o(this,"TripleNotFoundError")}constructor(e){super(`Triple not found: ${e.toString()}`),this.name="TripleNotFoundError"}};xn.TripleNotFoundError=Qp;var Yp=class extends Error{static{o(this,"TransactionError")}constructor(e){super(e),this.name="TransactionError"}};xn.TransactionError=Yp});var Jp=y(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});Qu.LRUCache=void 0;var Xp=class{static{o(this,"LRUCache")}constructor(e){this.maxSize=e,this.cache=new Map}get(e){let t=this.cache.get(e);return t!==void 0&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){let i=this.cache.keys().next().value;i!==void 0&&this.cache.delete(i)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}};Qu.LRUCache=Xp});var U2=y(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.InMemoryTripleStore=void 0;var Cn=B2(),Yu=et(),D4=sr(),N4=yt(),k4=Oi(),j4=Jp(),L4=k4.Namespace.XSD.term("string").value,M4=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi,sa="__default__",Zp=class r{static{o(this,"InMemoryTripleStore")}constructor(){this.triples=new Map,this.spo=new Map,this.sop=new Map,this.pso=new Map,this.pos=new Map,this.osp=new Map,this.ops=new Map,this.queryCache=new j4.LRUCache(1e3),this.uuidIndex=new Map,this.namedGraphs=new Map}async add(e){let t=this.getTripleKey(e);if(this.triples.has(t))return;this.triples.set(t,e);let i=this.getNodeKey(e.subject),n=this.getNodeKey(e.predicate),s=this.getNodeKey(e.object);this.addToIndex(this.spo,i,n,s),this.addToIndex(this.sop,i,s,n),this.addToIndex(this.pso,n,i,s),this.addToIndex(this.pos,n,s,i),this.addToIndex(this.osp,s,i,n),this.addToIndex(this.ops,s,n,i),this.addToUUIDIndex(e.subject),this.queryCache.clear()}async remove(e){let t=this.getTripleKey(e);if(!this.triples.has(t))return!1;this.triples.delete(t);let i=this.getNodeKey(e.subject),n=this.getNodeKey(e.predicate),s=this.getNodeKey(e.object);return this.removeFromIndex(this.spo,i,n,s),this.removeFromIndex(this.sop,i,s,n),this.removeFromIndex(this.pso,n,i,s),this.removeFromIndex(this.pos,n,s,i),this.removeFromIndex(this.osp,s,i,n),this.removeFromIndex(this.ops,s,n,i),this.queryCache.clear(),!0}async has(e){let t=this.getTripleKey(e);return this.triples.has(t)}async match(e,t,i){let n=this.getMatchCacheKey(e,t,i),s=this.queryCache.get(n);if(s!==void 0)return s;let a;return!e&&!t&&!i?a=Array.from(this.triples.values()):e&&t&&i?a=this.matchSPO(e,t,i):e&&t?a=this.matchSP(e,t):e&&i?a=this.matchSO(e,i):t&&i?a=this.matchPO(t,i):e?a=this.matchS(e):t?a=this.matchP(t):i?a=this.matchO(i):a=[],this.queryCache.set(n,a),a}async addAll(e){for(let t of e)await this.add(t)}async removeAll(e){let t=0;for(let i of e)await this.remove(i)&&t++;return t}async clear(){this.triples.clear(),this.spo.clear(),this.sop.clear(),this.pso.clear(),this.pos.clear(),this.osp.clear(),this.ops.clear(),this.uuidIndex.clear(),this.queryCache.clear()}async count(){return this.triples.size}async subjects(){let e=new Set;for(let t of this.triples.values())e.add(t.subject);return Array.from(e)}async predicates(){let e=new Set;for(let t of this.triples.values())e.add(t.predicate);return Array.from(e)}async objects(){let e=new Set;for(let t of this.triples.values())e.add(t.object);return Array.from(e)}async beginTransaction(){return new em(this)}async findSubjectsByUUID(e){return this.findSubjectsByUUIDSync(e)}findSubjectsByUUIDSync(e){let t=e.toLowerCase(),i=this.uuidIndex.get(t);if(!i||i.size===0)return[];let n=[];for(let s of i)this.spo.has(`i:${s}`)&&n.push(new Yu.IRI(s));return n}addToUUIDIndex(e){if(!(e instanceof Yu.IRI))return;let t=e.value,i=t.match(M4);if(i)for(let n of i){let s=n.toLowerCase();this.uuidIndex.has(s)||this.uuidIndex.set(s,new Set),this.uuidIndex.get(s).add(t)}}matchSPO(e,t,i){let n=this.getNodeKey(e),s=this.getNodeKey(t),a=this.getNodeKey(i),c=this.spo.get(n);if(!c)return[];let u=c.get(s);if(!u)return[];if(u.has(a)){let l=this.buildTripleKey(n,s,a),f=this.triples.get(l);return f?[f]:[]}return[]}matchSP(e,t){let i=this.getNodeKey(e),n=this.getNodeKey(t),s=this.spo.get(i);if(!s)return[];let a=s.get(n);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(i,n,c))):[]}matchSO(e,t){let i=this.getNodeKey(e),n=this.getNodeKey(t),s=this.sop.get(i);if(!s)return[];let a=s.get(n);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(i,c,n))):[]}matchPO(e,t){let i=this.getNodeKey(e),n=this.getNodeKey(t),s=this.pos.get(i);if(!s)return[];let a=s.get(n);return a?this.getTriplesByKeys(Array.from(a).map(c=>this.buildTripleKey(c,i,n))):[]}matchS(e){let t=this.getNodeKey(e),i=this.spo.get(t);if(!i)return[];let n=[];for(let[s,a]of i.entries())for(let c of a)n.push(this.buildTripleKey(t,s,c));return this.getTriplesByKeys(n)}matchP(e){let t=this.getNodeKey(e),i=this.pso.get(t);if(!i)return[];let n=[];for(let[s,a]of i.entries())for(let c of a)n.push(this.buildTripleKey(s,t,c));return this.getTriplesByKeys(n)}matchO(e){let t=this.getNodeKey(e),i=this.osp.get(t);if(!i)return[];let n=[];for(let[s,a]of i.entries())for(let c of a)n.push(this.buildTripleKey(s,c,t));return this.getTriplesByKeys(n)}getTriplesByKeys(e){let t=[];for(let i of e){let n=this.triples.get(i);n&&t.push(n)}return t}addToIndex(e,t,i,n){e.has(t)||e.set(t,new Map);let s=e.get(t);s.has(i)||s.set(i,new Set),s.get(i).add(n)}removeFromIndex(e,t,i,n){let s=e.get(t);if(!s)return;let a=s.get(i);a&&(a.delete(n),a.size===0&&s.delete(i),s.size===0&&e.delete(t))}getTripleKey(e){let t=this.getNodeKey(e.subject),i=this.getNodeKey(e.predicate),n=this.getNodeKey(e.object);return this.buildTripleKey(t,i,n)}buildTripleKey(e,t,i){return`${e}|${t}|${i}`}getNodeKey(e){if(e instanceof Yu.IRI)return`i:${e.value}`;if(e instanceof D4.BlankNode)return`b:${e.id}`;if(e instanceof N4.Literal){let t=`l:${e.value}`;return e.datatype&&e.datatype.value!==L4?t+=`^^${e.datatype.value}`:e.language&&(t+=`@${e.language}`),t}return""}getMatchCacheKey(e,t,i){let n=e?this.getNodeKey(e):"?",s=t?this.getNodeKey(t):"?",a=i?this.getNodeKey(i):"?";return`${n}|${s}|${a}`}getGraphKey(e){return e?e.value:sa}getOrCreateGraphStore(e){let t=this.getGraphKey(e);return t===sa?this:(this.namedGraphs.has(t)||this.namedGraphs.set(t,new r),this.namedGraphs.get(t))}async addToGraph(e,t){await this.getOrCreateGraphStore(t).add(e)}async removeFromGraph(e,t){let i=this.getGraphKey(t);if(i===sa)return this.remove(e);let n=this.namedGraphs.get(i);return n?n.remove(e):!1}async matchInGraph(e,t,i,n){let s=this.getGraphKey(n);if(s===sa)return this.match(e,t,i);let a=this.namedGraphs.get(s);return a?a.match(e,t,i):[]}async getNamedGraphs(){return Array.from(this.namedGraphs.keys()).map(e=>new Yu.IRI(e))}async hasGraph(e){let t=this.namedGraphs.get(e.value);return t?await t.count()>0:!1}async clearGraph(e){let t=this.getGraphKey(e);if(t===sa){await this.clear();return}let i=this.namedGraphs.get(t);i&&(await i.clear(),this.namedGraphs.delete(t))}async countInGraph(e){let t=this.getGraphKey(e);if(t===sa)return this.count();let i=this.namedGraphs.get(t);return i?i.count():0}};Xu.InMemoryTripleStore=Zp;var em=class{static{o(this,"InMemoryTransaction")}constructor(e){this.store=e,this.operations=[],this.committed=!1,this.rolledBack=!1}async add(e){if(this.committed)throw new Cn.TransactionError("Transaction already committed");if(this.rolledBack)throw new Cn.TransactionError("Transaction already rolled back");this.operations.push({type:"add",triple:e})}async remove(e){if(this.committed)throw new Cn.TransactionError("Transaction already committed");if(this.rolledBack)throw new Cn.TransactionError("Transaction already rolled back");return this.operations.push({type:"remove",triple:e}),!0}async commit(){if(this.committed)throw new Cn.TransactionError("Transaction already committed");if(this.rolledBack)throw new Cn.TransactionError("Transaction already rolled back");for(let e of this.operations)e.type==="add"?await this.store.add(e.triple):await this.store.remove(e.triple);this.committed=!0,this.operations=[]}async rollback(){if(this.committed)throw new Cn.TransactionError("Transaction already committed");if(this.rolledBack)throw new Cn.TransactionError("Transaction already rolled back");this.operations=[],this.rolledBack=!0}}});var rm=y(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0});Ju.RDFVocabularyMapper=void 0;var Pr=_n(),G2=et(),pe=Oi(),tm=class{static{o(this,"RDFVocabularyMapper")}constructor(){this.propertyMappings=new Map([["exo__Instance_class",pe.Namespace.RDF.term("type")],["exo__Asset_isDefinedBy",pe.Namespace.RDFS.term("isDefinedBy")],["exo__Class_superClass",pe.Namespace.RDFS.term("subClassOf")],["exo__Property_range",pe.Namespace.RDFS.term("range")],["exo__Property_domain",pe.Namespace.RDFS.term("domain")],["exo__Property_superProperty",pe.Namespace.RDFS.term("subPropertyOf")]])}generateClassHierarchyTriples(){let e=[];return e.push(new Pr.Triple(pe.Namespace.EXO.term("Asset"),pe.Namespace.RDFS.term("subClassOf"),pe.Namespace.RDFS.term("Resource"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Class"),pe.Namespace.RDFS.term("subClassOf"),pe.Namespace.RDFS.term("Class"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Property"),pe.Namespace.RDFS.term("subClassOf"),pe.Namespace.RDF.term("Property"))),e.push(new Pr.Triple(pe.Namespace.EMS.term("Task"),pe.Namespace.RDFS.term("subClassOf"),pe.Namespace.EXO.term("Asset"))),e.push(new Pr.Triple(pe.Namespace.EMS.term("Project"),pe.Namespace.RDFS.term("subClassOf"),pe.Namespace.EXO.term("Asset"))),e.push(new Pr.Triple(pe.Namespace.EMS.term("Area"),pe.Namespace.RDFS.term("subClassOf"),pe.Namespace.EXO.term("Asset"))),e}generatePropertyHierarchyTriples(){let e=[];return e.push(new Pr.Triple(pe.Namespace.EXO.term("Instance_class"),pe.Namespace.RDFS.term("subPropertyOf"),pe.Namespace.RDF.term("type"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Asset_isDefinedBy"),pe.Namespace.RDFS.term("subPropertyOf"),pe.Namespace.RDFS.term("isDefinedBy"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Class_superClass"),pe.Namespace.RDFS.term("subPropertyOf"),pe.Namespace.RDFS.term("subClassOf"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Property_range"),pe.Namespace.RDFS.term("subPropertyOf"),pe.Namespace.RDFS.term("range"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Property_domain"),pe.Namespace.RDFS.term("subPropertyOf"),pe.Namespace.RDFS.term("domain"))),e.push(new Pr.Triple(pe.Namespace.EXO.term("Property_superProperty"),pe.Namespace.RDFS.term("subPropertyOf"),pe.Namespace.RDFS.term("subPropertyOf"))),e}generateMappedTriple(e,t,i){let n=this.propertyMappings.get(t);if(!n)return null;let s;if(i instanceof G2.IRI)s=i;else{let a=i.match(/^(ems|exo)__(.+)$/);if(a){let[,c,u]=a;s=(c==="ems"?pe.Namespace.EMS:pe.Namespace.EXO).term(u)}else s=new G2.IRI(i)}return new Pr.Triple(e,n,s)}hasMappingFor(e){return this.propertyMappings.has(e)}};Ju.RDFVocabularyMapper=tm});var nm=y(fi=>{"use strict";var V4=fi&&fi.__decorate||function(r,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(e,t,s):a(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},$4=fi&&fi.__metadata||function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},q4=fi&&fi.__param||function(r,e){return function(t,i){e(t,i,r)}};Object.defineProperty(fi,"__esModule",{value:!0});fi.NoteToRDFConverter=void 0;var W2=Xe(),Zu=_n(),z2=et(),Ri=yt(),sn=Oi(),B4=at(),U4=rm(),im=class{static{o(this,"NoteToRDFConverter")}constructor(e){this.vault=e,this.OBSIDIAN_VAULT_SCHEME="obsidian://vault/",this.vocabularyMapper=new U4.RDFVocabularyMapper}async convertNote(e){let t=this.vault.getFrontmatter(e);if(!t)return[];let i=[],n=this.notePathToIRI(e.path),s=sn.Namespace.EXO.term("Asset_fileName");i.push(new Zu.Triple(n,s,new Ri.Literal(e.basename)));for(let[a,c]of Object.entries(t)){if(!this.isExocortexProperty(a))continue;let u=this.propertyKeyToIRI(a),l=Array.isArray(c)?c:[c];for(let f of l)if(a==="exo__Instance_class"){let h=this.valueToClassURI(f);i.push(new Zu.Triple(n,u,h))}else{let h=await this.valueToRDFObject(f,e);if(i.push(new Zu.Triple(n,u,h)),this.vocabularyMapper.hasMappingFor(a)&&h instanceof z2.IRI){let d=this.vocabularyMapper.generateMappedTriple(n,a,h);d&&i.push(d)}}if(a==="exo__Instance_class")for(let f of l){let h=this.expandClassValue(f);if(h){let d=sn.Namespace.RDF.term("type");i.push(new Zu.Triple(n,d,h))}}}return i}async convertVault(){let e=this.vault.getAllFiles(),t=[];for(let i of e)try{let n=await this.convertNote(i);t.push(...n)}catch(n){console.warn(`\u26A0\uFE0F Skipping file with invalid IRI: ${i.path}`),console.warn(`   Reason: ${n instanceof Error?n.message:String(n)}`);continue}return t}notePathToIRI(e){let t=encodeURI(e);return new z2.IRI(`${this.OBSIDIAN_VAULT_SCHEME}${t}`)}isExocortexProperty(e){return e.startsWith("exo__")||e.startsWith("ems__")}propertyKeyToIRI(e){if(e.startsWith("exo__")){let t=e.substring(5);return sn.Namespace.EXO.term(t)}if(e.startsWith("ems__")){let t=e.substring(5);return sn.Namespace.EMS.term(t)}throw new Error(`Invalid property key: ${e}`)}async valueToRDFObject(e,t){if(typeof e=="string"){let i=this.removeQuotes(e),n=this.extractWikilink(i);if(n){let s=this.vault.getFirstLinkpathDest(n,t.path);if(s)return this.notePathToIRI(s.path);if(this.isClassReference(n)){let a=this.expandClassValue(n);if(a)return a}return new Ri.Literal(i)}if(this.isClassReference(i)){let s=this.expandClassValue(i);if(s)return s}return this.isISO8601DateTime(i)?new Ri.Literal(i,sn.Namespace.XSD.term("dateTime")):new Ri.Literal(i)}return typeof e=="boolean"?new Ri.Literal(e.toString()):typeof e=="number"?new Ri.Literal(e.toString(),sn.Namespace.XSD.term("decimal")):e instanceof Date?new Ri.Literal(e.toISOString(),sn.Namespace.XSD.term("dateTime")):new Ri.Literal(String(e))}isISO8601DateTime(e){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{1,3})?(Z|[+-]\d{2}:\d{2})?$/.test(e)}removeQuotes(e){let t=e.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.substring(1,t.length-1):e}extractWikilink(e){let t=e.match(/^\[\[([^\]]+)\]\]$/);return t?t[1]:null}valueToClassURI(e){if(typeof e!="string")return new Ri.Literal(String(e));let t=this.removeQuotes(e),n=this.extractWikilink(t)||t,s=this.expandClassValue(n);return s||new Ri.Literal(t)}isClassReference(e){return(e.startsWith("ems__")||e.startsWith("exo__"))&&!/\s/.test(e)}expandClassValue(e){let t=this.removeQuotes(e);if(t.startsWith("ems__")){let i=t.substring(5);return sn.Namespace.EMS.term(i)}if(t.startsWith("exo__")){let i=t.substring(5);return sn.Namespace.EXO.term(i)}return null}};fi.NoteToRDFConverter=im;fi.NoteToRDFConverter=im=V4([(0,W2.injectable)(),q4(0,(0,W2.inject)(B4.DI_TOKENS.IVaultAdapter)),$4("design:paramtypes",[Object])],im)});var sm=y((aM,H2)=>{var aa=class{static{o(this,"Wildcard")}constructor(){return G4||this}equals(e){return e&&this.termType===e.termType}};Object.defineProperty(aa.prototype,"value",{enumerable:!0,value:"*"});Object.defineProperty(aa.prototype,"termType",{enumerable:!0,value:"Wildcard"});var G4=new aa;H2.exports.Wildcard=aa});var Q2=y((cM,K2)=>{var W4=(function(){var r=o(function(A,T,P,I){for(P=P||{},I=A.length;I--;P[A[I]]=T);return P},"o"),e=[6,12,13,15,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],t=[2,247],i=[100,110,113,115,116,123,126,131,329,330,331,332,333],n=[2,409],s=[1,18],a=[1,27],c=[13,16,45,197,224,229,308],u=[28,29,53],l=[28,53],f=[1,42],h=[1,45],d=[1,41],g=[1,44],w=[123,126],b=[1,67],x=[39,45,87],O=[13,16,45,197,224,308],F=[1,87],k=[2,281],G=[1,86],W=[13,16,45,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],Ie=[6,28,29,53,63,70,73,81,83,85],Je=[6,13,16,28,29,53,63,70,73,81,83,85,87,308],ot=[6,13,16,28,29,45,53,63,70,73,81,82,83,85,87,89,197,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314],q=[6,13,16,28,29,31,39,45,47,48,53,63,70,73,81,82,83,85,87,89,109,112,121,123,126,128,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,337,338,340,341,342,343,344,345,346],ue=[13,16,308],we=[112,132,327,334],He=[13,16,112,132,308],Ue=[1,111],Ze=[1,117],ke=[112,132,327,328,334],je=[13,16,112,132,308,328],Re=[28,29,45,53,87],H=[1,138],N=[1,151],Le=[1,128],Ge=[1,127],M=[1,129],he=[1,140],Ae=[1,141],z=[1,142],xe=[1,143],Ce=[1,144],be=[1,145],Oe=[1,147],le=[1,148],Se=[2,457],de=[1,158],Ee=[1,159],Pe=[1,160],J=[1,152],re=[1,153],ie=[1,156],Z=[1,171],ee=[1,172],te=[1,173],X=[1,174],ne=[1,175],ce=[1,176],se=[1,167],ae=[1,168],Q=[1,169],oe=[1,170],De=[1,157],Fe=[1,166],ve=[1,161],_=[1,162],E=[1,163],v=[1,164],C=[1,165],U=[6,13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],Ke=[1,195],it=[6,31,73,81,83,85],_e=[2,285],j=[1,199],L=[1,201],V=[6,31,70,73,81,83,85],B=[2,283],me=[1,207],Me=[1,218],Ve=[1,223],It=[1,219],yr=[1,225],Ar=[1,226],tr=[1,224],A1=[6,63,70,73,81,83,85],x1=[1,236],C1=[2,334],O1=[1,243],P1=[1,241],Rt=[6,193],bc=[2,349],F1=[2,339],gn=[28,128],I1=[47,48,193,272],Sc=[47,48,193,242,272],Ms=[47,48,193,242,246,272],Vs=[47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,341,342,343,344,345,346],At=[39,47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,338,341,342,343,344,345,346],R1=[1,271],D1=[1,270],mt=[6,13,16,29,31,39,45,47,48,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],N1=[1,281],k1=[1,280],rr=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],Za=[45,89],Ec=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],Tc=[13,16,31,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Ac=[31,89],xc=[48,87],Kn=[6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338],Si=[6,13,16,39,45,48,82,87,89,231,263,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338,340],j1=[1,313],$s=[6,85],Lf=[6,31,81,83,85],L1=[2,361],Gi=[2,353],Qn=[1,343],eo=[31,112,335],Wi=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Mf=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335],M1=[6,109,193],Yn=[31,112],gt=[13,16,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],Vf=[1,390],$f=[1,391],yn=[13,16,87,197,308,314],V1=[13,16,39,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],Cc=[1,417],Oc=[1,418],$1=[13,16,48,197,229,308],vn=[6,31,85],q1=[6,13,16,31,45,73,81,83,85,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],qf=[6,13,16,29,31,45,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,231,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,346,347,348,349,350,351],Xn=[29,31,85,112,159,160,161,163,164],Pc=[1,443],Fc=[1,444],B1=[1,449],Jn=[31,112,193,232,318,335],Ic=[13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],U1=[13,16,31,45,48,82,87,89,112,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Bf=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],to=[13,16,31,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],ro=[31,45],G1=[1,507],W1=[1,508],z1=[6,13,16,29,31,39,45,47,48,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,336,338,341,342,343,344,345,346,347,348,349,350,351],Rc=[29,31,85,112,159,160,161,163,164,335],Zn=[6,13,16,31,45,70,73,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],H1=[13,16,31,45,48,82,87,89,112,193,197,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],K1=[2,352],Uf=[13,16,197,308,314],Q1=[1,565],qs=[6,13,16,31,45,76,78,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],Y1=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],zi=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],X1=[13,16,87,308],Hi=[2,364],Bs=[29,31,85,112,159,160,161,163,164,193,232,318,335],Dc=[31,112,193,232,272,318,335],Ki=[2,359],J1=[13,16,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Nc=[29,31,85,112,159,160,161,163,164,193,232,272,318,335],Z1=[13,16,31,45,82,87,89,112,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],e0=[2,347],Gf={trace:o(function(){},"trace"),yy:{},symbols_:{error:2,QueryOrUpdate:3,Prologue:4,QueryOrUpdate_group0:5,EOF:6,Query:7,Qry:8,Query_option0:9,Prologue_repetition0:10,BaseDecl:11,BASE:12,IRIREF:13,PrefixDecl:14,PREFIX:15,PNAME_NS:16,SelectClauseWildcard:17,Qry_repetition0:18,WhereClause:19,SolutionModifierNoGroup:20,SelectClauseVars:21,Qry_repetition1:22,SolutionModifier:23,CONSTRUCT:24,ConstructTemplate:25,Qry_repetition2:26,Qry_repetition3:27,WHERE:28,"{":29,Qry_option0:30,"}":31,DESCRIBE:32,Qry_group0:33,Qry_repetition4:34,Qry_option1:35,ASK:36,Qry_repetition5:37,SelectClauseBase:38,"*":39,SelectClauseVars_repetition_plus0:40,SELECT:41,SelectClauseBase_option0:42,SelectClauseItem:43,Var:44,"(":45,Expression:46,AS:47,")":48,SubSelect:49,SubSelect_option0:50,SubSelect_option1:51,DatasetClause:52,FROM:53,DatasetClause_option0:54,iri:55,WhereClause_option0:56,GroupGraphPattern:57,SolutionModifier_option0:58,SolutionModifierNoGroup_option0:59,SolutionModifierNoGroup_option1:60,SolutionModifierNoGroup_option2:61,GroupClause:62,GROUP:63,BY:64,GroupClause_repetition_plus0:65,GroupCondition:66,BuiltInCall:67,FunctionCall:68,HavingClause:69,HAVING:70,HavingClause_repetition_plus0:71,OrderClause:72,ORDER:73,OrderClause_repetition_plus0:74,OrderCondition:75,ASC:76,BrackettedExpression:77,DESC:78,Constraint:79,LimitOffsetClauses:80,LIMIT:81,INTEGER:82,OFFSET:83,ValuesClause:84,VALUES:85,InlineData:86,VAR:87,InlineData_repetition0:88,NIL:89,InlineData_repetition1:90,InlineData_repetition_plus2:91,InlineData_repetition3:92,DataBlock:93,DataBlockValueList:94,DataBlockValueList_repetition_plus0:95,Update:96,Update_repetition0:97,Update1:98,Update_option0:99,LOAD:100,Update1_option0:101,Update1_option1:102,Update1_group0:103,Update1_option2:104,GraphRefAll:105,Update1_group1:106,Update1_option3:107,GraphOrDefault:108,TO:109,CREATE:110,Update1_option4:111,GRAPH:112,INSERTDATA:113,QuadPattern:114,DELETEDATA:115,DELETEWHERE:116,Update1_option5:117,InsertDeleteClause:118,Update1_repetition0:119,IntoGraphClause:120,INTO:121,GraphRef:122,DELETE:123,InsertDeleteClause_option0:124,InsertClause:125,INSERT:126,UsingClause:127,USING:128,UsingClause_option0:129,WithClause:130,WITH:131,DEFAULT:132,GraphOrDefault_option0:133,GraphRefAll_group0:134,Quads:135,Quads_option0:136,Quads_repetition0:137,QuadsNotTriples:138,VarOrIri:139,QuadsNotTriples_option0:140,QuadsNotTriples_option1:141,QuadsNotTriples_option2:142,TriplesTemplate:143,TriplesTemplate_repetition0:144,TriplesSameSubject:145,TriplesTemplate_option0:146,GroupGraphPatternSub:147,GroupGraphPatternSub_option0:148,GroupGraphPatternSub_repetition0:149,GroupGraphPatternSubTail:150,GraphPatternNotTriples:151,GroupGraphPatternSubTail_option0:152,GroupGraphPatternSubTail_option1:153,TriplesBlock:154,TriplesBlock_repetition0:155,TriplesSameSubjectPath:156,TriplesBlock_option0:157,GroupOrUnionGraphPattern:158,OPTIONAL:159,MINUS:160,SERVICE:161,GraphPatternNotTriples_option0:162,FILTER:163,BIND:164,InlineDataOneVar:165,InlineDataFull:166,InlineDataOneVar_repetition0:167,InlineDataFull_repetition0:168,InlineDataFull_repetition_plus1:169,InlineDataFull_repetition2:170,DataBlockValue:171,Literal:172,QuotedTriple:173,UNDEF:174,GroupOrUnionGraphPattern_repetition0:175,ArgList:176,ArgList_option0:177,ArgList_repetition0:178,ExpressionList:179,ExpressionList_repetition0:180,ConstructTemplate_option0:181,ConstructTriples:182,ConstructTriples_repetition0:183,ConstructTriples_option0:184,VarOrTermOrQuotedTP:185,PropertyListNotEmpty:186,TriplesNode:187,PropertyList:188,PropertyList_option0:189,VerbObjectList:190,PropertyListNotEmpty_repetition0:191,SemiOptionalVerbObjectList:192,";":193,SemiOptionalVerbObjectList_option0:194,Verb:195,ObjectList:196,a:197,ObjectList_repetition0:198,Object:199,GraphNode:200,Object_option0:201,PropertyListPathNotEmpty:202,TriplesNodePath:203,TriplesSameSubjectPath_option0:204,O:205,PropertyListPathNotEmpty_repetition0:206,PropertyListPathNotEmptyTail:207,O_group0:208,ObjectListPath:209,ObjectListPath_repetition0:210,ObjectPath:211,GraphNodePath:212,ObjectPath_option0:213,Path:214,Path_repetition0:215,PathSequence:216,PathSequence_repetition0:217,PathEltOrInverse:218,PathElt:219,PathPrimary:220,PathElt_option0:221,PathEltOrInverse_option0:222,IriOrA:223,"!":224,PathNegatedPropertySet:225,PathOneInPropertySet:226,PathNegatedPropertySet_repetition0:227,PathNegatedPropertySet_option0:228,"^":229,TriplesNode_repetition_plus0:230,"[":231,"]":232,TriplesNodePath_repetition_plus0:233,VarOrTermOrQuotedTPExpr:234,VarOrTerm:235,GraphTerm:236,BlankNode:237,ConditionalOrExpression:238,ConditionalAndExpression:239,ConditionalOrExpression_repetition0:240,ConditionalOrExpressionTail:241,"||":242,RelationalExpression:243,ConditionalAndExpression_repetition0:244,ConditionalAndExpressionTail:245,"&&":246,NumericExpression:247,RelationalExpression_group0:248,RelationalExpression_option0:249,IN:250,MultiplicativeExpression:251,NumericExpression_repetition0:252,AdditiveExpressionTail:253,AdditiveExpressionTail_group0:254,NumericLiteralPositive:255,AdditiveExpressionTail_repetition0:256,NumericLiteralNegative:257,AdditiveExpressionTail_repetition1:258,UnaryExpression:259,MultiplicativeExpression_repetition0:260,MultiplicativeExpressionTail:261,MultiplicativeExpressionTail_group0:262,"+":263,PrimaryExpression:264,"-":265,ExprQuotedTP:266,Aggregate:267,FUNC_ARITY0:268,FUNC_ARITY1:269,FUNC_ARITY1_SPARQL_STAR:270,FUNC_ARITY2:271,",":272,FUNC_ARITY3:273,FUNC_ARITY3_SPARQL_STAR:274,BuiltInCall_group0:275,BOUND:276,BNODE:277,BuiltInCall_option0:278,EXISTS:279,COUNT:280,Aggregate_option0:281,Aggregate_group0:282,FUNC_AGGREGATE:283,Aggregate_option1:284,GROUP_CONCAT:285,Aggregate_option2:286,Aggregate_option3:287,GroupConcatSeparator:288,SEPARATOR:289,"=":290,String:291,LANGTAG:292,"^^":293,DECIMAL:294,DOUBLE:295,BOOLEAN:296,INTEGER_POSITIVE:297,DECIMAL_POSITIVE:298,DOUBLE_POSITIVE:299,INTEGER_NEGATIVE:300,DECIMAL_NEGATIVE:301,DOUBLE_NEGATIVE:302,STRING_LITERAL1:303,STRING_LITERAL2:304,STRING_LITERAL_LONG1:305,STRING_LITERAL_LONG2:306,PrefixedName:307,PNAME_LN:308,BLANK_NODE_LABEL:309,ANON:310,QuotedTP:311,"<<":312,qtSubjectOrObject:313,">>":314,DataValueTerm:315,AnnotationPattern:316,"{|":317,"|}":318,AnnotationPatternPath:319,ExprVarOrTerm:320,QueryOrUpdate_group0_option0:321,Prologue_repetition0_group0:322,Qry_group0_repetition_plus0:323,SelectClauseBase_option0_group0:324,DISTINCT:325,REDUCED:326,NAMED:327,SILENT:328,CLEAR:329,DROP:330,ADD:331,MOVE:332,COPY:333,ALL:334,".":335,UNION:336,"|":337,"/":338,PathElt_option0_group0:339,"?":340,"!=":341,"<":342,">":343,"<=":344,">=":345,NOT:346,CONCAT:347,COALESCE:348,SUBSTR:349,REGEX:350,REPLACE:351,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",12:"BASE",13:"IRIREF",15:"PREFIX",16:"PNAME_NS",24:"CONSTRUCT",28:"WHERE",29:"{",31:"}",32:"DESCRIBE",36:"ASK",39:"*",41:"SELECT",45:"(",47:"AS",48:")",53:"FROM",63:"GROUP",64:"BY",70:"HAVING",73:"ORDER",76:"ASC",78:"DESC",81:"LIMIT",82:"INTEGER",83:"OFFSET",85:"VALUES",87:"VAR",89:"NIL",100:"LOAD",109:"TO",110:"CREATE",112:"GRAPH",113:"INSERTDATA",115:"DELETEDATA",116:"DELETEWHERE",121:"INTO",123:"DELETE",126:"INSERT",128:"USING",131:"WITH",132:"DEFAULT",159:"OPTIONAL",160:"MINUS",161:"SERVICE",163:"FILTER",164:"BIND",174:"UNDEF",193:";",197:"a",224:"!",229:"^",231:"[",232:"]",242:"||",246:"&&",250:"IN",263:"+",265:"-",268:"FUNC_ARITY0",269:"FUNC_ARITY1",270:"FUNC_ARITY1_SPARQL_STAR",271:"FUNC_ARITY2",272:",",273:"FUNC_ARITY3",274:"FUNC_ARITY3_SPARQL_STAR",276:"BOUND",277:"BNODE",279:"EXISTS",280:"COUNT",283:"FUNC_AGGREGATE",285:"GROUP_CONCAT",289:"SEPARATOR",290:"=",292:"LANGTAG",293:"^^",294:"DECIMAL",295:"DOUBLE",296:"BOOLEAN",297:"INTEGER_POSITIVE",298:"DECIMAL_POSITIVE",299:"DOUBLE_POSITIVE",300:"INTEGER_NEGATIVE",301:"DECIMAL_NEGATIVE",302:"DOUBLE_NEGATIVE",303:"STRING_LITERAL1",304:"STRING_LITERAL2",305:"STRING_LITERAL_LONG1",306:"STRING_LITERAL_LONG2",308:"PNAME_LN",309:"BLANK_NODE_LABEL",310:"ANON",312:"<<",314:">>",317:"{|",318:"|}",325:"DISTINCT",326:"REDUCED",327:"NAMED",328:"SILENT",329:"CLEAR",330:"DROP",331:"ADD",332:"MOVE",333:"COPY",334:"ALL",335:".",336:"UNION",337:"|",338:"/",340:"?",341:"!=",342:"<",343:">",344:"<=",345:">=",346:"NOT",347:"CONCAT",348:"COALESCE",349:"SUBSTR",350:"REGEX",351:"REPLACE"},productions_:[0,[3,3],[7,2],[4,1],[11,2],[14,3],[8,4],[8,4],[8,5],[8,7],[8,5],[8,4],[17,2],[21,2],[38,2],[43,1],[43,5],[49,4],[49,4],[52,3],[19,2],[23,2],[20,3],[62,3],[66,1],[66,1],[66,3],[66,5],[66,1],[69,2],[72,3],[75,2],[75,2],[75,1],[75,1],[80,2],[80,2],[80,4],[80,4],[84,2],[86,4],[86,4],[86,6],[86,2],[94,3],[96,3],[98,4],[98,3],[98,5],[98,4],[98,2],[98,2],[98,2],[98,5],[120,2],[118,3],[118,1],[125,2],[127,3],[130,2],[108,1],[108,2],[122,2],[105,1],[105,1],[114,3],[135,2],[138,7],[143,3],[57,3],[57,3],[147,2],[150,3],[154,3],[151,1],[151,2],[151,2],[151,3],[151,4],[151,2],[151,6],[151,1],[93,1],[93,1],[165,4],[166,4],[166,6],[171,1],[171,1],[171,1],[171,1],[158,2],[79,1],[79,1],[79,1],[68,2],[176,1],[176,5],[179,1],[179,4],[25,3],[182,3],[145,2],[145,2],[188,1],[186,2],[192,2],[190,2],[195,1],[195,1],[196,2],[199,2],[156,2],[156,2],[202,2],[207,1],[207,2],[205,2],[209,2],[211,2],[214,2],[216,2],[219,2],[218,2],[220,1],[220,2],[220,3],[225,1],[225,1],[225,4],[226,1],[226,2],[187,3],[187,3],[203,3],[203,3],[200,1],[200,1],[212,1],[212,1],[234,1],[235,1],[235,1],[139,1],[139,1],[44,1],[236,1],[236,1],[236,1],[236,1],[46,1],[238,2],[241,2],[239,2],[245,2],[243,1],[243,3],[243,4],[247,2],[253,2],[253,2],[253,2],[251,2],[261,2],[259,2],[259,2],[259,2],[259,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[77,3],[67,1],[67,2],[67,4],[67,4],[67,6],[67,8],[67,8],[67,2],[67,4],[67,2],[67,4],[67,3],[267,5],[267,5],[267,6],[288,4],[172,1],[172,2],[172,3],[172,1],[172,1],[172,1],[172,1],[172,1],[172,1],[255,1],[255,1],[255,1],[257,1],[257,1],[257,1],[291,1],[291,1],[291,1],[291,1],[55,1],[55,1],[307,1],[307,1],[237,1],[237,1],[311,5],[173,5],[313,1],[313,1],[313,1],[313,1],[313,1],[315,1],[315,1],[315,1],[185,1],[185,1],[185,1],[316,3],[319,3],[266,5],[320,1],[320,1],[320,1],[223,1],[223,1],[321,0],[321,1],[5,1],[5,1],[5,1],[9,0],[9,1],[322,1],[322,1],[10,0],[10,2],[18,0],[18,2],[22,0],[22,2],[26,0],[26,2],[27,0],[27,2],[30,0],[30,1],[323,1],[323,2],[33,1],[33,1],[34,0],[34,2],[35,0],[35,1],[37,0],[37,2],[40,1],[40,2],[324,1],[324,1],[42,0],[42,1],[50,0],[50,1],[51,0],[51,1],[54,0],[54,1],[56,0],[56,1],[58,0],[58,1],[59,0],[59,1],[60,0],[60,1],[61,0],[61,1],[65,1],[65,2],[71,1],[71,2],[74,1],[74,2],[88,0],[88,2],[90,0],[90,2],[91,1],[91,2],[92,0],[92,2],[95,1],[95,2],[97,0],[97,4],[99,0],[99,2],[101,0],[101,1],[102,0],[102,1],[103,1],[103,1],[104,0],[104,1],[106,1],[106,1],[106,1],[107,0],[107,1],[111,0],[111,1],[117,0],[117,1],[119,0],[119,2],[124,0],[124,1],[129,0],[129,1],[133,0],[133,1],[134,1],[134,1],[134,1],[136,0],[136,1],[137,0],[137,2],[140,0],[140,1],[141,0],[141,1],[142,0],[142,1],[144,0],[144,3],[146,0],[146,1],[148,0],[148,1],[149,0],[149,2],[152,0],[152,1],[153,0],[153,1],[155,0],[155,3],[157,0],[157,1],[162,0],[162,1],[167,0],[167,2],[168,0],[168,2],[169,1],[169,2],[170,0],[170,2],[175,0],[175,3],[177,0],[177,1],[178,0],[178,3],[180,0],[180,3],[181,0],[181,1],[183,0],[183,3],[184,0],[184,1],[189,0],[189,1],[191,0],[191,2],[194,0],[194,1],[198,0],[198,3],[201,0],[201,1],[204,0],[204,1],[206,0],[206,2],[208,1],[208,1],[210,0],[210,3],[213,0],[213,1],[215,0],[215,3],[217,0],[217,3],[339,1],[339,1],[339,1],[221,0],[221,1],[222,0],[222,1],[227,0],[227,3],[228,0],[228,1],[230,1],[230,2],[233,1],[233,2],[240,0],[240,2],[244,0],[244,2],[248,1],[248,1],[248,1],[248,1],[248,1],[248,1],[249,0],[249,1],[252,0],[252,2],[254,1],[254,1],[256,0],[256,2],[258,0],[258,2],[260,0],[260,2],[262,1],[262,1],[275,1],[275,1],[275,1],[275,1],[275,1],[278,0],[278,1],[281,0],[281,1],[282,1],[282,1],[284,0],[284,1],[286,0],[286,1],[287,0],[287,1]],performAction:o(function(T,P,I,K,ye,p,nr){var m=p.length-1;switch(ye){case 1:if(p[m-1]=p[m-1]||{},Te.base&&(p[m-1].base=Te.base),Te.base="",p[m-1].prefixes=Te.prefixes,Te.prefixes=null,Te.pathOnly){if(p[m-1].type==="path"||"termType"in p[m-1])return p[m-1];throw new Error("Received full SPARQL query in path only mode")}else if(p[m-1].type==="path"||"termType"in p[m-1])throw new Error("Received only path in full SPARQL mode");if(p[m-1].type==="update"){let Qe={};for(let ct of p[m-1].updates)if(ct.updateType==="insert"){let $e={};for(let ze of ct.insert)if(ze.type==="bgp"||ze.type==="graph")for(let vr of ze.triples)vr.subject.termType==="BlankNode"&&($e[vr.subject.value]=!0),vr.predicate.termType==="BlankNode"&&($e[vr.predicate.value]=!0),vr.object.termType==="BlankNode"&&($e[vr.object.value]=!0);for(let ze of Object.keys($e)){if(Qe[ze])throw new Error("Detected reuse blank node across different INSERT DATA clauses");Qe[ze]=!0}}}return p[m-1];case 2:this.$={...p[m-1],...p[m],type:"query"};break;case 4:Te.base=io(p[m]);break;case 5:Te.prefixes||(Te.prefixes={}),p[m-1]=p[m-1].substr(0,p[m-1].length-1),p[m]=io(p[m]),Te.prefixes[p[m-1]]=p[m];break;case 6:this.$={...p[m-3],...rs(p[m-2]),...p[m-1],...p[m]};break;case 7:if(!Te.skipValidation&&(Jf(p[m-3].variables.map(ct=>Xf(ct.expression))).some(ct=>ct.aggregation==="count"&&!(ct.expression instanceof kc))||p[m].group)){for(let ct of p[m-3].variables)if(ct.termType==="Variable"){if(!p[m].group||!p[m].group.map($e=>zs($e)).includes(zs(ct)))throw Error("Projection of ungrouped variable (?"+zs(ct)+")")}else if(Xf(ct.expression).length===0){let $e=FS(ct.expression);for(let ze of $e)if(!p[m].group||!p[m].group.map||!p[m].group.map(vr=>zs(vr)).includes(zs(ze)))throw Error("Use of ungrouped variable in projection of operation (?"+zs(ze)+")")}}let xi=p[m-1].where.filter(Qe=>Qe.type==="query");if(xi.length>0){let Qe=p[m-3].variables.filter($e=>$e.variable&&$e.variable.value).map($e=>$e.variable.value),ct=Jf(xi.map($e=>$e.variables)).map($e=>$e.value||$e.variable.value);for(let $e of Qe)if(ct.indexOf($e)>=0)throw Error("Target id of 'AS' (?"+$e+") already used in subquery")}this.$=ht(p[m-3],rs(p[m-2]),p[m-1],p[m]);break;case 8:this.$=ht({queryType:"CONSTRUCT",template:p[m-3]},rs(p[m-2]),p[m-1],p[m]);break;case 9:this.$=ht({queryType:"CONSTRUCT",template:p[m-2]=p[m-2]?p[m-2].triples:[]},rs(p[m-5]),{where:[{type:"bgp",triples:ts([],p[m-2])}]},p[m]);break;case 10:this.$=ht({queryType:"DESCRIBE",variables:p[m-3]==="*"?[new kc]:p[m-3]},rs(p[m-2]),p[m-1],p[m]);break;case 11:this.$=ht({queryType:"ASK"},rs(p[m-2]),p[m-1],p[m]);break;case 12:this.$=ht(p[m-1],{variables:[new kc]});break;case 13:let co=p[m].map(Qe=>Qe.value||Qe.variable.value),Hs=IS(co);if(Hs.length>0)throw Error("Two or more of the resulting columns have the same name (?"+Hs[0]+")");this.$=ht(p[m-1],{variables:p[m]});break;case 14:this.$=ht({queryType:"SELECT"},p[m]&&(p[m-1]=ir(p[m]),p[m]={},p[m][p[m-1]]=!0,p[m]));break;case 16:case 27:this.$=Us(p[m-3],{variable:p[m-1]});break;case 17:case 18:this.$=ht(p[m-3],p[m-2],p[m-1],p[m],{type:"query"});break;case 19:case 58:this.$={iri:p[m],named:!!p[m-1]};break;case 20:this.$={where:p[m].patterns};break;case 21:this.$=ht(p[m-1],p[m]);break;case 22:this.$=ht(p[m-2],p[m-1],p[m]);break;case 23:this.$={group:p[m]};break;case 24:case 25:case 28:case 31:case 33:case 34:this.$=Us(p[m]);break;case 26:this.$=Us(p[m-1]);break;case 29:this.$={having:p[m]};break;case 30:this.$={order:p[m]};break;case 32:this.$=Us(p[m],{descending:!0});break;case 35:this.$={limit:Ws(p[m])};break;case 36:this.$={offset:Ws(p[m])};break;case 37:this.$={limit:Ws(p[m-2]),offset:Ws(p[m])};break;case 38:this.$={limit:Ws(p[m]),offset:Ws(p[m-2])};break;case 39:case 43:this.$={type:"values",values:p[m]};break;case 40:case 84:this.$=p[m-1].map(Qe=>({[p[m-3]]:Qe}));break;case 41:case 85:this.$=p[m-1].map(()=>({}));break;case 42:case 86:var Ai=p[m-4].length;p[m-4]=p[m-4].map(Wf),this.$=p[m-1].map(function(Qe){if(Qe.length!==Ai)throw Error("Inconsistent VALUES length");for(var ct={},$e=0;$e<Ai;$e++)ct["?"+p[m-4][$e].value]=Qe[$e];return ct});break;case 44:case 65:case 100:case 126:case 175:this.$=p[m-1];break;case 45:this.$={type:"update",updates:Qi(p[m-2],p[m-1])};break;case 46:this.$=ht({type:"load",silent:!!p[m-2],source:p[m-1]},p[m]&&{destination:p[m]});break;case 47:this.$={type:ir(p[m-2]),silent:!!p[m-1],graph:p[m]};break;case 48:this.$={type:ir(p[m-4]),silent:!!p[m-3],source:p[m-2],destination:p[m]};break;case 49:this.$={type:"create",silent:!!p[m-2],graph:{type:"graph",name:p[m]}};break;case 50:this.$={updateType:"insert",insert:f0(p[m])};break;case 51:this.$={updateType:"delete",delete:th(f0(p[m]))};break;case 52:this.$={updateType:"deletewhere",delete:th(p[m])};break;case 53:this.$={updateType:"insertdelete",...p[m-4],...p[m-3],...rs(p[m-2],"using"),where:p[m].patterns};break;case 54:case 57:case 62:case 167:case 191:case 236:this.$=p[m];break;case 55:this.$={delete:th(p[m-1]),insert:p[m]||[]};break;case 56:this.$={delete:[],insert:p[m]};break;case 59:this.$={graph:p[m]};break;case 60:this.$={type:"graph",default:!0};break;case 61:case 63:this.$={type:"graph",name:p[m]};break;case 64:this.$={[ir(p[m])]:!0};break;case 66:this.$=p[m-1]?Ei(p[m],[p[m-1]]):Ei(p[m]);break;case 67:var ao=ht(p[m-3]||{triples:[]},{type:"graph",name:p[m-5]});this.$=p[m]?[ao,p[m]]:[ao];break;case 68:case 73:this.$={type:"bgp",triples:Ei(p[m-2],[p[m-1]])};break;case 69:this.$={type:"group",patterns:[p[m-1]]};break;case 70:for(let Qe of p[m-1].filter(ct=>ct.type==="bind")){let ct=p[m-1].indexOf(Qe),$e=new Set;for(let ze of p[m-1].slice(0,ct))(ze.type==="group"||ze.type==="bgp")&&u0(ze).forEach(vr=>$e.add(vr));if($e.has(Qe.variable.value))throw Error("Variable used to bind is already bound (?"+Qe.variable.value+")")}this.$={type:"group",patterns:p[m-1]};break;case 71:this.$=p[m-1]?Ei([p[m-1]],p[m]):Ei(p[m]);break;case 72:this.$=p[m]?[p[m-2],p[m]]:p[m-2];break;case 75:this.$=ht(p[m],{type:"optional"});break;case 76:this.$=ht(p[m],{type:"minus"});break;case 77:this.$=ht(p[m],{type:"graph",name:p[m-1]});break;case 78:this.$=ht(p[m],{type:"service",name:p[m-1],silent:!!p[m-2]});break;case 79:this.$={type:"filter",expression:p[m]};break;case 80:this.$={type:"bind",variable:p[m-1],expression:p[m-3]};break;case 89:this.$=so(p[m]);break;case 90:this.$=void 0;break;case 91:this.$=p[m-1].length?{type:"union",patterns:Ei(p[m-1].map(Hf),[Hf(p[m])])}:p[m];break;case 95:this.$={...p[m],function:p[m-1]};break;case 96:this.$={type:"functionCall",args:[]};break;case 97:this.$={type:"functionCall",args:Qi(p[m-2],p[m-1]),distinct:!!p[m-3]};break;case 98:case 115:case 128:case 247:case 249:case 251:case 253:case 255:case 263:case 267:case 297:case 299:case 303:case 307:case 328:case 341:case 349:case 355:case 361:case 367:case 369:case 373:case 375:case 379:case 381:case 385:case 391:case 395:case 401:case 405:case 409:case 411:case 420:case 428:case 430:case 440:case 444:case 446:case 448:this.$=[];break;case 99:this.$=Qi(p[m-2],p[m-1]);break;case 101:this.$=Ei(p[m-2],[p[m-1]]);break;case 102:case 112:this.$=eh(p[m].map(Qe=>ht(Yi(p[m-1]),Qe)));break;case 103:this.$=eh(ts(p[m].map(Qe=>ht(Yi(p[m-1].entity),Qe)),p[m-1].triples));break;case 105:this.$=Ei([p[m-1]],p[m]);break;case 106:this.$=Ei(p[m]);break;case 107:this.$=Yf(p[m-1],p[m]);break;case 109:case 237:this.$=Te.factory.namedNode(wS);break;case 110:case 118:this.$=Qi(p[m-1],p[m]);break;case 111:this.$=p[m]?{annotation:p[m],object:p[m-1]}:p[m-1];break;case 113:this.$=p[m]?eh(ts(p[m].map(Qe=>ht(Yi(p[m-1].entity),Qe)),p[m-1].triples)):p[m-1].triples;break;case 114:this.$=Yf(...p[m-1],p[m]);break;case 116:this.$=Yf(...p[m]);break;case 117:case 159:case 163:this.$=[p[m-1],p[m]];break;case 119:this.$=p[m]?{object:p[m-1],annotation:p[m]}:p[m-1];break;case 120:this.$=p[m-1].length?Gs("|",Qi(p[m-1],p[m])):p[m];break;case 121:this.$=p[m-1].length?Gs("/",Qi(p[m-1],p[m])):p[m];break;case 122:this.$=p[m]?Gs(p[m],[p[m-1]]):p[m-1];break;case 123:this.$=p[m-1]?Gs(p[m-1],[p[m]]):p[m];break;case 125:case 131:this.$=Gs(p[m-1],[p[m]]);break;case 129:this.$=Gs("|",Qi(p[m-2],p[m-1]));break;case 132:case 134:this.$=OS(p[m-1]);break;case 133:case 135:this.$=PS(p[m-1]);break;case 140:this.$={entity:p[m],triples:[]};break;case 145:this.$=Wf(p[m]);break;case 149:this.$=Te.factory.namedNode(t0);break;case 151:case 153:case 158:case 162:this.$=zf(p[m-1],p[m]);break;case 152:this.$=["||",p[m]];break;case 154:this.$=["&&",p[m]];break;case 156:this.$=Dt(p[m-1],[p[m-2],p[m]]);break;case 157:this.$=Dt(p[m-2]?"notin":"in",[p[m-3],p[m]]);break;case 160:this.$=["+",zf(p[m-1],p[m])];break;case 161:var Mc=Ti(p[m-1].value.replace("-",""),p[m-1].datatype);this.$=["-",zf(Mc,p[m])];break;case 164:this.$=Dt("UPLUS",[p[m]]);break;case 165:this.$=Dt(p[m-1],[p[m]]);break;case 166:this.$=Dt("UMINUS",[p[m]]);break;case 177:this.$=Dt(ir(p[m-1]));break;case 178:this.$=Dt(ir(p[m-3]),[p[m-1]]);break;case 179:this.$=so(Dt(ir(p[m-3]),[p[m-1]]));break;case 180:this.$=Dt(ir(p[m-5]),[p[m-3],p[m-1]]);break;case 181:this.$=Dt(ir(p[m-7]),[p[m-5],p[m-3],p[m-1]]);break;case 182:this.$=so(Dt(ir(p[m-7]),[p[m-5],p[m-3],p[m-1]]));break;case 183:this.$=Dt(ir(p[m-1]),p[m]);break;case 184:this.$=Dt("bound",[Wf(p[m-1])]);break;case 185:this.$=Dt(p[m-1],[]);break;case 186:this.$=Dt(p[m-3],[p[m-1]]);break;case 187:this.$=Dt(p[m-2]?"notexists":"exists",[Hf(p[m])]);break;case 188:case 189:this.$=Us(p[m-1],{type:"aggregate",aggregation:ir(p[m-4]),distinct:!!p[m-2]});break;case 190:this.$=Us(p[m-2],{type:"aggregate",aggregation:ir(p[m-5]),distinct:!!p[m-3],separator:typeof p[m-1]=="string"?p[m-1]:" "});break;case 192:this.$=Ti(p[m]);break;case 193:this.$=TS(p[m-1],ir(p[m].substr(1)));break;case 194:this.$=Ti(p[m-2],p[m]);break;case 195:case 204:this.$=Ti(p[m],r0);break;case 196:case 205:this.$=Ti(p[m],i0);break;case 197:case 206:this.$=Ti(ir(p[m]),n0);break;case 200:this.$=Ti(p[m].toLowerCase(),ES);break;case 201:this.$=Ti(p[m].substr(1),r0);break;case 202:this.$=Ti(p[m].substr(1),i0);break;case 203:this.$=Ti(p[m].substr(1).toLowerCase(),n0);break;case 207:case 208:this.$=c0(p[m],1);break;case 209:case 210:this.$=c0(p[m],3);break;case 211:this.$=Te.factory.namedNode(io(p[m]));break;case 213:var Vc=p[m].indexOf(":"),oo=p[m].substr(0,Vc),$c=Te.prefixes[oo];if(!$c)throw new Error("Unknown prefix: "+oo);var ft=io($c+p[m].substr(Vc+1));this.$=Te.factory.namedNode(ft);break;case 214:if(p[m]=p[m].substr(0,p[m].length-1),!(p[m]in Te.prefixes))throw new Error("Unknown prefix: "+p[m]);var ft=io(Te.prefixes[p[m]]);this.$=Te.factory.namedNode(ft);break;case 215:this.$=no(p[m].replace(/^(_:)/,""));break;case 216:this.$=no();break;case 217:case 218:case 232:this.$=so(Kf(p[m-3],p[m-2],p[m-1]));break;case 230:case 231:this.$=so(p[m-1]);break;case 248:case 250:case 252:case 254:case 256:case 260:case 264:case 268:case 270:case 292:case 294:case 296:case 298:case 300:case 302:case 304:case 306:case 329:case 342:case 356:case 368:case 370:case 372:case 374:case 392:case 402:case 425:case 427:case 429:case 431:case 441:case 445:case 447:case 449:p[m-1].push(p[m]);break;case 259:case 269:case 291:case 293:case 295:case 301:case 305:case 371:case 424:case 426:this.$=[p[m]];break;case 308:p[m-3].push(p[m-2]);break;case 350:case 362:case 376:case 380:case 382:case 386:case 396:case 406:case 410:case 412:case 421:p[m-2].push(p[m-1]);break}},"anonymous"),table:[r(e,t,{3:1,4:2,10:3}),{1:[3]},r(i,[2,307],{5:4,7:5,321:6,214:7,8:8,96:9,215:10,17:11,21:12,97:16,38:17,6:[2,238],13:n,16:n,45:n,197:n,224:n,229:n,308:n,24:[1,13],32:[1,14],36:[1,15],41:s}),r([6,13,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],[2,3],{322:19,11:20,14:21,12:[1,22],15:[1,23]}),{6:[1,24]},{6:[2,240]},{6:[2,241]},{6:[2,242]},{6:[2,243],9:25,84:26,85:a},{6:[2,239]},r(c,[2,411],{216:28,217:29}),r(u,[2,249],{18:30}),r(u,[2,251],{22:31}),r(l,[2,255],{25:32,27:33,29:[1,34]}),{13:f,16:h,33:35,39:[1,37],44:39,55:40,87:d,139:38,307:43,308:g,323:36},r(u,[2,267],{37:46}),r(w,[2,326],{98:47,103:49,106:50,117:55,130:61,100:[1,48],110:[1,51],113:[1,52],115:[1,53],116:[1,54],131:[1,62],329:[1,56],330:[1,57],331:[1,58],332:[1,59],333:[1,60]}),{39:[1,63],40:64,43:65,44:66,45:b,87:d},r(x,[2,273],{42:68,324:69,325:[1,70],326:[1,71]}),r(e,[2,248]),r(e,[2,245]),r(e,[2,246]),{13:[1,72]},{16:[1,73]},{1:[2,1]},{6:[2,2]},{6:[2,244]},{45:[1,77],85:[1,78],86:74,87:[1,75],89:[1,76]},r([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],[2,120],{337:[1,79]}),r(O,[2,418],{218:80,222:81,229:[1,82]}),{19:83,28:F,29:k,52:84,53:G,56:85},{19:88,28:F,29:k,52:89,53:G,56:85},r(u,[2,253],{26:90}),{28:[1,91],52:92,53:G},r(W,[2,385],{181:93,182:94,183:95,31:[2,383]}),r(Ie,[2,263],{34:96}),r(Ie,[2,261],{44:39,55:40,307:43,139:97,13:f,16:h,87:d,308:g}),r(Ie,[2,262]),r(Je,[2,259]),r(ot,[2,143]),r(ot,[2,144]),r([6,13,16,28,29,31,39,45,47,48,53,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,145]),r(q,[2,211]),r(q,[2,212]),r(q,[2,213]),r(q,[2,214]),{19:98,28:F,29:k,52:99,53:G,56:85},{6:[2,309],99:100,193:[1,101]},r(ue,[2,311],{101:102,328:[1,103]}),r(we,[2,317],{104:104,328:[1,105]}),r(He,[2,322],{107:106,328:[1,107]}),{111:108,112:[2,324],328:[1,109]},{29:Ue,114:110},{29:Ue,114:112},{29:Ue,114:113},{118:114,123:[1,115],125:116,126:Ze},r(ke,[2,315]),r(ke,[2,316]),r(je,[2,319]),r(je,[2,320]),r(je,[2,321]),r(w,[2,327]),{13:f,16:h,55:118,307:43,308:g},r(u,[2,12]),r(u,[2,13],{44:66,43:119,45:b,87:d}),r(Re,[2,269]),r(Re,[2,15]),{13:f,16:h,44:136,45:H,46:120,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(x,[2,14]),r(x,[2,274]),r(x,[2,271]),r(x,[2,272]),r(e,[2,4]),{13:[1,177]},r(U,[2,39]),{29:[1,178]},{29:[1,179]},{87:[1,181],91:180},{45:[1,187],87:[1,185],89:[1,186],93:182,165:183,166:184},r(c,[2,410]),r([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337],[2,121],{338:[1,188]}),{13:f,16:h,45:[1,193],55:194,197:Ke,219:189,220:190,223:191,224:[1,192],307:43,308:g},r(O,[2,419]),r(it,_e,{20:196,59:197,69:198,70:j}),r(u,[2,250]),{29:L,57:200},r(ue,[2,279],{54:202,327:[1,203]}),{29:[2,282]},r(V,B,{23:204,58:205,62:206,63:me}),r(u,[2,252]),{19:208,28:F,29:k,52:209,53:G,56:85},{29:[1,210]},r(l,[2,256]),{31:[1,211]},{31:[2,384]},{13:f,16:h,44:215,45:Me,55:220,82:N,87:d,89:Ve,145:212,172:221,185:213,187:214,231:It,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(A1,[2,265],{56:85,35:227,52:228,19:229,28:F,29:k,53:G}),r(Je,[2,260]),r(V,B,{58:205,62:206,23:230,63:me}),r(u,[2,268]),{6:[2,45]},r(e,t,{10:3,4:231}),{13:f,16:h,55:232,307:43,308:g},r(ue,[2,312]),{105:233,112:x1,122:234,132:[1,237],134:235,327:[1,238],334:[1,239]},r(we,[2,318]),r(ue,C1,{108:240,133:242,112:O1,132:P1}),r(He,[2,323]),{112:[1,244]},{112:[2,325]},r(Rt,[2,50]),r(W,bc,{135:245,136:246,143:247,144:248,31:F1,112:F1}),r(Rt,[2,51]),r(Rt,[2,52]),r(gn,[2,328],{119:249}),{29:Ue,114:250},r(gn,[2,56]),{29:Ue,114:251},r(w,[2,59]),r(Re,[2,270]),{47:[1,252]},r(I1,[2,150]),r(Sc,[2,428],{240:253}),r(Ms,[2,430],{244:254}),r(Ms,[2,155],{248:255,249:256,250:[2,438],290:[1,257],341:[1,258],342:[1,259],343:[1,260],344:[1,261],345:[1,262],346:[1,263]}),r(Vs,[2,440],{252:264}),r(At,[2,448],{260:265}),{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,255:154,257:155,264:266,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,255:154,257:155,264:267,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,255:154,257:155,264:268,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(At,[2,167]),r(At,[2,168]),r(At,[2,169]),r(At,[2,170],{176:269,45:R1,89:D1}),r(At,[2,171]),r(At,[2,172]),r(At,[2,173]),r(At,[2,174]),{13:f,16:h,44:136,45:H,46:272,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(mt,[2,176]),{89:[1,273]},{45:[1,274]},{45:[1,275]},{45:[1,276]},{45:[1,277]},{45:[1,278]},{45:N1,89:k1,179:279},{45:[1,282]},{45:[1,284],89:[1,283]},{279:[1,285]},r(rr,[2,192],{292:[1,286],293:[1,287]}),r(rr,[2,195]),r(rr,[2,196]),r(rr,[2,197]),r(rr,[2,198]),r(rr,[2,199]),r(rr,[2,200]),{13:f,16:h,44:39,55:40,82:N,87:d,139:289,172:291,255:154,257:155,266:290,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,320:288},{45:[1,292]},{45:[1,293]},{45:[1,294]},r(Za,[2,452]),r(Za,[2,453]),r(Za,[2,454]),r(Za,[2,455]),r(Za,[2,456]),{279:[2,458]},r(Ec,[2,207]),r(Ec,[2,208]),r(Ec,[2,209]),r(Ec,[2,210]),r(rr,[2,201]),r(rr,[2,202]),r(rr,[2,203]),r(rr,[2,204]),r(rr,[2,205]),r(rr,[2,206]),r(e,[2,5]),r(Tc,[2,297],{88:295}),r(Ac,[2,299],{90:296}),{48:[1,297],87:[1,298]},r(xc,[2,301]),r(U,[2,43]),r(U,[2,82]),r(U,[2,83]),{29:[1,299]},{29:[1,300]},{87:[1,302],169:301},r(c,[2,412]),r(Kn,[2,123]),r(Kn,[2,416],{221:303,339:304,39:[1,306],263:[1,307],340:[1,305]}),r(Si,[2,124]),{13:f,16:h,45:[1,311],55:194,89:[1,310],197:Ke,223:312,225:308,226:309,229:j1,307:43,308:g},r(c,n,{215:10,214:314}),r(Si,[2,236]),r(Si,[2,237]),r($s,[2,6]),r(Lf,[2,287],{60:315,72:316,73:[1,317]}),r(it,[2,286]),{13:f,16:h,45:H,55:323,67:321,68:322,71:318,77:320,79:319,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,307:43,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C},r([6,31,63,70,73,81,83,85],[2,20]),r(W,L1,{38:17,49:324,147:325,17:326,21:327,148:328,154:329,155:330,29:Gi,31:Gi,85:Gi,112:Gi,159:Gi,160:Gi,161:Gi,163:Gi,164:Gi,41:s}),{13:f,16:h,55:331,307:43,308:g},r(ue,[2,280]),r($s,[2,7]),r(it,_e,{59:197,69:198,20:332,70:j}),r(V,[2,284]),{64:[1,333]},r(V,B,{58:205,62:206,23:334,63:me}),r(u,[2,254]),r(W,bc,{144:248,30:335,143:336,31:[2,257]}),r(u,[2,100]),{31:[2,387],184:337,335:[1,338]},{13:f,16:h,44:39,55:40,87:d,139:342,186:339,190:340,195:341,197:Qn,307:43,308:g},r(eo,[2,389],{44:39,55:40,307:43,190:340,195:341,139:342,188:344,189:345,186:346,13:f,16:h,87:d,197:Qn,308:g}),r(Wi,[2,227]),r(Wi,[2,228]),r(Wi,[2,229]),{13:f,16:h,44:215,45:Me,55:220,82:N,87:d,89:Ve,172:221,185:351,187:350,200:348,230:347,231:It,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},{13:f,16:h,44:39,55:40,87:d,139:342,186:352,190:340,195:341,197:Qn,307:43,308:g},r(Wi,[2,146]),r(Wi,[2,147]),r(Wi,[2,148]),r(Wi,[2,149]),{13:f,16:h,44:354,55:355,82:N,87:d,172:357,237:356,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:358,312:tr,313:353},r(Mf,[2,215]),r(Mf,[2,216]),r(V,B,{58:205,62:206,23:359,63:me}),r(Ie,[2,264]),r(A1,[2,266]),r($s,[2,11]),r(i,[2,308],{6:[2,310]}),r(Rt,[2,313],{102:360,120:361,121:[1,362]}),r(Rt,[2,47]),r(Rt,[2,63]),r(Rt,[2,64]),{13:f,16:h,55:363,307:43,308:g},r(Rt,[2,336]),r(Rt,[2,337]),r(Rt,[2,338]),{109:[1,364]},r(M1,[2,60]),{13:f,16:h,55:365,307:43,308:g},r(ue,[2,335]),{13:f,16:h,55:366,307:43,308:g},{31:[1,367]},r(Yn,[2,341],{137:368}),r(Yn,[2,340]),{13:f,16:h,44:215,45:Me,55:220,82:N,87:d,89:Ve,145:369,172:221,185:213,187:214,231:It,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},{28:[1,370],127:371,128:[1,372]},r(gn,[2,330],{124:373,125:374,126:Ze}),r(gn,[2,57]),{44:375,87:d},r(I1,[2,151],{241:376,242:[1,377]}),r(Sc,[2,153],{245:378,246:[1,379]}),{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,247:380,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{250:[1,381]},r(gt,[2,432]),r(gt,[2,433]),r(gt,[2,434]),r(gt,[2,435]),r(gt,[2,436]),r(gt,[2,437]),{250:[2,439]},r([47,48,193,242,246,250,272,290,341,342,343,344,345,346],[2,158],{253:382,254:383,255:384,257:385,263:[1,386],265:[1,387],297:Z,298:ee,299:te,300:X,301:ne,302:ce}),r(Vs,[2,162],{261:388,262:389,39:Vf,338:$f}),r(At,[2,164]),r(At,[2,165]),r(At,[2,166]),r(mt,[2,95]),r(mt,[2,96]),r(gt,[2,377],{177:392,325:[1,393]}),{48:[1,394]},r(mt,[2,177]),{13:f,16:h,44:136,45:H,46:395,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:396,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:397,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:398,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:399,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(mt,[2,183]),r(mt,[2,98]),r(gt,[2,381],{180:400}),{87:[1,401]},r(mt,[2,185]),{13:f,16:h,44:136,45:H,46:402,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{29:L,57:403},r(rr,[2,193]),{13:f,16:h,55:404,307:43,308:g},{13:f,16:h,44:39,55:40,87:d,139:342,195:405,197:Qn,307:43,308:g},r(yn,[2,233]),r(yn,[2,234]),r(yn,[2,235]),r(V1,[2,459],{281:406,325:[1,407]}),r(gt,[2,463],{284:408,325:[1,409]}),r(gt,[2,465],{286:410,325:[1,411]}),{13:f,16:h,31:[1,412],55:414,82:N,171:413,172:415,173:416,174:Cc,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:Oc},{31:[1,419],89:[1,420]},{29:[1,421]},r(xc,[2,302]),r(Tc,[2,367],{167:422}),r(Ac,[2,369],{168:423}),{48:[1,424],87:[1,425]},r(xc,[2,371]),r(Kn,[2,122]),r(Kn,[2,417]),r(Kn,[2,413]),r(Kn,[2,414]),r(Kn,[2,415]),r(Si,[2,125]),r(Si,[2,127]),r(Si,[2,128]),r($1,[2,420],{227:426}),r(Si,[2,130]),{13:f,16:h,55:194,197:Ke,223:427,307:43,308:g},{48:[1,428]},r(vn,[2,289],{61:429,80:430,81:[1,431],83:[1,432]}),r(Lf,[2,288]),{64:[1,433]},r(it,[2,29],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:434,13:f,16:h,45:H,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,276:Oe,277:le,279:Se,280:de,283:Ee,285:Pe,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C}),r(q1,[2,293]),r(qf,[2,92]),r(qf,[2,93]),r(qf,[2,94]),{45:R1,89:D1,176:269},{31:[1,435]},{31:[1,436]},{19:437,28:F,29:k,56:85},{19:438,28:F,29:k,56:85},r(Xn,[2,355],{149:439}),r(Xn,[2,354]),{13:f,16:h,44:215,45:Pc,55:220,82:N,87:d,89:Ve,156:440,172:221,185:441,203:442,231:Fc,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(Ie,[2,19]),r(vn,[2,21]),{13:f,16:h,44:450,45:B1,55:323,65:445,66:446,67:447,68:448,87:d,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,307:43,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C},r($s,[2,8]),{31:[1,451]},{31:[2,258]},{31:[2,101]},r(W,[2,386],{31:[2,388]}),r(eo,[2,102]),r(Jn,[2,391],{191:452}),r(W,[2,395],{196:453,198:454}),r(W,[2,108]),r(W,[2,109]),r(eo,[2,103]),r(eo,[2,104]),r(eo,[2,390]),{13:f,16:h,44:215,45:Me,48:[1,455],55:220,82:N,87:d,89:Ve,172:221,185:351,187:350,200:456,231:It,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(Ic,[2,424]),r(U1,[2,136]),r(U1,[2,137]),r(Bf,[2,140]),{232:[1,457]},{13:f,16:h,44:39,55:40,87:d,139:342,195:458,197:Qn,307:43,308:g},r(yn,[2,219]),r(yn,[2,220]),r(yn,[2,221]),r(yn,[2,222]),r(yn,[2,223]),r($s,[2,10]),r(Rt,[2,46]),r(Rt,[2,314]),{112:x1,122:459},r(Rt,[2,62]),r(ue,C1,{133:242,108:460,112:O1,132:P1}),r(M1,[2,61]),r(Rt,[2,49]),r([6,28,126,128,193],[2,65]),{31:[2,66],112:[1,462],138:461},r(Yn,[2,351],{146:463,335:[1,464]}),{29:L,57:465},r(gn,[2,329]),r(ue,[2,332],{129:466,327:[1,467]}),r(gn,[2,55]),r(gn,[2,331]),{48:[1,468]},r(Sc,[2,429]),{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,239:469,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(Ms,[2,431]),{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,243:470,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(Ms,[2,156]),{45:N1,89:k1,179:471},r(Vs,[2,441]),{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,251:472,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(At,[2,444],{256:473}),r(At,[2,446],{258:474}),r(gt,[2,442]),r(gt,[2,443]),r(At,[2,449]),{13:f,16:h,44:136,45:H,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,255:154,257:155,259:475,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(gt,[2,450]),r(gt,[2,451]),r(gt,[2,379],{178:476}),r(gt,[2,378]),r([6,13,16,29,31,39,45,47,48,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,175]),{48:[1,477]},{48:[1,478]},{272:[1,479]},{272:[1,480]},{272:[1,481]},{13:f,16:h,44:136,45:H,46:482,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{48:[1,483]},{48:[1,484]},r(mt,[2,187]),r(rr,[2,194]),{13:f,16:h,44:39,55:40,82:N,87:d,139:289,172:291,255:154,257:155,266:290,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,320:485},{13:f,16:h,39:[1,487],44:136,45:H,46:488,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,282:486,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(V1,[2,460]),{13:f,16:h,44:136,45:H,46:489,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(gt,[2,464]),{13:f,16:h,44:136,45:H,46:490,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(gt,[2,466]),r(U,[2,40]),r(Tc,[2,298]),r(to,[2,87]),r(to,[2,88]),r(to,[2,89]),r(to,[2,90]),{13:f,16:h,55:492,82:N,172:493,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,311:494,312:tr,315:491},r(U,[2,41]),r(Ac,[2,300]),r(ro,[2,303],{92:495}),{13:f,16:h,31:[1,496],55:414,82:N,171:497,172:415,173:416,174:Cc,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:Oc},{31:[1,498],89:[1,499]},{29:[1,500]},r(xc,[2,372]),{13:f,16:h,48:[2,422],55:194,197:Ke,223:312,226:502,228:501,229:j1,307:43,308:g},r(Si,[2,131]),r(Si,[2,126]),r(vn,[2,22]),r(vn,[2,290]),{82:[1,503]},{82:[1,504]},{13:f,16:h,44:510,45:H,55:323,67:321,68:322,74:505,75:506,76:G1,77:320,78:W1,79:509,87:d,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,307:43,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(q1,[2,294]),r(z1,[2,69]),r(z1,[2,70]),r(it,_e,{59:197,69:198,20:511,70:j}),r(V,B,{58:205,62:206,23:512,63:me}),{29:[2,375],31:[2,71],84:522,85:a,112:[1,518],150:513,151:514,158:515,159:[1,516],160:[1,517],161:[1,519],163:[1,520],164:[1,521],175:523},r(Xn,[2,363],{157:524,335:[1,525]}),r(c,n,{215:10,202:526,205:527,208:528,214:529,44:530,87:d}),r(Rc,[2,399],{215:10,205:527,208:528,214:529,44:530,204:531,202:532,13:n,16:n,45:n,197:n,224:n,229:n,308:n,87:d}),{13:f,16:h,44:215,45:Pc,55:220,82:N,87:d,89:Ve,172:221,185:351,203:536,212:534,231:Fc,233:533,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(c,n,{215:10,205:527,208:528,214:529,44:530,202:537,87:d}),r(V,[2,23],{307:43,267:139,275:146,278:149,55:323,67:447,68:448,44:450,66:538,13:f,16:h,45:B1,87:d,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,276:Oe,277:le,279:Se,280:de,283:Ee,285:Pe,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C}),r(Zn,[2,291]),r(Zn,[2,24]),r(Zn,[2,25]),{13:f,16:h,44:136,45:H,46:539,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(Zn,[2,28]),r(V,B,{58:205,62:206,23:540,63:me}),r([31,112,232,318,335],[2,105],{192:541,193:[1,542]}),r(Jn,[2,107]),{13:f,16:h,44:215,45:Me,55:220,82:N,87:d,89:Ve,172:221,185:351,187:350,199:543,200:544,231:It,234:349,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(H1,[2,132]),r(Ic,[2,425]),r(H1,[2,133]),{13:f,16:h,44:354,55:355,82:N,87:d,172:357,237:356,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:358,312:tr,313:545},r(Rt,[2,54]),r(Rt,[2,48]),r(Yn,[2,342]),{13:f,16:h,44:39,55:40,87:d,139:546,307:43,308:g},r(Yn,[2,68]),r(W,[2,350],{31:K1,112:K1}),r(Rt,[2,53]),{13:f,16:h,55:547,307:43,308:g},r(ue,[2,333]),r(Re,[2,16]),r(Sc,[2,152]),r(Ms,[2,154]),r(Ms,[2,157]),r(Vs,[2,159]),r(Vs,[2,160],{262:389,261:548,39:Vf,338:$f}),r(Vs,[2,161],{262:389,261:549,39:Vf,338:$f}),r(At,[2,163]),{13:f,16:h,44:136,45:H,46:550,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(mt,[2,178]),r(mt,[2,179]),{13:f,16:h,44:136,45:H,46:551,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:552,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:553,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{48:[1,554],272:[1,555]},r(mt,[2,184]),r(mt,[2,186]),{314:[1,556]},{48:[1,557]},{48:[2,461]},{48:[2,462]},{48:[1,558]},{48:[2,467],193:[1,561],287:559,288:560},{13:f,16:h,55:194,197:Ke,223:562,307:43,308:g},r(Uf,[2,224]),r(Uf,[2,225]),r(Uf,[2,226]),{31:[1,563],45:Q1,94:564},r(U,[2,84]),r(Tc,[2,368]),r(U,[2,85]),r(Ac,[2,370]),r(ro,[2,373],{170:566}),{48:[1,567]},{48:[2,423],337:[1,568]},r(vn,[2,35],{83:[1,569]}),r(vn,[2,36],{81:[1,570]}),r(Lf,[2,30],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:509,44:510,75:571,13:f,16:h,45:H,76:G1,78:W1,87:d,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,276:Oe,277:le,279:Se,280:de,283:Ee,285:Pe,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C}),r(qs,[2,295]),{45:H,77:572},{45:H,77:573},r(qs,[2,33]),r(qs,[2,34]),{31:[2,275],50:574,84:575,85:a},{31:[2,277],51:576,84:577,85:a},r(Xn,[2,356]),r(Y1,[2,357],{152:578,335:[1,579]}),r(zi,[2,74]),{29:L,57:580},{29:L,57:581},{13:f,16:h,44:39,55:40,87:d,139:582,307:43,308:g},r(X1,[2,365],{162:583,328:[1,584]}),{13:f,16:h,45:H,55:323,67:321,68:322,77:320,79:585,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,307:43,308:g,346:Fe,347:ve,348:_,349:E,350:v,351:C},{45:[1,586]},r(zi,[2,81]),{29:L,57:587},r(Xn,[2,73]),r(W,[2,362],{29:Hi,31:Hi,85:Hi,112:Hi,159:Hi,160:Hi,161:Hi,163:Hi,164:Hi}),r(Rc,[2,112]),r(Bs,[2,401],{206:588}),r(W,[2,405],{209:589,210:590}),r(W,[2,403]),r(W,[2,404]),r(Rc,[2,113]),r(Rc,[2,400]),{13:f,16:h,44:215,45:Pc,48:[1,591],55:220,82:N,87:d,89:Ve,172:221,185:351,203:536,212:592,231:Fc,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(Ic,[2,426]),r(Bf,[2,138]),r(Bf,[2,139]),{232:[1,593]},r(Zn,[2,292]),{47:[1,595],48:[1,594]},r($s,[2,9]),r(Jn,[2,392]),r(Jn,[2,393],{44:39,55:40,307:43,195:341,139:342,194:596,190:597,13:f,16:h,87:d,197:Qn,308:g}),r(Jn,[2,110],{272:[1,598]}),r(Dc,[2,397],{201:599,316:600,317:[1,601]}),{314:[1,602]},{29:[1,603]},r(gn,[2,58]),r(At,[2,445]),r(At,[2,447]),{48:[1,604],272:[1,605]},{48:[1,606]},{272:[1,607]},{272:[1,608]},r(mt,[2,99]),r(gt,[2,382]),r([13,16,39,47,48,87,193,197,242,246,250,263,265,272,290,297,298,299,300,301,302,308,314,338,341,342,343,344,345,346],[2,232]),r(mt,[2,188]),r(mt,[2,189]),{48:[1,609]},{48:[2,468]},{289:[1,610]},{13:f,16:h,55:492,82:N,172:493,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,311:494,312:tr,315:611},r(U,[2,42]),r(ro,[2,304]),{13:f,16:h,55:414,82:N,95:612,171:613,172:415,173:416,174:Cc,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:Oc},{31:[1,614],45:Q1,94:615},r(Si,[2,129]),r($1,[2,421]),{82:[1,616]},{82:[1,617]},r(qs,[2,296]),r(qs,[2,31]),r(qs,[2,32]),{31:[2,17]},{31:[2,276]},{31:[2,18]},{31:[2,278]},r(W,L1,{155:330,153:618,154:619,29:Ki,31:Ki,85:Ki,112:Ki,159:Ki,160:Ki,161:Ki,163:Ki,164:Ki}),r(Y1,[2,358]),r(zi,[2,75]),r(zi,[2,76]),{29:L,57:620},{13:f,16:h,44:39,55:40,87:d,139:621,307:43,308:g},r(X1,[2,366]),r(zi,[2,79]),{13:f,16:h,44:136,45:H,46:622,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(zi,[2,91],{336:[1,623]}),r([29,31,85,112,159,160,161,163,164,232,318,335],[2,114],{207:624,193:[1,625]}),r(Bs,[2,117]),{13:f,16:h,44:215,45:Pc,55:220,82:N,87:d,89:Ve,172:221,185:351,203:536,211:626,212:627,231:Fc,234:535,236:216,237:222,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,309:yr,310:Ar,311:217,312:tr},r(Wi,[2,134]),r(Ic,[2,427]),r(Wi,[2,135]),r(Zn,[2,26]),{44:628,87:d},r(Jn,[2,106]),r(Jn,[2,394]),r(W,[2,396]),r(Dc,[2,111]),r(Dc,[2,398]),{13:f,16:h,44:39,55:40,87:d,139:342,186:629,190:340,195:341,197:Qn,307:43,308:g},r(Mf,[2,217]),r(W,bc,{144:248,140:630,143:631,31:[2,343]}),r(mt,[2,97]),r(gt,[2,380]),r(mt,[2,180]),{13:f,16:h,44:136,45:H,46:632,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},{13:f,16:h,44:136,45:H,46:633,55:133,67:132,68:134,77:131,82:N,87:d,172:135,224:Le,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:Ge,264:130,265:M,266:137,267:139,268:he,269:Ae,270:z,271:xe,273:Ce,274:be,275:146,276:Oe,277:le,278:149,279:Se,280:de,283:Ee,285:Pe,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:De,346:Fe,347:ve,348:_,349:E,350:v,351:C},r(mt,[2,190]),{290:[1,634]},{314:[1,635]},{13:f,16:h,48:[1,636],55:414,82:N,171:637,172:415,173:416,174:Cc,255:154,257:155,291:150,294:J,295:re,296:ie,297:Z,298:ee,299:te,300:X,301:ne,302:ce,303:se,304:ae,305:Q,306:oe,307:43,308:g,312:Oc},r(J1,[2,305]),r(U,[2,86]),r(ro,[2,374]),r(vn,[2,37]),r(vn,[2,38]),r(Xn,[2,72]),r(Xn,[2,360]),r(zi,[2,77]),{29:L,57:638},{47:[1,639]},{29:[2,376]},r(Bs,[2,402]),r(Bs,[2,115],{215:10,208:528,214:529,44:530,205:640,13:n,16:n,45:n,197:n,224:n,229:n,308:n,87:d}),r(Bs,[2,118],{272:[1,641]}),r(Nc,[2,407],{213:642,319:643,317:[1,644]}),{48:[1,645]},{318:[1,646]},{31:[1,647]},{31:[2,344]},{48:[1,648]},{48:[1,649]},{291:650,303:se,304:ae,305:Q,306:oe},r(to,[2,218]),r(ro,[2,44]),r(J1,[2,306]),r(zi,[2,78]),{44:651,87:d},r(Bs,[2,116]),r(W,[2,406]),r(Nc,[2,119]),r(Nc,[2,408]),r(c,n,{215:10,205:527,208:528,214:529,44:530,202:652,87:d}),r(Zn,[2,27]),r(Dc,[2,230]),r(Z1,[2,345],{141:653,335:[1,654]}),r(mt,[2,181]),r(mt,[2,182]),{48:[2,191]},{48:[1,655]},{318:[1,656]},r(W,bc,{144:248,142:657,143:658,31:e0,112:e0}),r(Z1,[2,346]),r(zi,[2,80]),r(Nc,[2,231]),r(Yn,[2,67]),r(Yn,[2,348])],defaultActions:{5:[2,240],6:[2,241],7:[2,242],9:[2,239],24:[2,1],25:[2,2],26:[2,244],87:[2,282],94:[2,384],100:[2,45],109:[2,325],166:[2,458],263:[2,439],336:[2,258],337:[2,101],487:[2,461],488:[2,462],560:[2,468],574:[2,17],575:[2,276],576:[2,18],577:[2,278],623:[2,376],631:[2,344],650:[2,191]},parseError:o(function(T,P){if(P.recoverable)this.trace(T);else{var I=new Error(T);throw I.hash=P,I}},"parseError"),parse:o(function(T){var P=this,I=[0],K=[],ye=[null],p=[],nr=this.table,m="",Ai=0,ao=0,Mc=0,Vc=2,oo=1,$c=p.slice.call(arguments,1),ft=Object.create(this.lexer),xi={yy:{}};for(var co in this.yy)Object.prototype.hasOwnProperty.call(this.yy,co)&&(xi.yy[co]=this.yy[co]);ft.setInput(T,xi.yy),xi.yy.lexer=ft,xi.yy.parser=this,typeof ft.yylloc>"u"&&(ft.yylloc={});var Hs=ft.yylloc;p.push(Hs);var Qe=ft.options&&ft.options.ranges;typeof xi.yy.parseError=="function"?this.parseError=xi.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function ct(Ci){I.length=I.length-2*Ci,ye.length=ye.length-Ci,p.length=p.length-Ci}o(ct,"popStack");for(var $e=o(function(){var Ci;return Ci=ft.lex()||oo,typeof Ci!="number"&&(Ci=P.symbols_[Ci]||Ci),Ci},"lex"),ze,vr,is,Nr,$7,rh,Ks={},qc,Xi,h0,Bc;;){if(is=I[I.length-1],this.defaultActions[is]?Nr=this.defaultActions[is]:((ze===null||typeof ze>"u")&&(ze=$e()),Nr=nr[is]&&nr[is][ze]),typeof Nr>"u"||!Nr.length||!Nr[0]){var ih="";Bc=[];for(qc in nr[is])this.terminals_[qc]&&qc>Vc&&Bc.push("'"+this.terminals_[qc]+"'");ft.showPosition?ih="Parse error on line "+(Ai+1)+`:
`+ft.showPosition()+`
Expecting `+Bc.join(", ")+", got '"+(this.terminals_[ze]||ze)+"'":ih="Parse error on line "+(Ai+1)+": Unexpected "+(ze==oo?"end of input":"'"+(this.terminals_[ze]||ze)+"'"),this.parseError(ih,{text:ft.match,token:this.terminals_[ze]||ze,line:ft.yylineno,loc:Hs,expected:Bc})}if(Nr[0]instanceof Array&&Nr.length>1)throw new Error("Parse Error: multiple actions possible at state: "+is+", token: "+ze);switch(Nr[0]){case 1:I.push(ze),ye.push(ft.yytext),p.push(ft.yylloc),I.push(Nr[1]),ze=null,vr?(ze=vr,vr=null):(ao=ft.yyleng,m=ft.yytext,Ai=ft.yylineno,Hs=ft.yylloc,Mc>0&&Mc--);break;case 2:if(Xi=this.productions_[Nr[1]][1],Ks.$=ye[ye.length-Xi],Ks._$={first_line:p[p.length-(Xi||1)].first_line,last_line:p[p.length-1].last_line,first_column:p[p.length-(Xi||1)].first_column,last_column:p[p.length-1].last_column},Qe&&(Ks._$.range=[p[p.length-(Xi||1)].range[0],p[p.length-1].range[1]]),rh=this.performAction.apply(Ks,[m,ao,Ai,xi.yy,Nr[1],ye,p].concat($c)),typeof rh<"u")return rh;Xi&&(I=I.slice(0,-1*Xi*2),ye=ye.slice(0,-1*Xi),p=p.slice(0,-1*Xi)),I.push(this.productions_[Nr[1]][0]),ye.push(Ks.$),p.push(Ks._$),h0=nr[I[I.length-2]][I[I.length-1]],I.push(h0);break;case 3:return!0}}return!0},"parse")},kc=sm().Wildcard,jc="http://www.w3.org/1999/02/22-rdf-syntax-ns#",wS=jc+"type",bS=jc+"first",SS=jc+"rest",t0=jc+"nil",Lc="http://www.w3.org/2001/XMLSchema#",r0=Lc+"integer",i0=Lc+"decimal",n0=Lc+"double",ES=Lc+"boolean",es="",s0="",a0="";function ir(A){return A.toLowerCase()}o(ir,"lowercase");function Qi(A,T){return A.push(T),A}o(Qi,"appendTo");function ts(A,T){return A.push.apply(A,T),A}o(ts,"appendAllTo");function ht(A){A||(A={});for(var T=1,P=arguments.length,I;T<P&&(I=arguments[T]||{});T++)for(var K in I)A[K]=I[K];return A}o(ht,"extend");function Ei(){for(var A=[],T=0,P=arguments.length;T<P;T++)A=A.concat.apply(A,arguments[T]);return A}o(Ei,"unionAll");function io(A){if(A[0]==="<"&&(A=A.substring(1,A.length-1)),/^[a-z][a-z0-9.+-]*:/i.test(A))return A;if(!Te.base)throw new Error("Cannot resolve relative IRI "+A+" because no base IRI was set.");switch(es!==Te.base&&(es=Te.base,s0=es.replace(/[^\/:]*$/,""),a0=es.match(/^(?:[a-z]+:\/*)?[^\/]*/)[0]),A[0]){case void 0:return es;case"#":return es+A;case"?":return es.replace(/(?:\?.*)?$/,A);case"/":return a0+A;default:return s0+A}}o(io,"resolveIRI");function Wf(A){if(A){var T=A[0];if(T==="?"||T==="$")return Te.factory.variable(A.substr(1))}return A}o(Wf,"toVar");function Dt(A,T){return{type:"operation",operator:A,args:T||[]}}o(Dt,"operation");function Us(A,T){var P={expression:A==="*"?new kc:A};if(T)for(var I in T)P[I]=T[I];return P}o(Us,"expression");function Gs(A,T){return{type:"path",pathType:A,items:T}}o(Gs,"path");function zf(A,T){for(var P=0,I=T.length,K;P<I&&(K=T[P]);P++)A=Dt(K[0],[A,K[1]]);return A}o(zf,"createOperationTree");function rs(A,T){var P=[],I=[],K=A.length,ye,p={};if(!K)return null;for(var nr=0;nr<K&&(ye=A[nr]);nr++)(ye.named?I:P).push(ye.iri);return p[T||"from"]={default:P,named:I},p}o(rs,"groupDatasets");function Ws(A){return parseInt(A,10)}o(Ws,"toInt");function Hf(A){return A.type==="group"&&A.patterns.length===1?A.patterns[0]:A}o(Hf,"degroupSingle");function Ti(A,T){return T&&T.termType!=="NamedNode"&&(T=Te.factory.namedNode(T)),Te.factory.literal(A,T)}o(Ti,"createTypedLiteral");function TS(A,T){return Te.factory.literal(A,T)}o(TS,"createLangLiteral");function Kf(A,T,P){if(!("termType"in T))throw new Error("Nested triples cannot contain paths");return Te.factory.quad(A,T,P)}o(Kf,"nestedTriple");function Yi(A,T,P,I){var K={};return A!=null&&(K.subject=A),T!=null&&(K.predicate=T),P!=null&&(K.object=P),I!=null&&(K.annotations=I),K}o(Yi,"triple");function no(A){return typeof A=="string"?A.startsWith("e_")?Te.factory.blankNode(A):Te.factory.blankNode("e_"+A):Te.factory.blankNode("g_"+o0++)}o(no,"blank");var o0=0;Te._resetBlanks=function(){o0=0};var AS=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\(.)/g,xS={"\\":"\\","'":"'",'"':'"',t:"	",b:"\b",n:`
`,r:"\r",f:"\f"},CS=/[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/,Qf=String.fromCharCode;function c0(A,T){A=A.substring(T,A.length-T);try{A=A.replace(AS,function(P,I,K,ye){var p;if(I){if(p=parseInt(I,16),isNaN(p))throw new Error;return Qf(p)}else if(K){if(p=parseInt(K,16),isNaN(p))throw new Error;return p<65535?Qf(p):Qf(55296+((p-=65536)>>10),56320+(p&1023))}else{var nr=xS[ye];if(!nr)throw new Error;return nr}})}catch{return""}if(CS.exec(A))throw new Error("Invalid unicode codepoint of surrogate pair without corresponding codepoint in "+A);return A}o(c0,"unescapeString");function OS(A){var T=no(),P=T,I=[],K,ye=[];A.forEach(function(Ai){I.push(Ai.entity),ts(ye,Ai.triples)});for(var p=0,nr=0,m=I.length,K=Array(m*2);p<m;)K[nr++]=Yi(P,Te.factory.namedNode(bS),I[p]),K[nr++]=Yi(P,Te.factory.namedNode(SS),P=++p<m?no():Te.factory.namedNode(t0));return{entity:T,triples:ts(K,ye)}}o(OS,"createList");function PS(A){var T=no();return{entity:T,triples:A.map(function(P){return ht(Yi(T),P)})}}o(PS,"createAnonymousObject");function Yf(A,T,P){var I=[],K=[];return T.forEach(function(ye){let p=null;ye.annotation&&(p=ye.annotation,ye=ye.object),I.push(Yi(null,A,ye.entity,p)),ts(K,ye.triples)}),Ei(I,P||[],K)}o(Yf,"objectListToTriples");function M7(A){for(var T=[],P,I=0,K;K=A[I];I++)switch(K.type){case"bgp":K.triples.length&&(P?ts(P.triples,K.triples):Qi(T,P=K));break;default:(!K.patterns||K.patterns.length>0)&&(Qi(T,K),P=null)}return T}o(M7,"mergeAdjacentBGPs");function zs(A){return A.variable?A.variable.value:A.value||A.expression.value}o(zs,"getExpressionId");function Xf(A){if(!A)return[];if(A.type==="aggregate")return[A];if(A.type==="operation"){let T=[];for(let P of A.args)T.push(...Xf(P));return T}return[]}o(Xf,"getAggregatesOfExpression");function FS(A){let T=new Set,P=o(function(I){I&&(I.termType==="Variable"?T.add(I):I.type==="operation"&&I.args.forEach(P))},"visitExpression");return P(A),T}o(FS,"getVariablesFromExpression");function Jf(A,T=1,P=[]){for(let I of A)T>0&&I instanceof Array?Jf(I,T-1,P):P.push(I);return P}o(Jf,"flatten");function Zf(A){return A.termType==="Variable"}o(Zf,"isVariable");function u0(A){if(A.triples){let T=[];for(let P of A.triples)Zf(P.subject)&&T.push(P.subject.value),Zf(P.predicate)&&T.push(P.predicate.value),Zf(P.object)&&T.push(P.object.value);return T}else if(A.patterns){let T=[];for(let P of A.patterns)T.push(...u0(P));return T}return[]}o(u0,"getBoundVarsFromGroupGraphPattern");function IS(A){let T=A.slice().sort(),P=[];for(let I=0;I<T.length-1;I++)T[I+1]==T[I]&&P.push(T[I]);return P}o(IS,"getDuplicatesInArray");function so(A){if(!Te.sparqlStar)throw new Error("SPARQL-star support is not enabled");return A}o(so,"ensureSparqlStar");function l0(A,T,P){for(let I of T){let K=Yi("subject"in I?I.subject:A,I.predicate,I.object);P.push(K),I.annotations&&l0(Kf(A,I.predicate,I.object),I.annotations,P)}}o(l0,"_applyAnnotations");function eh(A){if(Te.sparqlStar){let T=[];return A.forEach(P=>{let I=Yi(P.subject,P.predicate,P.object);T.push(I),P.annotations&&l0(Kf(P.subject,P.predicate,P.object),P.annotations,T)}),T}return A}o(eh,"applyAnnotations");function V7(A){if(!Te.sparqlStarNestedQuads)throw new Error("Lenient SPARQL-star support with nested quads is not enabled");return A}o(V7,"ensureSparqlStarNestedQuads");function f0(A){for(let T of A){if(T.type==="graph"&&T.name.termType==="Variable")throw new Error("Detected illegal variable in GRAPH");if(T.type==="bgp"||T.type==="graph"){for(let P of T.triples)if(P.subject.termType==="Variable"||P.predicate.termType==="Variable"||P.object.termType==="Variable")throw new Error("Detected illegal variable in BGP")}}return A}o(f0,"ensureNoVariables");function th(A){for(let T of A)if(T.type==="bgp"){for(let P of T.triples)if(P.subject.termType==="BlankNode"||P.predicate.termType==="BlankNode"||P.object.termType==="BlankNode")throw new Error("Detected illegal blank node in BGP")}return A}o(th,"ensureNoBnodes");var RS=(function(){var A={EOF:1,parseError:o(function(P,I){if(this.yy.parser)this.yy.parser.parseError(P,I);else throw new Error(P)},"parseError"),setInput:o(function(T,P){return this.yy=P||this.yy||{},this._input=T,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},"setInput"),input:o(function(){var T=this._input[0];this.yytext+=T,this.yyleng++,this.offset++,this.match+=T,this.matched+=T;var P=T.match(/(?:\r\n?|\n).*/g);return P?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),T},"input"),unput:o(function(T){var P=T.length,I=T.split(/(?:\r\n?|\n)/g);this._input=T+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-P),this.offset-=P;var K=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),I.length-1&&(this.yylineno-=I.length-1);var ye=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:I?(I.length===K.length?this.yylloc.first_column:0)+K[K.length-I.length].length-I[0].length:this.yylloc.first_column-P},this.options.ranges&&(this.yylloc.range=[ye[0],ye[0]+this.yyleng-P]),this.yyleng=this.yytext.length,this},"unput"),more:o(function(){return this._more=!0,this},"more"),reject:o(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},"reject"),less:o(function(T){this.unput(this.match.slice(T))},"less"),pastInput:o(function(){var T=this.matched.substr(0,this.matched.length-this.match.length);return(T.length>20?"...":"")+T.substr(-20).replace(/\n/g,"")},"pastInput"),upcomingInput:o(function(){var T=this.match;return T.length<20&&(T+=this._input.substr(0,20-T.length)),(T.substr(0,20)+(T.length>20?"...":"")).replace(/\n/g,"")},"upcomingInput"),showPosition:o(function(){var T=this.pastInput(),P=new Array(T.length+1).join("-");return T+this.upcomingInput()+`
`+P+"^"},"showPosition"),test_match:o(function(T,P){var I,K,ye;if(this.options.backtrack_lexer&&(ye={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ye.yylloc.range=this.yylloc.range.slice(0))),K=T[0].match(/(?:\r\n?|\n).*/g),K&&(this.yylineno+=K.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:K?K[K.length-1].length-K[K.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+T[0].length},this.yytext+=T[0],this.match+=T[0],this.matches=T,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(T[0].length),this.matched+=T[0],I=this.performAction.call(this,this.yy,this,P,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),I)return I;if(this._backtrack){for(var p in ye)this[p]=ye[p];return!1}return!1},"test_match"),next:o(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var T,P,I,K;this._more||(this.yytext="",this.match="");for(var ye=this._currentRules(),p=0;p<ye.length;p++)if(I=this._input.match(this.rules[ye[p]]),I&&(!P||I[0].length>P[0].length)){if(P=I,K=p,this.options.backtrack_lexer){if(T=this.test_match(I,ye[p]),T!==!1)return T;if(this._backtrack){P=!1;continue}else return!1}else if(!this.options.flex)break}return P?(T=this.test_match(P,ye[K]),T!==!1?T:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},"next"),lex:o(function(){var P=this.next();return P||this.lex()},"lex"),begin:o(function(P){this.conditionStack.push(P)},"begin"),popState:o(function(){var P=this.conditionStack.length-1;return P>0?this.conditionStack.pop():this.conditionStack[0]},"popState"),_currentRules:o(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},"_currentRules"),topState:o(function(P){return P=this.conditionStack.length-1-Math.abs(P||0),P>=0?this.conditionStack[P]:"INITIAL"},"topState"),pushState:o(function(P){this.begin(P)},"pushState"),stateStackSize:o(function(){return this.conditionStack.length},"stateStackSize"),options:{flex:!0,"case-insensitive":!0},performAction:o(function(P,I,K,ye){var p=ye;switch(K){case 0:break;case 1:return 12;case 2:return 15;case 3:return 41;case 4:return 325;case 5:return 326;case 6:return 45;case 7:return 47;case 8:return 48;case 9:return 39;case 10:return 24;case 11:return 28;case 12:return 29;case 13:return 31;case 14:return 32;case 15:return 36;case 16:return 53;case 17:return 327;case 18:return 63;case 19:return 64;case 20:return 70;case 21:return 73;case 22:return 76;case 23:return 78;case 24:return 81;case 25:return 83;case 26:return 85;case 27:return 193;case 28:return 100;case 29:return 328;case 30:return 121;case 31:return 329;case 32:return 330;case 33:return 110;case 34:return 331;case 35:return 109;case 36:return 332;case 37:return 333;case 38:return 113;case 39:return 115;case 40:return 116;case 41:return 131;case 42:return 123;case 43:return 126;case 44:return 128;case 45:return 132;case 46:return 112;case 47:return 334;case 48:return 335;case 49:return 159;case 50:return 161;case 51:return 164;case 52:return 174;case 53:return 160;case 54:return 336;case 55:return 163;case 56:return 312;case 57:return 314;case 58:return 317;case 59:return 318;case 60:return 272;case 61:return 197;case 62:return 337;case 63:return 338;case 64:return 229;case 65:return 340;case 66:return 263;case 67:return 224;case 68:return 231;case 69:return 232;case 70:return 242;case 71:return 246;case 72:return 290;case 73:return 341;case 74:return 342;case 75:return 343;case 76:return 344;case 77:return 345;case 78:return 250;case 79:return 346;case 80:return 265;case 81:return 276;case 82:return 277;case 83:return 268;case 84:return 269;case 85:return 270;case 86:return 271;case 87:return 347;case 88:return 348;case 89:return 273;case 90:return 274;case 91:return 350;case 92:return 349;case 93:return 351;case 94:return 279;case 95:return 280;case 96:return 283;case 97:return 285;case 98:return 289;case 99:return 293;case 100:return 296;case 101:return 13;case 102:return 16;case 103:return 308;case 104:return 309;case 105:return 87;case 106:return 292;case 107:return 82;case 108:return 294;case 109:return 295;case 110:return 297;case 111:return 298;case 112:return 299;case 113:return 300;case 114:return 301;case 115:return 302;case 116:return"EXPONENT";case 117:return 303;case 118:return 304;case 119:return 305;case 120:return 306;case 121:return 89;case 122:return 310;case 123:return 6;case 124:return"INVALID";case 125:console.log(I.yytext);break}},"anonymous"),rules:[/^(?:\s+|(#[^\n\r]*))/i,/^(?:BASE)/i,/^(?:PREFIX)/i,/^(?:SELECT)/i,/^(?:DISTINCT)/i,/^(?:REDUCED)/i,/^(?:\()/i,/^(?:AS)/i,/^(?:\))/i,/^(?:\*)/i,/^(?:CONSTRUCT)/i,/^(?:WHERE)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:DESCRIBE)/i,/^(?:ASK)/i,/^(?:FROM)/i,/^(?:NAMED)/i,/^(?:GROUP)/i,/^(?:BY)/i,/^(?:HAVING)/i,/^(?:ORDER)/i,/^(?:ASC)/i,/^(?:DESC)/i,/^(?:LIMIT)/i,/^(?:OFFSET)/i,/^(?:VALUES)/i,/^(?:;)/i,/^(?:LOAD)/i,/^(?:SILENT)/i,/^(?:INTO)/i,/^(?:CLEAR)/i,/^(?:DROP)/i,/^(?:CREATE)/i,/^(?:ADD)/i,/^(?:TO)/i,/^(?:MOVE)/i,/^(?:COPY)/i,/^(?:INSERT((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)WHERE)/i,/^(?:WITH)/i,/^(?:DELETE)/i,/^(?:INSERT)/i,/^(?:USING)/i,/^(?:DEFAULT)/i,/^(?:GRAPH)/i,/^(?:ALL)/i,/^(?:\.)/i,/^(?:OPTIONAL)/i,/^(?:SERVICE)/i,/^(?:BIND)/i,/^(?:UNDEF)/i,/^(?:MINUS)/i,/^(?:UNION)/i,/^(?:FILTER)/i,/^(?:<<)/i,/^(?:>>)/i,/^(?:\{\|)/i,/^(?:\|\})/i,/^(?:,)/i,/^(?:a)/i,/^(?:\|)/i,/^(?:\/)/i,/^(?:\^)/i,/^(?:\?)/i,/^(?:\+)/i,/^(?:!)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\|\|)/i,/^(?:&&)/i,/^(?:=)/i,/^(?:!=)/i,/^(?:<)/i,/^(?:>)/i,/^(?:<=)/i,/^(?:>=)/i,/^(?:IN)/i,/^(?:NOT)/i,/^(?:-)/i,/^(?:BOUND)/i,/^(?:BNODE)/i,/^(?:(RAND|NOW|UUID|STRUUID))/i,/^(?:(LANG|DATATYPE|IRI|URI|ABS|CEIL|FLOOR|ROUND|STRLEN|STR|UCASE|LCASE|ENCODE_FOR_URI|YEAR|MONTH|DAY|HOURS|MINUTES|SECONDS|TIMEZONE|TZ|MD5|SHA1|SHA256|SHA384|SHA512|isIRI|isURI|isBLANK|isLITERAL|isNUMERIC))/i,/^(?:(SUBJECT|PREDICATE|OBJECT|isTRIPLE))/i,/^(?:(LANGMATCHES|CONTAINS|STRSTARTS|STRENDS|STRBEFORE|STRAFTER|STRLANG|STRDT|sameTerm))/i,/^(?:CONCAT)/i,/^(?:COALESCE)/i,/^(?:IF)/i,/^(?:TRIPLE)/i,/^(?:REGEX)/i,/^(?:SUBSTR)/i,/^(?:REPLACE)/i,/^(?:EXISTS)/i,/^(?:COUNT)/i,/^(?:SUM|MIN|MAX|AVG|SAMPLE)/i,/^(?:GROUP_CONCAT)/i,/^(?:SEPARATOR)/i,/^(?:\^\^)/i,/^(?:true|false)/i,/^(?:(<(?:[^<>\"\{\}\|\^`\\\u0000-\u0020])*>))/i,/^(?:((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:))/i,/^(?:(((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:)((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|:|[0-9]|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(_:(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?))/i,/^(?:([\?\$]((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])*)))/i,/^(?:(@[a-zA-Z]+(?:-[a-zA-Z0-9]+)*))/i,/^(?:([0-9]+))/i,/^(?:([0-9]*\.[0-9]+))/i,/^(?:([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+)))/i,/^(?:(\+([0-9]+)))/i,/^(?:(\+([0-9]*\.[0-9]+)))/i,/^(?:(\+([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:(-([0-9]+)))/i,/^(?:(-([0-9]*\.[0-9]+)))/i,/^(?:(-([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:([eE][+-]?[0-9]+))/i,/^(?:('(?:(?:[^\u0027\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*'))/i,/^(?:("(?:(?:[^\u0022\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*"))/i,/^(?:('''(?:(?:'|'')?(?:[^'\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*'''))/i,/^(?:("""(?:(?:"|"")?(?:[^\"\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*"""))/i,/^(?:(\((\u0020|\u0009|\u000D|\u000A)*\)))/i,/^(?:(\[(\u0020|\u0009|\u000D|\u000A)*\]))/i,/^(?:$)/i,/^(?:.)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125],inclusive:!0}}};return A})();Gf.lexer=RS;function Te(){this.yy={}}return o(Te,"Parser"),Te.prototype=Gf,Gf.Parser=Te,new Te})();K2.exports=W4});var Z2=y((lM,J2)=>{var z4="http://www.w3.org/2001/XMLSchema#integer",H4="http://www.w3.org/2001/XMLSchema#string";function nt(r){this._options=r=r||{};var e=r.prefixes||{};this._prefixByIri={};var t=[];for(var i in e){var n=e[i];Fo(n)&&(this._prefixByIri[n]=i,t.push(n))}var s=t.join("|").replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&");this._prefixRegex=new RegExp("^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$"),this._usedPrefixes={},this._sparqlStar=r.sparqlStar,this._indent=Fo(r.indent)?r.indent:"  ",this._newline=Fo(r.newline)?r.newline:`
`,this._explicitDatatype=!!r.explicitDatatype}o(nt,"Generator");nt.prototype.toQuery=function(r){var e="";return r.queryType&&(e+=r.queryType.toUpperCase()+" "),r.reduced&&(e+="REDUCED "),r.distinct&&(e+="DISTINCT "),r.variables?e+=Fr(r.variables,void 0,function(t){return/^[?$]/.test(t)?t:On(t)?this.toEntity(t):"("+this.toExpression(t.expression)+" AS "+el(t.variable)+")"},this)+" ":r.template&&(e+=this.group(r.template,!0)+this._newline),r.from&&(e+=this.graphs("FROM ",r.from.default)+this.graphs("FROM NAMED ",r.from.named)),r.where&&(e+="WHERE "+this.group(r.where,!0)+this._newline),r.updates&&(e+=Fr(r.updates,";"+this._newline,this.toUpdate,this)),r.group&&(e+="GROUP BY "+Fr(r.group,void 0,function(t){var i=On(t.expression)?this.toEntity(t.expression):"("+this.toExpression(t.expression)+")";return t.variable?"("+i+" AS "+el(t.variable)+")":i},this)+this._newline),r.having&&(e+="HAVING ("+Fr(r.having,void 0,this.toExpression,this)+")"+this._newline),r.order&&(e+="ORDER BY "+Fr(r.order,void 0,function(t){var i="("+this.toExpression(t.expression)+")";return t.descending?"DESC "+i:i},this)+this._newline),r.offset&&(e+="OFFSET "+r.offset+this._newline),r.limit&&(e+="LIMIT "+r.limit+this._newline),r.values&&(e+=this.values(r)),e=this.baseAndPrefixes(r)+e,e.trim()};nt.prototype.baseAndPrefixes=function(r){var e=r.base?"BASE <"+r.base+">"+this._newline:"",t="";for(var i in r.prefixes)(this._options.allPrefixes||this._usedPrefixes[i])&&(t+="PREFIX "+i+": <"+r.prefixes[i]+">"+this._newline);return e+t};nt.prototype.toPattern=function(r){var e=r.type||r instanceof Array&&"array"||(r.subject&&r.predicate&&r.object?"triple":"");if(!(e in this))throw new Error("Unknown entry type: "+e);return this[e](r)};nt.prototype.triple=function(r){return this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+"."};nt.prototype.array=function(r){return Fr(r,this._newline,this.toPattern,this)};nt.prototype.bgp=function(r){return this.encodeTriples(r.triples)};nt.prototype.encodeTriples=function(r){if(!r.length)return"";for(var e=[],t=void 0,i=void 0,n=0;n<r.length;n++){var s=r[n];bs(s.subject,t)?bs(s.predicate,i)?e.push(","):(i=s.predicate,e.push(";"+this._newline,this._indent,this.toEntity(i))):(t&&e.push("."+this._newline),t=s.subject,i=s.predicate,e.push(this.toEntity(t)," ",this.toEntity(i))),e.push(" ",this.toEntity(s.object))}return e.push("."),e.join("")};nt.prototype.graph=function(r){return"GRAPH "+this.toEntity(r.name)+" "+this.group(r)};nt.prototype.graphs=function(r,e){return!e||e.length===0?"":Fr(e,"",function(t){return r+this.toEntity(t)+this._newline},this)};nt.prototype.group=function(r,e){return r=e!==!0?this.array(r.patterns||r.triples):this.toPattern(r.type!=="group"?r:r.patterns),r.indexOf(this._newline)===-1?"{ "+r+" }":"{"+this._newline+this.indent(r)+this._newline+"}"};nt.prototype.query=function(r){return this.toQuery(r)};nt.prototype.filter=function(r){return"FILTER("+this.toExpression(r.expression)+")"};nt.prototype.bind=function(r){return"BIND("+this.toExpression(r.expression)+" AS "+el(r.variable)+")"};nt.prototype.optional=function(r){return"OPTIONAL "+this.group(r)};nt.prototype.union=function(r){return Fr(r.patterns,this._newline+"UNION"+this._newline,function(e){return this.group(e,!0)},this)};nt.prototype.minus=function(r){return"MINUS "+this.group(r)};nt.prototype.values=function(r){var e=Object.keys(r.values.reduce(function(n,s){for(var a in s)n[a]=!0;return n},{})),t,i;return e.length===1?t=i="":(t="(",i=")"),"VALUES "+t+e.join(" ")+i+" {"+this._newline+Fr(r.values,this._newline,function(n){return"  "+t+Fr(e,void 0,function(s){return n[s]?this.toEntity(n[s]):"UNDEF"},this)+i},this)+this._newline+"}"};nt.prototype.service=function(r){return"SERVICE "+(r.silent?"SILENT ":"")+this.toEntity(r.name)+" "+this.group(r)};nt.prototype.toExpression=function(r){if(On(r))return this.toEntity(r);switch(r.type.toLowerCase()){case"aggregate":return r.aggregation.toUpperCase()+"("+(r.distinct?"DISTINCT ":"")+this.toExpression(r.expression)+(typeof r.separator=="string"?'; SEPARATOR = "'+r.separator.replace(Y2,X2)+'"':"")+")";case"functioncall":return this.toEntity(r.function)+"("+Fr(r.args,", ",this.toExpression,this)+")";case"operation":var e=r.operator.toUpperCase(),t=r.args||[];switch(r.operator.toLowerCase()){case"<":case">":case">=":case"<=":case"&&":case"||":case"=":case"!=":case"+":case"-":case"*":case"/":return(On(t[0])?this.toEntity(t[0]):"("+this.toExpression(t[0])+")")+" "+e+" "+(On(t[1])?this.toEntity(t[1]):"("+this.toExpression(t[1])+")");case"!":return"!("+this.toExpression(t[0])+")";case"uplus":return"+("+this.toExpression(t[0])+")";case"uminus":return"-("+this.toExpression(t[0])+")";case"notin":e="NOT IN";case"in":return this.toExpression(t[0])+" "+e+"("+(Fo(t[1])?t[1]:Fr(t[1],", ",this.toExpression,this))+")";case"notexists":e="NOT EXISTS";case"exists":return e+" "+this.group(t[0],!0);default:return e+"("+Fr(t,", ",this.toExpression,this)+")"}default:throw new Error("Unknown expression type: "+r.type)}};nt.prototype.toEntity=function(r){if(On(r))switch(r.termType){case"Wildcard":return"*";case"Variable":return el(r);case"BlankNode":return"_:"+r.value;case"Literal":var e=r.value||"",t=r.language||"",i=r.datatype;if(r='"'+e.replace(Y2,X2)+'"',t)r+="@"+t;else if(i){if(!this._explicitDatatype)switch(i.value){case H4:return r;case z4:if(/^\d+$/.test(e))return e+" "}r+="^^"+this.encodeIRI(i.value)}return r;case"Quad":if(!this._sparqlStar)throw new Error("SPARQL* support is not enabled");return r.graph&&r.graph.termType!=="DefaultGraph"?"<< GRAPH "+this.toEntity(r.graph)+" { "+this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+" }  >>":"<< "+this.toEntity(r.subject)+" "+this.toEntity(r.predicate)+" "+this.toEntity(r.object)+" >>";default:return this.encodeIRI(r.value)}else{var n=r.items.map(this.toEntity,this),s=r.pathType;switch(s){case"^":case"!":return s+n[0];case"*":case"+":case"?":return"("+n[0]+s+")";default:return"("+n.join(s)+")"}}};var Y2=/["\\\t\n\r\b\f]/g,X2=o(function(r){return K4[r]},"escapeReplacer"),K4={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};nt.prototype.encodeIRI=function(r){var e=this._prefixRegex.exec(r);if(e){var t=this._prefixByIri[e[1]];return this._usedPrefixes[t]=!0,t+":"+e[2]}return"<"+r+">"};nt.prototype.toUpdate=function(r){switch(r.type||r.updateType){case"load":return"LOAD"+(r.source?" "+this.toEntity(r.source):"")+(r.destination?" INTO GRAPH "+this.toEntity(r.destination):"");case"insert":return"INSERT DATA "+this.group(r.insert,!0);case"delete":return"DELETE DATA "+this.group(r.delete,!0);case"deletewhere":return"DELETE WHERE "+this.group(r.delete,!0);case"insertdelete":return(r.graph?"WITH "+this.toEntity(r.graph)+this._newline:"")+(r.delete.length?"DELETE "+this.group(r.delete,!0)+this._newline:"")+(r.insert.length?"INSERT "+this.group(r.insert,!0)+this._newline:"")+(r.using?this.graphs("USING ",r.using.default):"")+(r.using?this.graphs("USING NAMED ",r.using.named):"")+"WHERE "+this.group(r.where,!0);case"add":case"copy":case"move":return r.type.toUpperCase()+" "+(r.silent?"SILENT ":"")+(r.source.default?"DEFAULT":this.toEntity(r.source.name))+" TO "+this.toEntity(r.destination.name);case"create":case"clear":case"drop":return r.type.toUpperCase()+(r.silent?" SILENT ":" ")+(r.graph.default?"DEFAULT":r.graph.named?"NAMED":r.graph.all?"ALL":"GRAPH "+this.toEntity(r.graph.name));default:throw new Error("Unknown update query type: "+r.type)}};nt.prototype.indent=function(r){return r.replace(/^/gm,this._indent)};function el(r){return"?"+r.value}o(el,"variableToString");function Fo(r){return typeof r=="string"}o(Fo,"isString");function On(r){return typeof r.termType=="string"}o(On,"isTerm");function bs(r,e){if(!r||!On(r)||!e||!On(e)||r.termType!==e.termType)return!1;switch(r.termType){case"Literal":return r.value===e.value&&r.language===e.language&&bs(r.datatype,e.datatype);case"Quad":return bs(r.subject,e.subject)&&bs(r.predicate,e.predicate)&&bs(r.object,e.object)&&bs(r.graph,e.graph);default:return r.value===e.value}}o(bs,"equalTerms");function Fr(r,e,t,i){return r.map(t,i).join(Fo(e)?e:" ")}o(Fr,"mapJoin");function Q4(r={}){return{stringify:o(function(e){var t=Object.create(r);return t.prefixes=e.prefixes,new nt(t).toQuery(e)},"stringify"),createGenerator:o(function(){return new nt(r)},"createGenerator")}}o(Q4,"_Generator");J2.exports={Generator:Q4}});var om=y(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0});tl.BlankNode=void 0;var am=class{static{o(this,"BlankNode")}constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&e.termType==="BlankNode"&&e.value===this.value}};tl.BlankNode=am});var cm=y(rl=>{"use strict";Object.defineProperty(rl,"__esModule",{value:!0});rl.DefaultGraph=void 0;var Io=class{static{o(this,"DefaultGraph")}constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&e.termType==="DefaultGraph"}};rl.DefaultGraph=Io;Io.INSTANCE=new Io});var nl=y(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});il.NamedNode=void 0;var um=class{static{o(this,"NamedNode")}constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&e.termType==="NamedNode"&&e.value===this.value}};il.NamedNode=um});var lm=y(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});sl.Literal=void 0;var e3=nl(),Ro=class r{static{o(this,"Literal")}constructor(e,t){this.termType="Literal",this.value=e,typeof t=="string"?(this.language=t,this.datatype=r.RDF_LANGUAGE_STRING):t?(this.language="",this.datatype=t):(this.language="",this.datatype=r.XSD_STRING)}equals(e){return!!e&&e.termType==="Literal"&&e.value===this.value&&e.language===this.language&&this.datatype.equals(e.datatype)}};sl.Literal=Ro;Ro.RDF_LANGUAGE_STRING=new e3.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString");Ro.XSD_STRING=new e3.NamedNode("http://www.w3.org/2001/XMLSchema#string")});var hm=y(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});al.Quad=void 0;var fm=class{static{o(this,"Quad")}constructor(e,t,i,n){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=i,this.graph=n}equals(e){return!!e&&(e.termType==="Quad"||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}};al.Quad=fm});var pm=y(ol=>{"use strict";Object.defineProperty(ol,"__esModule",{value:!0});ol.Variable=void 0;var dm=class{static{o(this,"Variable")}constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&e.termType==="Variable"&&e.value===this.value}};ol.Variable=dm});var r3=y(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});cl.DataFactory=void 0;var Y4=om(),X4=cm(),t3=lm(),J4=nl(),Z4=hm(),eP=pm(),tP=0,mm=class{static{o(this,"DataFactory")}constructor(e){this.blankNodeCounter=0,e=e||{},this.blankNodePrefix=e.blankNodePrefix||`df_${tP++}_`}namedNode(e){return new J4.NamedNode(e)}blankNode(e){return new Y4.BlankNode(e||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new t3.Literal(e,t)}variable(e){return new eP.Variable(e)}defaultGraph(){return X4.DefaultGraph.INSTANCE}quad(e,t,i,n){return new Z4.Quad(e,t,i,n||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(t3.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}};cl.DataFactory=mm});var i3=y(Ir=>{"use strict";var rP=Ir&&Ir.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),Ss=Ir&&Ir.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&rP(e,r,t)};Object.defineProperty(Ir,"__esModule",{value:!0});Ss(om(),Ir);Ss(r3(),Ir);Ss(cm(),Ir);Ss(lm(),Ir);Ss(nl(),Ir);Ss(hm(),Ir);Ss(pm(),Ir)});var s3=y((OM,n3)=>{var{Parser:an}=Q2(),{Generator:iP}=Z2(),{Wildcard:nP}=sm(),{DataFactory:sP}=i3();function aP({prefixes:r,baseIRI:e,factory:t,pathOnly:i,sparqlStar:n,skipValidation:s,skipUngroupedVariableCheck:a}={}){let c={};for(let l in r??{})c[l]=r[l];let u=new an;return u.parse=function(){return an.base=e||"",an.prefixes=Object.create(c),an.factory=t||new sP,an.sparqlStar=!!n,an.pathOnly=!!i,an.skipValidation=!!s||!!a,an.prototype.parse.apply(u,arguments)},u._resetBlanks=an._resetBlanks,u}o(aP,"_Parser");n3.exports={Parser:aP,Generator:iP,Wildcard:nP}});var ym=y(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.CaseWhenTransformerError=oa.CaseWhenTransformer=void 0;var gm=class{static{o(this,"CaseWhenTransformer")}transform(e){let t=e,i,n=0,s=100;do if(i=t,t=this.transformSinglePass(t),n++,n>s)throw new on("Too many nested CASE expressions (max 100 iterations)");while(t!==i);return t}transformSinglePass(e){let t=this.findCasePositions(e);if(t.length===0)return e;let i=e;for(let n=t.length-1;n>=0;n--){let s=t[n],a=this.extractCaseExpression(i,s);if(a){let c=this.convertCaseToIf(a.content);i=i.substring(0,s)+c+i.substring(s+a.length)}}return i}findCasePositions(e){let t=[],i=e.toUpperCase(),n=0;for(;n<e.length;){if(e[n]==="'"||e[n]==='"'){let s=e[n];for(n++;n<e.length&&e[n]!==s;)e[n]==="\\"&&n++,n++;n++;continue}if(i.substring(n,n+4)==="CASE"&&this.isWordBoundary(e,n,4)){t.push(n),n+=4;continue}n++}return t}extractCaseExpression(e,t){let i=1,n=t+4,s=e.toUpperCase();for(;n<e.length&&i>0;){if(e[n]==="'"||e[n]==='"'){let a=e[n];for(n++;n<e.length&&e[n]!==a;)e[n]==="\\"&&n++,n++;n++;continue}if(s.substring(n,n+4)==="CASE"&&this.isWordBoundary(e,n,4)){i++,n+=4;continue}if(s.substring(n,n+3)==="END"&&this.isWordBoundary(e,n,3)){if(i--,i===0){let a=e.substring(t,n+3);return{content:a,length:a.length}}n+=3;continue}n++}if(i>0)throw new on(`Unclosed CASE expression at position ${t}`);return null}isWordBoundary(e,t,i){let n=t>0?e[t-1]:"",s=t===0||!/[a-zA-Z0-9_?$]/.test(n),a=t+i<e.length?e[t+i]:"",c=t+i>=e.length||!/[a-zA-Z0-9_]/.test(a);return s&&c}convertCaseToIf(e){let t=this.extractWhenClauses(e),i=this.extractElseClause(e);if(t.length===0)throw new on("CASE expression must have at least one WHEN clause");let n=i!==null?i:'""';for(let s=t.length-1;s>=0;s--){let{condition:a,result:c}=t[s];n=`IF(${a}, ${c}, ${n})`}return n}extractWhenClauses(e){let t=[],i=e.replace(/^\s*CASE\s+/i,"").replace(/\s*END\s*$/i,""),n=this.findKeywordPositions(i,"WHEN"),s=this.findKeywordPositions(i,"ELSE"),a=s.length>0?s[0]:i.length;for(let c=0;c<n.length;c++){let u=n[c]+4,l=c+1<n.length?n[c+1]:a,f=i.substring(u,l).trim(),h=this.parseWhenClause(f);h&&t.push(h)}return t}findKeywordPositions(e,t){let i=[],n=e.toUpperCase(),s=0,a=0;for(;s<e.length;){let c=e[s];if(c==="'"||c==='"'){let u=c;for(s++;s<e.length&&e[s]!==u;)e[s]==="\\"&&s++,s++;s++;continue}if(c==="("){a++,s++;continue}if(c===")"){a--,s++;continue}if(a===0&&n.substring(s,s+t.length)===t&&this.isWordBoundary(e,s,t.length)){i.push(s),s+=t.length;continue}s++}return i}parseWhenClause(e){let t=this.findKeywordPositions(e,"THEN");if(t.length===0)throw new on(`WHEN clause missing THEN keyword: ${e.substring(0,50)}...`);let i=t[0],n=e.substring(0,i).trim(),s=e.substring(i+4).trim();if(!n)throw new on("WHEN clause has empty condition");if(!s)throw new on("WHEN clause has empty result");return{condition:n,result:s}}extractElseClause(e){let t=e.replace(/^\s*CASE\s+/i,"").replace(/\s*END\s*$/i,""),i=this.findKeywordPositions(t,"ELSE");if(i.length>0){let n=i[0];return t.substring(n+4).trim()}return null}};oa.CaseWhenTransformer=gm;var on=class extends Error{static{o(this,"CaseWhenTransformerError")}constructor(e){super(`CASE WHEN transformation error: ${e}`),this.name="CaseWhenTransformerError"}};oa.CaseWhenTransformerError=on});var vm=y(ca=>{"use strict";Object.defineProperty(ca,"__esModule",{value:!0});ca.LateralTransformerError=ca.LateralTransformer=void 0;var ul=class r{static{o(this,"LateralTransformer")}transform(e){let t=e,i,n=0,s=100;do if(i=t,t=this.transformSinglePass(t),n++,n>s)throw new Pn("Too many nested LATERAL joins (max 100 iterations)");while(t!==i);return t}hasLateral(e){return this.findLateralPositions(e).length>0}static isLateralJoin(e){if(e.type==="group"&&e.patterns){for(let t of e.patterns)if(t.type==="query"&&t.queryType==="SELECT"&&t.variables&&Array.isArray(t.variables)){for(let i of t.variables)if(i.termType==="Variable"&&i.value===r.LATERAL_MARKER)return!0}}if(e.type==="query"&&e.queryType==="SELECT"&&e.variables&&Array.isArray(e.variables)){for(let t of e.variables)if(t.termType==="Variable"&&t.value===r.LATERAL_MARKER)return!0}return!1}transformSinglePass(e){let t=this.findLateralPositions(e);if(t.length===0)return e;let i=e;for(let n=t.length-1;n>=0;n--){let s=t[n],a=this.extractLateralExpression(i,s);if(a){let c=this.transformLateral(a.content);i=i.substring(0,s)+c+i.substring(s+a.length)}}return i}findLateralPositions(e){let t=[],i=e.toUpperCase(),n=0;for(;n<e.length;){if(e[n]==="'"||e[n]==='"'){let s=e[n];for(n++;n<e.length&&e[n]!==s;)e[n]==="\\"&&n++,n++;n++;continue}if(e[n]==="#"){for(;n<e.length&&e[n]!==`
`;)n++;continue}if(i.substring(n,n+7)==="LATERAL"&&this.isWordBoundary(e,n,7)){t.push(n),n+=7;continue}n++}return t}extractLateralExpression(e,t){let i=t+7;for(;i<e.length&&/\s/.test(e[i]);)i++;if(e[i]!=="{")throw new Pn(`Expected '{' after LATERAL keyword at position ${t}`);let n=1;for(i++;i<e.length&&n>0;){if(e[i]==="'"||e[i]==='"'){let s=e[i];for(i++;i<e.length&&e[i]!==s;)e[i]==="\\"&&i++,i++;i++;continue}if(e[i]==="#"){for(;i<e.length&&e[i]!==`
`;)i++;continue}if(e[i]==="{"){n++,i++;continue}if(e[i]==="}"){if(n--,n===0){let s=e.substring(t,i+1);return{content:s,length:s.length}}i++;continue}i++}if(n>0)throw new Pn(`Unclosed LATERAL block at position ${t}`);return null}transformLateral(e){let t=e.indexOf("{");if(t===-1)throw new Pn("LATERAL expression missing opening brace");let i=e.substring(t+1,e.length-1).trim();if(!i.toUpperCase().trim().startsWith("SELECT"))throw new Pn("LATERAL block must contain a SELECT subquery");let a=i.toUpperCase().indexOf("SELECT")+6;for(;a<i.length&&/\s/.test(i[a]);)a++;let c=i.substring(a).toUpperCase();return c.startsWith("DISTINCT")?a+=8:c.startsWith("REDUCED")&&(a+=7),`{ ${i.substring(0,a)+` ?${r.LATERAL_MARKER}`+i.substring(a)} }`}isWordBoundary(e,t,i){let n=t>0?e[t-1]:"",s=t===0||!/[a-zA-Z0-9_]/.test(n),a=t+i<e.length?e[t+i]:"",c=t+i>=e.length||!/[a-zA-Z0-9_]/.test(a);return s&&c}};ca.LateralTransformer=ul;ul.LATERAL_MARKER="__LATERAL_JOIN__";var Pn=class extends Error{static{o(this,"LateralTransformerError")}constructor(e){super(`LATERAL transformation error: ${e}`),this.name="LateralTransformerError"}};ca.LateralTransformerError=Pn});var a3=y(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.PrefixStarTransformerError=Fn.PrefixStarTransformer=Fn.WellKnownPrefixResolver=void 0;var ll=class{static{o(this,"WellKnownPrefixResolver")}constructor(){this.wellKnownPrefixes=new Map;let e=new Map;e.set("schema","http://schema.org/"),this.wellKnownPrefixes.set("http://schema.org/",e);let t=new Map;t.set("foaf","http://xmlns.com/foaf/0.1/"),this.wellKnownPrefixes.set("http://xmlns.com/foaf/0.1/",t);let i=new Map;i.set("dc","http://purl.org/dc/elements/1.1/"),i.set("dcterms","http://purl.org/dc/terms/"),this.wellKnownPrefixes.set("http://purl.org/dc/elements/1.1/",i),this.wellKnownPrefixes.set("http://purl.org/dc/terms/",i);let n=new Map;n.set("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),n.set("rdfs","http://www.w3.org/2000/01/rdf-schema#"),this.wellKnownPrefixes.set("http://www.w3.org/1999/02/22-rdf-syntax-ns#",n),this.wellKnownPrefixes.set("http://www.w3.org/2000/01/rdf-schema#",n);let s=new Map;s.set("owl","http://www.w3.org/2002/07/owl#"),this.wellKnownPrefixes.set("http://www.w3.org/2002/07/owl#",s);let a=new Map;a.set("xsd","http://www.w3.org/2001/XMLSchema#"),this.wellKnownPrefixes.set("http://www.w3.org/2001/XMLSchema#",a);let c=new Map;c.set("skos","http://www.w3.org/2004/02/skos/core#"),this.wellKnownPrefixes.set("http://www.w3.org/2004/02/skos/core#",c);let u=new Map;u.set("prov","http://www.w3.org/ns/prov#"),this.wellKnownPrefixes.set("http://www.w3.org/ns/prov#",u);let l=new Map;l.set("geo","http://www.w3.org/2003/01/geo/wgs84_pos#"),this.wellKnownPrefixes.set("http://www.w3.org/2003/01/geo/wgs84_pos#",l);let f=new Map;f.set("dcat","http://www.w3.org/ns/dcat#"),this.wellKnownPrefixes.set("http://www.w3.org/ns/dcat#",f)}async resolve(e){let t=e.endsWith("#")||e.endsWith("/")?e:e+(e.includes("#")?"":"/"),i=this.wellKnownPrefixes.get(t);if(i)return i;let n=t.slice(0,-1),s=this.wellKnownPrefixes.get(n);return s||new Map}addVocabulary(e,t){this.wellKnownPrefixes.set(e,t)}};Fn.WellKnownPrefixResolver=ll;var _m=class{static{o(this,"PrefixStarTransformer")}constructor(e){this.resolver=e??new ll}async transform(e){let t=this.findPrefixStarDeclarations(e);if(t.length===0)return e;let i=[],n=[];for(let a of t)try{let c=await this.resolver.resolve(a.uri);for(let[u,l]of c)i.push(`PREFIX ${u}: <${l}>`);if(c.size===0){let u=this.extractPrefixFromUri(a.uri);u&&i.push(`PREFIX ${u}: <${a.uri}>`)}}catch(c){let u=c instanceof Error?c.message:String(c);n.push(`Failed to resolve vocabulary ${a.uri}: ${u}`)}if(i.length===0&&n.length>0)throw new ua(n.join("; "));let s=e;for(let a=t.length-1;a>=0;a--){let c=t[a];s=s.substring(0,c.startPos)+s.substring(c.endPos)}return i.length>0&&(s=i.join(`
`)+`
`+s.trimStart()),s}findPrefixStarDeclarations(e){let t=[],i=e.toUpperCase(),n=0;for(;n<e.length;){if(e[n]==="'"||e[n]==='"'){let s=e[n];for(n++;n<e.length&&e[n]!==s;)e[n]==="\\"&&n++,n++;n++;continue}if(i.substring(n,n+6)==="PREFIX"){let s=n;for(n+=6;n<e.length&&/\s/.test(e[n]);)n++;if(e[n]==="*"){for(n++;n<e.length&&/\s/.test(e[n]);)n++;if(e[n]==="<"){n++;let a=n;for(;n<e.length&&e[n]!==">";)n++;if(e[n]===">"){let c=e.substring(a,n);n++;let u=this.findDeclarationEnd(e,n);t.push({uri:c,startPos:s,endPos:u}),n=u;continue}else throw new ua(`Unclosed IRI in PREFIX* declaration at position ${a}`)}else throw new ua(`Expected IRI after PREFIX* at position ${n}`)}else continue}n++}return t}findDeclarationEnd(e,t){let i=t;for(;i<e.length;){let n=e[i];if(n===`
`)return i+1;let s=e.substring(i).toUpperCase();if(s.startsWith("PREFIX")||s.startsWith("BASE")||s.startsWith("SELECT")||s.startsWith("CONSTRUCT")||s.startsWith("DESCRIBE")||s.startsWith("ASK"))return i;if(/\s/.test(n)){i++;continue}break}return i}extractPrefixFromUri(e){let t=e.replace(/^https?:\/\//,"");t=t.replace(/\/$/,"").replace(/#$/,"");let i=t.split(/[/.#]+/).filter(Boolean);if(i.length===0)return null;let n=i[i.length-1];return/^(ontology|vocab|schema|ns|core)$/i.test(n)&&i.length>1?i[i.length-2].toLowerCase():n.toLowerCase().replace(/[^a-z0-9]/g,"")}};Fn.PrefixStarTransformer=_m;var ua=class extends Error{static{o(this,"PrefixStarTransformerError")}constructor(e){super(`PREFIX* transformation error: ${e}`),this.name="PrefixStarTransformerError"}};Fn.PrefixStarTransformerError=ua});var wm=y(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.DescribeOptionsTransformer=fa.DescribeOptionsTransformerError=void 0;var fl=class extends Error{static{o(this,"DescribeOptionsTransformerError")}constructor(e){super(e),this.name="DescribeOptionsTransformerError"}};fa.DescribeOptionsTransformerError=fl;var la=class r{static{o(this,"DescribeOptionsTransformer")}transform(e){if(!r.DESCRIBE_QUERY_PATTERN.test(e))return{query:e};let t=e,i={},n=!1,s=r.DEPTH_PATTERN.exec(e);if(s){let a=parseInt(s[1],10);if(a<0)throw new fl(`DESCRIBE DEPTH must be a non-negative integer, got: ${a}`);i.depth=a,n=!0,r.DEPTH_PATTERN.lastIndex=0,t=t.replace(r.DEPTH_PATTERN,"")}return r.DEPTH_PATTERN.lastIndex=0,r.SYMMETRIC_PATTERN.test(e)&&(i.symmetric=!0,n=!0,r.SYMMETRIC_PATTERN.lastIndex=0,t=t.replace(r.SYMMETRIC_PATTERN,"")),r.SYMMETRIC_PATTERN.lastIndex=0,t=t.replace(/\s{2,}/g," ").trim(),{query:t,options:n?i:void 0}}hasDescribeOptions(e){let t=r.DEPTH_PATTERN.test(e);r.DEPTH_PATTERN.lastIndex=0;let i=r.SYMMETRIC_PATTERN.test(e);return r.SYMMETRIC_PATTERN.lastIndex=0,t||i}};fa.DescribeOptionsTransformer=la;la.DEPTH_PATTERN=/\bDEPTH\s+(\d+)/gi;la.SYMMETRIC_PATTERN=/\bSYMMETRIC\b/gi;la.DESCRIBE_QUERY_PATTERN=/\bDESCRIBE\b/i});var u3=y(Mr=>{"use strict";var oP=Mr&&Mr.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),cP=Mr&&Mr.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),uP=Mr&&Mr.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var i=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[i.length]=n);return i},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i=r(e),n=0;n<i.length;n++)i[n]!=="default"&&oP(t,e,i[n]);return cP(t,e),t}})();Object.defineProperty(Mr,"__esModule",{value:!0});Mr.SPARQLParser=Mr.SPARQLParseError=void 0;var o3=uP(s3()),bm=ym(),Sm=vm(),c3=a3(),Em=wm(),Lt=class extends Error{static{o(this,"SPARQLParseError")}constructor(e,t,i,n){super(e,n?{cause:n}:void 0),this.name="SPARQLParseError",this.line=t,this.column=i}};Mr.SPARQLParseError=Lt;var Tm=class{static{o(this,"SPARQLParser")}constructor(e){this.parser=new o3.Parser({sparqlStar:!0}),this.generator=new o3.Generator({sparqlStar:!0}),this.caseWhenTransformer=new bm.CaseWhenTransformer,this.lateralTransformer=new Sm.LateralTransformer,this.prefixStarTransformer=new c3.PrefixStarTransformer(e?.vocabularyResolver),this.describeOptionsTransformer=new Em.DescribeOptionsTransformer}parse(e){try{let t=this.describeOptionsTransformer.transform(e);this.lastDescribeOptions=t.options;let i=t.query;i=this.lateralTransformer.transform(i),i=this.caseWhenTransformer.transform(i);let n=this.parser.parse(i);return this.validateQuery(n),this.lastDescribeOptions&&this.isDescribeQuery(n)&&(n.describeOptions=this.lastDescribeOptions),n}catch(t){if(t instanceof Em.DescribeOptionsTransformerError)throw new Lt(t.message);if(t instanceof Sm.LateralTransformerError)throw new Lt(t.message);if(t instanceof bm.CaseWhenTransformerError)throw new Lt(t.message);if(t instanceof Error){let i=t.message.match(/line (\d+), column (\d+)/),n=i?parseInt(i[1],10):void 0,s=i?parseInt(i[2],10):void 0;throw new Lt(`SPARQL syntax error: ${t.message}`,n,s,t)}throw t}}parseWithOptions(e){return{query:this.parse(e),describeOptions:this.lastDescribeOptions}}getLastDescribeOptions(){return this.lastDescribeOptions}async parseAsync(e){try{let t=this.describeOptionsTransformer.transform(e);this.lastDescribeOptions=t.options;let i=t.query;i=await this.prefixStarTransformer.transform(i),i=this.lateralTransformer.transform(i),i=this.caseWhenTransformer.transform(i);let n=this.parser.parse(i);return this.validateQuery(n),this.lastDescribeOptions&&this.isDescribeQuery(n)&&(n.describeOptions=this.lastDescribeOptions),n}catch(t){if(t instanceof Em.DescribeOptionsTransformerError)throw new Lt(t.message);if(t instanceof c3.PrefixStarTransformerError)throw new Lt(t.message);if(t instanceof Sm.LateralTransformerError)throw new Lt(t.message);if(t instanceof bm.CaseWhenTransformerError)throw new Lt(t.message);if(t instanceof Error){let i=t.message.match(/line (\d+), column (\d+)/),n=i?parseInt(i[1],10):void 0,s=i?parseInt(i[2],10):void 0;throw new Lt(`SPARQL syntax error: ${t.message}`,n,s,t)}throw t}}async parseAsyncWithOptions(e){return{query:await this.parseAsync(e),describeOptions:this.lastDescribeOptions}}hasPrefixStar(e){return/PREFIX\s*\*/i.test(e)}hasLateral(e){return this.lateralTransformer.hasLateral(e)}hasDescribeOptions(e){return this.describeOptionsTransformer.hasDescribeOptions(e)}toString(e){try{return this.generator.stringify(e)}catch(t){throw t instanceof Error?new Lt(`Failed to serialize SPARQL query: ${t.message}`,void 0,void 0,t):t}}getQueryType(e){if("queryType"in e&&e.type==="query")return e.queryType;throw new Lt("Query does not have a valid queryType property")}isSelectQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="SELECT"}isConstructQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="CONSTRUCT"}isAskQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="ASK"}isDescribeQuery(e){return"queryType"in e&&e.type==="query"&&e.queryType==="DESCRIBE"}isUpdateQuery(e){return e.type==="update"}isInsertDataOperation(e){return"updateType"in e&&e.updateType==="insert"}isDeleteDataOperation(e){return"updateType"in e&&e.updateType==="delete"}validateQuery(e){if(!e||typeof e!="object")throw new Lt("Invalid query: not an object");if(e.type!=="query"&&e.type!=="update")throw new Lt(`Invalid type: expected "query" or "update", got "${e.type}"`);if(e.type==="query"){let t=["SELECT","CONSTRUCT","ASK","DESCRIBE"];if(!t.includes(e.queryType))throw new Lt(`Invalid query type: expected one of ${t.join(", ")}, got "${e.queryType}"`)}}};Mr.SPARQLParser=Tm});var f3=y(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.AlgebraTranslator=ha.AlgebraTranslatorError=void 0;var l3=vm(),fe=class extends Error{static{o(this,"AlgebraTranslatorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="AlgebraTranslatorError"}};ha.AlgebraTranslatorError=fe;var Am=class{static{o(this,"AlgebraTranslator")}constructor(){this.aggregateCounter=0}translate(e){if(e.type!=="query")throw new fe("Only query operations are supported (not updates)");if(e.queryType==="SELECT")return this.translateSelect(e);if(e.queryType==="CONSTRUCT")return this.translateConstruct(e);if(e.queryType==="ASK")return this.translateAsk(e);if(e.queryType==="DESCRIBE")return this.translateDescribe(e);throw new fe(`Query type ${e.queryType} not yet supported`)}translateSelect(e){let t;if(!e.where||e.where.length===0)throw new fe("SELECT query must have WHERE clause");t=this.translateWhere(e.where),this.aggregateCounter=0;let i=new Map,n=this.extractAggregatesWithMapping(e.variables,i),s=this.extractGroupVariables(e.group);if((n.length>0||s.length>0)&&(t={type:"group",variables:s,aggregates:n,input:t}),e.variables&&e.variables.length>0){for(let c of e.variables){let u=c;if(u.expression&&u.variable){if(u.expression.type==="aggregate")continue;let l=this.transformExpressionWithAggregateVars(u.expression,i);t={type:"extend",variable:u.variable.value,expression:l,input:t}}}let a=e.variables.filter(c=>c.termType==="Variable"||c.variable).map(c=>c.termType==="Variable"?c.value:c.variable.value);a.length>0&&(t={type:"project",variables:a,input:t})}return e.distinct&&(t={type:"distinct",input:t}),e.reduced&&(t={type:"reduced",input:t}),e.order&&e.order.length>0&&(t={type:"orderby",comparators:e.order.map(a=>this.translateOrderComparator(a)),input:t}),(e.limit!==void 0||e.offset!==void 0)&&(t={type:"slice",limit:e.limit,offset:e.offset,input:t}),t}translateConstruct(e){let t=this.translateConstructTemplate(e.template??[]);if(!e.where||e.where.length===0)throw new fe("CONSTRUCT query must have WHERE clause");let i=this.translateWhere(e.where);return{type:"construct",template:t,where:i}}translateConstructTemplate(e){return!e||!Array.isArray(e)?[]:e.map(t=>this.translateTriple(t))}translateAsk(e){return{type:"ask",where:e.where&&e.where.length>0?this.translateWhere(e.where):{type:"bgp",triples:[]}}}extractAggregatesWithMapping(e,t){if(!e)return[];let i=[];for(let n of e)!n.expression||!n.variable||(n.expression.type==="aggregate"?(i.push({variable:n.variable.value,expression:this.translateAggregateExpression(n.expression)}),t.set(n.expression,n.variable.value)):this.collectNestedAggregates(n.expression,i,t));return i}collectNestedAggregates(e,t,i){if(e){if(e.type==="aggregate"){let n=`__agg${this.aggregateCounter++}`;t.push({variable:n,expression:this.translateAggregateExpression(e)}),i.set(e,n)}else if(e.type==="operation"&&e.args)for(let n of e.args)this.collectNestedAggregates(n,t,i)}}transformExpressionWithAggregateVars(e,t){if(t.has(e))return{type:"variable",name:t.get(e)};if(e.type==="operation"&&e.args){let i=e.args.map(c=>this.transformExpressionWithAggregateVars(c,t)),n=["=","!=","<",">","<=",">="],s=["&&","||","!"],a=["+","-","*","/"];return n.includes(e.operator)?{type:"comparison",operator:e.operator,left:i[0],right:i[1]}:s.includes(e.operator)?{type:"logical",operator:e.operator,operands:i}:a.includes(e.operator)?{type:"arithmetic",operator:e.operator,left:i[0],right:i[1]}:{type:"function",function:e.operator,args:i}}return this.translateExpression(e)}extractGroupVariables(e){return e?e.filter(t=>t.expression&&t.expression.termType==="Variable").map(t=>t.expression.value):[]}translateAggregateExpression(e){let t=e.aggregation;if(typeof t=="string"){let i=t.toLowerCase();return["count","sum","avg","min","max","group_concat","sample"].includes(i)?{type:"aggregate",aggregation:i,expression:e.expression?this.translateExpression(e.expression):void 0,distinct:e.distinct||!1,separator:e.separator}:{type:"aggregate",aggregation:{type:"custom",iri:t},expression:e.expression?this.translateExpression(e.expression):void 0,distinct:e.distinct||!1,separator:e.separator}}if(t&&typeof t=="object"){let i;if(t.termType==="NamedNode"&&t.value)i=t.value;else if("value"in t)i=String(t.value);else throw new fe(`Invalid custom aggregate: expected IRI but got ${JSON.stringify(t)}`);return{type:"aggregate",aggregation:{type:"custom",iri:i},expression:e.expression?this.translateExpression(e.expression):void 0,distinct:e.distinct||!1,separator:e.separator}}throw new fe(`Unknown aggregate format: ${JSON.stringify(t)}`)}isLateralPattern(e){if(e.type==="query"&&this.isLateralSubquery(e))return!0;if(e.type==="group"&&e.patterns?.length===1){let t=e.patterns[0];if(t.type==="query"&&this.isLateralSubquery(t))return!0}return!1}extractLateralSubquery(e){if(e.type==="query")return e;if(e.type==="group"&&e.patterns?.length===1)return e.patterns[0];throw new fe("Invalid lateral pattern structure")}translateWhere(e){if(e.length===0)throw new fe("Empty WHERE clause");let t=e.filter(a=>a.type==="filter"),i=e.filter(a=>a.type==="bind"),n=e.filter(a=>a.type!=="filter"&&a.type!=="bind"),s;if(n.length===0)s={type:"bgp",triples:[]};else if(n.length===1)s=this.translatePattern(n[0]);else{s=this.translatePattern(n[0]);for(let a=1;a<n.length;a++){let c=n[a];if(this.isLateralPattern(c)){let u=this.extractLateralSubquery(c),l=this.removeLateralMarker(u),f=this.translateSelect(l);s={type:"lateraljoin",left:s,right:f}}else{let u=this.translatePattern(c);s={type:"join",left:s,right:u}}}}for(let a of i)s=this.translateBind(a,s);for(let a of t)s={type:"filter",expression:this.translateExpression(a.expression),input:s};return s}translatePattern(e){if(!e||!e.type)throw new fe("Invalid pattern: missing type");switch(e.type){case"bgp":return this.translateBGP(e);case"filter":return this.translateFilter(e);case"optional":return this.translateOptional(e);case"union":return this.translateUnion(e);case"minus":return this.translateMinus(e);case"values":return this.translateValues(e);case"group":return this.translateWhere(e.patterns);case"query":return this.translateSubquery(e);case"service":return this.translateService(e);case"graph":return this.translateGraph(e);default:throw new fe(`Unsupported pattern type: ${e.type}`)}}translateBGP(e){if(!e.triples||!Array.isArray(e.triples))throw new fe("BGP pattern must have triples array");return{type:"bgp",triples:e.triples.map(t=>this.translateTriple(t))}}translateTriple(e){if(!e.subject||!e.predicate||!e.object)throw new fe("Triple must have subject, predicate, and object");return{subject:this.translateTripleElement(e.subject),predicate:this.translatePredicate(e.predicate),object:this.translateTripleElement(e.object)}}translatePredicate(e){return e.type==="path"?this.translatePropertyPath(e):this.translateTripleElement(e)}translatePropertyPath(e){if(!e.pathType)throw new fe("Property path must have pathType");if(!e.items||!Array.isArray(e.items))throw new fe("Property path must have items array");let t=e.items.map(i=>this.translatePathItem(i));switch(e.pathType){case"/":return{type:"path",pathType:"/",items:t};case"|":return{type:"path",pathType:"|",items:t};case"^":if(t.length!==1)throw new fe("Inverse path must have exactly one item");return{type:"path",pathType:"^",items:[t[0]]};case"+":if(t.length!==1)throw new fe("OneOrMore path must have exactly one item");return{type:"path",pathType:"+",items:[t[0]]};case"*":if(t.length!==1)throw new fe("ZeroOrMore path must have exactly one item");return{type:"path",pathType:"*",items:[t[0]]};case"?":if(t.length!==1)throw new fe("ZeroOrOne path must have exactly one item");return{type:"path",pathType:"?",items:[t[0]]};default:throw new fe(`Unsupported property path type: ${e.pathType}`)}}translatePathItem(e){if(e.type==="path")return this.translatePropertyPath(e);if(e.termType==="NamedNode")return{type:"iri",value:e.value};throw new fe(`Unsupported path item type: ${e.type||e.termType}`)}translateTripleElement(e){if(!e||!e.termType)throw new fe("Triple element must have termType");switch(e.termType){case"Variable":return{type:"variable",value:e.value};case"NamedNode":return{type:"iri",value:e.value};case"Literal":return{type:"literal",value:e.value,datatype:e.datatype?.value,language:e.language};case"BlankNode":return{type:"blank",value:e.value};case"Quad":return this.translateQuotedTriple(e);default:throw new fe(`Unsupported term type: ${e.termType}`)}}translateQuotedTriple(e){if(!e.subject||!e.predicate||!e.object)throw new fe("Quoted triple must have subject, predicate, and object");let t=this.translateTripleElement(e.subject),i=this.translateQuotedTriplePredicate(e.predicate),n=this.translateTripleElement(e.object);return{type:"quoted",subject:t,predicate:i,object:n}}translateQuotedTriplePredicate(e){if(!e||!e.termType)throw new fe("Quoted triple predicate must have termType");switch(e.termType){case"Variable":return{type:"variable",value:e.value};case"NamedNode":return{type:"iri",value:e.value};default:throw new fe(`Quoted triple predicate must be IRI or Variable, got: ${e.termType}`)}}translateFilter(e){if(!e.expression)throw new fe("Filter pattern must have expression");let t=e.patterns?this.translateWhere(e.patterns):{type:"bgp",triples:[]};return{type:"filter",expression:this.translateExpression(e.expression),input:t}}translateExpression(e){if(!e)throw new fe("Expression cannot be null or undefined");if(e.type==="operation")return this.translateOperationExpression(e);if(e.type==="functioncall"||e.type==="functionCall")return{type:"functionCall",function:e.function,args:e.args.map(t=>this.translateExpression(t))};if(e.termType)return this.translateTermExpression(e);throw new fe(`Unsupported expression structure: ${JSON.stringify(e)}`)}translateOperationExpression(e){let t=["=","!=","<",">","<=",">="],i=["&&","||","!"],n=["+","-","*","/"];return t.includes(e.operator)?{type:"comparison",operator:e.operator,left:this.translateExpression(e.args[0]),right:this.translateExpression(e.args[1])}:i.includes(e.operator)?{type:"logical",operator:e.operator,operands:e.args.map(s=>this.translateExpression(s))}:n.includes(e.operator)?{type:"arithmetic",operator:e.operator,left:this.translateExpression(e.args[0]),right:this.translateExpression(e.args[1])}:e.operator==="exists"||e.operator==="notexists"?this.translateExistsExpression(e):e.operator==="in"||e.operator==="notin"?this.translateInExpression(e):{type:"function",function:e.operator,args:e.args.map(s=>this.translateExpression(s))}}translateExistsExpression(e){if(!e.args||e.args.length!==1)throw new fe("EXISTS/NOT EXISTS must have exactly one pattern argument");let t=e.args[0],i;return t.type==="group"&&t.patterns?i=this.translateWhere(t.patterns):t.type==="bgp"?i=this.translateBGP(t):i=this.translatePattern(t),{type:"exists",negated:e.operator==="notexists",pattern:i}}translateInExpression(e){if(!e.args||e.args.length!==2)throw new fe("IN/NOT IN must have exactly 2 arguments (expression and list)");let t=e.args[0],i=e.args[1];if(!Array.isArray(i))throw new fe("IN/NOT IN second argument must be an array of values");return{type:"in",expression:this.translateExpression(t),list:i.map(n=>this.translateExpression(n)),negated:e.operator==="notin"}}translateTermExpression(e){if(e.termType==="Variable")return{type:"variable",name:e.value};if(e.termType==="Literal"){let t=e.value;return e.datatype&&(e.datatype.value.includes("#integer")||e.datatype.value.includes("#decimal")?t=parseFloat(e.value):e.datatype.value.includes("#boolean")&&(t=e.value==="true")),{type:"literal",value:t,datatype:e.datatype?.value}}return{type:"literal",value:String(e.value||e)}}translateOptional(e){if(!e.patterns||e.patterns.length===0)throw new fe("OPTIONAL pattern must have patterns");return{type:"leftjoin",left:{type:"bgp",triples:[]},right:this.translateWhere(e.patterns),expression:e.expression?this.translateExpression(e.expression):void 0}}translateUnion(e){if(!e.patterns||e.patterns.length<2)throw new fe("UNION pattern must have at least 2 patterns");let t=o(n=>n.type==="graph"?this.translateGraph(n):n.type==="service"?this.translateService(n):n.patterns&&Array.isArray(n.patterns)?this.translateWhere(n.patterns):this.translateWhere([n]),"translateBranch"),i={type:"union",left:t(e.patterns[0]),right:t(e.patterns[1])};for(let n=2;n<e.patterns.length;n++)i={type:"union",left:i,right:t(e.patterns[n])};return i}translateMinus(e){if(!e.patterns||e.patterns.length===0)throw new fe("MINUS pattern must have patterns");return{type:"minus",left:{type:"bgp",triples:[]},right:this.translateWhere(e.patterns)}}translateValues(e){if(!e.values||!Array.isArray(e.values))throw new fe("VALUES pattern must have values array");let t=new Set;for(let n of e.values)for(let s of Object.keys(n)){let a=s.startsWith("?")?s.slice(1):s;t.add(a)}let i=e.values.map(n=>this.translateValuesBinding(n));return{type:"values",variables:Array.from(t),bindings:i}}translateValuesBinding(e){let t={};for(let[i,n]of Object.entries(e)){let s=i.startsWith("?")?i.slice(1):i,a=n;if(a.termType==="NamedNode")t[s]={type:"iri",value:a.value};else if(a.termType==="Literal")t[s]={type:"literal",value:a.value,datatype:a.datatype?.value,language:a.language||void 0};else throw new fe(`Unsupported VALUES term type: ${a.termType}`)}return t}translateBind(e,t){if(!e.variable||!e.expression)throw new fe("BIND pattern must have variable and expression");return{type:"extend",variable:e.variable.value,expression:this.translateExpression(e.expression),input:t}}translateOrderComparator(e){return{expression:this.translateExpression(e.expression),descending:e.descending||!1}}isLateralSubquery(e){return e.queryType!=="SELECT"||!e.variables?!1:e.variables.some(t=>t.termType==="Variable"&&t.value===l3.LateralTransformer.LATERAL_MARKER)}removeLateralMarker(e){return e.variables?{...e,variables:e.variables.filter(t=>!(t.termType==="Variable"&&t.value===l3.LateralTransformer.LATERAL_MARKER))}:e}translateSubquery(e){if(e.queryType!=="SELECT")throw new fe(`Only SELECT subqueries are supported, got: ${e.queryType}`);let t=this.removeLateralMarker(e);return{type:"subquery",query:this.translateSelect(t)}}translateService(e){if(!e.name||e.name.termType!=="NamedNode")throw new fe("SERVICE pattern must have a NamedNode endpoint");if(!e.patterns||!Array.isArray(e.patterns))throw new fe("SERVICE pattern must have patterns array");let t=this.translateWhere(e.patterns);return{type:"service",endpoint:e.name.value,pattern:t,silent:e.silent||!1}}translateGraph(e){if(!e.name)throw new fe("GRAPH pattern must have a name (IRI or variable)");if(!e.patterns||!Array.isArray(e.patterns))throw new fe("GRAPH pattern must have patterns array");let t;if(e.name.termType==="NamedNode")t={type:"iri",value:e.name.value};else if(e.name.termType==="Variable")t={type:"variable",value:e.name.value};else throw new fe(`GRAPH pattern name must be NamedNode or Variable, got: ${e.name.termType}`);let i=this.translateWhere(e.patterns);return{type:"graph",name:t,pattern:i}}translateDescribe(e){let t=[];if(e.variables&&Array.isArray(e.variables))for(let s of e.variables){let a=s;a.termType==="Wildcard"||a.value==="*"||(a.termType==="Variable"?t.push({type:"variable",value:a.value}):a.termType==="NamedNode"&&t.push({type:"iri",value:a.value}))}let i;e.where&&e.where.length>0&&(i=this.translateWhere(e.where));let n=e.describeOptions;return{type:"describe",resources:t,where:i,depth:n?.depth,symmetric:n?.symmetric}}};ha.AlgebraTranslator=Am});var Cm=y(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});hl.FilterContainsOptimizer=void 0;var lP=et(),fP=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i,xm=class{static{o(this,"FilterContainsOptimizer")}constructor(){this.tripleStore=null,this.lastOptimizationHints=[]}setTripleStore(e){this.tripleStore=e}getLastOptimizationHints(){return this.lastOptimizationHints}clearHints(){this.lastOptimizationHints=[]}async optimize(e){return this.clearHints(),this.optimizeRecursive(e)}optimizeSync(e,t){return this.clearHints(),this.optimizeSyncRecursive(e,t)}async optimizeRecursive(e){return e.type==="filter"?this.optimizeFilter(e):e.type==="join"?{type:"join",left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="leftjoin"?{...e,left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="union"?{type:"union",left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="minus"?{...e,left:await this.optimizeRecursive(e.left),right:await this.optimizeRecursive(e.right)}:e.type==="project"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="orderby"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="slice"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="distinct"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="reduced"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="group"?{...e,input:await this.optimizeRecursive(e.input)}:e.type==="extend"?{...e,input:await this.optimizeRecursive(e.input)}:e}optimizeSyncRecursive(e,t){return e.type==="filter"?this.optimizeFilterSync(e,t):e.type==="join"?{type:"join",left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="leftjoin"?{...e,left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="union"?{type:"union",left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="minus"?{...e,left:this.optimizeSyncRecursive(e.left,t),right:this.optimizeSyncRecursive(e.right,t)}:e.type==="project"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="orderby"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="slice"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="distinct"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="reduced"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="group"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e.type==="extend"?{...e,input:this.optimizeSyncRecursive(e.input,t)}:e}async optimizeFilter(e){let t=this.detectContainsUUIDPattern(e.expression);if(!t)return{type:"filter",expression:e.expression,input:await this.optimizeRecursive(e.input)};let i=[];return this.tripleStore&&(i=await this.findSubjectsContainingUUID(t.uuid)),this.rewriteFilter(e,t,i)}optimizeFilterSync(e,t){let i=this.detectContainsUUIDPattern(e.expression);if(!i)return{type:"filter",expression:e.expression,input:this.optimizeSyncRecursive(e.input,t)};let n=t?t.filter(s=>s.includes(i.uuid)):[];return this.rewriteFilter(e,i,n)}rewriteFilter(e,t,i){if(this.lastOptimizationHints.push({type:"uuid-index-lookup",originalPattern:`FILTER(CONTAINS(STR(?${t.variable}), "${t.uuid}"))`,suggestedRewrite:i.length===1?`VALUES ?${t.variable} { <${i[0]}> }`:i.length>1?`VALUES ?${t.variable} { ${i.map(n=>`<${n}>`).join(" ")} }`:"No matching URIs found for UUID",estimatedSpeedup:i.length>0?"O(n) \u2192 O(1)":"N/A",matchedUri:i.length===1?i[0]:void 0}),i.length===0)return{type:"filter",expression:e.expression,input:this.optimizeSyncRecursive(e.input)};if(i.length===1){let n=this.injectSubjectConstraint(e.input,t.variable,i[0]);if(n!==e.input)return n}return this.createValuesJoin(e,t,i)}detectContainsUUIDPattern(e){if(e.type==="function"||e.type==="functionCall"){let t=e;if((typeof t.function=="string"?t.function.toLowerCase():t.function?.value?.toLowerCase()??"")==="contains"&&t.args.length===2)return this.analyzeContainsArgs(t.args[0],t.args[1],e)}if(e.type==="logical"&&e.operator==="&&")for(let t of e.operands){let i=this.detectContainsUUIDPattern(t);if(i)return i}return null}analyzeContainsArgs(e,t,i){let n=null;if(e.type==="function"||e.type==="functionCall"){let s=e;if((typeof s.function=="string"?s.function.toLowerCase():s.function?.value?.toLowerCase()??"")==="str"&&s.args.length===1){let c=s.args[0];c.type==="variable"&&(n=c.name)}}if(!n&&e.type==="variable"&&(n=e.name),!n)return null;if(t.type==="literal"){let c=String(t.value).match(fP);if(c)return{variable:n,uuid:c[0].toLowerCase(),originalExpression:i}}return null}async findSubjectsContainingUUID(e){if(!this.tripleStore)return[];if(this.tripleStore.findSubjectsByUUID)return(await this.tripleStore.findSubjectsByUUID(e)).map(s=>s.value);let t=await this.tripleStore.subjects(),i=[];for(let n of t)n instanceof lP.IRI&&n.value.toLowerCase().includes(e.toLowerCase())&&i.push(n.value);return i}injectSubjectConstraint(e,t,i){if(e.type==="bgp"){let n=e.triples.map(a=>a.subject.type==="variable"&&a.subject.value===t?{...a,subject:{type:"iri",value:i}}:a);if(n.some((a,c)=>a.subject!==e.triples[c].subject))return{type:"bgp",triples:n}}if(e.type==="join"){let n=this.injectSubjectConstraint(e.left,t,i),s=this.injectSubjectConstraint(e.right,t,i);if(n!==e.left||s!==e.right)return{type:"join",left:n,right:s}}if(e.type==="filter"){let n=this.injectSubjectConstraint(e.input,t,i);if(n!==e.input)return{...e,input:n}}return e}createValuesJoin(e,t,i){return{type:"join",left:{type:"values",variables:[t.variable],bindings:i.map(a=>({[t.variable]:{type:"iri",value:a}}))},right:this.optimizeSyncRecursive(e.input)}}analyzeQuery(e){let t=[];return this.analyzeRecursive(e,t),t}analyzeRecursive(e,t){if(e.type==="filter"){let i=this.detectContainsUUIDPattern(e.expression);i&&t.push({type:"uuid-index-lookup",originalPattern:`FILTER(CONTAINS(STR(?${i.variable}), "${i.uuid}"))`,suggestedRewrite:`Use --optimize flag or rewrite as VALUES ?${i.variable} { <uri-containing-uuid> }`,estimatedSpeedup:"O(n) \u2192 O(1) with UUID index lookup"}),this.analyzeRecursive(e.input,t);return}e.type==="join"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="leftjoin"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="union"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="minus"?(this.analyzeRecursive(e.left,t),this.analyzeRecursive(e.right,t)):e.type==="project"?this.analyzeRecursive(e.input,t):e.type==="orderby"?this.analyzeRecursive(e.input,t):e.type==="slice"?this.analyzeRecursive(e.input,t):e.type==="distinct"?this.analyzeRecursive(e.input,t):e.type==="reduced"?this.analyzeRecursive(e.input,t):e.type==="group"?this.analyzeRecursive(e.input,t):e.type==="extend"&&this.analyzeRecursive(e.input,t)}};hl.FilterContainsOptimizer=xm});var h3=y(dl=>{"use strict";Object.defineProperty(dl,"__esModule",{value:!0});dl.AlgebraOptimizer=void 0;var hP=Cm(),Om=class{static{o(this,"AlgebraOptimizer")}constructor(){this.stats=new Map,this.tripleStore=null,this.filterContainsOptimizer=new hP.FilterContainsOptimizer}setTripleStore(e){this.tripleStore=e,this.filterContainsOptimizer.setTripleStore(e)}getOptimizationHints(){return this.filterContainsOptimizer.getLastOptimizationHints()}analyzeQuery(e){return this.filterContainsOptimizer.analyzeQuery(e)}optimize(e){let t=e;return t=this.eliminateEmptyBGPInFilterJoin(t),t=this.filterPushDown(t),t=this.joinReordering(t),t}async optimizeAsync(e){let t=e;return t=this.eliminateEmptyBGPInFilterJoin(t),this.tripleStore&&(t=await this.filterContainsOptimizer.optimize(t)),t=this.filterPushDown(t),t=this.joinReordering(t),t}optimizeWithSubjects(e,t){let i=e;return i=this.eliminateEmptyBGPInFilterJoin(i),i=this.filterContainsOptimizer.optimizeSync(i,t),i=this.filterPushDown(i),i=this.joinReordering(i),i}eliminateEmptyBGPInFilterJoin(e){if(e.type==="join"){if(e.left.type==="filter"){let t=e.left;if(t.input.type==="bgp"&&t.input.triples.length===0)return{type:"filter",expression:t.expression,input:this.eliminateEmptyBGPInFilterJoin(e.right)}}if(e.right.type==="filter"){let t=e.right;if(t.input.type==="bgp"&&t.input.triples.length===0)return{type:"filter",expression:t.expression,input:this.eliminateEmptyBGPInFilterJoin(e.left)}}return{type:"join",left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}}return e.type==="filter"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="leftjoin"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="union"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="minus"?{...e,left:this.eliminateEmptyBGPInFilterJoin(e.left),right:this.eliminateEmptyBGPInFilterJoin(e.right)}:e.type==="project"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="orderby"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="slice"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e.type==="distinct"?{...e,input:this.eliminateEmptyBGPInFilterJoin(e.input)}:e}filterPushDown(e){return e.type==="filter"?this.pushDownFilter(e):e.type==="join"?{type:"join",left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="leftjoin"?{...e,left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="union"?{type:"union",left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="minus"?{...e,left:this.filterPushDown(e.left),right:this.filterPushDown(e.right)}:e.type==="project"?{...e,input:this.filterPushDown(e.input)}:e.type==="orderby"?{...e,input:this.filterPushDown(e.input)}:e.type==="slice"?{...e,input:this.filterPushDown(e.input)}:e.type==="distinct"?{...e,input:this.filterPushDown(e.input)}:e}pushDownFilter(e){let t=e.input;if(t.type==="join"){let i=this.getFilterVariables(e.expression),n=this.getOperationVariables(t.left),s=this.getOperationVariables(t.right),a=i.every(u=>n.has(u)),c=i.every(u=>s.has(u));return a&&!c?{type:"join",left:{type:"filter",expression:e.expression,input:this.filterPushDown(t.left)},right:this.filterPushDown(t.right)}:c&&!a?{type:"join",left:this.filterPushDown(t.left),right:{type:"filter",expression:e.expression,input:this.filterPushDown(t.right)}}:{type:"filter",expression:e.expression,input:{type:"join",left:this.filterPushDown(t.left),right:this.filterPushDown(t.right)}}}return t.type==="union"?{type:"union",left:{type:"filter",expression:e.expression,input:this.filterPushDown(t.left)},right:{type:"filter",expression:e.expression,input:this.filterPushDown(t.right)}}:{type:"filter",expression:e.expression,input:this.filterPushDown(t)}}getFilterVariables(e){let t=[];if(e.type==="variable")t.push(e.name);else if(e.type==="comparison")t.push(...this.getFilterVariables(e.left)),t.push(...this.getFilterVariables(e.right));else if(e.type==="logical")for(let i of e.operands)t.push(...this.getFilterVariables(i));else if(e.type==="function")for(let i of e.args)t.push(...this.getFilterVariables(i));return Array.from(new Set(t))}getOperationVariables(e){let t=new Set;if(e.type==="bgp")for(let i of e.triples)i.subject.type==="variable"&&t.add(i.subject.value),i.predicate.type==="variable"&&t.add(i.predicate.value),i.object.type==="variable"&&t.add(i.object.value);else if(e.type==="join"){let i=this.getOperationVariables(e.left),n=this.getOperationVariables(e.right);return new Set([...i,...n])}else{if(e.type==="filter")return this.getOperationVariables(e.input);if(e.type==="leftjoin"){let i=this.getOperationVariables(e.left),n=this.getOperationVariables(e.right);return new Set([...i,...n])}else if(e.type==="union"){let i=this.getOperationVariables(e.left),n=this.getOperationVariables(e.right);return new Set([...i,...n])}else{if(e.type==="minus")return this.getOperationVariables(e.left);if(e.type==="project")return new Set(e.variables)}}return t}joinReordering(e){return e.type==="join"?this.reorderJoin(e):e.type==="filter"?{...e,input:this.joinReordering(e.input)}:e.type==="leftjoin"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="union"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="minus"?{...e,left:this.joinReordering(e.left),right:this.joinReordering(e.right)}:e.type==="project"?{...e,input:this.joinReordering(e.input)}:e.type==="orderby"?{...e,input:this.joinReordering(e.input)}:e.type==="slice"?{...e,input:this.joinReordering(e.input)}:e.type==="distinct"?{...e,input:this.joinReordering(e.input)}:e}reorderJoin(e){let t=this.estimateCost(e.left);return this.estimateCost(e.right)<t?{type:"join",left:this.joinReordering(e.right),right:this.joinReordering(e.left)}:{type:"join",left:this.joinReordering(e.left),right:this.joinReordering(e.right)}}estimateCost(e){if(e.type==="bgp"){let t=e.triples.length*100;for(let i of e.triples)i.subject.type==="variable"&&(t+=10),i.predicate.type==="variable"&&(t+=20),i.object.type==="variable"&&(t+=10);return t}return e.type==="filter"?this.estimateCost(e.input)*.3:e.type==="join"?this.estimateCost(e.left)*this.estimateCost(e.right):e.type==="leftjoin"?this.estimateCost(e.left)+this.estimateCost(e.right)*.5:e.type==="union"?this.estimateCost(e.left)+this.estimateCost(e.right):e.type==="minus"?this.estimateCost(e.left)+this.estimateCost(e.right)*.3:100}setStatistics(e,t){this.stats.set(e,t)}getStatistics(e){return this.stats.get(e)}};dl.AlgebraOptimizer=Om});var d3=y(pl=>{"use strict";Object.defineProperty(pl,"__esModule",{value:!0});pl.AlgebraSerializer=void 0;var Pm=class{static{o(this,"AlgebraSerializer")}toString(e,t=0){let i="  ".repeat(t);switch(e.type){case"bgp":return`${i}BGP [
${e.triples.map(l=>`${i}  ${this.tripleToString(l)}`).join(`
`)}
${i}]`;case"filter":return`${i}Filter(
${i}  ${this.expressionToString(e.expression)}
${this.toString(e.input,t+1)}
${i})`;case"join":return`${i}Join(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"leftjoin":let n=e.expression?` ${this.expressionToString(e.expression)}`:"";return`${i}LeftJoin(${n}
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"union":return`${i}Union(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"minus":return`${i}Minus(
${this.toString(e.left,t+1)}
${this.toString(e.right,t+1)}
${i})`;case"project":return`${i}Project [${e.variables.map(l=>`?${l}`).join(", ")}](
${this.toString(e.input,t+1)}
${i})`;case"orderby":let s=e.comparators.map(l=>`${this.expressionToString(l.expression)} ${l.descending?"DESC":"ASC"}`).join(", ");return`${i}OrderBy [${s}](
${this.toString(e.input,t+1)}
${i})`;case"slice":let a=[];return e.offset!==void 0&&a.push(`OFFSET ${e.offset}`),e.limit!==void 0&&a.push(`LIMIT ${e.limit}`),`${i}Slice [${a.join(", ")}](
${this.toString(e.input,t+1)}
${i})`;case"distinct":return`${i}Distinct(
${this.toString(e.input,t+1)}
${i})`;case"group":let c=e.variables.length>0?`[${e.variables.map(l=>`?${l}`).join(", ")}]`:"[]",u=e.aggregates.length>0?e.aggregates.map(l=>`?${l.variable} = ${l.expression.aggregation}(${l.expression.distinct?"DISTINCT ":""}${l.expression.expression?this.expressionToString(l.expression.expression):"*"})`).join(", "):"";return`${i}Group ${c}${u?` [${u}]`:""}(
${this.toString(e.input,t+1)}
${i})`;case"extend":return`${i}Extend (?${e.variable} = ${this.expressionToString(e.expression)})(
${this.toString(e.input,t+1)}
${i})`;case"subquery":return`${i}Subquery(
${this.toString(e.query,t+1)}
${i})`;default:return`${i}Unknown(${e.type})`}}tripleToString(e){return`${this.elementToString(e.subject)} ${this.predicateToString(e.predicate)} ${this.elementToString(e.object)}`}predicateToString(e){return this.isPropertyPath(e)?this.propertyPathToString(e):this.elementToString(e)}isPropertyPath(e){return e.type==="path"}propertyPathToString(e){let t=e.items.map(i=>i.type==="path"?`(${this.propertyPathToString(i)})`:`<${i.value}>`);switch(e.pathType){case"/":return t.join("/");case"|":return t.join("|");case"^":return`^${t[0]}`;case"+":return`${t[0]}+`;case"*":return`${t[0]}*`;case"?":return`${t[0]}?`}}elementToString(e){switch(e.type){case"variable":return`?${e.value}`;case"iri":return`<${e.value}>`;case"literal":let t=`"${e.value}"`;return e.language&&(t+=`@${e.language}`),e.datatype&&(t+=`^^<${e.datatype}>`),t;case"blank":return`_:${e.value}`;default:return String(e)}}expressionToString(e){switch(e.type){case"variable":return`?${e.name}`;case"literal":return typeof e.value=="string"?`"${e.value}"`:String(e.value);case"comparison":return`(${this.expressionToString(e.left)} ${e.operator} ${this.expressionToString(e.right)})`;case"logical":return e.operator==="!"?`!(${this.expressionToString(e.operands[0])})`:`(${e.operands.map(t=>this.expressionToString(t)).join(` ${e.operator} `)})`;case"arithmetic":return`(${this.expressionToString(e.left)} ${e.operator} ${this.expressionToString(e.right)})`;case"function":return`${e.function}(${e.args.map(t=>this.expressionToString(t)).join(", ")})`;case"exists":return`${e.negated?"NOT EXISTS":"EXISTS"} { ${this.toString(e.pattern,0)} }`;default:return"unknown"}}toJSON(e){return JSON.stringify(e,null,2)}};pl.AlgebraSerializer=Pm});var cn=y(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});ml.SolutionMapping=void 0;var p3=yt(),m3=et(),g3=sr(),Fm=class r{static{o(this,"SolutionMapping")}constructor(e){this.bindings=e?new Map(e):new Map}get(e){return this.bindings.get(e)}set(e,t){this.bindings.set(e,t)}has(e){return this.bindings.has(e)}variables(){return Array.from(this.bindings.keys())}getBindings(){return new Map(this.bindings)}isCompatibleWith(e){for(let[t,i]of this.bindings.entries()){let n=e.get(t);if(n!==void 0&&!this.areEqual(i,n))return!1}return!0}merge(e){if(!this.isCompatibleWith(e))return null;let t=new r(this.bindings);for(let[i,n]of e.getBindings().entries())t.set(i,n);return t}clone(){return new r(this.bindings)}areEqual(e,t){return e instanceof p3.Literal&&t instanceof p3.Literal?e.equals(t):e instanceof m3.IRI&&t instanceof m3.IRI?e.value===t.value:e instanceof g3.BlankNode&&t instanceof g3.BlankNode?e.id===t.id:!1}toJSON(){let e={};for(let[t,i]of this.bindings.entries())e[t]=i.toString();return e}size(){return this.bindings.size}};ml.SolutionMapping=Fm});var v3=y(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.PropertyPathExecutor=da.PropertyPathExecutorError=void 0;var dP=cn(),gl=et(),y3=sr(),Do=class extends Error{static{o(this,"PropertyPathExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="PropertyPathExecutorError"}};da.PropertyPathExecutorError=Do;var Im=class{static{o(this,"PropertyPathExecutor")}constructor(e){this.tripleStore=e,this.MAX_DEPTH=100}async*execute(e,t,i){let n=await this.resolveElement(e),s=this.isVariable(i)?null:await this.resolveElement(i);for(let a of n){let c=await this.evaluatePath(a,t,s);for(let u of c){let l=new dP.SolutionMapping;this.isVariable(e)&&l.set(e.value,a),this.isVariable(i)&&l.set(i.value,u),yield l}}}async*executeWithBindings(e,t){if(!this.isPropertyPath(e.predicate))throw new Do("Predicate is not a property path");let i=this.instantiateElement(e.subject,t),n=this.instantiateElement(e.object,t);for await(let s of this.execute(i,e.predicate,n)){let a=t.merge(s);a!==null&&(yield a)}}async evaluatePath(e,t,i){switch(t.pathType){case"/":return this.evaluateSequencePath(e,t.items,i);case"|":return this.evaluateAlternativePath(e,t.items,i);case"^":return this.evaluateInversePath(e,t.items[0],i);case"+":return this.evaluateOneOrMorePath(e,t.items[0],i);case"*":return this.evaluateZeroOrMorePath(e,t.items[0],i);case"?":return this.evaluateZeroOrOnePath(e,t.items[0],i)}}async evaluateSequencePath(e,t,i){let n=new Set([e]);for(let s=0;s<t.length;s++){let a=t[s],c=s===t.length-1,u=new Set;for(let l of n){let f=await this.evaluatePathItem(l,a,c?i:null);for(let h of f)u.add(h)}if(n=u,n.size===0)break}return n}async evaluateAlternativePath(e,t,i){let n=new Set;for(let s of t){let a=await this.evaluatePathItem(e,s,i);for(let c of a)n.add(c)}return n}async evaluateInversePath(e,t,i){if(t.type==="iri"){let n=new gl.IRI(t.value),s=await this.tripleStore.match(void 0,n,e),a=new Set;for(let c of s)(i===null||this.nodeInSet(c.subject,i))&&a.add(c.subject);return a}else return this.evaluatePath(e,this.invertPath(t),i)}async evaluateOneOrMorePath(e,t,i){let n=new Set,s=new Set,a=[{node:e,depth:0}];for(;a.length>0;){let{node:c,depth:u}=a.shift();if(u>=this.MAX_DEPTH)continue;let l=await this.evaluatePathItem(c,t,null);for(let f of l){let h=this.nodeToKey(f);(i===null||this.nodeInSet(f,i))&&s.add(f),n.has(h)||(n.add(h),a.push({node:f,depth:u+1}))}}return s}async evaluateZeroOrMorePath(e,t,i){let n=await this.evaluateOneOrMorePath(e,t,i);return(i===null||this.nodeInSet(e,i))&&n.add(e),n}async evaluateZeroOrOnePath(e,t,i){let n=new Set;(i===null||this.nodeInSet(e,i))&&n.add(e);let s=await this.evaluatePathItem(e,t,i);for(let a of s)n.add(a);return n}async evaluatePathItem(e,t,i){if(t.type==="iri"){let n=new gl.IRI(t.value),s=await this.tripleStore.match(e,n,void 0),a=new Set;for(let c of s)(i===null||this.nodeInSet(c.object,i))&&a.add(c.object);return a}else return this.evaluatePath(e,t,i)}invertPath(e){switch(e.pathType){case"^":return e.items[0];case"/":return{type:"path",pathType:"/",items:[...e.items].reverse().map(i=>i.type==="iri"?{type:"path",pathType:"^",items:[i]}:this.invertPath(i))};case"|":return{type:"path",pathType:"|",items:e.items.map(i=>i.type==="iri"?{type:"path",pathType:"^",items:[i]}:this.invertPath(i))};case"+":case"*":case"?":let t=e.items[0].type==="iri"?{type:"path",pathType:"^",items:[e.items[0]]}:this.invertPath(e.items[0]);return{type:"path",pathType:e.pathType,items:[t]}}}async resolveElement(e){if(this.isVariable(e)){let i=new Set,n=await this.tripleStore.match(void 0,void 0,void 0);for(let s of n)i.add(s.subject),i.add(s.object);return i}let t=new Set;switch(e.type){case"iri":t.add(new gl.IRI(e.value));break;case"blank":t.add(new y3.BlankNode(e.value));break;default:throw new Do(`Unsupported element type in subject/object position: ${e.type}`)}return t}instantiateElement(e,t){if(this.isVariable(e)){let i=t.get(e.value);if(i){if(i instanceof gl.IRI)return{type:"iri",value:i.value};if(i instanceof y3.BlankNode)return{type:"blank",value:i.id}}}return e}isVariable(e){return e.type==="variable"}isPropertyPath(e){return e.type==="path"}nodeToKey(e){return e.toString()}nodeInSet(e,t){let i=this.nodeToKey(e);for(let n of t)if(this.nodeToKey(n)===i)return!0;return!1}};da.PropertyPathExecutor=Im});var Nm=y(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.BGPExecutor=pa.BGPExecutorError=void 0;var yl=cn(),In=et(),Rm=yt(),vl=sr(),_l=eu(),pP=v3(),Ht=class extends Error{static{o(this,"BGPExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="BGPExecutorError"}};pa.BGPExecutorError=Ht;var Dm=class{static{o(this,"BGPExecutor")}constructor(e){this.tripleStore=e,this.propertyPathExecutor=new pP.PropertyPathExecutor(e)}async*execute(e){if(e.triples.length===0){yield new yl.SolutionMapping;return}let t=this.matchTriplePattern(e.triples[0]);for(let i=1;i<e.triples.length;i++)t=this.joinWithPattern(t,e.triples[i]);for await(let i of t)yield i}async executeAll(e){let t=[];for await(let i of this.execute(e))t.push(i);return t}async*executeInGraph(e,t){if(e.triples.length===0){yield new yl.SolutionMapping;return}let i=this.matchTriplePatternInGraph(e.triples[0],t);for(let n=1;n<e.triples.length;n++)i=this.joinWithPatternInGraph(i,e.triples[n],t);for await(let n of i)yield n}async*matchTriplePatternInGraph(e,t){if(this.isPropertyPath(e.predicate))throw new Ht("Property paths within named graphs are not yet supported");let i=e.predicate,n=this.isVariable(e.subject)?void 0:this.toRDFTermAsSubject(e.subject),s=this.isVariable(i)?void 0:this.toRDFTermAsPredicate(i),a=this.isVariable(e.object)?void 0:this.toRDFTerm(e.object);if(!this.tripleStore.matchInGraph)throw new Ht("Triple store does not support named graph operations");let c=await this.tripleStore.matchInGraph(n,s,a,t);for(let u of c){let l=new yl.SolutionMapping;this.isVariable(e.subject)&&l.set(e.subject.value,u.subject),this.isVariable(i)&&l.set(i.value,u.predicate),this.isVariable(e.object)&&l.set(e.object.value,u.object),yield l}}async*joinWithPatternInGraph(e,t,i){let n=[];for await(let s of e)n.push(s);for(let s of n){let a=this.instantiatePattern(t,s);for await(let c of this.matchTriplePatternInGraph(a,i)){let u=s.merge(c);u!==null&&(yield u)}}}async*matchTriplePattern(e){if(this.isPropertyPath(e.predicate)){yield*this.propertyPathExecutor.execute(e.subject,e.predicate,e.object);return}let t=e.predicate,i=this.isVariable(e.subject)||this.isQuotedTriple(e.subject)&&this.hasVariablesInQuotedTriple(e.subject)?void 0:this.toRDFTermAsSubject(e.subject),n=this.isVariable(t)?void 0:this.toRDFTermAsPredicate(t),s=this.isVariable(e.object)||this.isQuotedTriple(e.object)&&this.hasVariablesInQuotedTriple(e.object)?void 0:this.toRDFTerm(e.object),a=await this.tripleStore.match(i,n,s);for(let c of a){let u=new yl.SolutionMapping;if(this.isVariable(e.subject))u.set(e.subject.value,c.subject);else if(this.isQuotedTriple(e.subject)){let l=this.matchQuotedTriplePattern(e.subject,c.subject);if(l===null)continue;for(let[f,h]of l.entries())u.set(f,h)}if(this.isVariable(t)&&u.set(t.value,c.predicate),this.isVariable(e.object))u.set(e.object.value,c.object);else if(this.isQuotedTriple(e.object)){let l=this.matchQuotedTriplePattern(e.object,c.object);if(l===null)continue;for(let[f,h]of l.entries())u.set(f,h)}yield u}}hasVariablesInQuotedTriple(e){return!!(this.isVariable(e.subject)||e.predicate.type==="variable"||this.isVariable(e.object)||this.isQuotedTriple(e.subject)&&this.hasVariablesInQuotedTriple(e.subject)||this.isQuotedTriple(e.object)&&this.hasVariablesInQuotedTriple(e.object))}matchQuotedTriplePattern(e,t){if(!(t instanceof _l.QuotedTriple))return null;let i=new Map;if(this.isVariable(e.subject))i.set(e.subject.value,t.subject);else if(this.isQuotedTriple(e.subject)){let n=this.matchQuotedTriplePattern(e.subject,t.subject);if(n===null)return null;for(let[s,a]of n)i.set(s,a)}else if(!this.elementsMatch(e.subject,t.subject))return null;if(e.predicate.type==="variable")i.set(e.predicate.value,t.predicate);else if(e.predicate.value!==t.predicate.value)return null;if(this.isVariable(e.object))i.set(e.object.value,t.object);else if(this.isQuotedTriple(e.object)){let n=this.matchQuotedTriplePattern(e.object,t.object);if(n===null)return null;for(let[s,a]of n)i.set(s,a)}else if(!this.elementsMatch(e.object,t.object))return null;return i}elementsMatch(e,t){switch(e.type){case"iri":return t instanceof In.IRI&&e.value===t.value;case"literal":return!(!(t instanceof Rm.Literal)||e.value!==t.value||e.datatype!==t.datatype?.value||e.language!==t.language);case"blank":return t instanceof vl.BlankNode&&e.value===t.id;case"quoted":return t instanceof _l.QuotedTriple?this.toRDFQuotedTriple(e).equals(t):!1;default:return!1}}isPropertyPath(e){return e.type==="path"}async*joinWithPattern(e,t){let i=[];for await(let n of e)i.push(n);for(let n of i){let s=this.instantiatePattern(t,n);for await(let a of this.matchTriplePattern(s)){let c=n.merge(a);c!==null&&(yield c)}}}instantiatePattern(e,t){let i=this.isPropertyPath(e.predicate)?e.predicate:this.instantiateElement(e.predicate,t);return{subject:this.instantiateElement(e.subject,t),predicate:i,object:this.instantiateElement(e.object,t)}}instantiateElement(e,t){if(this.isVariable(e)){let i=t.get(e.value);if(i)return this.toAlgebraElement(i)}return this.isQuotedTriple(e)?this.instantiateQuotedTriple(e,t):e}instantiateQuotedTriple(e,t){let i=this.instantiateElement(e.subject,t),n=e.predicate.type==="variable"?this.instantiatePredicateVariable(e.predicate,t):e.predicate,s=this.instantiateElement(e.object,t);return{type:"quoted",subject:i,predicate:n,object:s}}instantiatePredicateVariable(e,t){let i=t.get(e.value);return i&&i instanceof In.IRI?{type:"iri",value:i.value}:e}isVariable(e){return e.type==="variable"}isQuotedTriple(e){return e.type==="quoted"}toRDFTermAsSubject(e){switch(e.type){case"iri":return new In.IRI(e.value);case"blank":return new vl.BlankNode(e.value);case"literal":throw new Ht("Literals cannot appear in subject position");case"variable":throw new Ht(`Cannot convert variable to RDF term: ${e.value}`);case"quoted":return this.toRDFQuotedTriple(e);default:throw new Ht(`Unknown element type: ${e.type}`)}}toRDFQuotedTriple(e){let t=this.toRDFTermAsSubject(e.subject),i=e.predicate.type==="iri"?new In.IRI(e.predicate.value):(()=>{throw new Ht("Quoted triple predicate must be IRI")})(),n=this.toRDFTerm(e.object);return new _l.QuotedTriple(t,i,n)}toRDFTermAsPredicate(e){switch(e.type){case"iri":return new In.IRI(e.value);case"literal":throw new Ht("Literals cannot appear in predicate position");case"blank":throw new Ht("Blank nodes cannot appear in predicate position");case"variable":throw new Ht(`Cannot convert variable to RDF term: ${e.value}`);default:throw new Ht(`Unknown element type: ${e.type}`)}}toRDFTerm(e){switch(e.type){case"iri":return new In.IRI(e.value);case"literal":return new Rm.Literal(e.value,e.datatype?new In.IRI(e.datatype):void 0,e.language);case"blank":return new vl.BlankNode(e.value);case"variable":throw new Ht(`Cannot convert variable to RDF term: ${e.value}`);case"quoted":return this.toRDFQuotedTriple(e);default:throw new Ht(`Unknown element type: ${e.type}`)}}toAlgebraElement(e){if(e instanceof In.IRI)return{type:"iri",value:e.value};if(e instanceof Rm.Literal)return{type:"literal",value:e.value,datatype:e.datatype?.value,language:e.language};if(e instanceof vl.BlankNode)return{type:"blank",value:e.id};if(e instanceof _l.QuotedTriple)return this.toAlgebraQuotedTriple(e);throw new Ht(`Unknown RDF term type: ${e.constructor?.name||"unknown"}`)}toAlgebraQuotedTriple(e){return{type:"quoted",subject:this.toAlgebraElement(e.subject),predicate:{type:"iri",value:e.predicate.value},object:this.toAlgebraElement(e.object)}}};pa.BGPExecutor=Dm});var jm=y(wl=>{"use strict";Object.defineProperty(wl,"__esModule",{value:!0});wl.BuiltInFunctions=void 0;var Be=et(),$=yt(),hi=sr(),km=Cr(),No=class{static{o(this,"BuiltInFunctions")}static str(e){if(e===void 0)throw new Error("STR: argument is undefined");return e instanceof Be.IRI||e instanceof $.Literal?e.value:e instanceof hi.BlankNode?e.id:String(e)}static lang(e){if(e===void 0)throw new Error("LANG: argument is undefined");return e instanceof $.Literal&&e.language?e.language:""}static langdir(e){if(e===void 0)throw new Error("LANGDIR: argument is undefined");return!(e instanceof $.Literal)||!e.language?"":e.direction?`${e.language}--${e.direction}`:e.language}static langMatches(e,t){let i=e.toLowerCase(),n=t.toLowerCase();return n==="*"?i!=="":i===""?n==="":i===n?!0:i.startsWith(n+"-")}static datatype(e){if(e===void 0)throw new Error("DATATYPE: argument is undefined");if(e instanceof $.Literal)return e.datatype?e.datatype:e.language?new Be.IRI("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"):new Be.IRI("http://www.w3.org/2001/XMLSchema#string");throw new Error("DATATYPE: argument must be a literal")}static bound(e){return e!==void 0}static isIRI(e){return e===void 0?!1:e instanceof Be.IRI}static isBlank(e){return e===void 0?!1:e instanceof hi.BlankNode}static isLiteral(e){return e===void 0?!1:e instanceof $.Literal}static isNumeric(e){if(e===void 0||!(e instanceof $.Literal))return!1;let t=e.datatype?.value;return t?["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float","http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedShort","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#positiveInteger"].includes(t):!1}static regex(e,t,i){try{return new RegExp(t,i).test(e)}catch(n){throw new Error(`REGEX: invalid pattern '${t}': ${n.message}`)}}static compare(e,t,i){if(this.isDayTimeDurationValue(e)&&this.isDayTimeDurationValue(t))return this.compareDurations(e instanceof $.Literal?e:String(e),t instanceof $.Literal?t:String(t),i);let n=this.toComparableValue(e),s=this.toComparableValue(t);switch(i){case"=":return n===s;case"!=":return n!==s;case"<":return n<s;case">":return n>s;case"<=":return n<=s;case">=":return n>=s;default:throw new Error(`Unknown comparison operator: ${i}`)}}static isDayTimeDurationValue(e){return e instanceof $.Literal?(e.datatype?.value||"")==="http://www.w3.org/2001/XMLSchema#dayTimeDuration":!1}static toComparableValue(e){if(typeof e=="string"||typeof e=="number")return e;if(e instanceof $.Literal){let t=e.datatype?.value;if(t?.includes("#integer")||t?.includes("#decimal")||t?.includes("#double")){let i=parseFloat(e.value);if(!isNaN(i))return i}if(t==="http://www.w3.org/2001/XMLSchema#dayTimeDuration")try{return this.parseDayTimeDuration(e.value)}catch{return e.value}return e.value}return e instanceof Be.IRI?e.value:e instanceof hi.BlankNode?e.id:String(e)}static contains(e,t){return e.includes(t)}static strStarts(e,t){return e.startsWith(t)}static strEnds(e,t){return e.endsWith(t)}static strlen(e){return e.length}static ucase(e){return e.toUpperCase()}static lcase(e){return e.toLowerCase()}static substr(e,t,i){let n=t-1;if(n<0){if(i!==void 0){let s=i+n;return s<=0?"":e.substring(0,s)}return e}return i!==void 0?e.substring(n,n+i):e.substring(n)}static strBefore(e,t){if(t==="")return"";let i=e.indexOf(t);return i===-1?"":e.substring(0,i)}static strAfter(e,t){if(t==="")return e;let i=e.indexOf(t);return i===-1?"":e.substring(i+t.length)}static concat(...e){return e.join("")}static replace(e,t,i,n){try{let s=new RegExp(t,n||"g");return e.replace(s,i)}catch(s){throw new Error(`REPLACE: invalid pattern '${t}': ${s.message}`)}}static parseDate(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`PARSEDATE: invalid date string '${e}'`);return t.getTime()}static dateBefore(e,t){let i=this.parseDate(e),n=this.parseDate(t);return i<n}static dateAfter(e,t){let i=this.parseDate(e),n=this.parseDate(t);return i>n}static dateInRange(e,t,i){let n=this.parseDate(e),s=this.parseDate(t),a=this.parseDate(i);return n>=s&&n<=a}static dateDiffMinutes(e,t){let i=this.parseDate(e),n=this.parseDate(t),s=Math.abs(n-i);return Math.round(s/(1e3*60))}static dateDiffHours(e,t){let i=this.parseDate(e),n=this.parseDate(t),s=Math.abs(n-i);return Math.round(s/(1e3*60*60)*100)/100}static logicalAnd(e){return e.every(t=>t===!0)}static logicalOr(e){return e.some(t=>t===!0)}static logicalNot(e){return!e}static year(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`YEAR: invalid date string '${e}'`);return t.getFullYear()}static month(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`MONTH: invalid date string '${e}'`);return t.getMonth()+1}static day(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`DAY: invalid date string '${e}'`);return t.getDate()}static hours(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`HOURS: invalid date string '${e}'`);return t.getHours()}static minutes(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`MINUTES: invalid date string '${e}'`);return t.getMinutes()}static seconds(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`SECONDS: invalid date string '${e}'`);return t.getSeconds()+t.getMilliseconds()/1e3}static timezone(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`TIMEZONE: invalid date string '${e}'`);let i;if(e.endsWith("Z"))i="PT0S";else{let n=e.match(/([+-]\d{2}):?(\d{2})$/);if(n){let s=parseInt(n[1],10),a=parseInt(n[2],10),c=s>=0?"":"-",u=Math.abs(s);a===0?i=`${c}PT${u}H`:i=`${c}PT${u}H${a}M`}else{let s=-t.getTimezoneOffset(),a=Math.floor(Math.abs(s)/60),c=Math.abs(s)%60,u=s>=0?"":"-";c===0?i=`${u}PT${a}H`:i=`${u}PT${a}H${c}M`}}return new $.Literal(i,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static tz(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`TZ: invalid date string '${e}'`);if(e.endsWith("Z"))return"Z";let i=e.match(/([+-]\d{2}:\d{2})$/);if(i)return i[1];let n=e.match(/([+-])(\d{2})(\d{2})$/);return n?`${n[1]}${n[2]}:${n[3]}`:""}static now(){return new Date().toISOString()}static msToMinutes(e){return Math.round(e/(1e3*60))}static msToHours(e){return Math.round(e/(1e3*60*60)*100)/100}static msToSeconds(e){return Math.round(e/1e3)}static abs(e){return Math.abs(e)}static round(e){return Math.round(e)}static ceil(e){return Math.ceil(e)}static floor(e){return Math.floor(e)}static rand(){return Math.random()}static coalesce(e){for(let t of e)if(t!=null)return t}static if(e,t,i){return e?t:i}static xsdDateTime(e){let t=new Date(e);if(isNaN(t.getTime()))throw new Error(`xsd:dateTime: invalid date string '${e}'`);return new $.Literal(t.toISOString(),new Be.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}static xsdInteger(e){let t=parseInt(e,10);if(isNaN(t))throw new Error(`xsd:integer: cannot convert '${e}' to integer`);return new $.Literal(String(t),new Be.IRI("http://www.w3.org/2001/XMLSchema#integer"))}static xsdDecimal(e){let t=parseFloat(e);if(isNaN(t))throw new Error(`xsd:decimal: cannot convert '${e}' to decimal`);return new $.Literal(String(t),new Be.IRI("http://www.w3.org/2001/XMLSchema#decimal"))}static encodeForUri(e){return encodeURIComponent(e)}static md5(e){return require("crypto").createHash("md5").update(e).digest("hex")}static sha1(e){return require("crypto").createHash("sha1").update(e).digest("hex")}static sha256(e){return require("crypto").createHash("sha256").update(e).digest("hex")}static sha384(e){return require("crypto").createHash("sha384").update(e).digest("hex")}static sha512(e){return require("crypto").createHash("sha512").update(e).digest("hex")}static sameTerm(e,t){if(e===void 0&&t===void 0)return!0;if(e===void 0||t===void 0||e.constructor!==t.constructor)return!1;if(e instanceof Be.IRI&&t instanceof Be.IRI)return e.value===t.value;if(e instanceof hi.BlankNode&&t instanceof hi.BlankNode)return e.id===t.id;if(e instanceof $.Literal&&t instanceof $.Literal){if(e.value!==t.value||e.language!==t.language)return!1;let i=e.datatype?.value,n=t.datatype?.value;return i===n}return!1}static iri(e){if(e===void 0)throw new Error("IRI: argument is undefined");if(e instanceof Be.IRI)return e;if(e instanceof $.Literal)return new Be.IRI(e.value);throw e instanceof hi.BlankNode?new Error("IRI: cannot convert blank node to IRI"):new Error("IRI: unsupported term type")}static uri(e){return this.iri(e)}static bnode(e){if(e===void 0){let t=`b${(0,km.v4)().replace(/-/g,"").substring(0,12)}`;return new hi.BlankNode(t)}if(e instanceof $.Literal)return new hi.BlankNode(e.value);if(e instanceof hi.BlankNode)return e;throw new Error("BNODE: argument must be a string literal or omitted")}static strdt(e,t){if(e===void 0)throw new Error("STRDT: lexical form is undefined");if(t===void 0)throw new Error("STRDT: datatype IRI is undefined");let i;if(e instanceof $.Literal){if(e.language)throw new Error("STRDT: lexical form must not have a language tag");i=e.value}else if(typeof e=="string")i=e;else throw new Error("STRDT: lexical form must be a string literal");let n;if(t instanceof Be.IRI)n=t;else if(t instanceof $.Literal)n=new Be.IRI(t.value);else throw new Error("STRDT: datatype must be an IRI");return new $.Literal(i,n)}static strlang(e,t){if(e===void 0)throw new Error("STRLANG: lexical form is undefined");if(t===void 0)throw new Error("STRLANG: language tag is undefined");let i;if(e instanceof $.Literal){if(e.language)throw new Error("STRLANG: lexical form must not already have a language tag");i=e.value}else if(typeof e=="string")i=e;else throw new Error("STRLANG: lexical form must be a string literal");let n;if(t instanceof $.Literal)n=t.value;else if(typeof t=="string")n=t;else throw new Error("STRLANG: language tag must be a string literal");if(n==="")throw new Error("STRLANG: language tag cannot be empty");return new $.Literal(i,void 0,n)}static strlangdir(e,t,i){if(e===void 0)throw new Error("STRLANGDIR: lexical form is undefined");if(t===void 0)throw new Error("STRLANGDIR: language tag is undefined");if(i===void 0)throw new Error("STRLANGDIR: direction is undefined");let n;if(e instanceof $.Literal){if(e.language)throw new Error("STRLANGDIR: lexical form must not already have a language tag");n=e.value}else if(typeof e=="string")n=e;else throw new Error("STRLANGDIR: lexical form must be a string literal");let s;if(t instanceof $.Literal)s=t.value;else if(typeof t=="string")s=t;else throw new Error("STRLANGDIR: language tag must be a string literal");if(s==="")throw new Error("STRLANGDIR: language tag cannot be empty");let a;if(i instanceof $.Literal)a=i.value.toLowerCase();else throw new Error("STRLANGDIR: direction must be a string literal");if(a!=="ltr"&&a!=="rtl")throw new Error(`STRLANGDIR: invalid direction '${a}'. Must be 'ltr' or 'rtl'`);return new $.Literal(n,void 0,s,a)}static uuid(){let e=(0,km.v4)();return new Be.IRI(`urn:uuid:${e}`)}static struuid(){let e=(0,km.v4)();return new $.Literal(e)}static parseDayTimeDuration(e){if(!e)throw new Error("parseDayTimeDuration: duration string is empty");let t=!1,i=e.trim();if(i.startsWith("-")&&(t=!0,i=i.substring(1)),!i.startsWith("P"))throw new Error(`parseDayTimeDuration: invalid format, must start with 'P': '${e}'`);i=i.substring(1);let n=0,s=i.indexOf("T"),a="",c="";if(s===-1?a=i:(a=i.substring(0,s),c=i.substring(s+1)),a){let u=a.match(/^(\d+(?:\.\d+)?)D$/);if(u){let l=parseFloat(u[1]);n+=l*24*60*60*1e3}else if(a!=="")throw new Error(`parseDayTimeDuration: invalid day component: '${a}' in '${e}'`)}if(c){let u=c,l=u.match(/^(\d+(?:\.\d+)?)H/);if(l){let d=parseFloat(l[1]);n+=d*60*60*1e3,u=u.substring(l[0].length)}let f=u.match(/^(\d+(?:\.\d+)?)M/);if(f){let d=parseFloat(f[1]);n+=d*60*1e3,u=u.substring(f[0].length)}let h=u.match(/^(\d+(?:\.\d+)?)S$/);if(h){let d=parseFloat(h[1]);n+=d*1e3,u=u.substring(h[0].length)}if(u!=="")throw new Error(`parseDayTimeDuration: invalid time component: '${u}' in '${e}'`)}return t?-n:n}static formatDayTimeDuration(e){let t=e<0,i=Math.abs(e),n=Math.floor(i/(1440*60*1e3));i=i%(1440*60*1e3);let s=Math.floor(i/(3600*1e3));i=i%(3600*1e3);let a=Math.floor(i/(60*1e3));i=i%(60*1e3);let c=i/1e3,u=t?"-P":"P";return n>0&&(u+=`${n}D`),(s>0||a>0||c>0||n===0)&&(u+="T",s>0&&(u+=`${s}H`),a>0&&(u+=`${a}M`),(c>0||s===0&&a===0)&&(Number.isInteger(c)?u+=`${c}S`:u+=`${parseFloat(c.toFixed(3))}S`)),u}static xsdDayTimeDuration(e){return this.parseDayTimeDuration(e),new $.Literal(e,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static compareDurations(e,t,i){let n=e instanceof $.Literal?e.value:e,s=t instanceof $.Literal?t.value:t,a=this.parseDayTimeDuration(n),c=this.parseDayTimeDuration(s);switch(i){case"=":return a===c;case"!=":return a!==c;case"<":return a<c;case">":return a>c;case"<=":return a<=c;case">=":return a>=c;default:throw new Error(`compareDurations: unknown operator: ${i}`)}}static isDayTimeDuration(e){return e instanceof $.Literal?(e.datatype?.value||"")==="http://www.w3.org/2001/XMLSchema#dayTimeDuration":!1}static dateTimeDiff(e,t){let i=e instanceof $.Literal?e.value:e,n=t instanceof $.Literal?t.value:t,s=new Date(i),a=new Date(n);if(isNaN(s.getTime()))throw new Error(`dateTimeDiff: invalid first dateTime: '${i}'`);if(isNaN(a.getTime()))throw new Error(`dateTimeDiff: invalid second dateTime: '${n}'`);let c=s.getTime()-a.getTime(),u=this.formatDayTimeDuration(c);return new $.Literal(u,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static dateTimeAdd(e,t){let i=e instanceof $.Literal?e.value:e,n=t instanceof $.Literal?t.value:t,s=new Date(i);if(isNaN(s.getTime()))throw new Error(`dateTimeAdd: invalid dateTime: '${i}'`);let a=this.parseDayTimeDuration(n),c=s.getTime()+a,u=new Date(c);return new $.Literal(u.toISOString(),new Be.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}static dateTimeSubtract(e,t){let i=e instanceof $.Literal?e.value:e,n=t instanceof $.Literal?t.value:t,s=new Date(i);if(isNaN(s.getTime()))throw new Error(`dateTimeSubtract: invalid dateTime: '${i}'`);let a=this.parseDayTimeDuration(n),c=s.getTime()-a,u=new Date(c);return new $.Literal(u.toISOString(),new Be.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}static durationAdd(e,t){let i=e instanceof $.Literal?e.value:e,n=t instanceof $.Literal?t.value:t,s=this.parseDayTimeDuration(i),a=this.parseDayTimeDuration(n),c=this.formatDayTimeDuration(s+a);return new $.Literal(c,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static durationSubtract(e,t){let i=e instanceof $.Literal?e.value:e,n=t instanceof $.Literal?t.value:t,s=this.parseDayTimeDuration(i),a=this.parseDayTimeDuration(n),c=this.formatDayTimeDuration(s-a);return new $.Literal(c,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static durationMultiply(e,t){let i=e instanceof $.Literal?e.value:e,n=this.parseDayTimeDuration(i),s=this.formatDayTimeDuration(n*t);return new $.Literal(s,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static durationDivide(e,t){if(t===0)throw new Error("durationDivide: division by zero");let i=e instanceof $.Literal?e.value:e,n=this.parseDayTimeDuration(i),s=this.formatDayTimeDuration(n/t);return new $.Literal(s,new Be.IRI("http://www.w3.org/2001/XMLSchema#dayTimeDuration"))}static durationToDays(e){let t=e instanceof $.Literal?e.value:e;return this.parseDayTimeDuration(t)/(1440*60*1e3)}static durationToHours(e){let t=e instanceof $.Literal?e.value:e;return this.parseDayTimeDuration(t)/(3600*1e3)}static durationToMinutes(e){let t=e instanceof $.Literal?e.value:e;return this.parseDayTimeDuration(t)/(60*1e3)}static durationToSeconds(e){let t=e instanceof $.Literal?e.value:e;return this.parseDayTimeDuration(t)/1e3}static parseDurationComponents(e){if(!e)throw new Error("parseDurationComponents: duration string is empty");let t=!1,i=e.trim();if(i.startsWith("-")&&(t=!0,i=i.substring(1)),!i.startsWith("P"))throw new Error(`parseDurationComponents: invalid format, must start with 'P': '${e}'`);i=i.substring(1);let n=0,s=0,a=0,c=0,u=i.indexOf("T"),l="",f="";if(u===-1?l=i:(l=i.substring(0,u),f=i.substring(u+1)),l){let h=l.match(/^(\d+(?:\.\d+)?)D$/);if(h)n=parseFloat(h[1]);else if(l!=="")throw new Error(`parseDurationComponents: invalid day component: '${l}' in '${e}'`)}if(f){let h=f,d=h.match(/^(\d+(?:\.\d+)?)H/);d&&(s=parseFloat(d[1]),h=h.substring(d[0].length));let g=h.match(/^(\d+(?:\.\d+)?)M/);g&&(a=parseFloat(g[1]),h=h.substring(g[0].length));let w=h.match(/^(\d+(?:\.\d+)?)S$/);if(w&&(c=parseFloat(w[1]),h=h.substring(w[0].length)),h!=="")throw new Error(`parseDurationComponents: invalid time component: '${h}' in '${e}'`)}return{negative:t,days:n,hours:s,minutes:a,seconds:c}}static durationDays(e){let t=e instanceof $.Literal?e.value:e,i=this.parseDurationComponents(t),n=Math.floor(i.days);return i.negative?-n:n}static durationHours(e){let t=e instanceof $.Literal?e.value:e,i=this.parseDurationComponents(t),n=Math.floor(i.hours);return i.negative?-n:n}static durationMinutes(e){let t=e instanceof $.Literal?e.value:e,i=this.parseDurationComponents(t),n=Math.floor(i.minutes);return i.negative?-n:n}static durationSeconds(e){let t=e instanceof $.Literal?e.value:e,i=this.parseDurationComponents(t);return i.negative?-i.seconds:i.seconds}static adjust(e,t){let i=e instanceof $.Literal?e.value:e,n=new Date(i);if(isNaN(n.getTime()))throw new Error(`ADJUST: invalid dateTime: '${i}'`);if(t==null){let Ie=n.getUTCFullYear(),Je=String(n.getUTCMonth()+1).padStart(2,"0"),ot=String(n.getUTCDate()).padStart(2,"0"),q=String(n.getUTCHours()).padStart(2,"0"),ue=String(n.getUTCMinutes()).padStart(2,"0"),we=String(n.getUTCSeconds()).padStart(2,"0"),He=n.getUTCMilliseconds(),Ue=`${Ie}-${Je}-${ot}T${q}:${ue}:${we}`;return He>0&&(Ue+=`.${String(He).padStart(3,"0")}`),new $.Literal(Ue,new Be.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}let s=t instanceof $.Literal?t.value:t,a=this.parseDayTimeDuration(s),c=840*60*1e3;if(Math.abs(a)>c)throw new Error(`ADJUST: timezone offset out of range: '${s}'`);let u=n.getTime(),l=new Date(u+a),f=l.getUTCFullYear(),h=String(l.getUTCMonth()+1).padStart(2,"0"),d=String(l.getUTCDate()).padStart(2,"0"),g=String(l.getUTCHours()).padStart(2,"0"),w=String(l.getUTCMinutes()).padStart(2,"0"),b=String(l.getUTCSeconds()).padStart(2,"0"),x=l.getUTCMilliseconds(),O=a>=0?"+":"-",F=Math.floor(Math.abs(a)/(3600*1e3)),k=Math.floor(Math.abs(a)%(3600*1e3)/(60*1e3)),G=`${O}${String(F).padStart(2,"0")}:${String(k).padStart(2,"0")}`,W=`${f}-${h}-${d}T${g}:${w}:${b}`;return x>0&&(W+=`.${String(x).padStart(3,"0")}`),W+=G,new $.Literal(W,new Be.IRI("http://www.w3.org/2001/XMLSchema#dateTime"))}static normalize(e,t){if(e===void 0)throw new Error("NORMALIZE: string argument is undefined");let i;if(e instanceof $.Literal)i=e.value;else if(e instanceof Be.IRI)i=e.value;else if(e instanceof hi.BlankNode)i=e.id;else if(typeof e=="string")i=e;else throw new Error("NORMALIZE: first argument must be a string or literal");let n="NFC";if(t!==void 0)if(t instanceof $.Literal)n=t.value.toUpperCase();else if(typeof t=="string")n=t.toUpperCase();else if(t instanceof Be.IRI)n=t.value.toUpperCase();else throw new Error("NORMALIZE: second argument must be a string literal");if(!this.VALID_NORMALIZATION_FORMS.includes(n))throw new Error(`NORMALIZE: invalid normalization form '${n}'. Valid forms are: NFC, NFD, NFKC, NFKD`);let s=i.normalize(n);return new $.Literal(s,new Be.IRI("http://www.w3.org/2001/XMLSchema#string"))}static fold(e){if(e===void 0)throw new Error("FOLD: string argument is undefined");let t;if(e instanceof $.Literal)t=e.value;else if(e instanceof Be.IRI)t=e.value;else if(e instanceof hi.BlankNode)t=e.id;else if(typeof e=="string")t=e;else throw new Error("FOLD: argument must be a string or literal");let i=this.unicodeCaseFold(t);return new $.Literal(i,new Be.IRI("http://www.w3.org/2001/XMLSchema#string"))}static unicodeCaseFold(e){let t="";for(let i of e){let n=this.CASE_FOLDING_MAP.get(i);n!==void 0?t+=n:t+=i.toLowerCase()}return t}};wl.BuiltInFunctions=No;No.VALID_NORMALIZATION_FORMS=["NFC","NFD","NFKC","NFKD"];No.CASE_FOLDING_MAP=new Map([["\xDF","ss"],["\u1E9E","ss"],["\u03A3","\u03C3"],["\u03C2","\u03C3"],["\u0130","i\u0307"],["I","i"],["\u0587","\u0565\u0582"],["\uFB00","ff"],["\uFB01","fi"],["\uFB02","fl"],["\uFB03","ffi"],["\uFB04","ffl"],["\uFB05","st"],["\uFB06","st"],["\u0390","\u03B9\u0308\u0301"],["\u03B0","\u03C5\u0308\u0301"],["\u017F","s"],["\u1E9B","\u1E61"],["\u212A","k"],["\u212B","\xE5"]])});var Sl=y(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.FilterExecutor=ma.FilterExecutorError=void 0;var D=jm(),bl=yt(),Mt=class extends Error{static{o(this,"FilterExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="FilterExecutorError"}};ma.FilterExecutorError=Mt;var Lm=class{static{o(this,"FilterExecutor")}constructor(){this.existsEvaluator=null,this.tripleStore=null,this.uuidCache=new Map}setExistsEvaluator(e){this.existsEvaluator=e}setTripleStore(e){this.tripleStore=e,this.uuidCache.clear()}async*execute(e,t){let i=this.expressionContainsExists(e.expression);for await(let n of t)try{let s;i?s=await this.evaluateExpressionAsync(e.expression,n):s=this.evaluateExpression(e.expression,n),s===!0&&(yield n)}catch{continue}}expressionContainsExists(e){if(e.type==="exists")return!0;if(e.type==="logical")return e.operands.some(t=>this.expressionContainsExists(t));if(e.type==="comparison")return this.expressionContainsExists(e.left)||this.expressionContainsExists(e.right);if(e.type==="in"){let t=e;return this.expressionContainsExists(t.expression)||t.list.some(i=>this.expressionContainsExists(i))}return!1}async executeAll(e,t){let i=[];async function*n(){for(let s of t)yield s}o(n,"generator");for await(let s of this.execute(e,n()))i.push(s);return i}evaluateExpression(e,t){let i=e;if(i.termType)switch(i.termType){case"Variable":return t.get(i.value);case"Literal":return i.value;case"NamedNode":return i.value;default:throw new Mt(`Unsupported termType: ${i.termType}`)}switch(e.type){case"comparison":return this.evaluateComparison(e,t);case"logical":return this.evaluateLogical(e,t);case"arithmetic":return this.evaluateArithmetic(e,t);case"function":case"functionCall":return this.evaluateFunction(e,t);case"variable":return t.get(e.name);case"literal":return e.value;case"in":return this.evaluateIn(e,t);case"exists":throw new Mt("EXISTS expressions require async evaluation. Use evaluateExpressionAsync instead.");default:throw new Mt(`Unsupported expression type: ${e.type}, expr.termType=${i.termType}`)}}async evaluateExpressionAsync(e,t){return e.type==="exists"?this.evaluateExists(e,t):e.type==="logical"?this.evaluateLogicalAsync(e,t):this.evaluateExpression(e,t)}async evaluateExists(e,t){if(!this.existsEvaluator)throw new Mt("EXISTS evaluator not set. Call setExistsEvaluator before evaluating EXISTS expressions.");let i=await this.existsEvaluator(e.pattern,t);return e.negated?!i:i}async evaluateLogicalAsync(e,t){if(e.operator==="!"){let n=await this.evaluateExpressionAsync(e.operands[0],t);return D.BuiltInFunctions.logicalNot(n)}let i=[];for(let n of e.operands){let s=await this.evaluateExpressionAsync(n,t);i.push(s)}if(e.operator==="&&")return D.BuiltInFunctions.logicalAnd(i);if(e.operator==="||")return D.BuiltInFunctions.logicalOr(i);throw new Mt(`Unknown logical operator: ${e.operator}`)}evaluateComparison(e,t){let i=this.evaluateExpression(e.left,t),n=this.evaluateExpression(e.right,t);return D.BuiltInFunctions.compare(i,n,e.operator)}evaluateLogical(e,t){if(e.operator==="!"){let n=this.evaluateExpression(e.operands[0],t);return D.BuiltInFunctions.logicalNot(n)}let i=e.operands.map(n=>this.evaluateExpression(n,t));if(e.operator==="&&")return D.BuiltInFunctions.logicalAnd(i);if(e.operator==="||")return D.BuiltInFunctions.logicalOr(i);throw new Mt(`Unknown logical operator: ${e.operator}`)}evaluateIn(e,t){let i=this.evaluateExpression(e.expression,t),n=e.list.some(s=>{let a=this.evaluateExpression(s,t);return D.BuiltInFunctions.compare(i,a,"=")});return e.negated?!n:n}evaluateArithmetic(e,t){let i=this.evaluateExpression(e.left,t),n=this.evaluateExpression(e.right,t);if(e.operator==="-"&&this.isDateTimeValue(i)&&this.isDateTimeValue(n))return D.BuiltInFunctions.dateTimeDiff(i,n);if(e.operator==="+"&&this.isDateTimeValue(i)&&this.isDayTimeDurationValue(n))return D.BuiltInFunctions.dateTimeAdd(i,n);if(e.operator==="-"&&this.isDateTimeValue(i)&&this.isDayTimeDurationValue(n))return D.BuiltInFunctions.dateTimeSubtract(i,n);if(e.operator==="+"&&this.isDayTimeDurationValue(i)&&this.isDayTimeDurationValue(n))return D.BuiltInFunctions.durationAdd(i,n);if(e.operator==="-"&&this.isDayTimeDurationValue(i)&&this.isDayTimeDurationValue(n))return D.BuiltInFunctions.durationSubtract(i,n);if(e.operator==="*"&&this.isDayTimeDurationValue(i)&&!this.isDayTimeDurationValue(n)){let c=this.toNumericValue(n);return D.BuiltInFunctions.durationMultiply(i,c)}if(e.operator==="*"&&!this.isDayTimeDurationValue(i)&&this.isDayTimeDurationValue(n)){let c=this.toNumericValue(i);return D.BuiltInFunctions.durationMultiply(n,c)}if(e.operator==="/"&&this.isDayTimeDurationValue(i)&&!this.isDayTimeDurationValue(n)){let c=this.toNumericValue(n);if(c===0)throw new Mt("Division by zero");return D.BuiltInFunctions.durationDivide(i,c)}let s=this.toNumericValue(i),a=this.toNumericValue(n);switch(e.operator){case"+":return s+a;case"-":return s-a;case"*":return s*a;case"/":if(a===0)throw new Mt("Division by zero");return s/a;default:throw new Mt(`Unknown arithmetic operator: ${e.operator}`)}}isDayTimeDurationValue(e){return e instanceof bl.Literal?(e.datatype?.value||"")==="http://www.w3.org/2001/XMLSchema#dayTimeDuration":!1}toNumericValue(e){if(typeof e=="number")return e;if(e instanceof bl.Literal){let t=e.datatype?.value||"";if(t.includes("#integer")||t.includes("#decimal")||t.includes("#double")||t.includes("#float")){let n=parseFloat(e.value);if(!isNaN(n))return n}let i=parseFloat(e.value);if(!isNaN(i))return i}if(typeof e=="string"){let t=parseFloat(e);if(!isNaN(t))return t}if(e&&typeof e=="object"&&"value"in e){let t=parseFloat(String(e.value));if(!isNaN(t))return t}throw new Mt(`Cannot convert to number: ${e}`)}isDateTimeValue(e){if(e instanceof bl.Literal){let t=e.datatype?.value||"";return t.includes("#dateTime")||t.includes("#date")?!0:/^\d{4}-\d{2}-\d{2}(T|\s)/.test(e.value)}return typeof e=="string"?/^\d{4}-\d{2}-\d{2}(T|\s)/.test(e):!1}evaluateFunction(e,t){let i;if(typeof e.function=="string")i=e.function.toLowerCase();else if(e.function&&typeof e.function=="object"&&"value"in e.function){let n=e.function.value;i=((n.includes("#")?n.split("#").pop():n.split("/").pop())||n).toLowerCase()}else throw new Mt(`Unknown function format: ${e.function}`);switch(i){case"str":let n=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.str(n);case"lang":let s=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.lang(s);case"datatype":let a=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.datatype(a).value;case"bound":if(e.args[0].type==="variable"){let v=t.get(e.args[0].name);return D.BuiltInFunctions.bound(v)}return!0;case"isiri":case"isuri":let c=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.isIRI(c);case"isblank":let u=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.isBlank(u);case"isliteral":let l=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.isLiteral(l);case"regex":let f=this.getStringValue(this.evaluateExpression(e.args[0],t)),h=this.getStringValue(this.evaluateExpression(e.args[1],t)),d=e.args[2]?this.getStringValue(this.evaluateExpression(e.args[2],t)):void 0;return D.BuiltInFunctions.regex(f,h,d);case"langmatches":let g=this.getStringValue(this.evaluateExpression(e.args[0],t)),w=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.langMatches(g,w);case"contains":let b=this.getStringValue(this.evaluateExpression(e.args[0],t)),x=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.contains(b,x);case"strstarts":let O=this.getStringValue(this.evaluateExpression(e.args[0],t)),F=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.strStarts(O,F);case"strends":let k=this.getStringValue(this.evaluateExpression(e.args[0],t)),G=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.strEnds(k,G);case"strlen":let W=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.strlen(W);case"ucase":let Ie=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.ucase(Ie);case"lcase":let Je=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.lcase(Je);case"substr":let ot=this.getStringValue(this.evaluateExpression(e.args[0],t)),q=Number(this.evaluateExpression(e.args[1],t));if(e.args[2]){let v=Number(this.evaluateExpression(e.args[2],t));return D.BuiltInFunctions.substr(ot,q,v)}return D.BuiltInFunctions.substr(ot,q);case"strbefore":let ue=this.getStringValue(this.evaluateExpression(e.args[0],t)),we=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.strBefore(ue,we);case"strafter":let He=this.getStringValue(this.evaluateExpression(e.args[0],t)),Ue=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.strAfter(He,Ue);case"concat":let Ze=e.args.map(v=>this.getStringValue(this.evaluateExpression(v,t)));return D.BuiltInFunctions.concat(...Ze);case"replace":let ke=this.getStringValue(this.evaluateExpression(e.args[0],t)),je=this.getStringValue(this.evaluateExpression(e.args[1],t)),Re=this.getStringValue(this.evaluateExpression(e.args[2],t)),H=e.args[3]?this.getStringValue(this.evaluateExpression(e.args[3],t)):void 0;return D.BuiltInFunctions.replace(ke,je,Re,H);case"parsedate":let N=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.parseDate(N);case"datebefore":let Le=this.getStringValue(this.evaluateExpression(e.args[0],t)),Ge=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.dateBefore(Le,Ge);case"dateafter":let M=this.getStringValue(this.evaluateExpression(e.args[0],t)),he=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.dateAfter(M,he);case"dateinrange":let Ae=this.getStringValue(this.evaluateExpression(e.args[0],t)),z=this.getStringValue(this.evaluateExpression(e.args[1],t)),xe=this.getStringValue(this.evaluateExpression(e.args[2],t));return D.BuiltInFunctions.dateInRange(Ae,z,xe);case"datediffminutes":let Ce=this.getStringValue(this.evaluateExpression(e.args[0],t)),be=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.dateDiffMinutes(Ce,be);case"datediffhours":let Oe=this.getStringValue(this.evaluateExpression(e.args[0],t)),le=this.getStringValue(this.evaluateExpression(e.args[1],t));return D.BuiltInFunctions.dateDiffHours(Oe,le);case"year":let Se=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.year(Se);case"month":let de=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.month(de);case"day":case"days":{let v=this.evaluateExpression(e.args[0],t);return this.isDayTimeDurationValue(v)?D.BuiltInFunctions.durationDays(v):D.BuiltInFunctions.day(this.getStringValue(v))}case"hours":{let v=this.evaluateExpression(e.args[0],t);return this.isDayTimeDurationValue(v)?D.BuiltInFunctions.durationHours(v):D.BuiltInFunctions.hours(this.getStringValue(v))}case"minutes":{let v=this.evaluateExpression(e.args[0],t);return this.isDayTimeDurationValue(v)?D.BuiltInFunctions.durationMinutes(v):D.BuiltInFunctions.minutes(this.getStringValue(v))}case"seconds":{let v=this.evaluateExpression(e.args[0],t);return this.isDayTimeDurationValue(v)?D.BuiltInFunctions.durationSeconds(v):D.BuiltInFunctions.seconds(this.getStringValue(v))}case"timezone":let Ee=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.timezone(Ee);case"tz":let Pe=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.tz(Pe);case"adjust":{let v=this.evaluateExpression(e.args[0],t),C=e.args.length>1?this.evaluateExpression(e.args[1],t):void 0;return D.BuiltInFunctions.adjust(v,C)}case"now":return D.BuiltInFunctions.now();case"datetime":case"xsd:datetime":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.xsdDateTime(this.getStringValue(v))}case"integer":case"xsd:integer":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.xsdInteger(this.getStringValue(v))}case"decimal":case"xsd:decimal":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.xsdDecimal(this.getStringValue(v))}case"daytimeduration":case"xsd:daytimeduration":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.xsdDayTimeDuration(this.getStringValue(v))}case"durationtodays":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationToDays(v)}case"durationtohours":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationToHours(v)}case"durationtominutes":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationToMinutes(v)}case"durationtoseconds":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationToSeconds(v)}case"durationdays":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationDays(v)}case"durationhours":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationHours(v)}case"durationminutes":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationMinutes(v)}case"durationseconds":{let v=this.evaluateExpression(e.args[0],t);return D.BuiltInFunctions.durationSeconds(v)}case"datetimediff":{let v=this.evaluateExpression(e.args[0],t),C=this.evaluateExpression(e.args[1],t);return D.BuiltInFunctions.dateTimeDiff(v,C)}case"datetimeadd":{let v=this.evaluateExpression(e.args[0],t),C=this.evaluateExpression(e.args[1],t);return D.BuiltInFunctions.dateTimeAdd(v,C)}case"datetimesubtract":{let v=this.evaluateExpression(e.args[0],t),C=this.evaluateExpression(e.args[1],t);return D.BuiltInFunctions.dateTimeSubtract(v,C)}case"mstominutes":let J=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.msToMinutes(J);case"mstohours":let re=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.msToHours(re);case"mstoseconds":let ie=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.msToSeconds(ie);case"abs":let Z=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.abs(Z);case"round":let ee=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.round(ee);case"ceil":let te=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.ceil(te);case"floor":let X=Number(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.floor(X);case"rand":return D.BuiltInFunctions.rand();case"coalesce":for(let v of e.args)try{let C=this.evaluateExpression(v,t);if(C!=null)return C}catch{continue}return;case"if":if(!e.args||e.args.length!==3)throw new Mt("IF requires exactly 3 arguments");let ne=this.evaluateExpression(e.args[0],t);return this.toBoolean(ne)?this.evaluateExpression(e.args[1],t):this.evaluateExpression(e.args[2],t);case"encode_for_uri":let se=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.encodeForUri(se);case"isnumeric":let ae=this.getTermFromExpression(e.args[0],t);return D.BuiltInFunctions.isNumeric(ae);case"sameterm":let Q=this.getTermFromExpression(e.args[0],t),oe=this.getTermFromExpression(e.args[1],t);return D.BuiltInFunctions.sameTerm(Q,oe);case"md5":let De=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.md5(De);case"sha1":let Fe=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.sha1(Fe);case"sha256":let ve=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.sha256(ve);case"sha384":let _=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.sha384(_);case"sha512":let E=this.getStringValue(this.evaluateExpression(e.args[0],t));return D.BuiltInFunctions.sha512(E);case"byuuid":return this.evaluateByUUID(e,t);default:throw new Mt(`Unknown function: ${i}`)}}getTermFromExpression(e,t){if(e.type==="variable")return t.get(e.name)}getStringValue(e){return e==null?"":typeof e=="object"&&"value"in e?String(e.value):String(e)}toBoolean(e){if(typeof e=="boolean")return e;if(typeof e=="number")return!isNaN(e)&&e!==0;if(typeof e=="string")return e.length>0;if(e instanceof bl.Literal){let t=e.datatype?.value||"";if(t.includes("#boolean"))return e.value==="true"||e.value==="1";if(t.includes("#integer")||t.includes("#decimal")||t.includes("#double")||t.includes("#float")){let i=parseFloat(e.value);return!isNaN(i)&&i!==0}return e.value.length>0}return!!e}evaluateByUUID(e,t){if(!e.args||e.args.length!==1)throw new Mt("exo:byUUID requires exactly 1 argument (UUID string)");let i=this.evaluateExpression(e.args[0],t),n=this.getStringValue(i);if(!n)return;let s=n.toLowerCase();if(this.uuidCache.has(s))return this.uuidCache.get(s)??void 0;if(!this.tripleStore){this.uuidCache.set(s,null);return}if(this.tripleStore.findSubjectsByUUIDSync){let a=this.tripleStore.findSubjectsByUUIDSync(s);if(a.length===0){this.uuidCache.set(s,null);return}let c=a[0];return this.uuidCache.set(s,c),c}this.uuidCache.set(s,null)}cacheUUIDResult(e,t){let i=e.toLowerCase();this.uuidCache.set(i,t)}getCachedUUID(e){let t=e.toLowerCase();if(this.uuidCache.has(t))return this.uuidCache.get(t)}};ma.FilterExecutor=Lm});var Vm=y(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});El.OptionalExecutor=void 0;var Mm=class{static{o(this,"OptionalExecutor")}async*execute(e,t){let i=[];for await(let s of e)i.push(s);let n=[];for await(let s of t)n.push(s);for(let s of i){let a=!1;for(let c of n){let u=s.merge(c);u!==null&&(yield u,a=!0)}a||(yield s)}}async executeAll(e,t){let i=[];async function*n(){for(let a of e)yield a}o(n,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(n(),s()))i.push(a);return i}};El.OptionalExecutor=Mm});var qm=y(Tl=>{"use strict";Object.defineProperty(Tl,"__esModule",{value:!0});Tl.UnionExecutor=void 0;var $m=class{static{o(this,"UnionExecutor")}async*execute(e,t){let i=new Set;for await(let n of e){let s=this.getSolutionKey(n);i.has(s)||(i.add(s),yield n)}for await(let n of t){let s=this.getSolutionKey(n);i.has(s)||(i.add(s),yield n)}}async executeAll(e,t){let i=[];async function*n(){for(let a of e)yield a}o(n,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(n(),s()))i.push(a);return i}getSolutionKey(e){let t=e.toJSON();return Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("|")}};Tl.UnionExecutor=$m});var Wm=y(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.ConstructExecutor=void 0;var mP=_n(),Es=et(),Bm=yt(),Um=sr(),gP=eu(),Gm=class{static{o(this,"ConstructExecutor")}async execute(e,t){let i=[],n=new Set;for(let s of t)for(let a of e)try{let c=this.instantiateTriple(a,s),u=`${c.subject.toString()}|${c.predicate.toString()}|${c.object.toString()}`;n.has(u)||(n.add(u),i.push(c))}catch{continue}return i}instantiateTriple(e,t){if(this.isPropertyPath(e.predicate))throw new Error("Property paths are not supported in CONSTRUCT templates");let i=this.instantiateElement(e.subject,t),n=this.instantiateElement(e.predicate,t),s=this.instantiateElement(e.object,t);return new mP.Triple(i,n,s)}isPropertyPath(e){return e.type==="path"}instantiateElement(e,t){if(e.type==="variable"){let i=t.get(e.value);if(!i)throw new Error(`Unbound variable: ${e.value}`);return i}if(e.type==="iri")return new Es.IRI(e.value);if(e.type==="literal")return new Bm.Literal(e.value,e.datatype?new Es.IRI(e.datatype):void 0,e.language);if(e.type==="blank")return new Um.BlankNode(e.value);if(e.type==="quoted")return this.instantiateQuotedTriple(e,t);throw new Error(`Unknown element type: ${e.type}`)}instantiateQuotedTriple(e,t){let i=this.instantiateQuotedSubject(e.subject,t),n=this.instantiateQuotedPredicate(e.predicate,t),s=this.instantiateQuotedObject(e.object,t);return new gP.QuotedTriple(i,n,s)}instantiateQuotedSubject(e,t){if(e.type==="variable"){let i=t.get(e.value);if(!i)throw new Error(`Unbound variable in quoted triple subject: ${e.value}`);if(i instanceof Bm.Literal)throw new Error("Literals cannot appear in quoted triple subject position");return i}if(e.type==="iri")return new Es.IRI(e.value);if(e.type==="blank")return new Um.BlankNode(e.value);if(e.type==="quoted")return this.instantiateQuotedTriple(e,t);throw new Error(`Invalid element type for quoted triple subject: ${e.type}`)}instantiateQuotedPredicate(e,t){if(e.type==="variable"){let i=t.get(e.value);if(!i)throw new Error(`Unbound variable in quoted triple predicate: ${e.value}`);if(!(i instanceof Es.IRI))throw new Error("Quoted triple predicate must be an IRI");return i}return new Es.IRI(e.value)}instantiateQuotedObject(e,t){if(e.type==="variable"){let n=t.get(e.value);if(!n)throw new Error(`Unbound variable in quoted triple object: ${e.value}`);return n}if(e.type==="iri")return new Es.IRI(e.value);if(e.type==="blank")return new Um.BlankNode(e.value);if(e.type==="literal")return new Bm.Literal(e.value,e.datatype?new Es.IRI(e.datatype):void 0,e.language);if(e.type==="quoted")return this.instantiateQuotedTriple(e,t);let i=e;throw new Error(`Invalid element type for quoted triple object: ${i.type}`)}};Al.ConstructExecutor=Gm});var w3=y(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});xl.DescribeExecutor=void 0;var _3=et(),zm=class{static{o(this,"DescribeExecutor")}constructor(e){this.tripleStore=e}async execute(e,t){let i=[],n=new Set,s=new Set,a=t?.depth;for(let c of e)await this.describeResourceWithDepth(c,a,1,t?.symmetric??!0,i,n,s);return i}async describeResourceWithDepth(e,t,i,n,s,a,c){let u=e.toString();if(c.has(u)||(c.add(u),t!==void 0&&i>t))return;let l=[],f=await this.tripleStore.match(e,void 0,void 0);if(l.push(...f),n){let d=await this.tripleStore.match(void 0,void 0,e);l.push(...d)}let h=[];for(let d of l){let g=`${d.subject.toString()}|${d.predicate.toString()}|${d.object.toString()}`;a.has(g)||(a.add(g),s.push(d),(t===void 0||i<t)&&(this.isIRI(d.subject)&&d.subject.toString()!==u&&h.push(d.subject),this.isIRI(d.object)&&d.object.toString()!==u&&h.push(d.object)))}for(let d of h)await this.describeResourceWithDepth(d,t,i+1,n,s,a,c)}isIRI(e){return e?e instanceof _3.IRI||e.termType==="NamedNode"||typeof e.value=="string"&&e.value.startsWith("http"):!1}async describeByIRI(e,t){let i=new _3.IRI(e);return this.execute([i],t)}};xl.DescribeExecutor=zm});var b3=y(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.MinusExecutor=void 0;var Hm=class{static{o(this,"MinusExecutor")}async*execute(e,t){let i=[];for await(let s of e)i.push(s);let n=[];for await(let s of t)n.push(s);for(let s of i){let a=!1;for(let c of n)if(this.areCompatible(s,c)){a=!0;break}a||(yield s)}}async executeAll(e,t){let i=[];async function*n(){for(let a of e)yield a}o(n,"generateLeft");async function*s(){for(let a of t)yield a}o(s,"generateRight");for await(let a of this.execute(n(),s()))i.push(a);return i}areCompatible(e,t){let i=e.variables(),n=new Set(t.variables()),s=i.filter(a=>n.has(a));if(s.length===0)return!1;for(let a of s){let c=e.get(a),u=t.get(a);if(c===void 0||u===void 0||c.toString()!==u.toString())return!1}return!0}};Cl.MinusExecutor=Hm});var E3=y(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.ValuesExecutor=ga.ValuesExecutorError=void 0;var yP=cn(),S3=et(),vP=yt(),Ol=class extends Error{static{o(this,"ValuesExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="ValuesExecutorError"}};ga.ValuesExecutorError=Ol;var Km=class{static{o(this,"ValuesExecutor")}async*execute(e){if(e.bindings.length!==0)for(let t of e.bindings)yield this.createSolutionMapping(t)}async executeAll(e){let t=[];for await(let i of this.execute(e))t.push(i);return t}createSolutionMapping(e){let t=new yP.SolutionMapping;for(let[i,n]of Object.entries(e)){let s=this.toRDFTerm(n);t.set(i,s)}return t}toRDFTerm(e){if(e.type==="iri")return new S3.IRI(e.value);if(e.type==="literal")return new vP.Literal(e.value,e.datatype?new S3.IRI(e.datatype):void 0,e.language);throw new Ol(`Unknown term type: ${e.type}`)}};ga.ValuesExecutor=Km});var Qm=y(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.CustomAggregateRegistry=va.CustomAggregateError=void 0;var ya=class extends Error{static{o(this,"CustomAggregateError")}constructor(e,t){super(e),this.iri=t,this.name="CustomAggregateError"}};va.CustomAggregateError=ya;var Pl=class r{static{o(this,"CustomAggregateRegistry")}constructor(){this.aggregates=new Map}static getInstance(){return r.instance||(r.instance=new r),r.instance}static resetInstance(){r.instance&&r.instance.clear(),r.instance=null}register(e,t){if(!e||typeof e!="string")throw new ya("Aggregate IRI must be a non-empty string");if(!t||typeof t.init!="function"||typeof t.step!="function"||typeof t.finalize!="function")throw new ya("Aggregate must implement init(), step(), and finalize() methods",e);if(this.aggregates.has(e))throw new ya(`Aggregate with IRI "${e}" is already registered`,e);this.aggregates.set(e,t)}unregister(e){return this.aggregates.delete(e)}get(e){return this.aggregates.get(e)}has(e){return this.aggregates.has(e)}getRegisteredIris(){return Array.from(this.aggregates.keys())}clear(){this.aggregates.clear()}get size(){return this.aggregates.size}};va.CustomAggregateRegistry=Pl;Pl.instance=null});var Ym=y(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.BUILT_IN_AGGREGATES=Ne.modeAggregate=Ne.stddevAggregate=Ne.varianceAggregate=Ne.medianAggregate=Ne.EXO_AGGREGATE_NS=void 0;Ne.getNumericValue=Fl;Ne.createDecimalLiteral=di;Ne.createDoubleLiteral=bP;Ne.createPercentileAggregate=Ts;var As=yt(),_a=et(),_P=new _a.IRI("http://www.w3.org/2001/XMLSchema#decimal"),wP=new _a.IRI("http://www.w3.org/2001/XMLSchema#double");Ne.EXO_AGGREGATE_NS="https://exocortex.my/ontology/agg#";function Fl(r){return r==null?NaN:typeof r=="number"?r:typeof r=="string"?parseFloat(r):r instanceof As.Literal?parseFloat(r.value):r instanceof _a.IRI?NaN:typeof r=="boolean"?r?1:0:NaN}o(Fl,"getNumericValue");function di(r){return new As.Literal(String(r),_P)}o(di,"createDecimalLiteral");function bP(r){return new As.Literal(String(r),wP)}o(bP,"createDoubleLiteral");Ne.medianAggregate={init(){return{values:[]}},step(r,e){let t=r,i=Fl(e);isNaN(i)||t.values.push(i)},finalize(r){let e=r,{values:t}=e;if(t.length===0)return di(0);let i=[...t].sort((a,c)=>a-c),n=Math.floor(i.length/2),s=i.length%2!==0?i[n]:(i[n-1]+i[n])/2;return di(s)}};Ne.varianceAggregate={init(){return{values:[]}},step(r,e){let t=r,i=Fl(e);isNaN(i)||t.values.push(i)},finalize(r){let e=r,{values:t}=e;if(t.length===0)return di(0);let i=t.reduce((s,a)=>s+a,0)/t.length,n=t.reduce((s,a)=>s+Math.pow(a-i,2),0)/t.length;return di(n)}};Ne.stddevAggregate={init(){return{values:[]}},step(r,e){Ne.varianceAggregate.step(r,e)},finalize(r){let e=r,{values:t}=e;if(t.length===0)return di(0);let i=t.reduce((s,a)=>s+a,0)/t.length,n=t.reduce((s,a)=>s+Math.pow(a-i,2),0)/t.length;return di(Math.sqrt(n))}};Ne.modeAggregate={init(){return{counts:new Map,values:new Map}},step(r,e){if(e==null)return;let t=r,i=String(e instanceof As.Literal||e instanceof _a.IRI?e.value:e),n=t.counts.get(i)||0;t.counts.set(i,n+1),t.values.set(i,e)},finalize(r){let e=r;if(e.counts.size===0)return new As.Literal(" ",new _a.IRI("http://www.w3.org/2001/XMLSchema#string"));let t="",i=0;for(let[a,c]of e.counts)c>i&&(i=c,t=a);let n=e.values.get(t);if(n instanceof As.Literal)return n;let s=parseFloat(t);return isNaN(s)?new As.Literal(t,new _a.IRI("http://www.w3.org/2001/XMLSchema#string")):di(s)}};function Ts(r){let e=Math.max(0,Math.min(100,r))/100;return{init(){return{values:[],percentile:e}},step(t,i){let n=t,s=Fl(i);isNaN(s)||n.values.push(s)},finalize(t){let i=t,{values:n}=i;if(n.length===0)return di(0);let s=[...n].sort((h,d)=>h-d),a=i.percentile*(s.length-1),c=Math.floor(a),u=Math.ceil(a);if(c===u)return di(s[c]);let l=a-c,f=s[c]*(1-l)+s[u]*l;return di(f)}}}o(Ts,"createPercentileAggregate");Ne.BUILT_IN_AGGREGATES={[`${Ne.EXO_AGGREGATE_NS}median`]:Ne.medianAggregate,[`${Ne.EXO_AGGREGATE_NS}variance`]:Ne.varianceAggregate,[`${Ne.EXO_AGGREGATE_NS}stddev`]:Ne.stddevAggregate,[`${Ne.EXO_AGGREGATE_NS}mode`]:Ne.modeAggregate,[`${Ne.EXO_AGGREGATE_NS}percentile25`]:Ts(25),[`${Ne.EXO_AGGREGATE_NS}percentile50`]:Ts(50),[`${Ne.EXO_AGGREGATE_NS}percentile75`]:Ts(75),[`${Ne.EXO_AGGREGATE_NS}percentile90`]:Ts(90),[`${Ne.EXO_AGGREGATE_NS}percentile95`]:Ts(95),[`${Ne.EXO_AGGREGATE_NS}percentile99`]:Ts(99)}});var x3=y(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.AggregateExecutor=wa.AggregateExecutorError=void 0;var bt=yt(),Jm=et(),SP=Sl(),EP=Qm(),TP=Ym(),T3=new Jm.IRI("http://www.w3.org/2001/XMLSchema#integer"),xs=new Jm.IRI("http://www.w3.org/2001/XMLSchema#decimal"),Di=new Jm.IRI("http://www.w3.org/2001/XMLSchema#string");function A3(r){return typeof r=="object"&&r.type==="custom"}o(A3,"isCustomAggregation");var ko=class extends Error{static{o(this,"AggregateExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="AggregateExecutorError"}};wa.AggregateExecutorError=ko;var Xm=class{static{o(this,"AggregateExecutor")}constructor(){this.filterExecutor=new SP.FilterExecutor}execute(e,t){let i=this.groupSolutions(t,e.variables),n=[];for(let[s,a]of i.entries()){let c=new Map;for(let f of e.variables)if(a.length>0){let h=a[0].get(f);h&&c.set(f,h)}for(let f of e.aggregates){let h=this.computeAggregate(f.expression,a);c.set(f.variable,h)}let{SolutionMapping:u}=cn(),l=new u;for(let[f,h]of c.entries())l.set(f,h);n.push(l)}if(n.length===0&&e.aggregates.length>0){let s=this.createEmptyAggregateResult(e);s&&n.push(s)}return n}groupSolutions(e,t){let i=new Map;if(t.length===0)return i.set("",e),i;for(let n of e){let s=this.computeGroupKey(n,t),a=i.get(s);a?a.push(n):i.set(s,[n])}return i}computeGroupKey(e,t){return t.map(i=>{let n=e.get(i);return n?this.termToString(n):""}).join("|")}termToString(e){if(e&&typeof e=="object"){if("value"in e)return String(e.value);if("id"in e)return String(e.id)}return String(e)}computeAggregate(e,t){if(A3(e.aggregation))return this.computeCustomAggregate(e,t);let i=this.extractValues(e,t),n=e.aggregation;switch(n){case"count":{let s=this.computeCount(i,e.distinct);return new bt.Literal(String(s),T3)}case"sum":{let s=this.computeSum(i);return new bt.Literal(String(s),xs)}case"avg":{let s=this.computeAvg(i);return new bt.Literal(String(s),xs)}case"min":{let s=this.computeMin(i);return s===void 0?new bt.Literal("",Di):typeof s=="number"?new bt.Literal(String(s),xs):new bt.Literal(String(s),Di)}case"max":{let s=this.computeMax(i);return s===void 0?new bt.Literal("",Di):typeof s=="number"?new bt.Literal(String(s),xs):new bt.Literal(String(s),Di)}case"group_concat":{let s=this.computeGroupConcat(i,e.separator||" ",e.distinct);return new bt.Literal(s||" ",Di)}case"sample":{let s=this.computeSample(i,e.distinct);return s===void 0?new bt.Literal(" ",Di):typeof s=="number"?new bt.Literal(String(s),xs):new bt.Literal(String(s),Di)}default:{let s=n;throw new ko(`Unknown aggregation function: ${s}`)}}}computeCustomAggregate(e,t){let n=e.aggregation.iri,a=EP.CustomAggregateRegistry.getInstance().get(n);if(a||(a=TP.BUILT_IN_AGGREGATES[n]),!a)throw new ko(`Unknown custom aggregate function: ${n}. Register it with CustomAggregateRegistry.getInstance().register() or use a built-in aggregate.`);let c=a.init();for(let u of t){let l=null;if(e.expression){let f=this.evaluateExpression(e.expression,u);f!==void 0&&(l=f)}else l=1;a.step(c,l)}return a.finalize(c)}extractValues(e,t){if(!e.expression)return t.map(()=>1);let i=[];for(let n of t){let s=this.evaluateExpression(e.expression,n);s!=null&&i.push(s)}return i}evaluateExpression(e,t){if(e.type==="variable"){let i=t.get(e.name);return i==null?void 0:typeof i=="number"||typeof i=="string"||typeof i=="boolean"?i:typeof i=="object"&&"value"in i?i.value:i}if(e.type==="literal")return e.value;try{return this.filterExecutor.evaluateExpression(e,t)}catch{return}}computeCount(e,t){return t?new Set(e.map(i=>String(i))).size:e.length}computeSum(e){return e.map(i=>parseFloat(String(i))).filter(i=>!isNaN(i)).reduce((i,n)=>i+n,0)}computeAvg(e){let t=e.map(i=>parseFloat(String(i))).filter(i=>!isNaN(i));return t.length===0?0:t.reduce((i,n)=>i+n,0)/t.length}computeMin(e){if(e.length===0)return;let t=e.map(n=>parseFloat(String(n))).filter(n=>!isNaN(n));if(t.length>0)return Math.min(...t);let i=e.map(n=>String(n));return i.reduce((n,s)=>s<n?s:n,i[0])}computeMax(e){if(e.length===0)return;let t=e.map(n=>parseFloat(String(n))).filter(n=>!isNaN(n));if(t.length>0)return Math.max(...t);let i=e.map(n=>String(n));return i.reduce((n,s)=>s>n?s:n,i[0])}computeGroupConcat(e,t,i){let n=e.map(s=>String(s));return i&&(n=[...new Set(n)]),n.join(t)}computeSample(e,t){if(e.length===0)return;if(t){let s=[...new Set(e.map(u=>String(u)))];if(s.length===0)return;let a=s[0],c=parseFloat(a);return isNaN(c)?a:c}let i=e[0];if(typeof i=="number")return i;let n=parseFloat(String(i));return isNaN(n)?String(i):n}createEmptyAggregateResult(e){let{SolutionMapping:t}=cn(),i=new t;for(let n of e.aggregates){let s=n.expression.aggregation;if(A3(s)){i.set(n.variable,new bt.Literal("0",xs));continue}switch(s){case"count":i.set(n.variable,new bt.Literal("0",T3));break;case"sum":case"avg":i.set(n.variable,new bt.Literal("0",xs));break;case"group_concat":i.set(n.variable,new bt.Literal(" ",Di));break;case"min":case"max":case"sample":i.set(n.variable,new bt.Literal("",Di));break;default:i.set(n.variable,new bt.Literal("",Di))}}return i}};wa.AggregateExecutor=Xm});var O3=y(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.ServiceExecutor=ba.ServiceExecutorError=void 0;var AP=cn(),C3=et(),xP=yt(),CP=sr(),Cs=class extends Error{static{o(this,"ServiceExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="ServiceExecutorError"}};ba.ServiceExecutorError=Cs;var Zm=class{static{o(this,"ServiceExecutor")}constructor(e={}){this.timeout=e.timeout??3e4,this.httpClient=e.httpClient??((t,i)=>fetch(t,i)),this.maxRetries=e.maxRetries??2,this.retryDelay=e.retryDelay??1e3}async*execute(e,t){try{let i=t(e.pattern),n=await this.executeRemoteQuery(e.endpoint,i);for(let s of n)yield s}catch(i){if(e.silent)return;throw i}}async executeRemoteQuery(e,t){let i;for(let n=0;n<=this.maxRetries;n++)try{let s=new AbortController,a=setTimeout(()=>s.abort(),this.timeout);try{let c=await this.httpClient(e,{method:"POST",headers:{"Content-Type":"application/sparql-query",Accept:"application/sparql-results+json"},body:t,signal:s.signal});if(!c.ok)throw new Cs(`Remote SPARQL endpoint returned ${c.status}: ${c.statusText}`);let u=await c.json();return this.parseJsonResults(u)}finally{clearTimeout(a)}}catch(s){if(i=s instanceof Error?s:new Error(String(s)),this.isRetryableError(i)&&n<this.maxRetries){await this.delay(this.retryDelay);continue}throw new Cs(`Failed to query remote SPARQL endpoint ${e}: ${i.message}`,i)}throw new Cs(`Failed to query remote SPARQL endpoint ${e} after ${this.maxRetries+1} attempts`,i)}parseJsonResults(e){return!e.results||!Array.isArray(e.results.bindings)?[]:e.results.bindings.map(t=>this.parseBinding(t))}parseBinding(e){let t=new AP.SolutionMapping;for(let[i,n]of Object.entries(e)){let s=this.parseRDFTerm(n);t.set(i,s)}return t}parseRDFTerm(e){switch(e.type){case"uri":return new C3.IRI(e.value);case"literal":{let t=e.datatype?new C3.IRI(e.datatype):void 0;return new xP.Literal(e.value,t,e["xml:lang"])}case"bnode":return new CP.BlankNode(e.value);default:throw new Cs(`Unknown RDF term type: ${e.type}`)}}isRetryableError(e){let t=e.message.toLowerCase();return!!(e.name==="AbortError"||t.includes("network")||t.includes("econnreset")||t.includes("econnrefused")||t.includes("etimedout")||t.includes("returned 5"))}delay(e){return new Promise(t=>setTimeout(t,e))}};ba.ServiceExecutor=Zm});var F3=y(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.GraphExecutor=Sa.GraphExecutorError=void 0;var P3=et(),Il=class extends Error{static{o(this,"GraphExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="GraphExecutorError"}};Sa.GraphExecutorError=Il;var eg=class{static{o(this,"GraphExecutor")}constructor(e){this.tripleStore=e}async*execute(e,t,i){let n=e.name;if(n.type==="iri")yield*this.executeWithGraph(e.pattern,n,t);else if(n.type==="variable")yield*this.executeWithGraphVariable(e,n,t,i);else throw new Il(`Invalid graph name type: ${n.type}`)}async*executeWithGraph(e,t,i){let n=new P3.IRI(t.value);this.tripleStore.hasGraph&&!await this.tripleStore.hasGraph(n)||(yield*i(e,n))}async*executeWithGraphVariable(e,t,i,n){if(n){let a=n.get(t.value);if(a&&a instanceof P3.IRI){yield*this.executeWithGraph(e.pattern,{type:"iri",value:a.value},i);return}}if(!this.tripleStore.getNamedGraphs)return;let s=await this.tripleStore.getNamedGraphs();for(let a of s)for await(let c of i(e.pattern,a)){let u=c.clone();u.set(t.value,a),yield u}}};Sa.GraphExecutor=eg});var I3=y(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.SPARQLGenerator=Ta.SPARQLGeneratorError=void 0;var Ea=class extends Error{static{o(this,"SPARQLGeneratorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="SPARQLGeneratorError"}};Ta.SPARQLGeneratorError=Ea;var tg=class{static{o(this,"SPARQLGenerator")}collectVariables(e){let t=new Set;return this.collectVariablesFromOperation(e,t),t}generateSelect(e){let t=this.collectVariables(e),i=t.size>0?Array.from(t).map(s=>`?${s}`).join(" "):"*",n=this.generateWhereClause(e);return`SELECT ${i} WHERE {
${n}
}`}generateWhereClause(e,t=2){let i=" ".repeat(t);switch(e.type){case"bgp":return this.generateBGP(e,t);case"filter":return`${this.generateWhereClause(e.input,t)}
${i}FILTER(${this.generateExpression(e.expression)})`;case"join":return`${this.generateWhereClause(e.left,t)}
${this.generateWhereClause(e.right,t)}`;case"leftjoin":{let n=this.generateWhereClause(e.left,t),s=this.generateWhereClause(e.right,t+2);return`${n}
${i}OPTIONAL {
${s}
${i}}`}case"union":{let n=this.generateWhereClause(e.left,t+2),s=this.generateWhereClause(e.right,t+2);return`${i}{
${n}
${i}}
${i}UNION
${i}{
${s}
${i}}`}case"values":return this.generateValues(e,t);case"extend":{let n=this.generateWhereClause(e.input,t),s=this.generateExpression(e.expression);return`${n}
${i}BIND(${s} AS ?${e.variable})`}case"project":case"distinct":case"reduced":return this.generateWhereClause(e.input,t);case"orderby":case"slice":case"group":return this.generateWhereClause(e.input,t);case"subquery":{let s=this.generateSelect(e.query).split(`
`).map(a=>i+a).join(`
`);return`${i}{
${s}
${i}}`}default:throw new Ea(`Unsupported operation type for SPARQL generation: ${e.type}`)}}generateBGP(e,t){let i=" ".repeat(t);return e.triples.map(n=>`${i}${this.generateTriple(n)} .`).join(`
`)}generateTriple(e){let t=this.generateElement(e.subject),i=this.generatePredicate(e.predicate),n=this.generateElement(e.object);return`${t} ${i} ${n}`}generatePredicate(e){return"pathType"in e?this.generatePropertyPath(e):this.generateElement(e)}generatePropertyPath(e){let t=e.items.map(i=>"pathType"in i?`(${this.generatePropertyPath(i)})`:`<${i.value}>`);switch(e.pathType){case"/":return t.join("/");case"|":return t.join("|");case"^":return`^${t[0]}`;case"+":return`${t[0]}+`;case"*":return`${t[0]}*`;case"?":return`${t[0]}?`}}generateElement(e){switch(e.type){case"variable":return`?${e.value}`;case"iri":return`<${e.value}>`;case"literal":{let i=`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`;return e.language?i+=`@${e.language}`:e.datatype&&(i+=`^^<${e.datatype}>`),i}case"blank":return`_:${e.value}`;default:throw new Ea(`Unknown element type: ${e.type}`)}}generateValues(e,t){let i=" ".repeat(t);if(e.variables.length===0||e.bindings.length===0)return"";if(e.variables.length===1){let a=e.variables[0],c=e.bindings.map(u=>{let l=u[a];return l?this.generateValuesTerm(l):"UNDEF"}).join(" ");return`${i}VALUES ?${a} { ${c} }`}let n=e.variables.map(a=>`?${a}`).join(" "),s=e.bindings.map(a=>`(${e.variables.map(u=>{let l=a[u];return l?this.generateValuesTerm(l):"UNDEF"}).join(" ")})`);return`${i}VALUES (${n}) {
${s.map(a=>`${i}  ${a}`).join(`
`)}
${i}}`}generateValuesTerm(e){if(e.type==="iri")return`<${e.value}>`;let i=`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`;return e.language?i+=`@${e.language}`:e.datatype&&(i+=`^^<${e.datatype}>`),i}generateExpression(e){switch(e.type){case"variable":return`?${e.name}`;case"literal":return typeof e.value=="string"?`"${e.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:typeof e.value=="boolean"?e.value?"true":"false":String(e.value);case"comparison":return`(${this.generateExpression(e.left)} ${e.operator} ${this.generateExpression(e.right)})`;case"logical":return e.operator==="!"?`!(${this.generateExpression(e.operands[0])})`:`(${e.operands.map(t=>this.generateExpression(t)).join(` ${e.operator} `)})`;case"arithmetic":return`(${this.generateExpression(e.left)} ${e.operator} ${this.generateExpression(e.right)})`;case"function":return`${e.function.toUpperCase()}(${e.args.map(t=>this.generateExpression(t)).join(", ")})`;case"functionCall":return`${(typeof e.function=="string"?e.function:e.function.value).toUpperCase()}(${e.args.map(i=>this.generateExpression(i)).join(", ")})`;case"exists":return`${e.negated?"NOT EXISTS":"EXISTS"} { ${this.generateWhereClause(e.pattern,0)} }`;case"in":{let t=this.generateExpression(e.expression),i=e.list.map(n=>this.generateExpression(n)).join(", ");return e.negated?`${t} NOT IN (${i})`:`${t} IN (${i})`}default:throw new Ea(`Unknown expression type: ${e.type}`)}}collectVariablesFromOperation(e,t){switch(e.type){case"bgp":for(let i of e.triples)this.collectVariablesFromTriple(i,t);break;case"filter":this.collectVariablesFromOperation(e.input,t),this.collectVariablesFromExpression(e.expression,t);break;case"join":case"leftjoin":case"union":case"minus":this.collectVariablesFromOperation(e.left,t),this.collectVariablesFromOperation(e.right,t);break;case"values":for(let i of e.variables)t.add(i);break;case"project":for(let i of e.variables)t.add(i);this.collectVariablesFromOperation(e.input,t);break;case"extend":t.add(e.variable),this.collectVariablesFromOperation(e.input,t);break;case"orderby":case"slice":case"distinct":case"reduced":this.collectVariablesFromOperation(e.input,t);break;case"group":for(let i of e.variables)t.add(i);for(let i of e.aggregates)t.add(i.variable);this.collectVariablesFromOperation(e.input,t);break;case"subquery":this.collectVariablesFromOperation(e.query,t);break}}collectVariablesFromTriple(e,t){e.subject.type==="variable"&&t.add(e.subject.value),"type"in e.predicate&&e.predicate.type==="variable"&&t.add(e.predicate.value),e.object.type==="variable"&&t.add(e.object.value)}collectVariablesFromExpression(e,t){switch(e.type){case"variable":t.add(e.name);break;case"comparison":case"arithmetic":this.collectVariablesFromExpression(e.left,t),this.collectVariablesFromExpression(e.right,t);break;case"logical":for(let i of e.operands)this.collectVariablesFromExpression(i,t);break;case"function":case"functionCall":for(let i of e.args)this.collectVariablesFromExpression(i,t);break;case"exists":this.collectVariablesFromOperation(e.pattern,t);break;case"in":this.collectVariablesFromExpression(e.expression,t);for(let i of e.list)this.collectVariablesFromExpression(i,t);break}}};Ta.SPARQLGenerator=tg});var R3=y(Vr=>{"use strict";var OP=Vr&&Vr.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),PP=Vr&&Vr.__setModuleDefault||(Object.create?(function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}):function(r,e){r.default=e}),FP=Vr&&Vr.__importStar||(function(){var r=o(function(e){return r=Object.getOwnPropertyNames||function(t){var i=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[i.length]=n);return i},r(e)},"ownKeys");return function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i=r(e),n=0;n<i.length;n++)i[n]!=="default"&&OP(t,e,i[n]);return PP(t,e),t}})();Object.defineProperty(Vr,"__esModule",{value:!0});Vr.QueryExecutor=Vr.QueryExecutorError=void 0;var IP=Nm(),RP=Sl(),DP=Vm(),NP=qm(),kP=b3(),jP=E3(),LP=x3(),MP=Wm(),VP=O3(),$P=F3(),qP=I3(),BP=et(),Aa=class extends Error{static{o(this,"QueryExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="QueryExecutorError"}};Vr.QueryExecutorError=Aa;var rg=class{static{o(this,"QueryExecutor")}constructor(e,t={}){this.tripleStore=e,this.bgpExecutor=new IP.BGPExecutor(e),this.filterExecutor=new RP.FilterExecutor,this.optionalExecutor=new DP.OptionalExecutor,this.unionExecutor=new NP.UnionExecutor,this.minusExecutor=new kP.MinusExecutor,this.valuesExecutor=new jP.ValuesExecutor,this.aggregateExecutor=new LP.AggregateExecutor,this.constructExecutor=new MP.ConstructExecutor,this.serviceExecutor=new VP.ServiceExecutor(t.serviceConfig),this.graphExecutor=new $P.GraphExecutor(e),this.sparqlGenerator=new qP.SPARQLGenerator,this.filterExecutor.setExistsEvaluator(async(i,n)=>this.evaluateExistsPattern(i,n)),this.filterExecutor.setTripleStore(e)}async evaluateExistsPattern(e,t){for await(let i of this.execute(e))if(t.merge(i)!==null)return!0;return!1}async executeAll(e){let t=[];for await(let i of this.execute(e))t.push(i);return t}async*execute(e){switch(e.type){case"bgp":yield*this.executeBGP(e);break;case"filter":yield*this.executeFilter(e);break;case"join":yield*this.executeJoin(e);break;case"leftjoin":yield*this.executeLeftJoin(e);break;case"union":yield*this.executeUnion(e);break;case"minus":yield*this.executeMinus(e);break;case"values":yield*this.executeValues(e);break;case"project":yield*this.executeProject(e);break;case"orderby":yield*this.executeOrderBy(e);break;case"slice":yield*this.executeSlice(e);break;case"distinct":yield*this.executeDistinct(e);break;case"reduced":yield*this.executeReduced(e);break;case"group":yield*this.executeGroup(e);break;case"extend":yield*this.executeExtend(e);break;case"subquery":yield*this.executeSubquery(e);break;case"lateraljoin":yield*this.executeLateralJoin(e);break;case"service":yield*this.executeService(e);break;case"graph":yield*this.executeGraph(e);break;default:throw new Aa(`Unknown operation type: ${e.type}`)}}async*executeBGP(e){yield*this.bgpExecutor.execute(e)}async*executeFilter(e){let t=this.execute(e.input);yield*this.filterExecutor.execute(e,t)}async*executeJoin(e){let t=[];for await(let i of this.execute(e.left))t.push(i);for(let i of t)for await(let n of this.execute(e.right)){let s=i.merge(n);s!==null&&(yield s)}}async*executeLeftJoin(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let i=[];for await(let a of this.execute(e.right))i.push(a);async function*n(){for(let a of t)yield a}o(n,"leftGen");async function*s(){for(let a of i)yield a}o(s,"rightGen"),yield*this.optionalExecutor.execute(n(),s())}async*executeUnion(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let i=[];for await(let a of this.execute(e.right))i.push(a);async function*n(){for(let a of t)yield a}o(n,"leftGen");async function*s(){for(let a of i)yield a}o(s,"rightGen"),yield*this.unionExecutor.execute(n(),s())}async*executeMinus(e){let t=[];for await(let a of this.execute(e.left))t.push(a);let i=[];for await(let a of this.execute(e.right))i.push(a);async function*n(){for(let a of t)yield a}o(n,"leftGen");async function*s(){for(let a of i)yield a}o(s,"rightGen"),yield*this.minusExecutor.execute(n(),s())}async*executeValues(e){yield*this.valuesExecutor.execute(e)}async*executeProject(e){for await(let t of this.execute(e.input))yield t}async*executeOrderBy(e){let t=[];for await(let i of this.execute(e.input))t.push(i);t.sort((i,n)=>{for(let s of e.comparators){let a=this.getExpressionValue(s.expression,i),c=this.getExpressionValue(s.expression,n),u=0;if(a===void 0&&c===void 0?u=0:a===void 0?u=1:c===void 0?u=-1:typeof a=="number"&&typeof c=="number"?u=a-c:u=String(a).localeCompare(String(c)),s.descending&&(u=-u),u!==0)return u}return 0});for(let i of t)yield i}async*executeSlice(e){let t=0,i=e.offset??0,n=e.limit;for await(let s of this.execute(e.input)){if(t>=i){if(n!==void 0&&t-i>=n)break;yield s}t++}}async*executeDistinct(e){let t=new Set;for await(let i of this.execute(e.input)){let n=this.getSolutionKey(i);t.has(n)||(t.add(n),yield i)}}async*executeReduced(e){let t=new Set;for await(let i of this.execute(e.input)){let n=this.getSolutionKey(i);t.has(n)||(t.add(n),yield i)}}async*executeGroup(e){let t=[];for await(let n of this.execute(e.input))t.push(n);let i=this.aggregateExecutor.execute(e,t);for(let n of i)yield n}async*executeExtend(e){for await(let t of this.execute(e.input)){let i=t.clone(),n=this.evaluateExtendExpression(e.expression,t);n!==void 0&&i.set(e.variable,n),yield i}}async*executeSubquery(e){yield*this.execute(e.query)}async*executeLateralJoin(e){let t=[];for await(let i of this.execute(e.left))t.push(i);for(let i of t){let n=this.substituteVariables(e.right,i);for await(let s of this.execute(n)){let a=i.merge(s);a!==null&&(yield a)}}}substituteVariables(e,t){let i=JSON.parse(JSON.stringify(e));return this.substituteInOperation(i,t)}substituteInOperation(e,t){return!e||typeof e!="object"?e:e.type==="bgp"&&e.triples?(e.triples=e.triples.map(i=>this.substituteInTriple(i,t)),e):(e.input&&(e.input=this.substituteInOperation(e.input,t)),e.left&&(e.left=this.substituteInOperation(e.left,t)),e.right&&(e.right=this.substituteInOperation(e.right,t)),e.pattern&&(e.pattern=this.substituteInOperation(e.pattern,t)),e.query&&(e.query=this.substituteInOperation(e.query,t)),e.where&&(e.where=this.substituteInOperation(e.where,t)),e)}substituteInTriple(e,t){return{subject:this.substituteInTripleElement(e.subject,t),predicate:e.predicate,object:this.substituteInTripleElement(e.object,t)}}substituteInTripleElement(e,t){if(e&&e.type==="variable"){let i=t.get(e.value);if(i){if(i instanceof BP.IRI||i.termType==="NamedNode")return{type:"iri",value:i.value};if(i.termType==="Literal"||typeof i.value=="string"){let n=i;return{type:"literal",value:n.value,datatype:n.datatype?.value||n._datatype?.value,language:n.language||n._language}}}}return e}async*executeService(e){yield*this.serviceExecutor.execute(e,t=>this.sparqlGenerator.generateSelect(t))}async*executeGraph(e){let t=async function*(i,n){let s=this.currentGraphContext;this.currentGraphContext=n;try{i.type==="bgp"&&n&&this.tripleStore.matchInGraph?yield*this.executeBGPInGraph(i,n):yield*this.execute(i)}finally{this.currentGraphContext=s}}.bind(this);yield*this.graphExecutor.execute(e,t)}async*executeBGPInGraph(e,t){if(e.triples.length===0){let{SolutionMapping:i}=await Promise.resolve().then(()=>FP(cn()));yield new i;return}yield*this.bgpExecutor.executeInGraph(e,t)}evaluateExtendExpression(e,t){if(e.type!=="aggregate")try{return this.filterExecutor.evaluateExpression(e,t)}catch{return}}getExpressionValue(e,t){if(e.type==="variable"){let i=t.get(e.name);return i?i.value??i.id??String(i):void 0}return e.value}getSolutionKey(e){let t=e.toJSON();return Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("|")}isConstructQuery(e){return e.type==="construct"}async executeConstruct(e){if(e.type!=="construct")throw new Aa("executeConstruct requires a CONSTRUCT operation");let t=await this.executeAll(e.where);return this.constructExecutor.execute(e.template,t)}isAskQuery(e){return e.type==="ask"}async executeAsk(e){if(e.type!=="ask")throw new Aa("executeAsk requires an ASK operation");for await(let t of this.execute(e.where))return!0;return!1}};Vr.QueryExecutor=rg});var N3=y(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.UpdateExecutor=Ca.UpdateExecutorError=void 0;var UP=_n(),xa=et(),ig=yt(),D3=sr(),Kt=class extends Error{static{o(this,"UpdateExecutorError")}constructor(e,t){super(e,t?{cause:t}:void 0),this.name="UpdateExecutorError"}};Ca.UpdateExecutorError=Kt;var ng=class{static{o(this,"UpdateExecutor")}constructor(e){this.tripleStore=e}async execute(e){if(e.type!=="update")throw new Kt("Expected UPDATE request");let t=[];for(let i of e.updates){let n=await this.executeOperation(i);t.push(n)}return t}async executeOperation(e){if("updateType"in e)switch(e.updateType){case"insert":return this.executeInsertData(e);case"delete":return this.executeDeleteData(e);case"insertdelete":throw new Kt("INSERT/DELETE with WHERE clause not yet implemented");case"deletewhere":throw new Kt("DELETE WHERE not yet implemented");default:throw new Kt(`Unknown update type: ${e.updateType}`)}if("type"in e)switch(e.type){case"clear":case"drop":case"load":case"create":case"copy":case"move":case"add":throw new Kt(`${e.type.toUpperCase()} operation not yet implemented`);default:throw new Kt(`Unknown operation type: ${e.type}`)}throw new Kt("Unknown update operation structure")}async executeInsertData(e){if(e.updateType!=="insert")throw new Kt("Expected INSERT DATA operation");let t=e,i=0;for(let n of t.insert)if(n.type==="bgp"){let s=this.resolveGraphName(t.graph);i+=await this.insertTriples(n.triples,s)}else if(n.type==="graph"){let s=n,a=this.parseGraphName(s.name);i+=await this.insertTriples(s.triples,a)}return{type:"insert",inserted:i,success:!0}}async executeDeleteData(e){if(e.updateType!=="delete")throw new Kt("Expected DELETE DATA operation");let t=e,i=0;for(let n of t.delete)if(n.type==="bgp"){let s=this.resolveGraphName(t.graph);i+=await this.deleteTriples(n.triples,s)}else if(n.type==="graph"){let s=n,a=this.parseGraphName(s.name);i+=await this.deleteTriples(s.triples,a)}return{type:"delete",deleted:i,success:!0}}async insertTriples(e,t){let i=0;for(let n of e){let s=this.convertTriple(n);t&&this.tripleStore.addToGraph?await this.tripleStore.addToGraph(s,t):await this.tripleStore.add(s),i++}return i}async deleteTriples(e,t){let i=0;for(let n of e){let s=this.convertTriple(n),a;t&&this.tripleStore.removeFromGraph?a=await this.tripleStore.removeFromGraph(s,t):a=await this.tripleStore.remove(s),a&&i++}return i}convertTriple(e){return new UP.Triple(this.convertSubject(e.subject),this.convertPredicate(e.predicate),this.convertObject(e.object))}convertSubject(e){if(e.termType==="NamedNode")return new xa.IRI(e.value);if(e.termType==="BlankNode")return new D3.BlankNode(e.value);throw new Kt(`Invalid subject term type: ${e.termType}. Variables are not allowed in INSERT DATA.`)}convertPredicate(e){if("termType"in e&&e.termType==="NamedNode")return new xa.IRI(e.value);throw new Kt("Invalid predicate term type. Only IRIs are allowed in INSERT DATA.")}convertObject(e){if(e.termType==="NamedNode")return new xa.IRI(e.value);if(e.termType==="BlankNode")return new D3.BlankNode(e.value);if(e.termType==="Literal"){let t=e;return t.language?new ig.Literal(t.value,void 0,t.language):t.datatype?new ig.Literal(t.value,new xa.IRI(t.datatype.value)):new ig.Literal(t.value)}throw new Kt(`Invalid object term type: ${e.termType}. Variables are not allowed in INSERT DATA.`)}resolveGraphName(e){if(e&&!e.default&&e.name)return new xa.IRI(e.name.value)}parseGraphName(e){if(e.termType==="Variable")throw new Kt("Variables are not allowed as graph names in INSERT DATA / DELETE DATA.");return new xa.IRI(e.value)}};Ca.UpdateExecutor=ng});var j3=y(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});Rl.AggregateFunctions=void 0;var sg=yt(),k3=et(),ag=class{static{o(this,"AggregateFunctions")}static count(e,t){if(!t)return e.length;let i=0;for(let n of e)n.has(t)&&i++;return i}static countDistinct(e,t){let i=new Set;for(let n of e){let s=n.get(t);s&&i.add(s.toString())}return i.size}static sum(e,t){let i=0;for(let n of e){let s=n.get(t);if(s instanceof sg.Literal){let a=this.toNumber(s);isNaN(a)||(i+=a)}}return i}static avg(e,t){let i=this.sum(e,t),n=this.count(e,t);return n>0?i/n:0}static min(e,t){let i=null;for(let n of e){let s=n.get(t);if(!s)continue;let a=this.toComparable(s);(i===null||a<i)&&(i=a)}return i}static max(e,t){let i=null;for(let n of e){let s=n.get(t);if(!s)continue;let a=this.toComparable(s);(i===null||a>i)&&(i=a)}return i}static groupConcat(e,t,i=" "){let n=[];for(let s of e){let a=s.get(t);a&&(a instanceof sg.Literal||a instanceof k3.IRI?n.push(a.value):n.push(a.toString()))}return n.join(i)}static sample(e,t){for(let i of e){let n=i.get(t);if(n)return this.toComparable(n)}return null}static sampleDistinct(e,t){return this.sample(e,t)}static toNumber(e){let t=e.datatype?.value;return t?.includes("#integer")||t?.includes("#decimal")||t?.includes("#double"),parseFloat(e.value)}static toComparable(e){if(e instanceof sg.Literal){let t=this.toNumber(e);return isNaN(t)?e.value:t}return e instanceof k3.IRI?e.value:String(e)}};Rl.AggregateFunctions=ag});var L3=y(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});Dl.QueryPlanCache=void 0;var GP=Jp(),og=class{static{o(this,"QueryPlanCache")}constructor(e=100){this.hits=0,this.misses=0,this.cache=new GP.LRUCache(e)}get(e){let t=this.normalizeQuery(e),i=this.cache.get(t);return i!==void 0?this.hits++:this.misses++,i}set(e,t){let i=this.normalizeQuery(e);this.cache.set(i,t)}has(e){let t=this.normalizeQuery(e);return this.cache.get(t)!==void 0}clear(){this.cache.clear()}getStats(){let e=this.hits+this.misses;return{hits:this.hits,misses:this.misses,hitRate:e>0?this.hits/e:0,size:this.cache.size()}}resetStats(){this.hits=0,this.misses=0}normalizeQuery(e){return e.replace(/\s+/g," ").trim()}};Dl.QueryPlanCache=og});var M3=y(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.FileAlreadyExistsError=Oa.FileNotFoundError=void 0;var cg=class extends Error{static{o(this,"FileNotFoundError")}constructor(e){super(`File not found: ${e}`),this.name="FileNotFoundError"}};Oa.FileNotFoundError=cg;var ug=class extends Error{static{o(this,"FileAlreadyExistsError")}constructor(e){super(`File already exists: ${e}`),this.name="FileAlreadyExistsError"}};Oa.FileAlreadyExistsError=ug});var V3=y(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.container=void 0;Rn.registerCoreServices=gF;Rn.createChildContainer=yF;Rn.getContainer=vF;Rn.resetContainer=_F;sh();var jo=Xe();Object.defineProperty(Rn,"container",{enumerable:!0,get:o(function(){return jo.container},"get")});var st=at(),WP=Kd(),zP=Fu(),HP=xp(),KP=Iu(),QP=vp(),YP=Yd(),XP=rp(),JP=ep(),ZP=ju(),eF=Lu(),tF=hp(),rF=pp(),iF=wp(),nF=lp(),sF=Op(),aF=Rp(),oF=Fp(),cF=ap(),uF=cp(),lF=Tp(),fF=Sp(),hF=nm(),dF=np(),pF=Np(),mF=jp();function gF(r){let e=r||jo.container;e.registerSingleton(st.DI_TOKENS.TaskFrontmatterGenerator,zP.TaskFrontmatterGenerator),e.registerSingleton(st.DI_TOKENS.DynamicFrontmatterGenerator,HP.DynamicFrontmatterGenerator),e.registerSingleton(st.DI_TOKENS.AlgorithmExtractor,KP.AlgorithmExtractor),e.registerSingleton(st.DI_TOKENS.EffortStatusWorkflow,ZP.EffortStatusWorkflow),e.registerSingleton(st.DI_TOKENS.StatusTimestampService,eF.StatusTimestampService),e.registerSingleton(st.DI_TOKENS.TaskStatusService,JP.TaskStatusService),e.registerSingleton(st.DI_TOKENS.TaskCreationService,WP.TaskCreationService),e.registerSingleton(st.DI_TOKENS.ProjectCreationService,YP.ProjectCreationService),e.registerSingleton(st.DI_TOKENS.AreaCreationService,XP.AreaCreationService),e.registerSingleton(st.DI_TOKENS.ClassCreationService,cF.ClassCreationService),e.registerSingleton(st.DI_TOKENS.ConceptCreationService,uF.ConceptCreationService),e.registerSingleton(st.DI_TOKENS.FleetingNoteCreationService,lF.FleetingNoteCreationService),e.registerSingleton(st.DI_TOKENS.SupervisionCreationService,fF.SupervisionCreationService),e.registerSingleton(st.DI_TOKENS.GenericAssetCreationService,mF.GenericAssetCreationService),e.registerSingleton(st.DI_TOKENS.PropertyCleanupService,QP.PropertyCleanupService),e.registerSingleton(st.DI_TOKENS.FolderRepairService,tF.FolderRepairService),e.registerSingleton(st.DI_TOKENS.LabelToAliasService,rF.LabelToAliasService),e.registerSingleton(st.DI_TOKENS.RenameToUidService,iF.RenameToUidService),e.registerSingleton(st.DI_TOKENS.PlanningService,sF.PlanningService),e.registerSingleton(st.DI_TOKENS.EffortVotingService,nF.EffortVotingService),e.registerSingleton(st.DI_TOKENS.SessionEventService,aF.SessionEventService),e.registerSingleton(st.DI_TOKENS.AssetConversionService,oF.AssetConversionService),e.registerSingleton(st.DI_TOKENS.NoteToRDFConverter,hF.NoteToRDFConverter),e.registerSingleton(st.DI_TOKENS.AreaHierarchyBuilder,dF.AreaHierarchyBuilder),e.registerSingleton(st.DI_TOKENS.URIConstructionService,pF.URIConstructionService)}o(gF,"registerCoreServices");function yF(){return jo.container.createChildContainer()}o(yF,"createChildContainer");function vF(){return jo.container}o(vF,"getContainer");function _F(){jo.container.reset()}o(_F,"resetContainer")});var Ni=y(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});Nl.ErrorCode=void 0;var $3;(function(r){r[r.INVALID_INPUT=1e3]="INVALID_INPUT",r[r.INVALID_FORMAT=1001]="INVALID_FORMAT",r[r.MISSING_REQUIRED_FIELD=1002]="MISSING_REQUIRED_FIELD",r[r.INVALID_SCHEMA=1003]="INVALID_SCHEMA",r[r.NETWORK_ERROR=2e3]="NETWORK_ERROR",r[r.REQUEST_TIMEOUT=2001]="REQUEST_TIMEOUT",r[r.CONNECTION_FAILED=2002]="CONNECTION_FAILED",r[r.FILE_READ_ERROR=2003]="FILE_READ_ERROR",r[r.FILE_WRITE_ERROR=2004]="FILE_WRITE_ERROR",r[r.INVALID_STATE=3e3]="INVALID_STATE",r[r.INVALID_TRANSITION=3001]="INVALID_TRANSITION",r[r.OPERATION_FAILED=3002]="OPERATION_FAILED",r[r.CONCURRENT_MODIFICATION=3003]="CONCURRENT_MODIFICATION",r[r.PERMISSION_DENIED=4e3]="PERMISSION_DENIED",r[r.UNAUTHORIZED=4001]="UNAUTHORIZED",r[r.FORBIDDEN=4003]="FORBIDDEN",r[r.NOT_FOUND=5e3]="NOT_FOUND",r[r.RESOURCE_EXHAUSTED=5001]="RESOURCE_EXHAUSTED",r[r.ALREADY_EXISTS=5002]="ALREADY_EXISTS",r[r.UNKNOWN_ERROR=9e3]="UNKNOWN_ERROR",r[r.INTERNAL_ERROR=9001]="INTERNAL_ERROR"})($3||(Nl.ErrorCode=$3={}))});var ki=y(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});kl.ApplicationError=void 0;var lg=class extends Error{static{o(this,"ApplicationError")}constructor(e,t){super(e),this.name=this.constructor.name,this.context=t,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}format(){let e=`\u274C ${this.name}: ${this.message}`;if(this.guidance&&(e+=`

\u{1F4A1} ${this.guidance}`),this.context&&Object.keys(this.context).length>0){e+=`

\u{1F4CB} Context:`;for(let[t,i]of Object.entries(this.context))e+=`
  ${t}: ${JSON.stringify(i)}`}return e}toJSON(){return{name:this.name,message:this.message,code:this.code,retriable:this.retriable,timestamp:this.timestamp.toISOString(),context:this.context,stack:this.stack}}};kl.ApplicationError=lg});var q3=y(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});jl.ValidationError=void 0;var wF=ki(),bF=Ni(),fg=class extends wF.ApplicationError{static{o(this,"ValidationError")}constructor(e,t){super(e,t),this.code=bF.ErrorCode.INVALID_INPUT,this.retriable=!1,this.guidance=`Check the input data for correctness.
Common issues:
  \u2022 Missing required fields
  \u2022 Invalid data format or type
  \u2022 Values outside allowed range
  \u2022 Schema validation failed`}};jl.ValidationError=fg});var B3=y(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});Ll.NetworkError=void 0;var SF=ki(),EF=Ni(),hg=class extends SF.ApplicationError{static{o(this,"NetworkError")}constructor(e,t){super(e,t),this.code=EF.ErrorCode.NETWORK_ERROR,this.retriable=!0,this.guidance=`This is typically a transient network issue.
To resolve:
  \u2022 Check your internet connection
  \u2022 Retry the operation
  \u2022 Verify external services are available
  \u2022 Check firewall/proxy settings`}};Ll.NetworkError=hg});var U3=y(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.StateTransitionError=void 0;var TF=ki(),AF=Ni(),dg=class extends TF.ApplicationError{static{o(this,"StateTransitionError")}constructor(e,t){super(e,t),this.code=AF.ErrorCode.INVALID_TRANSITION,this.retriable=!1,this.guidance=`The requested state transition is not allowed.
To fix:
  \u2022 Check the current state of the resource
  \u2022 Verify the transition is valid for this workflow
  \u2022 Review state machine documentation
  \u2022 Ensure no concurrent modifications occurred`}};Ml.StateTransitionError=dg});var G3=y(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.PermissionError=void 0;var xF=ki(),CF=Ni(),pg=class extends xF.ApplicationError{static{o(this,"PermissionError")}constructor(e,t){super(e,t),this.code=CF.ErrorCode.PERMISSION_DENIED,this.retriable=!1,this.guidance=`You don't have permission to perform this operation.
To resolve:
  \u2022 Check file/directory permissions
  \u2022 Verify you're authenticated
  \u2022 Ensure you have sufficient privileges
  \u2022 Contact administrator if access is needed`}};Vl.PermissionError=pg});var W3=y($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});$l.NotFoundError=void 0;var OF=ki(),PF=Ni(),mg=class extends OF.ApplicationError{static{o(this,"NotFoundError")}constructor(e,t){super(e,t),this.code=PF.ErrorCode.NOT_FOUND,this.retriable=!1,this.guidance=`The requested resource could not be found.
To resolve:
  \u2022 Verify the resource path/ID is correct
  \u2022 Check the resource exists
  \u2022 Ensure proper file extension (.md for notes)
  \u2022 Verify resource hasn't been deleted`}};$l.NotFoundError=mg});var z3=y(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});ql.ResourceExhaustedError=void 0;var FF=ki(),IF=Ni(),gg=class extends FF.ApplicationError{static{o(this,"ResourceExhaustedError")}constructor(e,t){super(e,t),this.code=IF.ErrorCode.RESOURCE_EXHAUSTED,this.retriable=!0,this.guidance=`A resource limit has been exceeded.
To resolve:
  \u2022 Free up system resources (memory, disk space)
  \u2022 Reduce the size of your request
  \u2022 Wait and retry (for rate limits)
  \u2022 Close unused files/connections
  \u2022 Paginate large queries`}};ql.ResourceExhaustedError=gg});var H3=y(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.ServiceError=void 0;var RF=ki(),DF=Ni(),yg=class extends RF.ApplicationError{static{o(this,"ServiceError")}constructor(e,t){super(e,t),this.code=DF.ErrorCode.INTERNAL_ERROR,this.retriable=!1,this.guidance=`This is an internal service error.
To resolve:
  \u2022 Check service initialization parameters
  \u2022 Verify all required dependencies are available
  \u2022 Review service logs for detailed error information
  \u2022 Contact support if the issue persists`}};Bl.ServiceError=yg});var K3=y(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.ServiceError=_t.ResourceExhaustedError=_t.NotFoundError=_t.PermissionError=_t.StateTransitionError=_t.NetworkError=_t.ValidationError=_t.ApplicationError=_t.ErrorCode=void 0;var NF=Ni();Object.defineProperty(_t,"ErrorCode",{enumerable:!0,get:o(function(){return NF.ErrorCode},"get")});var kF=ki();Object.defineProperty(_t,"ApplicationError",{enumerable:!0,get:o(function(){return kF.ApplicationError},"get")});var jF=q3();Object.defineProperty(_t,"ValidationError",{enumerable:!0,get:o(function(){return jF.ValidationError},"get")});var LF=B3();Object.defineProperty(_t,"NetworkError",{enumerable:!0,get:o(function(){return LF.NetworkError},"get")});var MF=U3();Object.defineProperty(_t,"StateTransitionError",{enumerable:!0,get:o(function(){return MF.StateTransitionError},"get")});var VF=G3();Object.defineProperty(_t,"PermissionError",{enumerable:!0,get:o(function(){return VF.PermissionError},"get")});var $F=W3();Object.defineProperty(_t,"NotFoundError",{enumerable:!0,get:o(function(){return $F.NotFoundError},"get")});var qF=z3();Object.defineProperty(_t,"ResourceExhaustedError",{enumerable:!0,get:o(function(){return qF.ResourceExhaustedError},"get")});var BF=H3();Object.defineProperty(_t,"ServiceError",{enumerable:!0,get:o(function(){return BF.ServiceError},"get")})});var Q3=y(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});Ul.ApplicationErrorHandler=void 0;var vg=ki(),UF=Ni(),_g=class{static{o(this,"ApplicationErrorHandler")}constructor(e={},t,i){this.logger=t,this.notifier=i,this.telemetryHooks=new Set,this.retryConfig={maxRetries:e.maxRetries??3,initialDelayMs:e.initialDelayMs??1e3,backoffMultiplier:e.backoffMultiplier??2,maxDelayMs:e.maxDelayMs??1e4}}handle(e,t){let i=this.ensureApplicationError(e,t);return this.notifier&&this.notifier.error(i.message),this.callTelemetryHooks("onError",i,t),this.formatError(i)}async executeWithRetry(e,t){let i,n=0;for(;n<=this.retryConfig.maxRetries;)try{return await e()}catch(s){if(i=this.ensureApplicationError(s,t),!i.retriable||n>=this.retryConfig.maxRetries)throw this.callTelemetryHooks("onError",i,t),n>=this.retryConfig.maxRetries&&i.retriable&&this.callTelemetryHooks("onRetryExhausted",i,n+1),i;let a=this.calculateDelay(n);this.callTelemetryHooks("onRetry",i,n+1,a),this.logger?.debug(`Retrying after ${a}ms (attempt ${n+1}/${this.retryConfig.maxRetries})`),await this.sleep(a),n++}throw i}registerTelemetryHook(e){this.telemetryHooks.add(e)}unregisterTelemetryHook(e){this.telemetryHooks.delete(e)}ensureApplicationError(e,t){if(e instanceof vg.ApplicationError){if(t){let n=e,s={...e.context,...t};return new class extends vg.ApplicationError{constructor(){super(...arguments),this.code=n.code,this.retriable=n.retriable,this.guidance=n.guidance}}(e.message,s)}return e}return new class extends vg.ApplicationError{static{o(this,"UnknownError")}constructor(s,a){super(s,{originalError:a.name,...t}),this.code=UF.ErrorCode.UNKNOWN_ERROR,this.retriable=!1,this.guidance="An unexpected error occurred"}}(e.message,e)}formatError(e){let t=[];return t.push(`\u274C ${e.name}: ${e.message}`),e.guidance&&t.push(`\u{1F4A1} ${e.guidance}`),e.context&&Object.keys(e.context).length>0&&t.push(`Context: ${JSON.stringify(e.context,null,2)}`),t.join(`
`)}calculateDelay(e){let t=this.retryConfig.initialDelayMs*Math.pow(this.retryConfig.backoffMultiplier,e);return Math.min(t,this.retryConfig.maxDelayMs)}sleep(e){return new Promise(t=>setTimeout(t,e))}callTelemetryHooks(e,...t){for(let i of this.telemetryHooks)try{let n=i[e];n&&n.apply(i,t)}catch(n){console.error("Error in telemetry hook:",n)}}};Ul.ApplicationErrorHandler=_g});var Y3=y(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.ApplicationErrorHandler=void 0;var GF=Q3();Object.defineProperty(Gl,"ApplicationErrorHandler",{enumerable:!0,get:o(function(){return GF.ApplicationErrorHandler},"get")})});var Dn=y(S=>{"use strict";var WF=S&&S.__createBinding||(Object.create?(function(r,e,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:o(function(){return e[t]},"get")}),Object.defineProperty(r,i,n)}):(function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]})),ji=S&&S.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&WF(e,r,t)};Object.defineProperty(S,"__esModule",{value:!0});S.FilterExecutor=S.BGPExecutor=S.AlgebraSerializer=S.AlgebraOptimizer=S.AlgebraTranslator=S.DescribeOptionsTransformerError=S.DescribeOptionsTransformer=S.SPARQLParseError=S.SPARQLParser=S.NoteToRDFConverter=S.RDFVocabularyMapper=S.InMemoryTripleStore=S.RDFSerializer=S.FilenameValidator=S.EffortSortingHelpers=S.MetadataExtractor=S.MetadataHelpers=S.WikiLinkHelpers=S.DateFormatter=S.FrontmatterService=S.GenericAssetCreationService=S.URIConstructionService=S.SessionEventService=S.AssetConversionService=S.PlanningService=S.AlgorithmExtractor=S.DynamicFrontmatterGenerator=S.TaskFrontmatterGenerator=S.FleetingNoteCreationService=S.SupervisionCreationService=S.StatusTimestampService=S.RenameToUidService=S.PropertyCleanupService=S.LoggingService=S.LabelToAliasService=S.FolderRepairService=S.EffortVotingService=S.EffortStatusWorkflow=S.ConceptCreationService=S.ClassCreationService=S.AreaHierarchyBuilder=S.AreaCreationService=S.TaskStatusService=S.ProjectCreationService=S.TaskCreationService=S.extractPropertyLabel=S.uriToPropertyName=S.propertyNameToUri=S.rangeToFieldType=S.PropertyFieldType=void 0;S.container=S.resetContainer=S.getContainer=S.createChildContainer=S.registerCoreServices=S.DI_TOKENS=S.FileAlreadyExistsError=S.FileNotFoundError=S.FilterContainsOptimizer=S.CaseWhenTransformerError=S.CaseWhenTransformer=S.QueryPlanCache=S.createDoubleLiteral=S.createDecimalLiteral=S.getNumericValue=S.createPercentileAggregate=S.modeAggregate=S.stddevAggregate=S.varianceAggregate=S.medianAggregate=S.EXO_AGGREGATE_NS=S.BUILT_IN_AGGREGATES=S.CustomAggregateError=S.CustomAggregateRegistry=S.AggregateFunctions=S.BuiltInFunctions=S.SolutionMapping=S.UpdateExecutorError=S.UpdateExecutor=S.QueryExecutor=S.DescribeExecutor=S.ConstructExecutor=S.UnionExecutor=S.OptionalExecutor=void 0;ji(Eh(),S);ji(Th(),S);ji(I0(),S);ji(D0(),S);ji(k0(),S);ji(L0(),S);ji($0(),S);ji(ty(),S);var X3=Lh();Object.defineProperty(S,"PropertyFieldType",{enumerable:!0,get:o(function(){return X3.PropertyFieldType},"get")});Object.defineProperty(S,"rangeToFieldType",{enumerable:!0,get:o(function(){return X3.rangeToFieldType},"get")});var wg=ny();Object.defineProperty(S,"propertyNameToUri",{enumerable:!0,get:o(function(){return wg.propertyNameToUri},"get")});Object.defineProperty(S,"uriToPropertyName",{enumerable:!0,get:o(function(){return wg.uriToPropertyName},"get")});Object.defineProperty(S,"extractPropertyLabel",{enumerable:!0,get:o(function(){return wg.extractPropertyLabel},"get")});var zF=Kd();Object.defineProperty(S,"TaskCreationService",{enumerable:!0,get:o(function(){return zF.TaskCreationService},"get")});var HF=Yd();Object.defineProperty(S,"ProjectCreationService",{enumerable:!0,get:o(function(){return HF.ProjectCreationService},"get")});var KF=ep();Object.defineProperty(S,"TaskStatusService",{enumerable:!0,get:o(function(){return KF.TaskStatusService},"get")});var QF=rp();Object.defineProperty(S,"AreaCreationService",{enumerable:!0,get:o(function(){return QF.AreaCreationService},"get")});var YF=np();Object.defineProperty(S,"AreaHierarchyBuilder",{enumerable:!0,get:o(function(){return YF.AreaHierarchyBuilder},"get")});var XF=ap();Object.defineProperty(S,"ClassCreationService",{enumerable:!0,get:o(function(){return XF.ClassCreationService},"get")});var JF=cp();Object.defineProperty(S,"ConceptCreationService",{enumerable:!0,get:o(function(){return JF.ConceptCreationService},"get")});var ZF=ju();Object.defineProperty(S,"EffortStatusWorkflow",{enumerable:!0,get:o(function(){return ZF.EffortStatusWorkflow},"get")});var e5=lp();Object.defineProperty(S,"EffortVotingService",{enumerable:!0,get:o(function(){return e5.EffortVotingService},"get")});var t5=hp();Object.defineProperty(S,"FolderRepairService",{enumerable:!0,get:o(function(){return t5.FolderRepairService},"get")});var r5=pp();Object.defineProperty(S,"LabelToAliasService",{enumerable:!0,get:o(function(){return r5.LabelToAliasService},"get")});var i5=mp();Object.defineProperty(S,"LoggingService",{enumerable:!0,get:o(function(){return i5.LoggingService},"get")});var n5=vp();Object.defineProperty(S,"PropertyCleanupService",{enumerable:!0,get:o(function(){return n5.PropertyCleanupService},"get")});var s5=wp();Object.defineProperty(S,"RenameToUidService",{enumerable:!0,get:o(function(){return s5.RenameToUidService},"get")});var a5=Lu();Object.defineProperty(S,"StatusTimestampService",{enumerable:!0,get:o(function(){return a5.StatusTimestampService},"get")});var o5=Sp();Object.defineProperty(S,"SupervisionCreationService",{enumerable:!0,get:o(function(){return o5.SupervisionCreationService},"get")});var c5=Tp();Object.defineProperty(S,"FleetingNoteCreationService",{enumerable:!0,get:o(function(){return c5.FleetingNoteCreationService},"get")});var u5=Fu();Object.defineProperty(S,"TaskFrontmatterGenerator",{enumerable:!0,get:o(function(){return u5.TaskFrontmatterGenerator},"get")});var l5=xp();Object.defineProperty(S,"DynamicFrontmatterGenerator",{enumerable:!0,get:o(function(){return l5.DynamicFrontmatterGenerator},"get")});var f5=Iu();Object.defineProperty(S,"AlgorithmExtractor",{enumerable:!0,get:o(function(){return f5.AlgorithmExtractor},"get")});var h5=Op();Object.defineProperty(S,"PlanningService",{enumerable:!0,get:o(function(){return h5.PlanningService},"get")});var d5=Fp();Object.defineProperty(S,"AssetConversionService",{enumerable:!0,get:o(function(){return d5.AssetConversionService},"get")});var p5=Rp();Object.defineProperty(S,"SessionEventService",{enumerable:!0,get:o(function(){return p5.SessionEventService},"get")});var m5=Np();Object.defineProperty(S,"URIConstructionService",{enumerable:!0,get:o(function(){return m5.URIConstructionService},"get")});var g5=jp();Object.defineProperty(S,"GenericAssetCreationService",{enumerable:!0,get:o(function(){return g5.GenericAssetCreationService},"get")});var y5=Js();Object.defineProperty(S,"FrontmatterService",{enumerable:!0,get:o(function(){return y5.FrontmatterService},"get")});var v5=cr();Object.defineProperty(S,"DateFormatter",{enumerable:!0,get:o(function(){return v5.DateFormatter},"get")});var _5=ss();Object.defineProperty(S,"WikiLinkHelpers",{enumerable:!0,get:o(function(){return _5.WikiLinkHelpers},"get")});var w5=Lr();Object.defineProperty(S,"MetadataHelpers",{enumerable:!0,get:o(function(){return w5.MetadataHelpers},"get")});var b5=Ao();Object.defineProperty(S,"MetadataExtractor",{enumerable:!0,get:o(function(){return b5.MetadataExtractor},"get")});var S5=D2();Object.defineProperty(S,"EffortSortingHelpers",{enumerable:!0,get:o(function(){return S5.EffortSortingHelpers},"get")});var E5=N2();Object.defineProperty(S,"FilenameValidator",{enumerable:!0,get:o(function(){return E5.FilenameValidator},"get")});var T5=q2();Object.defineProperty(S,"RDFSerializer",{enumerable:!0,get:o(function(){return T5.RDFSerializer},"get")});var A5=U2();Object.defineProperty(S,"InMemoryTripleStore",{enumerable:!0,get:o(function(){return A5.InMemoryTripleStore},"get")});var x5=rm();Object.defineProperty(S,"RDFVocabularyMapper",{enumerable:!0,get:o(function(){return x5.RDFVocabularyMapper},"get")});var C5=nm();Object.defineProperty(S,"NoteToRDFConverter",{enumerable:!0,get:o(function(){return C5.NoteToRDFConverter},"get")});var J3=u3();Object.defineProperty(S,"SPARQLParser",{enumerable:!0,get:o(function(){return J3.SPARQLParser},"get")});Object.defineProperty(S,"SPARQLParseError",{enumerable:!0,get:o(function(){return J3.SPARQLParseError},"get")});var Z3=wm();Object.defineProperty(S,"DescribeOptionsTransformer",{enumerable:!0,get:o(function(){return Z3.DescribeOptionsTransformer},"get")});Object.defineProperty(S,"DescribeOptionsTransformerError",{enumerable:!0,get:o(function(){return Z3.DescribeOptionsTransformerError},"get")});var O5=f3();Object.defineProperty(S,"AlgebraTranslator",{enumerable:!0,get:o(function(){return O5.AlgebraTranslator},"get")});var P5=h3();Object.defineProperty(S,"AlgebraOptimizer",{enumerable:!0,get:o(function(){return P5.AlgebraOptimizer},"get")});var F5=d3();Object.defineProperty(S,"AlgebraSerializer",{enumerable:!0,get:o(function(){return F5.AlgebraSerializer},"get")});var I5=Nm();Object.defineProperty(S,"BGPExecutor",{enumerable:!0,get:o(function(){return I5.BGPExecutor},"get")});var R5=Sl();Object.defineProperty(S,"FilterExecutor",{enumerable:!0,get:o(function(){return R5.FilterExecutor},"get")});var D5=Vm();Object.defineProperty(S,"OptionalExecutor",{enumerable:!0,get:o(function(){return D5.OptionalExecutor},"get")});var N5=qm();Object.defineProperty(S,"UnionExecutor",{enumerable:!0,get:o(function(){return N5.UnionExecutor},"get")});var k5=Wm();Object.defineProperty(S,"ConstructExecutor",{enumerable:!0,get:o(function(){return k5.ConstructExecutor},"get")});var j5=w3();Object.defineProperty(S,"DescribeExecutor",{enumerable:!0,get:o(function(){return j5.DescribeExecutor},"get")});var L5=R3();Object.defineProperty(S,"QueryExecutor",{enumerable:!0,get:o(function(){return L5.QueryExecutor},"get")});var ev=N3();Object.defineProperty(S,"UpdateExecutor",{enumerable:!0,get:o(function(){return ev.UpdateExecutor},"get")});Object.defineProperty(S,"UpdateExecutorError",{enumerable:!0,get:o(function(){return ev.UpdateExecutorError},"get")});var M5=cn();Object.defineProperty(S,"SolutionMapping",{enumerable:!0,get:o(function(){return M5.SolutionMapping},"get")});var V5=jm();Object.defineProperty(S,"BuiltInFunctions",{enumerable:!0,get:o(function(){return V5.BuiltInFunctions},"get")});var $5=j3();Object.defineProperty(S,"AggregateFunctions",{enumerable:!0,get:o(function(){return $5.AggregateFunctions},"get")});var tv=Qm();Object.defineProperty(S,"CustomAggregateRegistry",{enumerable:!0,get:o(function(){return tv.CustomAggregateRegistry},"get")});Object.defineProperty(S,"CustomAggregateError",{enumerable:!0,get:o(function(){return tv.CustomAggregateError},"get")});var Li=Ym();Object.defineProperty(S,"BUILT_IN_AGGREGATES",{enumerable:!0,get:o(function(){return Li.BUILT_IN_AGGREGATES},"get")});Object.defineProperty(S,"EXO_AGGREGATE_NS",{enumerable:!0,get:o(function(){return Li.EXO_AGGREGATE_NS},"get")});Object.defineProperty(S,"medianAggregate",{enumerable:!0,get:o(function(){return Li.medianAggregate},"get")});Object.defineProperty(S,"varianceAggregate",{enumerable:!0,get:o(function(){return Li.varianceAggregate},"get")});Object.defineProperty(S,"stddevAggregate",{enumerable:!0,get:o(function(){return Li.stddevAggregate},"get")});Object.defineProperty(S,"modeAggregate",{enumerable:!0,get:o(function(){return Li.modeAggregate},"get")});Object.defineProperty(S,"createPercentileAggregate",{enumerable:!0,get:o(function(){return Li.createPercentileAggregate},"get")});Object.defineProperty(S,"getNumericValue",{enumerable:!0,get:o(function(){return Li.getNumericValue},"get")});Object.defineProperty(S,"createDecimalLiteral",{enumerable:!0,get:o(function(){return Li.createDecimalLiteral},"get")});Object.defineProperty(S,"createDoubleLiteral",{enumerable:!0,get:o(function(){return Li.createDoubleLiteral},"get")});var q5=L3();Object.defineProperty(S,"QueryPlanCache",{enumerable:!0,get:o(function(){return q5.QueryPlanCache},"get")});var rv=ym();Object.defineProperty(S,"CaseWhenTransformer",{enumerable:!0,get:o(function(){return rv.CaseWhenTransformer},"get")});Object.defineProperty(S,"CaseWhenTransformerError",{enumerable:!0,get:o(function(){return rv.CaseWhenTransformerError},"get")});var B5=Cm();Object.defineProperty(S,"FilterContainsOptimizer",{enumerable:!0,get:o(function(){return B5.FilterContainsOptimizer},"get")});var iv=M3();Object.defineProperty(S,"FileNotFoundError",{enumerable:!0,get:o(function(){return iv.FileNotFoundError},"get")});Object.defineProperty(S,"FileAlreadyExistsError",{enumerable:!0,get:o(function(){return iv.FileAlreadyExistsError},"get")});var U5=at();Object.defineProperty(S,"DI_TOKENS",{enumerable:!0,get:o(function(){return U5.DI_TOKENS},"get")});var Lo=V3();Object.defineProperty(S,"registerCoreServices",{enumerable:!0,get:o(function(){return Lo.registerCoreServices},"get")});Object.defineProperty(S,"createChildContainer",{enumerable:!0,get:o(function(){return Lo.createChildContainer},"get")});Object.defineProperty(S,"getContainer",{enumerable:!0,get:o(function(){return Lo.getContainer},"get")});Object.defineProperty(S,"resetContainer",{enumerable:!0,get:o(function(){return Lo.resetContainer},"get")});Object.defineProperty(S,"container",{enumerable:!0,get:o(function(){return Lo.container},"get")});ji(K3(),S);ji(Y3(),S)});var xt=y(bg=>{"use strict";bg.fromCallback=function(r){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")r.apply(this,e);else return new Promise((t,i)=>{e.push((n,s)=>n!=null?i(n):t(s)),r.apply(this,e)})},"name",{value:r.name})};bg.fromPromise=function(r){return Object.defineProperty(function(...e){let t=e[e.length-1];if(typeof t!="function")return r.apply(this,e);e.pop(),r.apply(this,e).then(i=>t(null,i),t)},"name",{value:r.name})}});var sv=y((p$,nv)=>{var Nn=require("constants"),G5=process.cwd,Wl=null,W5=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Wl||(Wl=G5.call(process)),Wl};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Sg=process.chdir,process.chdir=function(r){Wl=null,Sg.call(process,r)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Sg));var Sg;nv.exports=z5;function z5(r){Nn.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(r),r.lutimes||t(r),r.chown=s(r.chown),r.fchown=s(r.fchown),r.lchown=s(r.lchown),r.chmod=i(r.chmod),r.fchmod=i(r.fchmod),r.lchmod=i(r.lchmod),r.chownSync=a(r.chownSync),r.fchownSync=a(r.fchownSync),r.lchownSync=a(r.lchownSync),r.chmodSync=n(r.chmodSync),r.fchmodSync=n(r.fchmodSync),r.lchmodSync=n(r.lchmodSync),r.stat=c(r.stat),r.fstat=c(r.fstat),r.lstat=c(r.lstat),r.statSync=u(r.statSync),r.fstatSync=u(r.fstatSync),r.lstatSync=u(r.lstatSync),r.chmod&&!r.lchmod&&(r.lchmod=function(f,h,d){d&&process.nextTick(d)},r.lchmodSync=function(){}),r.chown&&!r.lchown&&(r.lchown=function(f,h,d,g){g&&process.nextTick(g)},r.lchownSync=function(){}),W5==="win32"&&(r.rename=typeof r.rename!="function"?r.rename:(function(f){function h(d,g,w){var b=Date.now(),x=0;f(d,g,o(function O(F){if(F&&(F.code==="EACCES"||F.code==="EPERM"||F.code==="EBUSY")&&Date.now()-b<6e4){setTimeout(function(){r.stat(g,function(k,G){k&&k.code==="ENOENT"?f(d,g,O):w(F)})},x),x<100&&(x+=10);return}w&&w(F)},"CB"))}return o(h,"rename"),Object.setPrototypeOf&&Object.setPrototypeOf(h,f),h})(r.rename)),r.read=typeof r.read!="function"?r.read:(function(f){function h(d,g,w,b,x,O){var F;if(O&&typeof O=="function"){var k=0;F=o(function(G,W,Ie){if(G&&G.code==="EAGAIN"&&k<10)return k++,f.call(r,d,g,w,b,x,F);O.apply(this,arguments)},"callback")}return f.call(r,d,g,w,b,x,F)}return o(h,"read"),Object.setPrototypeOf&&Object.setPrototypeOf(h,f),h})(r.read),r.readSync=typeof r.readSync!="function"?r.readSync:(function(f){return function(h,d,g,w,b){for(var x=0;;)try{return f.call(r,h,d,g,w,b)}catch(O){if(O.code==="EAGAIN"&&x<10){x++;continue}throw O}}})(r.readSync);function e(f){f.lchmod=function(h,d,g){f.open(h,Nn.O_WRONLY|Nn.O_SYMLINK,d,function(w,b){if(w){g&&g(w);return}f.fchmod(b,d,function(x){f.close(b,function(O){g&&g(x||O)})})})},f.lchmodSync=function(h,d){var g=f.openSync(h,Nn.O_WRONLY|Nn.O_SYMLINK,d),w=!0,b;try{b=f.fchmodSync(g,d),w=!1}finally{if(w)try{f.closeSync(g)}catch{}else f.closeSync(g)}return b}}o(e,"patchLchmod");function t(f){Nn.hasOwnProperty("O_SYMLINK")&&f.futimes?(f.lutimes=function(h,d,g,w){f.open(h,Nn.O_SYMLINK,function(b,x){if(b){w&&w(b);return}f.futimes(x,d,g,function(O){f.close(x,function(F){w&&w(O||F)})})})},f.lutimesSync=function(h,d,g){var w=f.openSync(h,Nn.O_SYMLINK),b,x=!0;try{b=f.futimesSync(w,d,g),x=!1}finally{if(x)try{f.closeSync(w)}catch{}else f.closeSync(w)}return b}):f.futimes&&(f.lutimes=function(h,d,g,w){w&&process.nextTick(w)},f.lutimesSync=function(){})}o(t,"patchLutimes");function i(f){return f&&function(h,d,g){return f.call(r,h,d,function(w){l(w)&&(w=null),g&&g.apply(this,arguments)})}}o(i,"chmodFix");function n(f){return f&&function(h,d){try{return f.call(r,h,d)}catch(g){if(!l(g))throw g}}}o(n,"chmodFixSync");function s(f){return f&&function(h,d,g,w){return f.call(r,h,d,g,function(b){l(b)&&(b=null),w&&w.apply(this,arguments)})}}o(s,"chownFix");function a(f){return f&&function(h,d,g){try{return f.call(r,h,d,g)}catch(w){if(!l(w))throw w}}}o(a,"chownFixSync");function c(f){return f&&function(h,d,g){typeof d=="function"&&(g=d,d=null);function w(b,x){x&&(x.uid<0&&(x.uid+=4294967296),x.gid<0&&(x.gid+=4294967296)),g&&g.apply(this,arguments)}return o(w,"callback"),d?f.call(r,h,d,w):f.call(r,h,w)}}o(c,"statFix");function u(f){return f&&function(h,d){var g=d?f.call(r,h,d):f.call(r,h);return g&&(g.uid<0&&(g.uid+=4294967296),g.gid<0&&(g.gid+=4294967296)),g}}o(u,"statFixSync");function l(f){if(!f||f.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(f.code==="EINVAL"||f.code==="EPERM"))}o(l,"chownErOk")}o(z5,"patch")});var cv=y((g$,ov)=>{var av=require("stream").Stream;ov.exports=H5;function H5(r){return{ReadStream:e,WriteStream:t};function e(i,n){if(!(this instanceof e))return new e(i,n);av.call(this);var s=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var a=Object.keys(n),c=0,u=a.length;c<u;c++){var l=a[c];this[l]=n[l]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}r.open(this.path,this.flags,this.mode,function(f,h){if(f){s.emit("error",f),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function t(i,n){if(!(this instanceof t))return new t(i,n);av.call(this),this.path=i,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),a=0,c=s.length;a<c;a++){var u=s[a];this[u]=n[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=r.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}o(H5,"legacy")});var lv=y((v$,uv)=>{"use strict";uv.exports=Q5;var K5=Object.getPrototypeOf||function(r){return r.__proto__};function Q5(r){if(r===null||typeof r!="object")return r;if(r instanceof Object)var e={__proto__:K5(r)};else var e=Object.create(null);return Object.getOwnPropertyNames(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}),e}o(Q5,"clone")});var Fa=y((w$,Ag)=>{var ut=require("fs"),Y5=sv(),X5=cv(),J5=lv(),zl=require("util"),Vt,Kl;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Vt=Symbol.for("graceful-fs.queue"),Kl=Symbol.for("graceful-fs.previous")):(Vt="___graceful-fs.queue",Kl="___graceful-fs.previous");function Z5(){}o(Z5,"noop");function dv(r,e){Object.defineProperty(r,Vt,{get:o(function(){return e},"get")})}o(dv,"publishQueue");var Os=Z5;zl.debuglog?Os=zl.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Os=o(function(){var r=zl.format.apply(zl,arguments);r="GFS4: "+r.split(/\n/).join(`
GFS4: `),console.error(r)},"debug"));ut[Vt]||(fv=global[Vt]||[],dv(ut,fv),ut.close=(function(r){function e(t,i){return r.call(ut,t,function(n){n||hv(),typeof i=="function"&&i.apply(this,arguments)})}return o(e,"close"),Object.defineProperty(e,Kl,{value:r}),e})(ut.close),ut.closeSync=(function(r){function e(t){r.apply(ut,arguments),hv()}return o(e,"closeSync"),Object.defineProperty(e,Kl,{value:r}),e})(ut.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Os(ut[Vt]),require("assert").equal(ut[Vt].length,0)}));var fv;global[Vt]||dv(global,ut[Vt]);Ag.exports=Eg(J5(ut));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!ut.__patched&&(Ag.exports=Eg(ut),ut.__patched=!0);function Eg(r){Y5(r),r.gracefulify=Eg,r.createReadStream=W,r.createWriteStream=Ie;var e=r.readFile;r.readFile=t;function t(q,ue,we){return typeof ue=="function"&&(we=ue,ue=null),He(q,ue,we);function He(Ue,Ze,ke,je){return e(Ue,Ze,function(Re){Re&&(Re.code==="EMFILE"||Re.code==="ENFILE")?Pa([He,[Ue,Ze,ke],Re,je||Date.now(),Date.now()]):typeof ke=="function"&&ke.apply(this,arguments)})}o(He,"go$readFile")}o(t,"readFile");var i=r.writeFile;r.writeFile=n;function n(q,ue,we,He){return typeof we=="function"&&(He=we,we=null),Ue(q,ue,we,He);function Ue(Ze,ke,je,Re,H){return i(Ze,ke,je,function(N){N&&(N.code==="EMFILE"||N.code==="ENFILE")?Pa([Ue,[Ze,ke,je,Re],N,H||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(Ue,"go$writeFile")}o(n,"writeFile");var s=r.appendFile;s&&(r.appendFile=a);function a(q,ue,we,He){return typeof we=="function"&&(He=we,we=null),Ue(q,ue,we,He);function Ue(Ze,ke,je,Re,H){return s(Ze,ke,je,function(N){N&&(N.code==="EMFILE"||N.code==="ENFILE")?Pa([Ue,[Ze,ke,je,Re],N,H||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(Ue,"go$appendFile")}o(a,"appendFile");var c=r.copyFile;c&&(r.copyFile=u);function u(q,ue,we,He){return typeof we=="function"&&(He=we,we=0),Ue(q,ue,we,He);function Ue(Ze,ke,je,Re,H){return c(Ze,ke,je,function(N){N&&(N.code==="EMFILE"||N.code==="ENFILE")?Pa([Ue,[Ze,ke,je,Re],N,H||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(Ue,"go$copyFile")}o(u,"copyFile");var l=r.readdir;r.readdir=h;var f=/^v[0-5]\./;function h(q,ue,we){typeof ue=="function"&&(we=ue,ue=null);var He=f.test(process.version)?o(function(ke,je,Re,H){return l(ke,Ue(ke,je,Re,H))},"go$readdir"):o(function(ke,je,Re,H){return l(ke,je,Ue(ke,je,Re,H))},"go$readdir");return He(q,ue,we);function Ue(Ze,ke,je,Re){return function(H,N){H&&(H.code==="EMFILE"||H.code==="ENFILE")?Pa([He,[Ze,ke,je],H,Re||Date.now(),Date.now()]):(N&&N.sort&&N.sort(),typeof je=="function"&&je.call(this,H,N))}}}if(o(h,"readdir"),process.version.substr(0,4)==="v0.8"){var d=X5(r);O=d.ReadStream,k=d.WriteStream}var g=r.ReadStream;g&&(O.prototype=Object.create(g.prototype),O.prototype.open=F);var w=r.WriteStream;w&&(k.prototype=Object.create(w.prototype),k.prototype.open=G),Object.defineProperty(r,"ReadStream",{get:o(function(){return O},"get"),set:o(function(q){O=q},"set"),enumerable:!0,configurable:!0}),Object.defineProperty(r,"WriteStream",{get:o(function(){return k},"get"),set:o(function(q){k=q},"set"),enumerable:!0,configurable:!0});var b=O;Object.defineProperty(r,"FileReadStream",{get:o(function(){return b},"get"),set:o(function(q){b=q},"set"),enumerable:!0,configurable:!0});var x=k;Object.defineProperty(r,"FileWriteStream",{get:o(function(){return x},"get"),set:o(function(q){x=q},"set"),enumerable:!0,configurable:!0});function O(q,ue){return this instanceof O?(g.apply(this,arguments),this):O.apply(Object.create(O.prototype),arguments)}o(O,"ReadStream");function F(){var q=this;ot(q.path,q.flags,q.mode,function(ue,we){ue?(q.autoClose&&q.destroy(),q.emit("error",ue)):(q.fd=we,q.emit("open",we),q.read())})}o(F,"ReadStream$open");function k(q,ue){return this instanceof k?(w.apply(this,arguments),this):k.apply(Object.create(k.prototype),arguments)}o(k,"WriteStream");function G(){var q=this;ot(q.path,q.flags,q.mode,function(ue,we){ue?(q.destroy(),q.emit("error",ue)):(q.fd=we,q.emit("open",we))})}o(G,"WriteStream$open");function W(q,ue){return new r.ReadStream(q,ue)}o(W,"createReadStream");function Ie(q,ue){return new r.WriteStream(q,ue)}o(Ie,"createWriteStream");var Je=r.open;r.open=ot;function ot(q,ue,we,He){return typeof we=="function"&&(He=we,we=null),Ue(q,ue,we,He);function Ue(Ze,ke,je,Re,H){return Je(Ze,ke,je,function(N,Le){N&&(N.code==="EMFILE"||N.code==="ENFILE")?Pa([Ue,[Ze,ke,je,Re],N,H||Date.now(),Date.now()]):typeof Re=="function"&&Re.apply(this,arguments)})}o(Ue,"go$open")}return o(ot,"open"),r}o(Eg,"patch");function Pa(r){Os("ENQUEUE",r[0].name,r[1]),ut[Vt].push(r),Tg()}o(Pa,"enqueue");var Hl;function hv(){for(var r=Date.now(),e=0;e<ut[Vt].length;++e)ut[Vt][e].length>2&&(ut[Vt][e][3]=r,ut[Vt][e][4]=r);Tg()}o(hv,"resetQueue");function Tg(){if(clearTimeout(Hl),Hl=void 0,ut[Vt].length!==0){var r=ut[Vt].shift(),e=r[0],t=r[1],i=r[2],n=r[3],s=r[4];if(n===void 0)Os("RETRY",e.name,t),e.apply(null,t);else if(Date.now()-n>=6e4){Os("TIMEOUT",e.name,t);var a=t.pop();typeof a=="function"&&a.call(null,i)}else{var c=Date.now()-s,u=Math.max(s-n,1),l=Math.min(u*1.2,100);c>=l?(Os("RETRY",e.name,t),e.apply(null,t.concat([n]))):ut[Vt].push(r)}Hl===void 0&&(Hl=setTimeout(Tg,0))}}o(Tg,"retry")});var lr=y(un=>{"use strict";var pv=xt().fromCallback,ur=Fa(),eI=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter(r=>typeof ur[r]=="function");Object.assign(un,ur);eI.forEach(r=>{un[r]=pv(ur[r])});un.exists=function(r,e){return typeof e=="function"?ur.exists(r,e):new Promise(t=>ur.exists(r,t))};un.read=function(r,e,t,i,n,s){return typeof s=="function"?ur.read(r,e,t,i,n,s):new Promise((a,c)=>{ur.read(r,e,t,i,n,(u,l,f)=>{if(u)return c(u);a({bytesRead:l,buffer:f})})})};un.write=function(r,e,...t){return typeof t[t.length-1]=="function"?ur.write(r,e,...t):new Promise((i,n)=>{ur.write(r,e,...t,(s,a,c)=>{if(s)return n(s);i({bytesWritten:a,buffer:c})})})};un.readv=function(r,e,...t){return typeof t[t.length-1]=="function"?ur.readv(r,e,...t):new Promise((i,n)=>{ur.readv(r,e,...t,(s,a,c)=>{if(s)return n(s);i({bytesRead:a,buffers:c})})})};un.writev=function(r,e,...t){return typeof t[t.length-1]=="function"?ur.writev(r,e,...t):new Promise((i,n)=>{ur.writev(r,e,...t,(s,a,c)=>{if(s)return n(s);i({bytesWritten:a,buffers:c})})})};typeof ur.realpath.native=="function"?un.realpath.native=pv(ur.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var gv=y((E$,mv)=>{"use strict";var tI=require("path");mv.exports.checkPath=o(function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(tI.parse(e).root,""))){let i=new Error(`Path contains invalid characters: ${e}`);throw i.code="EINVAL",i}},"checkPath")});var wv=y((A$,xg)=>{"use strict";var yv=lr(),{checkPath:vv}=gv(),_v=o(r=>{let e={mode:511};return typeof r=="number"?r:{...e,...r}.mode},"getMode");xg.exports.makeDir=async(r,e)=>(vv(r),yv.mkdir(r,{mode:_v(e),recursive:!0}));xg.exports.makeDirSync=(r,e)=>(vv(r),yv.mkdirSync(r,{mode:_v(e),recursive:!0}))});var pi=y((C$,bv)=>{"use strict";var rI=xt().fromPromise,{makeDir:iI,makeDirSync:Cg}=wv(),Og=rI(iI);bv.exports={mkdirs:Og,mkdirsSync:Cg,mkdirp:Og,mkdirpSync:Cg,ensureDir:Og,ensureDirSync:Cg}});var kn=y((O$,Ev)=>{"use strict";var nI=xt().fromPromise,Sv=lr();function sI(r){return Sv.access(r).then(()=>!0).catch(()=>!1)}o(sI,"pathExists");Ev.exports={pathExists:nI(sI),pathExistsSync:Sv.existsSync}});var Pg=y((F$,Tv)=>{"use strict";var Ia=lr(),aI=xt().fromPromise;async function oI(r,e,t){let i=await Ia.open(r,"r+"),n=null;try{await Ia.futimes(i,e,t)}finally{try{await Ia.close(i)}catch(s){n=s}}if(n)throw n}o(oI,"utimesMillis");function cI(r,e,t){let i=Ia.openSync(r,"r+");return Ia.futimesSync(i,e,t),Ia.closeSync(i)}o(cI,"utimesMillisSync");Tv.exports={utimesMillis:aI(oI),utimesMillisSync:cI}});var Ps=y((R$,Ov)=>{"use strict";var Ra=lr(),Ct=require("path"),Av=xt().fromPromise;function uI(r,e,t){let i=t.dereference?n=>Ra.stat(n,{bigint:!0}):n=>Ra.lstat(n,{bigint:!0});return Promise.all([i(r),i(e).catch(n=>{if(n.code==="ENOENT")return null;throw n})]).then(([n,s])=>({srcStat:n,destStat:s}))}o(uI,"getStats");function lI(r,e,t){let i,n=t.dereference?a=>Ra.statSync(a,{bigint:!0}):a=>Ra.lstatSync(a,{bigint:!0}),s=n(r);try{i=n(e)}catch(a){if(a.code==="ENOENT")return{srcStat:s,destStat:null};throw a}return{srcStat:s,destStat:i}}o(lI,"getStatsSync");async function fI(r,e,t,i){let{srcStat:n,destStat:s}=await uI(r,e,i);if(s){if(Mo(n,s)){let a=Ct.basename(r),c=Ct.basename(e);if(t==="move"&&a!==c&&a.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${r}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${r}'.`)}if(n.isDirectory()&&Fg(r,e))throw new Error(Ql(r,e,t));return{srcStat:n,destStat:s}}o(fI,"checkPaths");function hI(r,e,t,i){let{srcStat:n,destStat:s}=lI(r,e,i);if(s){if(Mo(n,s)){let a=Ct.basename(r),c=Ct.basename(e);if(t==="move"&&a!==c&&a.toLowerCase()===c.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${r}'.`);if(!n.isDirectory()&&s.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${r}'.`)}if(n.isDirectory()&&Fg(r,e))throw new Error(Ql(r,e,t));return{srcStat:n,destStat:s}}o(hI,"checkPathsSync");async function xv(r,e,t,i){let n=Ct.resolve(Ct.dirname(r)),s=Ct.resolve(Ct.dirname(t));if(s===n||s===Ct.parse(s).root)return;let a;try{a=await Ra.stat(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Mo(e,a))throw new Error(Ql(r,t,i));return xv(r,e,s,i)}o(xv,"checkParentPaths");function Cv(r,e,t,i){let n=Ct.resolve(Ct.dirname(r)),s=Ct.resolve(Ct.dirname(t));if(s===n||s===Ct.parse(s).root)return;let a;try{a=Ra.statSync(s,{bigint:!0})}catch(c){if(c.code==="ENOENT")return;throw c}if(Mo(e,a))throw new Error(Ql(r,t,i));return Cv(r,e,s,i)}o(Cv,"checkParentPathsSync");function Mo(r,e){return e.ino!==void 0&&e.dev!==void 0&&e.ino===r.ino&&e.dev===r.dev}o(Mo,"areIdentical");function Fg(r,e){let t=Ct.resolve(r).split(Ct.sep).filter(n=>n),i=Ct.resolve(e).split(Ct.sep).filter(n=>n);return t.every((n,s)=>i[s]===n)}o(Fg,"isSrcSubdir");function Ql(r,e,t){return`Cannot ${t} '${r}' to a subdirectory of itself, '${e}'.`}o(Ql,"errMsg");Ov.exports={checkPaths:Av(fI),checkPathsSync:hI,checkParentPaths:Av(xv),checkParentPathsSync:Cv,isSrcSubdir:Fg,areIdentical:Mo}});var Fv=y((N$,Pv)=>{"use strict";async function dI(r,e){let t=[];for await(let i of r)t.push(e(i).then(()=>null,n=>n??new Error("unknown error")));await Promise.all(t.map(i=>i.then(n=>{if(n!==null)throw n})))}o(dI,"asyncIteratorConcurrentProcess");Pv.exports={asyncIteratorConcurrentProcess:dI}});var kv=y((j$,Nv)=>{"use strict";var Qt=lr(),Vo=require("path"),{mkdirs:pI}=pi(),{pathExists:mI}=kn(),{utimesMillis:gI}=Pg(),$o=Ps(),{asyncIteratorConcurrentProcess:yI}=Fv();async function vI(r,e,t={}){typeof t=="function"&&(t={filter:t}),t.clobber="clobber"in t?!!t.clobber:!0,t.overwrite="overwrite"in t?!!t.overwrite:t.clobber,t.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:i,destStat:n}=await $o.checkPaths(r,e,"copy",t);if(await $o.checkParentPaths(r,i,e,"copy"),!await Rv(r,e,t))return;let a=Vo.dirname(e);await mI(a)||await pI(a),await Dv(n,r,e,t)}o(vI,"copy");async function Rv(r,e,t){return t.filter?t.filter(r,e):!0}o(Rv,"runFilter");async function Dv(r,e,t,i){let s=await(i.dereference?Qt.stat:Qt.lstat)(e);if(s.isDirectory())return SI(s,r,e,t,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return _I(s,r,e,t,i);if(s.isSymbolicLink())return EI(r,e,t,i);throw s.isSocket()?new Error(`Cannot copy a socket file: ${e}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}o(Dv,"getStatsAndPerformCopy");async function _I(r,e,t,i,n){if(!e)return Iv(r,t,i,n);if(n.overwrite)return await Qt.unlink(i),Iv(r,t,i,n);if(n.errorOnExist)throw new Error(`'${i}' already exists`)}o(_I,"onFile");async function Iv(r,e,t,i){if(await Qt.copyFile(e,t),i.preserveTimestamps){wI(r.mode)&&await bI(t,r.mode);let n=await Qt.stat(e);await gI(t,n.atime,n.mtime)}return Qt.chmod(t,r.mode)}o(Iv,"copyFile");function wI(r){return(r&128)===0}o(wI,"fileIsNotWritable");function bI(r,e){return Qt.chmod(r,e|128)}o(bI,"makeFileWritable");async function SI(r,e,t,i,n){e||await Qt.mkdir(i),await yI(await Qt.opendir(t),async s=>{let a=Vo.join(t,s.name),c=Vo.join(i,s.name);if(await Rv(a,c,n)){let{destStat:l}=await $o.checkPaths(a,c,"copy",n);await Dv(l,a,c,n)}}),e||await Qt.chmod(i,r.mode)}o(SI,"onDir");async function EI(r,e,t,i){let n=await Qt.readlink(e);if(i.dereference&&(n=Vo.resolve(process.cwd(),n)),!r)return Qt.symlink(n,t);let s=null;try{s=await Qt.readlink(t)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return Qt.symlink(n,t);throw a}if(i.dereference&&(s=Vo.resolve(process.cwd(),s)),$o.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if($o.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return await Qt.unlink(t),Qt.symlink(n,t)}o(EI,"onLink");Nv.exports=vI});var $v=y((M$,Vv)=>{"use strict";var fr=Fa(),qo=require("path"),TI=pi().mkdirsSync,AI=Pg().utimesMillisSync,Bo=Ps();function xI(r,e,t){typeof t=="function"&&(t={filter:t}),t=t||{},t.clobber="clobber"in t?!!t.clobber:!0,t.overwrite="overwrite"in t?!!t.overwrite:t.clobber,t.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:i,destStat:n}=Bo.checkPathsSync(r,e,"copy",t);if(Bo.checkParentPathsSync(r,i,e,"copy"),t.filter&&!t.filter(r,e))return;let s=qo.dirname(e);return fr.existsSync(s)||TI(s),jv(n,r,e,t)}o(xI,"copySync");function jv(r,e,t,i){let s=(i.dereference?fr.statSync:fr.lstatSync)(e);if(s.isDirectory())return DI(s,r,e,t,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return CI(s,r,e,t,i);if(s.isSymbolicLink())return jI(r,e,t,i);throw s.isSocket()?new Error(`Cannot copy a socket file: ${e}`):s.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}o(jv,"getStats");function CI(r,e,t,i,n){return e?OI(r,t,i,n):Lv(r,t,i,n)}o(CI,"onFile");function OI(r,e,t,i){if(i.overwrite)return fr.unlinkSync(t),Lv(r,e,t,i);if(i.errorOnExist)throw new Error(`'${t}' already exists`)}o(OI,"mayCopyFile");function Lv(r,e,t,i){return fr.copyFileSync(e,t),i.preserveTimestamps&&PI(r.mode,e,t),Ig(t,r.mode)}o(Lv,"copyFile");function PI(r,e,t){return FI(r)&&II(t,r),RI(e,t)}o(PI,"handleTimestamps");function FI(r){return(r&128)===0}o(FI,"fileIsNotWritable");function II(r,e){return Ig(r,e|128)}o(II,"makeFileWritable");function Ig(r,e){return fr.chmodSync(r,e)}o(Ig,"setDestMode");function RI(r,e){let t=fr.statSync(r);return AI(e,t.atime,t.mtime)}o(RI,"setDestTimestamps");function DI(r,e,t,i,n){return e?Mv(t,i,n):NI(r.mode,t,i,n)}o(DI,"onDir");function NI(r,e,t,i){return fr.mkdirSync(t),Mv(e,t,i),Ig(t,r)}o(NI,"mkDirAndCopy");function Mv(r,e,t){let i=fr.opendirSync(r);try{let n;for(;(n=i.readSync())!==null;)kI(n.name,r,e,t)}finally{i.closeSync()}}o(Mv,"copyDir");function kI(r,e,t,i){let n=qo.join(e,r),s=qo.join(t,r);if(i.filter&&!i.filter(n,s))return;let{destStat:a}=Bo.checkPathsSync(n,s,"copy",i);return jv(a,n,s,i)}o(kI,"copyDirItem");function jI(r,e,t,i){let n=fr.readlinkSync(e);if(i.dereference&&(n=qo.resolve(process.cwd(),n)),r){let s;try{s=fr.readlinkSync(t)}catch(a){if(a.code==="EINVAL"||a.code==="UNKNOWN")return fr.symlinkSync(n,t);throw a}if(i.dereference&&(s=qo.resolve(process.cwd(),s)),Bo.isSrcSubdir(n,s))throw new Error(`Cannot copy '${n}' to a subdirectory of itself, '${s}'.`);if(Bo.isSrcSubdir(s,n))throw new Error(`Cannot overwrite '${s}' with '${n}'.`);return LI(n,t)}else return fr.symlinkSync(n,t)}o(jI,"onLink");function LI(r,e){return fr.unlinkSync(e),fr.symlinkSync(r,e)}o(LI,"copyLink");Vv.exports=xI});var Yl=y(($$,qv)=>{"use strict";var MI=xt().fromPromise;qv.exports={copy:MI(kv()),copySync:$v()}});var Uo=y((q$,Uv)=>{"use strict";var Bv=Fa(),VI=xt().fromCallback;function $I(r,e){Bv.rm(r,{recursive:!0,force:!0},e)}o($I,"remove");function qI(r){Bv.rmSync(r,{recursive:!0,force:!0})}o(qI,"removeSync");Uv.exports={remove:VI($I),removeSync:qI}});var Xv=y((U$,Yv)=>{"use strict";var BI=xt().fromPromise,zv=lr(),Hv=require("path"),Kv=pi(),Qv=Uo(),Gv=BI(o(async function(e){let t;try{t=await zv.readdir(e)}catch{return Kv.mkdirs(e)}return Promise.all(t.map(i=>Qv.remove(Hv.join(e,i))))},"emptyDir"));function Wv(r){let e;try{e=zv.readdirSync(r)}catch{return Kv.mkdirsSync(r)}e.forEach(t=>{t=Hv.join(r,t),Qv.removeSync(t)})}o(Wv,"emptyDirSync");Yv.exports={emptyDirSync:Wv,emptydirSync:Wv,emptyDir:Gv,emptydir:Gv}});var t_=y((W$,e_)=>{"use strict";var UI=xt().fromPromise,Jv=require("path"),ln=lr(),Zv=pi();async function GI(r){let e;try{e=await ln.stat(r)}catch{}if(e&&e.isFile())return;let t=Jv.dirname(r),i=null;try{i=await ln.stat(t)}catch(n){if(n.code==="ENOENT"){await Zv.mkdirs(t),await ln.writeFile(r,"");return}else throw n}i.isDirectory()?await ln.writeFile(r,""):await ln.readdir(t)}o(GI,"createFile");function WI(r){let e;try{e=ln.statSync(r)}catch{}if(e&&e.isFile())return;let t=Jv.dirname(r);try{ln.statSync(t).isDirectory()||ln.readdirSync(t)}catch(i){if(i&&i.code==="ENOENT")Zv.mkdirsSync(t);else throw i}ln.writeFileSync(r,"")}o(WI,"createFileSync");e_.exports={createFile:UI(GI),createFileSync:WI}});var a_=y((H$,s_)=>{"use strict";var zI=xt().fromPromise,r_=require("path"),jn=lr(),i_=pi(),{pathExists:HI}=kn(),{areIdentical:n_}=Ps();async function KI(r,e){let t;try{t=await jn.lstat(e)}catch{}let i;try{i=await jn.lstat(r)}catch(a){throw a.message=a.message.replace("lstat","ensureLink"),a}if(t&&n_(i,t))return;let n=r_.dirname(e);await HI(n)||await i_.mkdirs(n),await jn.link(r,e)}o(KI,"createLink");function QI(r,e){let t;try{t=jn.lstatSync(e)}catch{}try{let s=jn.lstatSync(r);if(t&&n_(s,t))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let i=r_.dirname(e);return jn.existsSync(i)||i_.mkdirsSync(i),jn.linkSync(r,e)}o(QI,"createLinkSync");s_.exports={createLink:zI(KI),createLinkSync:QI}});var c_=y((Q$,o_)=>{"use strict";var Ln=require("path"),Go=lr(),{pathExists:YI}=kn(),XI=xt().fromPromise;async function JI(r,e){if(Ln.isAbsolute(r)){try{await Go.lstat(r)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:r,toDst:r}}let t=Ln.dirname(e),i=Ln.join(t,r);if(await YI(i))return{toCwd:i,toDst:r};try{await Go.lstat(r)}catch(s){throw s.message=s.message.replace("lstat","ensureSymlink"),s}return{toCwd:r,toDst:Ln.relative(t,r)}}o(JI,"symlinkPaths");function ZI(r,e){if(Ln.isAbsolute(r)){if(!Go.existsSync(r))throw new Error("absolute srcpath does not exist");return{toCwd:r,toDst:r}}let t=Ln.dirname(e),i=Ln.join(t,r);if(Go.existsSync(i))return{toCwd:i,toDst:r};if(!Go.existsSync(r))throw new Error("relative srcpath does not exist");return{toCwd:r,toDst:Ln.relative(t,r)}}o(ZI,"symlinkPathsSync");o_.exports={symlinkPaths:XI(JI),symlinkPathsSync:ZI}});var f_=y((X$,l_)=>{"use strict";var u_=lr(),eR=xt().fromPromise;async function tR(r,e){if(e)return e;let t;try{t=await u_.lstat(r)}catch{return"file"}return t&&t.isDirectory()?"dir":"file"}o(tR,"symlinkType");function rR(r,e){if(e)return e;let t;try{t=u_.lstatSync(r)}catch{return"file"}return t&&t.isDirectory()?"dir":"file"}o(rR,"symlinkTypeSync");l_.exports={symlinkType:eR(tR),symlinkTypeSync:rR}});var m_=y((Z$,p_)=>{"use strict";var iR=xt().fromPromise,h_=require("path"),Mi=lr(),{mkdirs:nR,mkdirsSync:sR}=pi(),{symlinkPaths:aR,symlinkPathsSync:oR}=c_(),{symlinkType:cR,symlinkTypeSync:uR}=f_(),{pathExists:lR}=kn(),{areIdentical:d_}=Ps();async function fR(r,e,t){let i;try{i=await Mi.lstat(e)}catch{}if(i&&i.isSymbolicLink()){let[c,u]=await Promise.all([Mi.stat(r),Mi.stat(e)]);if(d_(c,u))return}let n=await aR(r,e);r=n.toDst;let s=await cR(n.toCwd,t),a=h_.dirname(e);return await lR(a)||await nR(a),Mi.symlink(r,e,s)}o(fR,"createSymlink");function hR(r,e,t){let i;try{i=Mi.lstatSync(e)}catch{}if(i&&i.isSymbolicLink()){let c=Mi.statSync(r),u=Mi.statSync(e);if(d_(c,u))return}let n=oR(r,e);r=n.toDst,t=uR(n.toCwd,t);let s=h_.dirname(e);return Mi.existsSync(s)||sR(s),Mi.symlinkSync(r,e,t)}o(hR,"createSymlinkSync");p_.exports={createSymlink:iR(fR),createSymlinkSync:hR}});var E_=y((tq,S_)=>{"use strict";var{createFile:g_,createFileSync:y_}=t_(),{createLink:v_,createLinkSync:__}=a_(),{createSymlink:w_,createSymlinkSync:b_}=m_();S_.exports={createFile:g_,createFileSync:y_,ensureFile:g_,ensureFileSync:y_,createLink:v_,createLinkSync:__,ensureLink:v_,ensureLinkSync:__,createSymlink:w_,createSymlinkSync:b_,ensureSymlink:w_,ensureSymlinkSync:b_}});var Xl=y((rq,T_)=>{function dR(r,{EOL:e=`
`,finalEOL:t=!0,replacer:i=null,spaces:n}={}){let s=t?e:"";return JSON.stringify(r,i,n).replace(/\n/g,e)+s}o(dR,"stringify");function pR(r){return Buffer.isBuffer(r)&&(r=r.toString("utf8")),r.replace(/^\uFEFF/,"")}o(pR,"stripBom");T_.exports={stringify:dR,stripBom:pR}});var O_=y((nq,C_)=>{var Da;try{Da=Fa()}catch{Da=require("fs")}var Jl=xt(),{stringify:A_,stripBom:x_}=Xl();async function mR(r,e={}){typeof e=="string"&&(e={encoding:e});let t=e.fs||Da,i="throws"in e?e.throws:!0,n=await Jl.fromCallback(t.readFile)(r,e);n=x_(n);let s;try{s=JSON.parse(n,e?e.reviver:null)}catch(a){if(i)throw a.message=`${r}: ${a.message}`,a;return null}return s}o(mR,"_readFile");var gR=Jl.fromPromise(mR);function yR(r,e={}){typeof e=="string"&&(e={encoding:e});let t=e.fs||Da,i="throws"in e?e.throws:!0;try{let n=t.readFileSync(r,e);return n=x_(n),JSON.parse(n,e.reviver)}catch(n){if(i)throw n.message=`${r}: ${n.message}`,n;return null}}o(yR,"readFileSync");async function vR(r,e,t={}){let i=t.fs||Da,n=A_(e,t);await Jl.fromCallback(i.writeFile)(r,n,t)}o(vR,"_writeFile");var _R=Jl.fromPromise(vR);function wR(r,e,t={}){let i=t.fs||Da,n=A_(e,t);return i.writeFileSync(r,n,t)}o(wR,"writeFileSync");C_.exports={readFile:gR,readFileSync:yR,writeFile:_R,writeFileSync:wR}});var F_=y((aq,P_)=>{"use strict";var Zl=O_();P_.exports={readJson:Zl.readFile,readJsonSync:Zl.readFileSync,writeJson:Zl.writeFile,writeJsonSync:Zl.writeFileSync}});var ef=y((oq,D_)=>{"use strict";var bR=xt().fromPromise,Rg=lr(),I_=require("path"),R_=pi(),SR=kn().pathExists;async function ER(r,e,t="utf-8"){let i=I_.dirname(r);return await SR(i)||await R_.mkdirs(i),Rg.writeFile(r,e,t)}o(ER,"outputFile");function TR(r,...e){let t=I_.dirname(r);Rg.existsSync(t)||R_.mkdirsSync(t),Rg.writeFileSync(r,...e)}o(TR,"outputFileSync");D_.exports={outputFile:bR(ER),outputFileSync:TR}});var k_=y((uq,N_)=>{"use strict";var{stringify:AR}=Xl(),{outputFile:xR}=ef();async function CR(r,e,t={}){let i=AR(e,t);await xR(r,i,t)}o(CR,"outputJson");N_.exports=CR});var L_=y((fq,j_)=>{"use strict";var{stringify:OR}=Xl(),{outputFileSync:PR}=ef();function FR(r,e,t){let i=OR(e,t);PR(r,i,t)}o(FR,"outputJsonSync");j_.exports=FR});var V_=y((dq,M_)=>{"use strict";var IR=xt().fromPromise,hr=F_();hr.outputJson=IR(k_());hr.outputJsonSync=L_();hr.outputJSON=hr.outputJson;hr.outputJSONSync=hr.outputJsonSync;hr.writeJSON=hr.writeJson;hr.writeJSONSync=hr.writeJsonSync;hr.readJSON=hr.readJson;hr.readJSONSync=hr.readJsonSync;M_.exports=hr});var G_=y((pq,U_)=>{"use strict";var RR=lr(),$_=require("path"),{copy:DR}=Yl(),{remove:B_}=Uo(),{mkdirp:NR}=pi(),{pathExists:kR}=kn(),q_=Ps();async function jR(r,e,t={}){let i=t.overwrite||t.clobber||!1,{srcStat:n,isChangingCase:s=!1}=await q_.checkPaths(r,e,"move",t);await q_.checkParentPaths(r,n,e,"move");let a=$_.dirname(e);return $_.parse(a).root!==a&&await NR(a),LR(r,e,i,s)}o(jR,"move");async function LR(r,e,t,i){if(!i){if(t)await B_(e);else if(await kR(e))throw new Error("dest already exists.")}try{await RR.rename(r,e)}catch(n){if(n.code!=="EXDEV")throw n;await MR(r,e,t)}}o(LR,"doRename");async function MR(r,e,t){return await DR(r,e,{overwrite:t,errorOnExist:!0,preserveTimestamps:!0}),B_(r)}o(MR,"moveAcrossDevice");U_.exports=jR});var Q_=y((gq,K_)=>{"use strict";var z_=Fa(),Ng=require("path"),VR=Yl().copySync,H_=Uo().removeSync,$R=pi().mkdirpSync,W_=Ps();function qR(r,e,t){t=t||{};let i=t.overwrite||t.clobber||!1,{srcStat:n,isChangingCase:s=!1}=W_.checkPathsSync(r,e,"move",t);return W_.checkParentPathsSync(r,n,e,"move"),BR(e)||$R(Ng.dirname(e)),UR(r,e,i,s)}o(qR,"moveSync");function BR(r){let e=Ng.dirname(r);return Ng.parse(e).root===e}o(BR,"isParentRoot");function UR(r,e,t,i){if(i)return Dg(r,e,t);if(t)return H_(e),Dg(r,e,t);if(z_.existsSync(e))throw new Error("dest already exists.");return Dg(r,e,t)}o(UR,"doRename");function Dg(r,e,t){try{z_.renameSync(r,e)}catch(i){if(i.code!=="EXDEV")throw i;return GR(r,e,t)}}o(Dg,"rename");function GR(r,e,t){return VR(r,e,{overwrite:t,errorOnExist:!0,preserveTimestamps:!0}),H_(r)}o(GR,"moveAcrossDevice");K_.exports=qR});var X_=y((vq,Y_)=>{"use strict";var WR=xt().fromPromise;Y_.exports={move:WR(G_()),moveSync:Q_()}});var Na=y((_q,J_)=>{"use strict";J_.exports={...lr(),...Yl(),...Xv(),...E_(),...V_(),...pi(),...X_(),...ef(),...kn(),...Uo()}});var cb=y((XB,ob)=>{"use strict";ob.exports=sb;function sb(r,e,t){r instanceof RegExp&&(r=nb(r,t)),e instanceof RegExp&&(e=nb(e,t));var i=ab(r,e,t);return i&&{start:i[0],end:i[1],pre:t.slice(0,i[0]),body:t.slice(i[0]+r.length,i[1]),post:t.slice(i[1]+e.length)}}o(sb,"balanced");function nb(r,e){var t=e.match(r);return t?t[0]:null}o(nb,"maybeMatch");sb.range=ab;function ab(r,e,t){var i,n,s,a,c,u=t.indexOf(r),l=t.indexOf(e,u+1),f=u;if(u>=0&&l>0){if(r===e)return[u,l];for(i=[],s=t.length;f>=0&&!c;)f==u?(i.push(f),u=t.indexOf(r,f+1)):i.length==1?c=[i.pop(),l]:(n=i.pop(),n<s&&(s=n,a=l),l=t.indexOf(e,f+1)),f=u<l&&u>=0?u:l;i.length&&(c=[s,a])}return c}o(ab,"range")});var gb=y((ZB,mb)=>{var ub=cb();mb.exports=g6;var lb="\0SLASH"+Math.random()+"\0",fb="\0OPEN"+Math.random()+"\0",Xg="\0CLOSE"+Math.random()+"\0",hb="\0COMMA"+Math.random()+"\0",db="\0PERIOD"+Math.random()+"\0";function Yg(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}o(Yg,"numeric");function p6(r){return r.split("\\\\").join(lb).split("\\{").join(fb).split("\\}").join(Xg).split("\\,").join(hb).split("\\.").join(db)}o(p6,"escapeBraces");function m6(r){return r.split(lb).join("\\").split(fb).join("{").split(Xg).join("}").split(hb).join(",").split(db).join(".")}o(m6,"unescapeBraces");function pb(r){if(!r)return[""];var e=[],t=ub("{","}",r);if(!t)return r.split(",");var i=t.pre,n=t.body,s=t.post,a=i.split(",");a[a.length-1]+="{"+n+"}";var c=pb(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}o(pb,"parseCommaParts");function g6(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),ec(p6(r),!0).map(m6)):[]}o(g6,"expandTop");function y6(r){return"{"+r+"}"}o(y6,"embrace");function v6(r){return/^-?0\d/.test(r)}o(v6,"isPadded");function _6(r,e){return r<=e}o(_6,"lte");function w6(r,e){return r>=e}o(w6,"gte");function ec(r,e){var t=[],i=ub("{","}",r);if(!i)return[r];var n=i.pre,s=i.post.length?ec(i.post,!1):[""];if(/\$$/.test(i.pre))for(var a=0;a<s.length;a++){var c=n+"{"+i.body+"}"+s[a];t.push(c)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),f=u||l,h=i.body.indexOf(",")>=0;if(!f&&!h)return i.post.match(/,(?!,).*\}/)?(r=i.pre+"{"+i.body+Xg+i.post,ec(r)):[r];var d;if(f)d=i.body.split(/\.\./);else if(d=pb(i.body),d.length===1&&(d=ec(d[0],!1).map(y6),d.length===1))return s.map(function(ue){return i.pre+d[0]+ue});var g;if(f){var w=Yg(d[0]),b=Yg(d[1]),x=Math.max(d[0].length,d[1].length),O=d.length==3?Math.abs(Yg(d[2])):1,F=_6,k=b<w;k&&(O*=-1,F=w6);var G=d.some(v6);g=[];for(var W=w;F(W,b);W+=O){var Ie;if(l)Ie=String.fromCharCode(W),Ie==="\\"&&(Ie="");else if(Ie=String(W),G){var Je=x-Ie.length;if(Je>0){var ot=new Array(Je+1).join("0");W<0?Ie="-"+ot+Ie.slice(1):Ie=ot+Ie}}g.push(Ie)}}else{g=[];for(var q=0;q<d.length;q++)g.push.apply(g,ec(d[q],!1))}for(var q=0;q<g.length;q++)for(var a=0;a<s.length;a++){var c=n+g[q]+s[a];(!e||f||c)&&t.push(c)}}return t}o(ec,"expand")});var gz=Ye(sh());var C0=Ye(x0(),1),{program:nN,createCommand:sN,createArgument:aN,createOption:oN,CommanderError:cN,InvalidArgumentError:uN,InvalidOptionArgumentError:lN,Command:_r,Argument:fN,Option:hN,Help:dN}=C0.default;var Zo=require("fs"),Qg=require("path"),mr=Ye(Dn());var Et=Ye(Na()),Xt=Ye(require("path"));function pw(r){return typeof r>"u"||r===null}o(pw,"isNothing");function zR(r){return typeof r=="object"&&r!==null}o(zR,"isObject");function HR(r){return Array.isArray(r)?r:pw(r)?[]:[r]}o(HR,"toArray");function KR(r,e){var t,i,n,s;if(e)for(s=Object.keys(e),t=0,i=s.length;t<i;t+=1)n=s[t],r[n]=e[n];return r}o(KR,"extend");function QR(r,e){var t="",i;for(i=0;i<e;i+=1)t+=r;return t}o(QR,"repeat");function YR(r){return r===0&&Number.NEGATIVE_INFINITY===1/r}o(YR,"isNegativeZero");var XR=pw,JR=zR,ZR=HR,eD=QR,tD=YR,rD=KR,St={isNothing:XR,isObject:JR,toArray:ZR,repeat:eD,isNegativeZero:tD,extend:rD};function mw(r,e){var t="",i=r.reason||"(unknown reason)";return r.mark?(r.mark.name&&(t+='in "'+r.mark.name+'" '),t+="("+(r.mark.line+1)+":"+(r.mark.column+1)+")",!e&&r.mark.snippet&&(t+=`

`+r.mark.snippet),i+" "+t):i}o(mw,"formatError");function zo(r,e){Error.call(this),this.name="YAMLException",this.reason=r,this.mark=e,this.message=mw(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}o(zo,"YAMLException$1");zo.prototype=Object.create(Error.prototype);zo.prototype.constructor=zo;zo.prototype.toString=o(function(e){return this.name+": "+mw(this,e)},"toString");var dr=zo;function kg(r,e,t,i,n){var s="",a="",c=Math.floor(n/2)-1;return i-e>c&&(s=" ... ",e=i-c+s.length),t-i>c&&(a=" ...",t=i+c-a.length),{str:s+r.slice(e,t).replace(/\t/g,"\u2192")+a,pos:i-e+s.length}}o(kg,"getLine");function jg(r,e){return St.repeat(" ",e-r.length)+r}o(jg,"padStart");function iD(r,e){if(e=Object.create(e||null),!r.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var t=/\r?\n|\r|\0/g,i=[0],n=[],s,a=-1;s=t.exec(r.buffer);)n.push(s.index),i.push(s.index+s[0].length),r.position<=s.index&&a<0&&(a=i.length-2);a<0&&(a=i.length-1);var c="",u,l,f=Math.min(r.line+e.linesAfter,n.length).toString().length,h=e.maxLength-(e.indent+f+3);for(u=1;u<=e.linesBefore&&!(a-u<0);u++)l=kg(r.buffer,i[a-u],n[a-u],r.position-(i[a]-i[a-u]),h),c=St.repeat(" ",e.indent)+jg((r.line-u+1).toString(),f)+" | "+l.str+`
`+c;for(l=kg(r.buffer,i[a],n[a],r.position,h),c+=St.repeat(" ",e.indent)+jg((r.line+1).toString(),f)+" | "+l.str+`
`,c+=St.repeat("-",e.indent+f+3+l.pos)+`^
`,u=1;u<=e.linesAfter&&!(a+u>=n.length);u++)l=kg(r.buffer,i[a+u],n[a+u],r.position-(i[a]-i[a+u]),h),c+=St.repeat(" ",e.indent)+jg((r.line+u+1).toString(),f)+" | "+l.str+`
`;return c.replace(/\n$/,"")}o(iD,"makeSnippet");var nD=iD,sD=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],aD=["scalar","sequence","mapping"];function oD(r){var e={};return r!==null&&Object.keys(r).forEach(function(t){r[t].forEach(function(i){e[String(i)]=t})}),e}o(oD,"compileStyleAliases");function cD(r,e){if(e=e||{},Object.keys(e).forEach(function(t){if(sD.indexOf(t)===-1)throw new dr('Unknown option "'+t+'" is met in definition of "'+r+'" YAML type.')}),this.options=e,this.tag=r,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=oD(e.styleAliases||null),aD.indexOf(this.kind)===-1)throw new dr('Unknown kind "'+this.kind+'" is specified for "'+r+'" YAML type.')}o(cD,"Type$1");var $t=cD;function Z_(r,e){var t=[];return r[e].forEach(function(i){var n=t.length;t.forEach(function(s,a){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(n=a)}),t[n]=i}),t}o(Z_,"compileList");function uD(){var r={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,t;function i(n){n.multi?(r.multi[n.kind].push(n),r.multi.fallback.push(n)):r[n.kind][n.tag]=r.fallback[n.tag]=n}for(o(i,"collectType"),e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return r}o(uD,"compileMap");function Mg(r){return this.extend(r)}o(Mg,"Schema$1");Mg.prototype.extend=o(function(e){var t=[],i=[];if(e instanceof $t)i.push(e);else if(Array.isArray(e))i=i.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(i=i.concat(e.explicit));else throw new dr("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(s){if(!(s instanceof $t))throw new dr("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new dr("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new dr("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof $t))throw new dr("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var n=Object.create(Mg.prototype);return n.implicit=(this.implicit||[]).concat(t),n.explicit=(this.explicit||[]).concat(i),n.compiledImplicit=Z_(n,"implicit"),n.compiledExplicit=Z_(n,"explicit"),n.compiledTypeMap=uD(n.compiledImplicit,n.compiledExplicit),n},"extend");var gw=Mg,yw=new $t("tag:yaml.org,2002:str",{kind:"scalar",construct:o(function(r){return r!==null?r:""},"construct")}),vw=new $t("tag:yaml.org,2002:seq",{kind:"sequence",construct:o(function(r){return r!==null?r:[]},"construct")}),_w=new $t("tag:yaml.org,2002:map",{kind:"mapping",construct:o(function(r){return r!==null?r:{}},"construct")}),ww=new gw({explicit:[yw,vw,_w]});function lD(r){if(r===null)return!0;var e=r.length;return e===1&&r==="~"||e===4&&(r==="null"||r==="Null"||r==="NULL")}o(lD,"resolveYamlNull");function fD(){return null}o(fD,"constructYamlNull");function hD(r){return r===null}o(hD,"isNull");var bw=new $t("tag:yaml.org,2002:null",{kind:"scalar",resolve:lD,construct:fD,predicate:hD,represent:{canonical:o(function(){return"~"},"canonical"),lowercase:o(function(){return"null"},"lowercase"),uppercase:o(function(){return"NULL"},"uppercase"),camelcase:o(function(){return"Null"},"camelcase"),empty:o(function(){return""},"empty")},defaultStyle:"lowercase"});function dD(r){if(r===null)return!1;var e=r.length;return e===4&&(r==="true"||r==="True"||r==="TRUE")||e===5&&(r==="false"||r==="False"||r==="FALSE")}o(dD,"resolveYamlBoolean");function pD(r){return r==="true"||r==="True"||r==="TRUE"}o(pD,"constructYamlBoolean");function mD(r){return Object.prototype.toString.call(r)==="[object Boolean]"}o(mD,"isBoolean");var Sw=new $t("tag:yaml.org,2002:bool",{kind:"scalar",resolve:dD,construct:pD,predicate:mD,represent:{lowercase:o(function(r){return r?"true":"false"},"lowercase"),uppercase:o(function(r){return r?"TRUE":"FALSE"},"uppercase"),camelcase:o(function(r){return r?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function gD(r){return 48<=r&&r<=57||65<=r&&r<=70||97<=r&&r<=102}o(gD,"isHexCode");function yD(r){return 48<=r&&r<=55}o(yD,"isOctCode");function vD(r){return 48<=r&&r<=57}o(vD,"isDecCode");function _D(r){if(r===null)return!1;var e=r.length,t=0,i=!1,n;if(!e)return!1;if(n=r[t],(n==="-"||n==="+")&&(n=r[++t]),n==="0"){if(t+1===e)return!0;if(n=r[++t],n==="b"){for(t++;t<e;t++)if(n=r[t],n!=="_"){if(n!=="0"&&n!=="1")return!1;i=!0}return i&&n!=="_"}if(n==="x"){for(t++;t<e;t++)if(n=r[t],n!=="_"){if(!gD(r.charCodeAt(t)))return!1;i=!0}return i&&n!=="_"}if(n==="o"){for(t++;t<e;t++)if(n=r[t],n!=="_"){if(!yD(r.charCodeAt(t)))return!1;i=!0}return i&&n!=="_"}}if(n==="_")return!1;for(;t<e;t++)if(n=r[t],n!=="_"){if(!vD(r.charCodeAt(t)))return!1;i=!0}return!(!i||n==="_")}o(_D,"resolveYamlInteger");function wD(r){var e=r,t=1,i;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),i=e[0],(i==="-"||i==="+")&&(i==="-"&&(t=-1),e=e.slice(1),i=e[0]),e==="0")return 0;if(i==="0"){if(e[1]==="b")return t*parseInt(e.slice(2),2);if(e[1]==="x")return t*parseInt(e.slice(2),16);if(e[1]==="o")return t*parseInt(e.slice(2),8)}return t*parseInt(e,10)}o(wD,"constructYamlInteger");function bD(r){return Object.prototype.toString.call(r)==="[object Number]"&&r%1===0&&!St.isNegativeZero(r)}o(bD,"isInteger");var Ew=new $t("tag:yaml.org,2002:int",{kind:"scalar",resolve:_D,construct:wD,predicate:bD,represent:{binary:o(function(r){return r>=0?"0b"+r.toString(2):"-0b"+r.toString(2).slice(1)},"binary"),octal:o(function(r){return r>=0?"0o"+r.toString(8):"-0o"+r.toString(8).slice(1)},"octal"),decimal:o(function(r){return r.toString(10)},"decimal"),hexadecimal:o(function(r){return r>=0?"0x"+r.toString(16).toUpperCase():"-0x"+r.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),SD=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ED(r){return!(r===null||!SD.test(r)||r[r.length-1]==="_")}o(ED,"resolveYamlFloat");function TD(r){var e,t;return e=r.replace(/_/g,"").toLowerCase(),t=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:t*parseFloat(e,10)}o(TD,"constructYamlFloat");var AD=/^[-+]?[0-9]+e/;function xD(r,e){var t;if(isNaN(r))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===r)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===r)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(St.isNegativeZero(r))return"-0.0";return t=r.toString(10),AD.test(t)?t.replace("e",".e"):t}o(xD,"representYamlFloat");function CD(r){return Object.prototype.toString.call(r)==="[object Number]"&&(r%1!==0||St.isNegativeZero(r))}o(CD,"isFloat");var Tw=new $t("tag:yaml.org,2002:float",{kind:"scalar",resolve:ED,construct:TD,predicate:CD,represent:xD,defaultStyle:"lowercase"}),Aw=ww.extend({implicit:[bw,Sw,Ew,Tw]}),xw=Aw,Cw=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Ow=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function OD(r){return r===null?!1:Cw.exec(r)!==null||Ow.exec(r)!==null}o(OD,"resolveYamlTimestamp");function PD(r){var e,t,i,n,s,a,c,u=0,l=null,f,h,d;if(e=Cw.exec(r),e===null&&(e=Ow.exec(r)),e===null)throw new Error("Date resolve error");if(t=+e[1],i=+e[2]-1,n=+e[3],!e[4])return new Date(Date.UTC(t,i,n));if(s=+e[4],a=+e[5],c=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(f=+e[10],h=+(e[11]||0),l=(f*60+h)*6e4,e[9]==="-"&&(l=-l)),d=new Date(Date.UTC(t,i,n,s,a,c,u)),l&&d.setTime(d.getTime()-l),d}o(PD,"constructYamlTimestamp");function FD(r){return r.toISOString()}o(FD,"representYamlTimestamp");var Pw=new $t("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:OD,construct:PD,instanceOf:Date,represent:FD});function ID(r){return r==="<<"||r===null}o(ID,"resolveYamlMerge");var Fw=new $t("tag:yaml.org,2002:merge",{kind:"scalar",resolve:ID}),Ug=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function RD(r){if(r===null)return!1;var e,t,i=0,n=r.length,s=Ug;for(t=0;t<n;t++)if(e=s.indexOf(r.charAt(t)),!(e>64)){if(e<0)return!1;i+=6}return i%8===0}o(RD,"resolveYamlBinary");function DD(r){var e,t,i=r.replace(/[\r\n=]/g,""),n=i.length,s=Ug,a=0,c=[];for(e=0;e<n;e++)e%4===0&&e&&(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)),a=a<<6|s.indexOf(i.charAt(e));return t=n%4*6,t===0?(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)):t===18?(c.push(a>>10&255),c.push(a>>2&255)):t===12&&c.push(a>>4&255),new Uint8Array(c)}o(DD,"constructYamlBinary");function ND(r){var e="",t=0,i,n,s=r.length,a=Ug;for(i=0;i<s;i++)i%3===0&&i&&(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]),t=(t<<8)+r[i];return n=s%3,n===0?(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]):n===2?(e+=a[t>>10&63],e+=a[t>>4&63],e+=a[t<<2&63],e+=a[64]):n===1&&(e+=a[t>>2&63],e+=a[t<<4&63],e+=a[64],e+=a[64]),e}o(ND,"representYamlBinary");function kD(r){return Object.prototype.toString.call(r)==="[object Uint8Array]"}o(kD,"isBinary");var Iw=new $t("tag:yaml.org,2002:binary",{kind:"scalar",resolve:RD,construct:DD,predicate:kD,represent:ND}),jD=Object.prototype.hasOwnProperty,LD=Object.prototype.toString;function MD(r){if(r===null)return!0;var e=[],t,i,n,s,a,c=r;for(t=0,i=c.length;t<i;t+=1){if(n=c[t],a=!1,LD.call(n)!=="[object Object]")return!1;for(s in n)if(jD.call(n,s))if(!a)a=!0;else return!1;if(!a)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}o(MD,"resolveYamlOmap");function VD(r){return r!==null?r:[]}o(VD,"constructYamlOmap");var Rw=new $t("tag:yaml.org,2002:omap",{kind:"sequence",resolve:MD,construct:VD}),$D=Object.prototype.toString;function qD(r){if(r===null)return!0;var e,t,i,n,s,a=r;for(s=new Array(a.length),e=0,t=a.length;e<t;e+=1){if(i=a[e],$D.call(i)!=="[object Object]"||(n=Object.keys(i),n.length!==1))return!1;s[e]=[n[0],i[n[0]]]}return!0}o(qD,"resolveYamlPairs");function BD(r){if(r===null)return[];var e,t,i,n,s,a=r;for(s=new Array(a.length),e=0,t=a.length;e<t;e+=1)i=a[e],n=Object.keys(i),s[e]=[n[0],i[n[0]]];return s}o(BD,"constructYamlPairs");var Dw=new $t("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:qD,construct:BD}),UD=Object.prototype.hasOwnProperty;function GD(r){if(r===null)return!0;var e,t=r;for(e in t)if(UD.call(t,e)&&t[e]!==null)return!1;return!0}o(GD,"resolveYamlSet");function WD(r){return r!==null?r:{}}o(WD,"constructYamlSet");var Nw=new $t("tag:yaml.org,2002:set",{kind:"mapping",resolve:GD,construct:WD}),Gg=xw.extend({implicit:[Pw,Fw],explicit:[Iw,Rw,Dw,Nw]}),Vn=Object.prototype.hasOwnProperty,tf=1,kw=2,jw=3,rf=4,Lg=1,zD=2,ew=3,HD=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,KD=/[\x85\u2028\u2029]/,QD=/[,\[\]\{\}]/,Lw=/^(?:!|!!|![a-z\-]+!)$/i,Mw=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function tw(r){return Object.prototype.toString.call(r)}o(tw,"_class");function Vi(r){return r===10||r===13}o(Vi,"is_EOL");function Is(r){return r===9||r===32}o(Is,"is_WHITE_SPACE");function Tr(r){return r===9||r===32||r===10||r===13}o(Tr,"is_WS_OR_EOL");function ja(r){return r===44||r===91||r===93||r===123||r===125}o(ja,"is_FLOW_INDICATOR");function YD(r){var e;return 48<=r&&r<=57?r-48:(e=r|32,97<=e&&e<=102?e-97+10:-1)}o(YD,"fromHexCode");function XD(r){return r===120?2:r===117?4:r===85?8:0}o(XD,"escapedHexLen");function JD(r){return 48<=r&&r<=57?r-48:-1}o(JD,"fromDecimalCode");function rw(r){return r===48?"\0":r===97?"\x07":r===98?"\b":r===116||r===9?"	":r===110?`
`:r===118?"\v":r===102?"\f":r===114?"\r":r===101?"\x1B":r===32?" ":r===34?'"':r===47?"/":r===92?"\\":r===78?"\x85":r===95?"\xA0":r===76?"\u2028":r===80?"\u2029":""}o(rw,"simpleEscapeSequence");function ZD(r){return r<=65535?String.fromCharCode(r):String.fromCharCode((r-65536>>10)+55296,(r-65536&1023)+56320)}o(ZD,"charFromCodepoint");function Vw(r,e,t){e==="__proto__"?Object.defineProperty(r,e,{configurable:!0,enumerable:!0,writable:!0,value:t}):r[e]=t}o(Vw,"setProperty");var $w=new Array(256),qw=new Array(256);for(Fs=0;Fs<256;Fs++)$w[Fs]=rw(Fs)?1:0,qw[Fs]=rw(Fs);var Fs;function e9(r,e){this.input=r,this.filename=e.filename||null,this.schema=e.schema||Gg,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=r.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}o(e9,"State$1");function Bw(r,e){var t={name:r.filename,buffer:r.input.slice(0,-1),position:r.position,line:r.line,column:r.position-r.lineStart};return t.snippet=nD(t),new dr(e,t)}o(Bw,"generateError");function Y(r,e){throw Bw(r,e)}o(Y,"throwError");function nf(r,e){r.onWarning&&r.onWarning.call(null,Bw(r,e))}o(nf,"throwWarning");var iw={YAML:o(function(e,t,i){var n,s,a;e.version!==null&&Y(e,"duplication of %YAML directive"),i.length!==1&&Y(e,"YAML directive accepts exactly one argument"),n=/^([0-9]+)\.([0-9]+)$/.exec(i[0]),n===null&&Y(e,"ill-formed argument of the YAML directive"),s=parseInt(n[1],10),a=parseInt(n[2],10),s!==1&&Y(e,"unacceptable YAML version of the document"),e.version=i[0],e.checkLineBreaks=a<2,a!==1&&a!==2&&nf(e,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:o(function(e,t,i){var n,s;i.length!==2&&Y(e,"TAG directive accepts exactly two arguments"),n=i[0],s=i[1],Lw.test(n)||Y(e,"ill-formed tag handle (first argument) of the TAG directive"),Vn.call(e.tagMap,n)&&Y(e,'there is a previously declared suffix for "'+n+'" tag handle'),Mw.test(s)||Y(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{Y(e,"tag prefix is malformed: "+s)}e.tagMap[n]=s},"handleTagDirective")};function Mn(r,e,t,i){var n,s,a,c;if(e<t){if(c=r.input.slice(e,t),i)for(n=0,s=c.length;n<s;n+=1)a=c.charCodeAt(n),a===9||32<=a&&a<=1114111||Y(r,"expected valid JSON character");else HD.test(c)&&Y(r,"the stream contains non-printable characters");r.result+=c}}o(Mn,"captureSegment");function nw(r,e,t,i){var n,s,a,c;for(St.isObject(t)||Y(r,"cannot merge mappings; the provided source object is unacceptable"),n=Object.keys(t),a=0,c=n.length;a<c;a+=1)s=n[a],Vn.call(e,s)||(Vw(e,s,t[s]),i[s]=!0)}o(nw,"mergeMappings");function La(r,e,t,i,n,s,a,c,u){var l,f;if(Array.isArray(n))for(n=Array.prototype.slice.call(n),l=0,f=n.length;l<f;l+=1)Array.isArray(n[l])&&Y(r,"nested arrays are not supported inside keys"),typeof n=="object"&&tw(n[l])==="[object Object]"&&(n[l]="[object Object]");if(typeof n=="object"&&tw(n)==="[object Object]"&&(n="[object Object]"),n=String(n),e===null&&(e={}),i==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(l=0,f=s.length;l<f;l+=1)nw(r,e,s[l],t);else nw(r,e,s,t);else!r.json&&!Vn.call(t,n)&&Vn.call(e,n)&&(r.line=a||r.line,r.lineStart=c||r.lineStart,r.position=u||r.position,Y(r,"duplicated mapping key")),Vw(e,n,s),delete t[n];return e}o(La,"storeMappingPair");function Wg(r){var e;e=r.input.charCodeAt(r.position),e===10?r.position++:e===13?(r.position++,r.input.charCodeAt(r.position)===10&&r.position++):Y(r,"a line break is expected"),r.line+=1,r.lineStart=r.position,r.firstTabInLine=-1}o(Wg,"readLineBreak");function wt(r,e,t){for(var i=0,n=r.input.charCodeAt(r.position);n!==0;){for(;Is(n);)n===9&&r.firstTabInLine===-1&&(r.firstTabInLine=r.position),n=r.input.charCodeAt(++r.position);if(e&&n===35)do n=r.input.charCodeAt(++r.position);while(n!==10&&n!==13&&n!==0);if(Vi(n))for(Wg(r),n=r.input.charCodeAt(r.position),i++,r.lineIndent=0;n===32;)r.lineIndent++,n=r.input.charCodeAt(++r.position);else break}return t!==-1&&i!==0&&r.lineIndent<t&&nf(r,"deficient indentation"),i}o(wt,"skipSeparationSpace");function of(r){var e=r.position,t;return t=r.input.charCodeAt(e),!!((t===45||t===46)&&t===r.input.charCodeAt(e+1)&&t===r.input.charCodeAt(e+2)&&(e+=3,t=r.input.charCodeAt(e),t===0||Tr(t)))}o(of,"testDocumentSeparator");function zg(r,e){e===1?r.result+=" ":e>1&&(r.result+=St.repeat(`
`,e-1))}o(zg,"writeFoldedLines");function t9(r,e,t){var i,n,s,a,c,u,l,f,h=r.kind,d=r.result,g;if(g=r.input.charCodeAt(r.position),Tr(g)||ja(g)||g===35||g===38||g===42||g===33||g===124||g===62||g===39||g===34||g===37||g===64||g===96||(g===63||g===45)&&(n=r.input.charCodeAt(r.position+1),Tr(n)||t&&ja(n)))return!1;for(r.kind="scalar",r.result="",s=a=r.position,c=!1;g!==0;){if(g===58){if(n=r.input.charCodeAt(r.position+1),Tr(n)||t&&ja(n))break}else if(g===35){if(i=r.input.charCodeAt(r.position-1),Tr(i))break}else{if(r.position===r.lineStart&&of(r)||t&&ja(g))break;if(Vi(g))if(u=r.line,l=r.lineStart,f=r.lineIndent,wt(r,!1,-1),r.lineIndent>=e){c=!0,g=r.input.charCodeAt(r.position);continue}else{r.position=a,r.line=u,r.lineStart=l,r.lineIndent=f;break}}c&&(Mn(r,s,a,!1),zg(r,r.line-u),s=a=r.position,c=!1),Is(g)||(a=r.position+1),g=r.input.charCodeAt(++r.position)}return Mn(r,s,a,!1),r.result?!0:(r.kind=h,r.result=d,!1)}o(t9,"readPlainScalar");function r9(r,e){var t,i,n;if(t=r.input.charCodeAt(r.position),t!==39)return!1;for(r.kind="scalar",r.result="",r.position++,i=n=r.position;(t=r.input.charCodeAt(r.position))!==0;)if(t===39)if(Mn(r,i,r.position,!0),t=r.input.charCodeAt(++r.position),t===39)i=r.position,r.position++,n=r.position;else return!0;else Vi(t)?(Mn(r,i,n,!0),zg(r,wt(r,!1,e)),i=n=r.position):r.position===r.lineStart&&of(r)?Y(r,"unexpected end of the document within a single quoted scalar"):(r.position++,n=r.position);Y(r,"unexpected end of the stream within a single quoted scalar")}o(r9,"readSingleQuotedScalar");function i9(r,e){var t,i,n,s,a,c;if(c=r.input.charCodeAt(r.position),c!==34)return!1;for(r.kind="scalar",r.result="",r.position++,t=i=r.position;(c=r.input.charCodeAt(r.position))!==0;){if(c===34)return Mn(r,t,r.position,!0),r.position++,!0;if(c===92){if(Mn(r,t,r.position,!0),c=r.input.charCodeAt(++r.position),Vi(c))wt(r,!1,e);else if(c<256&&$w[c])r.result+=qw[c],r.position++;else if((a=XD(c))>0){for(n=a,s=0;n>0;n--)c=r.input.charCodeAt(++r.position),(a=YD(c))>=0?s=(s<<4)+a:Y(r,"expected hexadecimal character");r.result+=ZD(s),r.position++}else Y(r,"unknown escape sequence");t=i=r.position}else Vi(c)?(Mn(r,t,i,!0),zg(r,wt(r,!1,e)),t=i=r.position):r.position===r.lineStart&&of(r)?Y(r,"unexpected end of the document within a double quoted scalar"):(r.position++,i=r.position)}Y(r,"unexpected end of the stream within a double quoted scalar")}o(i9,"readDoubleQuotedScalar");function n9(r,e){var t=!0,i,n,s,a=r.tag,c,u=r.anchor,l,f,h,d,g,w=Object.create(null),b,x,O,F;if(F=r.input.charCodeAt(r.position),F===91)f=93,g=!1,c=[];else if(F===123)f=125,g=!0,c={};else return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=c),F=r.input.charCodeAt(++r.position);F!==0;){if(wt(r,!0,e),F=r.input.charCodeAt(r.position),F===f)return r.position++,r.tag=a,r.anchor=u,r.kind=g?"mapping":"sequence",r.result=c,!0;t?F===44&&Y(r,"expected the node content, but found ','"):Y(r,"missed comma between flow collection entries"),x=b=O=null,h=d=!1,F===63&&(l=r.input.charCodeAt(r.position+1),Tr(l)&&(h=d=!0,r.position++,wt(r,!0,e))),i=r.line,n=r.lineStart,s=r.position,Ma(r,e,tf,!1,!0),x=r.tag,b=r.result,wt(r,!0,e),F=r.input.charCodeAt(r.position),(d||r.line===i)&&F===58&&(h=!0,F=r.input.charCodeAt(++r.position),wt(r,!0,e),Ma(r,e,tf,!1,!0),O=r.result),g?La(r,c,w,x,b,O,i,n,s):h?c.push(La(r,null,w,x,b,O,i,n,s)):c.push(b),wt(r,!0,e),F=r.input.charCodeAt(r.position),F===44?(t=!0,F=r.input.charCodeAt(++r.position)):t=!1}Y(r,"unexpected end of the stream within a flow collection")}o(n9,"readFlowCollection");function s9(r,e){var t,i,n=Lg,s=!1,a=!1,c=e,u=0,l=!1,f,h;if(h=r.input.charCodeAt(r.position),h===124)i=!1;else if(h===62)i=!0;else return!1;for(r.kind="scalar",r.result="";h!==0;)if(h=r.input.charCodeAt(++r.position),h===43||h===45)Lg===n?n=h===43?ew:zD:Y(r,"repeat of a chomping mode identifier");else if((f=JD(h))>=0)f===0?Y(r,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Y(r,"repeat of an indentation width identifier"):(c=e+f-1,a=!0);else break;if(Is(h)){do h=r.input.charCodeAt(++r.position);while(Is(h));if(h===35)do h=r.input.charCodeAt(++r.position);while(!Vi(h)&&h!==0)}for(;h!==0;){for(Wg(r),r.lineIndent=0,h=r.input.charCodeAt(r.position);(!a||r.lineIndent<c)&&h===32;)r.lineIndent++,h=r.input.charCodeAt(++r.position);if(!a&&r.lineIndent>c&&(c=r.lineIndent),Vi(h)){u++;continue}if(r.lineIndent<c){n===ew?r.result+=St.repeat(`
`,s?1+u:u):n===Lg&&s&&(r.result+=`
`);break}for(i?Is(h)?(l=!0,r.result+=St.repeat(`
`,s?1+u:u)):l?(l=!1,r.result+=St.repeat(`
`,u+1)):u===0?s&&(r.result+=" "):r.result+=St.repeat(`
`,u):r.result+=St.repeat(`
`,s?1+u:u),s=!0,a=!0,u=0,t=r.position;!Vi(h)&&h!==0;)h=r.input.charCodeAt(++r.position);Mn(r,t,r.position,!1)}return!0}o(s9,"readBlockScalar");function sw(r,e){var t,i=r.tag,n=r.anchor,s=[],a,c=!1,u;if(r.firstTabInLine!==-1)return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=s),u=r.input.charCodeAt(r.position);u!==0&&(r.firstTabInLine!==-1&&(r.position=r.firstTabInLine,Y(r,"tab characters must not be used in indentation")),!(u!==45||(a=r.input.charCodeAt(r.position+1),!Tr(a))));){if(c=!0,r.position++,wt(r,!0,-1)&&r.lineIndent<=e){s.push(null),u=r.input.charCodeAt(r.position);continue}if(t=r.line,Ma(r,e,jw,!1,!0),s.push(r.result),wt(r,!0,-1),u=r.input.charCodeAt(r.position),(r.line===t||r.lineIndent>e)&&u!==0)Y(r,"bad indentation of a sequence entry");else if(r.lineIndent<e)break}return c?(r.tag=i,r.anchor=n,r.kind="sequence",r.result=s,!0):!1}o(sw,"readBlockSequence");function a9(r,e,t){var i,n,s,a,c,u,l=r.tag,f=r.anchor,h={},d=Object.create(null),g=null,w=null,b=null,x=!1,O=!1,F;if(r.firstTabInLine!==-1)return!1;for(r.anchor!==null&&(r.anchorMap[r.anchor]=h),F=r.input.charCodeAt(r.position);F!==0;){if(!x&&r.firstTabInLine!==-1&&(r.position=r.firstTabInLine,Y(r,"tab characters must not be used in indentation")),i=r.input.charCodeAt(r.position+1),s=r.line,(F===63||F===58)&&Tr(i))F===63?(x&&(La(r,h,d,g,w,null,a,c,u),g=w=b=null),O=!0,x=!0,n=!0):x?(x=!1,n=!0):Y(r,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),r.position+=1,F=i;else{if(a=r.line,c=r.lineStart,u=r.position,!Ma(r,t,kw,!1,!0))break;if(r.line===s){for(F=r.input.charCodeAt(r.position);Is(F);)F=r.input.charCodeAt(++r.position);if(F===58)F=r.input.charCodeAt(++r.position),Tr(F)||Y(r,"a whitespace character is expected after the key-value separator within a block mapping"),x&&(La(r,h,d,g,w,null,a,c,u),g=w=b=null),O=!0,x=!1,n=!1,g=r.tag,w=r.result;else if(O)Y(r,"can not read an implicit mapping pair; a colon is missed");else return r.tag=l,r.anchor=f,!0}else if(O)Y(r,"can not read a block mapping entry; a multiline key may not be an implicit key");else return r.tag=l,r.anchor=f,!0}if((r.line===s||r.lineIndent>e)&&(x&&(a=r.line,c=r.lineStart,u=r.position),Ma(r,e,rf,!0,n)&&(x?w=r.result:b=r.result),x||(La(r,h,d,g,w,b,a,c,u),g=w=b=null),wt(r,!0,-1),F=r.input.charCodeAt(r.position)),(r.line===s||r.lineIndent>e)&&F!==0)Y(r,"bad indentation of a mapping entry");else if(r.lineIndent<e)break}return x&&La(r,h,d,g,w,null,a,c,u),O&&(r.tag=l,r.anchor=f,r.kind="mapping",r.result=h),O}o(a9,"readBlockMapping");function o9(r){var e,t=!1,i=!1,n,s,a;if(a=r.input.charCodeAt(r.position),a!==33)return!1;if(r.tag!==null&&Y(r,"duplication of a tag property"),a=r.input.charCodeAt(++r.position),a===60?(t=!0,a=r.input.charCodeAt(++r.position)):a===33?(i=!0,n="!!",a=r.input.charCodeAt(++r.position)):n="!",e=r.position,t){do a=r.input.charCodeAt(++r.position);while(a!==0&&a!==62);r.position<r.length?(s=r.input.slice(e,r.position),a=r.input.charCodeAt(++r.position)):Y(r,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Tr(a);)a===33&&(i?Y(r,"tag suffix cannot contain exclamation marks"):(n=r.input.slice(e-1,r.position+1),Lw.test(n)||Y(r,"named tag handle cannot contain such characters"),i=!0,e=r.position+1)),a=r.input.charCodeAt(++r.position);s=r.input.slice(e,r.position),QD.test(s)&&Y(r,"tag suffix cannot contain flow indicator characters")}s&&!Mw.test(s)&&Y(r,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{Y(r,"tag name is malformed: "+s)}return t?r.tag=s:Vn.call(r.tagMap,n)?r.tag=r.tagMap[n]+s:n==="!"?r.tag="!"+s:n==="!!"?r.tag="tag:yaml.org,2002:"+s:Y(r,'undeclared tag handle "'+n+'"'),!0}o(o9,"readTagProperty");function c9(r){var e,t;if(t=r.input.charCodeAt(r.position),t!==38)return!1;for(r.anchor!==null&&Y(r,"duplication of an anchor property"),t=r.input.charCodeAt(++r.position),e=r.position;t!==0&&!Tr(t)&&!ja(t);)t=r.input.charCodeAt(++r.position);return r.position===e&&Y(r,"name of an anchor node must contain at least one character"),r.anchor=r.input.slice(e,r.position),!0}o(c9,"readAnchorProperty");function u9(r){var e,t,i;if(i=r.input.charCodeAt(r.position),i!==42)return!1;for(i=r.input.charCodeAt(++r.position),e=r.position;i!==0&&!Tr(i)&&!ja(i);)i=r.input.charCodeAt(++r.position);return r.position===e&&Y(r,"name of an alias node must contain at least one character"),t=r.input.slice(e,r.position),Vn.call(r.anchorMap,t)||Y(r,'unidentified alias "'+t+'"'),r.result=r.anchorMap[t],wt(r,!0,-1),!0}o(u9,"readAlias");function Ma(r,e,t,i,n){var s,a,c,u=1,l=!1,f=!1,h,d,g,w,b,x;if(r.listener!==null&&r.listener("open",r),r.tag=null,r.anchor=null,r.kind=null,r.result=null,s=a=c=rf===t||jw===t,i&&wt(r,!0,-1)&&(l=!0,r.lineIndent>e?u=1:r.lineIndent===e?u=0:r.lineIndent<e&&(u=-1)),u===1)for(;o9(r)||c9(r);)wt(r,!0,-1)?(l=!0,c=s,r.lineIndent>e?u=1:r.lineIndent===e?u=0:r.lineIndent<e&&(u=-1)):c=!1;if(c&&(c=l||n),(u===1||rf===t)&&(tf===t||kw===t?b=e:b=e+1,x=r.position-r.lineStart,u===1?c&&(sw(r,x)||a9(r,x,b))||n9(r,b)?f=!0:(a&&s9(r,b)||r9(r,b)||i9(r,b)?f=!0:u9(r)?(f=!0,(r.tag!==null||r.anchor!==null)&&Y(r,"alias node should not have any properties")):t9(r,b,tf===t)&&(f=!0,r.tag===null&&(r.tag="?")),r.anchor!==null&&(r.anchorMap[r.anchor]=r.result)):u===0&&(f=c&&sw(r,x))),r.tag===null)r.anchor!==null&&(r.anchorMap[r.anchor]=r.result);else if(r.tag==="?"){for(r.result!==null&&r.kind!=="scalar"&&Y(r,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+r.kind+'"'),h=0,d=r.implicitTypes.length;h<d;h+=1)if(w=r.implicitTypes[h],w.resolve(r.result)){r.result=w.construct(r.result),r.tag=w.tag,r.anchor!==null&&(r.anchorMap[r.anchor]=r.result);break}}else if(r.tag!=="!"){if(Vn.call(r.typeMap[r.kind||"fallback"],r.tag))w=r.typeMap[r.kind||"fallback"][r.tag];else for(w=null,g=r.typeMap.multi[r.kind||"fallback"],h=0,d=g.length;h<d;h+=1)if(r.tag.slice(0,g[h].tag.length)===g[h].tag){w=g[h];break}w||Y(r,"unknown tag !<"+r.tag+">"),r.result!==null&&w.kind!==r.kind&&Y(r,"unacceptable node kind for !<"+r.tag+'> tag; it should be "'+w.kind+'", not "'+r.kind+'"'),w.resolve(r.result,r.tag)?(r.result=w.construct(r.result,r.tag),r.anchor!==null&&(r.anchorMap[r.anchor]=r.result)):Y(r,"cannot resolve a node with !<"+r.tag+"> explicit tag")}return r.listener!==null&&r.listener("close",r),r.tag!==null||r.anchor!==null||f}o(Ma,"composeNode");function l9(r){var e=r.position,t,i,n,s=!1,a;for(r.version=null,r.checkLineBreaks=r.legacy,r.tagMap=Object.create(null),r.anchorMap=Object.create(null);(a=r.input.charCodeAt(r.position))!==0&&(wt(r,!0,-1),a=r.input.charCodeAt(r.position),!(r.lineIndent>0||a!==37));){for(s=!0,a=r.input.charCodeAt(++r.position),t=r.position;a!==0&&!Tr(a);)a=r.input.charCodeAt(++r.position);for(i=r.input.slice(t,r.position),n=[],i.length<1&&Y(r,"directive name must not be less than one character in length");a!==0;){for(;Is(a);)a=r.input.charCodeAt(++r.position);if(a===35){do a=r.input.charCodeAt(++r.position);while(a!==0&&!Vi(a));break}if(Vi(a))break;for(t=r.position;a!==0&&!Tr(a);)a=r.input.charCodeAt(++r.position);n.push(r.input.slice(t,r.position))}a!==0&&Wg(r),Vn.call(iw,i)?iw[i](r,i,n):nf(r,'unknown document directive "'+i+'"')}if(wt(r,!0,-1),r.lineIndent===0&&r.input.charCodeAt(r.position)===45&&r.input.charCodeAt(r.position+1)===45&&r.input.charCodeAt(r.position+2)===45?(r.position+=3,wt(r,!0,-1)):s&&Y(r,"directives end mark is expected"),Ma(r,r.lineIndent-1,rf,!1,!0),wt(r,!0,-1),r.checkLineBreaks&&KD.test(r.input.slice(e,r.position))&&nf(r,"non-ASCII line breaks are interpreted as content"),r.documents.push(r.result),r.position===r.lineStart&&of(r)){r.input.charCodeAt(r.position)===46&&(r.position+=3,wt(r,!0,-1));return}if(r.position<r.length-1)Y(r,"end of the stream or a document separator is expected");else return}o(l9,"readDocument");function Uw(r,e){r=String(r),e=e||{},r.length!==0&&(r.charCodeAt(r.length-1)!==10&&r.charCodeAt(r.length-1)!==13&&(r+=`
`),r.charCodeAt(0)===65279&&(r=r.slice(1)));var t=new e9(r,e),i=r.indexOf("\0");for(i!==-1&&(t.position=i,Y(t,"null byte is not allowed in input")),t.input+="\0";t.input.charCodeAt(t.position)===32;)t.lineIndent+=1,t.position+=1;for(;t.position<t.length-1;)l9(t);return t.documents}o(Uw,"loadDocuments");function f9(r,e,t){e!==null&&typeof e=="object"&&typeof t>"u"&&(t=e,e=null);var i=Uw(r,t);if(typeof e!="function")return i;for(var n=0,s=i.length;n<s;n+=1)e(i[n])}o(f9,"loadAll$1");function h9(r,e){var t=Uw(r,e);if(t.length!==0){if(t.length===1)return t[0];throw new dr("expected a single document in the stream, but found more")}}o(h9,"load$1");var d9=f9,p9=h9,Gw={loadAll:d9,load:p9},Ww=Object.prototype.toString,zw=Object.prototype.hasOwnProperty,Hg=65279,m9=9,Ho=10,g9=13,y9=32,v9=33,_9=34,Vg=35,w9=37,b9=38,S9=39,E9=42,Hw=44,T9=45,sf=58,A9=61,x9=62,C9=63,O9=64,Kw=91,Qw=93,P9=96,Yw=123,F9=124,Xw=125,Yt={};Yt[0]="\\0";Yt[7]="\\a";Yt[8]="\\b";Yt[9]="\\t";Yt[10]="\\n";Yt[11]="\\v";Yt[12]="\\f";Yt[13]="\\r";Yt[27]="\\e";Yt[34]='\\"';Yt[92]="\\\\";Yt[133]="\\N";Yt[160]="\\_";Yt[8232]="\\L";Yt[8233]="\\P";var I9=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],R9=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function D9(r,e){var t,i,n,s,a,c,u;if(e===null)return{};for(t={},i=Object.keys(e),n=0,s=i.length;n<s;n+=1)a=i[n],c=String(e[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),u=r.compiledTypeMap.fallback[a],u&&zw.call(u.styleAliases,c)&&(c=u.styleAliases[c]),t[a]=c;return t}o(D9,"compileStyleMap");function N9(r){var e,t,i;if(e=r.toString(16).toUpperCase(),r<=255)t="x",i=2;else if(r<=65535)t="u",i=4;else if(r<=4294967295)t="U",i=8;else throw new dr("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+t+St.repeat("0",i-e.length)+e}o(N9,"encodeHex");var k9=1,Ko=2;function j9(r){this.schema=r.schema||Gg,this.indent=Math.max(1,r.indent||2),this.noArrayIndent=r.noArrayIndent||!1,this.skipInvalid=r.skipInvalid||!1,this.flowLevel=St.isNothing(r.flowLevel)?-1:r.flowLevel,this.styleMap=D9(this.schema,r.styles||null),this.sortKeys=r.sortKeys||!1,this.lineWidth=r.lineWidth||80,this.noRefs=r.noRefs||!1,this.noCompatMode=r.noCompatMode||!1,this.condenseFlow=r.condenseFlow||!1,this.quotingType=r.quotingType==='"'?Ko:k9,this.forceQuotes=r.forceQuotes||!1,this.replacer=typeof r.replacer=="function"?r.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}o(j9,"State");function aw(r,e){for(var t=St.repeat(" ",e),i=0,n=-1,s="",a,c=r.length;i<c;)n=r.indexOf(`
`,i),n===-1?(a=r.slice(i),i=c):(a=r.slice(i,n+1),i=n+1),a.length&&a!==`
`&&(s+=t),s+=a;return s}o(aw,"indentString");function $g(r,e){return`
`+St.repeat(" ",r.indent*e)}o($g,"generateNextLine");function L9(r,e){var t,i,n;for(t=0,i=r.implicitTypes.length;t<i;t+=1)if(n=r.implicitTypes[t],n.resolve(e))return!0;return!1}o(L9,"testImplicitResolving");function af(r){return r===y9||r===m9}o(af,"isWhitespace");function Qo(r){return 32<=r&&r<=126||161<=r&&r<=55295&&r!==8232&&r!==8233||57344<=r&&r<=65533&&r!==Hg||65536<=r&&r<=1114111}o(Qo,"isPrintable");function ow(r){return Qo(r)&&r!==Hg&&r!==g9&&r!==Ho}o(ow,"isNsCharOrWhitespace");function cw(r,e,t){var i=ow(r),n=i&&!af(r);return(t?i:i&&r!==Hw&&r!==Kw&&r!==Qw&&r!==Yw&&r!==Xw)&&r!==Vg&&!(e===sf&&!n)||ow(e)&&!af(e)&&r===Vg||e===sf&&n}o(cw,"isPlainSafe");function M9(r){return Qo(r)&&r!==Hg&&!af(r)&&r!==T9&&r!==C9&&r!==sf&&r!==Hw&&r!==Kw&&r!==Qw&&r!==Yw&&r!==Xw&&r!==Vg&&r!==b9&&r!==E9&&r!==v9&&r!==F9&&r!==A9&&r!==x9&&r!==S9&&r!==_9&&r!==w9&&r!==O9&&r!==P9}o(M9,"isPlainSafeFirst");function V9(r){return!af(r)&&r!==sf}o(V9,"isPlainSafeLast");function Wo(r,e){var t=r.charCodeAt(e),i;return t>=55296&&t<=56319&&e+1<r.length&&(i=r.charCodeAt(e+1),i>=56320&&i<=57343)?(t-55296)*1024+i-56320+65536:t}o(Wo,"codePointAt");function Jw(r){var e=/^\n* /;return e.test(r)}o(Jw,"needIndentIndicator");var Zw=1,qg=2,eb=3,tb=4,ka=5;function $9(r,e,t,i,n,s,a,c){var u,l=0,f=null,h=!1,d=!1,g=i!==-1,w=-1,b=M9(Wo(r,0))&&V9(Wo(r,r.length-1));if(e||a)for(u=0;u<r.length;l>=65536?u+=2:u++){if(l=Wo(r,u),!Qo(l))return ka;b=b&&cw(l,f,c),f=l}else{for(u=0;u<r.length;l>=65536?u+=2:u++){if(l=Wo(r,u),l===Ho)h=!0,g&&(d=d||u-w-1>i&&r[w+1]!==" ",w=u);else if(!Qo(l))return ka;b=b&&cw(l,f,c),f=l}d=d||g&&u-w-1>i&&r[w+1]!==" "}return!h&&!d?b&&!a&&!n(r)?Zw:s===Ko?ka:qg:t>9&&Jw(r)?ka:a?s===Ko?ka:qg:d?tb:eb}o($9,"chooseScalarStyle");function q9(r,e,t,i,n){r.dump=(function(){if(e.length===0)return r.quotingType===Ko?'""':"''";if(!r.noCompatMode&&(I9.indexOf(e)!==-1||R9.test(e)))return r.quotingType===Ko?'"'+e+'"':"'"+e+"'";var s=r.indent*Math.max(1,t),a=r.lineWidth===-1?-1:Math.max(Math.min(r.lineWidth,40),r.lineWidth-s),c=i||r.flowLevel>-1&&t>=r.flowLevel;function u(l){return L9(r,l)}switch(o(u,"testAmbiguity"),$9(e,c,r.indent,a,u,r.quotingType,r.forceQuotes&&!i,n)){case Zw:return e;case qg:return"'"+e.replace(/'/g,"''")+"'";case eb:return"|"+uw(e,r.indent)+lw(aw(e,s));case tb:return">"+uw(e,r.indent)+lw(aw(B9(e,a),s));case ka:return'"'+U9(e)+'"';default:throw new dr("impossible error: invalid scalar style")}})()}o(q9,"writeScalar");function uw(r,e){var t=Jw(r)?String(e):"",i=r[r.length-1]===`
`,n=i&&(r[r.length-2]===`
`||r===`
`),s=n?"+":i?"":"-";return t+s+`
`}o(uw,"blockHeader");function lw(r){return r[r.length-1]===`
`?r.slice(0,-1):r}o(lw,"dropEndingNewline");function B9(r,e){for(var t=/(\n+)([^\n]*)/g,i=(function(){var l=r.indexOf(`
`);return l=l!==-1?l:r.length,t.lastIndex=l,fw(r.slice(0,l),e)})(),n=r[0]===`
`||r[0]===" ",s,a;a=t.exec(r);){var c=a[1],u=a[2];s=u[0]===" ",i+=c+(!n&&!s&&u!==""?`
`:"")+fw(u,e),n=s}return i}o(B9,"foldString");function fw(r,e){if(r===""||r[0]===" ")return r;for(var t=/ [^ ]/g,i,n=0,s,a=0,c=0,u="";i=t.exec(r);)c=i.index,c-n>e&&(s=a>n?a:c,u+=`
`+r.slice(n,s),n=s+1),a=c;return u+=`
`,r.length-n>e&&a>n?u+=r.slice(n,a)+`
`+r.slice(a+1):u+=r.slice(n),u.slice(1)}o(fw,"foldLine");function U9(r){for(var e="",t=0,i,n=0;n<r.length;t>=65536?n+=2:n++)t=Wo(r,n),i=Yt[t],!i&&Qo(t)?(e+=r[n],t>=65536&&(e+=r[n+1])):e+=i||N9(t);return e}o(U9,"escapeString");function G9(r,e,t){var i="",n=r.tag,s,a,c;for(s=0,a=t.length;s<a;s+=1)c=t[s],r.replacer&&(c=r.replacer.call(t,String(s),c)),(fn(r,e,c,!1,!1)||typeof c>"u"&&fn(r,e,null,!1,!1))&&(i!==""&&(i+=","+(r.condenseFlow?"":" ")),i+=r.dump);r.tag=n,r.dump="["+i+"]"}o(G9,"writeFlowSequence");function hw(r,e,t,i){var n="",s=r.tag,a,c,u;for(a=0,c=t.length;a<c;a+=1)u=t[a],r.replacer&&(u=r.replacer.call(t,String(a),u)),(fn(r,e+1,u,!0,!0,!1,!0)||typeof u>"u"&&fn(r,e+1,null,!0,!0,!1,!0))&&((!i||n!=="")&&(n+=$g(r,e)),r.dump&&Ho===r.dump.charCodeAt(0)?n+="-":n+="- ",n+=r.dump);r.tag=s,r.dump=n||"[]"}o(hw,"writeBlockSequence");function W9(r,e,t){var i="",n=r.tag,s=Object.keys(t),a,c,u,l,f;for(a=0,c=s.length;a<c;a+=1)f="",i!==""&&(f+=", "),r.condenseFlow&&(f+='"'),u=s[a],l=t[u],r.replacer&&(l=r.replacer.call(t,u,l)),fn(r,e,u,!1,!1)&&(r.dump.length>1024&&(f+="? "),f+=r.dump+(r.condenseFlow?'"':"")+":"+(r.condenseFlow?"":" "),fn(r,e,l,!1,!1)&&(f+=r.dump,i+=f));r.tag=n,r.dump="{"+i+"}"}o(W9,"writeFlowMapping");function z9(r,e,t,i){var n="",s=r.tag,a=Object.keys(t),c,u,l,f,h,d;if(r.sortKeys===!0)a.sort();else if(typeof r.sortKeys=="function")a.sort(r.sortKeys);else if(r.sortKeys)throw new dr("sortKeys must be a boolean or a function");for(c=0,u=a.length;c<u;c+=1)d="",(!i||n!=="")&&(d+=$g(r,e)),l=a[c],f=t[l],r.replacer&&(f=r.replacer.call(t,l,f)),fn(r,e+1,l,!0,!0,!0)&&(h=r.tag!==null&&r.tag!=="?"||r.dump&&r.dump.length>1024,h&&(r.dump&&Ho===r.dump.charCodeAt(0)?d+="?":d+="? "),d+=r.dump,h&&(d+=$g(r,e)),fn(r,e+1,f,!0,h)&&(r.dump&&Ho===r.dump.charCodeAt(0)?d+=":":d+=": ",d+=r.dump,n+=d));r.tag=s,r.dump=n||"{}"}o(z9,"writeBlockMapping");function dw(r,e,t){var i,n,s,a,c,u;for(n=t?r.explicitTypes:r.implicitTypes,s=0,a=n.length;s<a;s+=1)if(c=n[s],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof e=="object"&&e instanceof c.instanceOf)&&(!c.predicate||c.predicate(e))){if(t?c.multi&&c.representName?r.tag=c.representName(e):r.tag=c.tag:r.tag="?",c.represent){if(u=r.styleMap[c.tag]||c.defaultStyle,Ww.call(c.represent)==="[object Function]")i=c.represent(e,u);else if(zw.call(c.represent,u))i=c.represent[u](e,u);else throw new dr("!<"+c.tag+'> tag resolver accepts not "'+u+'" style');r.dump=i}return!0}return!1}o(dw,"detectType");function fn(r,e,t,i,n,s,a){r.tag=null,r.dump=t,dw(r,t,!1)||dw(r,t,!0);var c=Ww.call(r.dump),u=i,l;i&&(i=r.flowLevel<0||r.flowLevel>e);var f=c==="[object Object]"||c==="[object Array]",h,d;if(f&&(h=r.duplicates.indexOf(t),d=h!==-1),(r.tag!==null&&r.tag!=="?"||d||r.indent!==2&&e>0)&&(n=!1),d&&r.usedDuplicates[h])r.dump="*ref_"+h;else{if(f&&d&&!r.usedDuplicates[h]&&(r.usedDuplicates[h]=!0),c==="[object Object]")i&&Object.keys(r.dump).length!==0?(z9(r,e,r.dump,n),d&&(r.dump="&ref_"+h+r.dump)):(W9(r,e,r.dump),d&&(r.dump="&ref_"+h+" "+r.dump));else if(c==="[object Array]")i&&r.dump.length!==0?(r.noArrayIndent&&!a&&e>0?hw(r,e-1,r.dump,n):hw(r,e,r.dump,n),d&&(r.dump="&ref_"+h+r.dump)):(G9(r,e,r.dump),d&&(r.dump="&ref_"+h+" "+r.dump));else if(c==="[object String]")r.tag!=="?"&&q9(r,r.dump,e,s,u);else{if(c==="[object Undefined]")return!1;if(r.skipInvalid)return!1;throw new dr("unacceptable kind of an object to dump "+c)}r.tag!==null&&r.tag!=="?"&&(l=encodeURI(r.tag[0]==="!"?r.tag.slice(1):r.tag).replace(/!/g,"%21"),r.tag[0]==="!"?l="!"+l:l.slice(0,18)==="tag:yaml.org,2002:"?l="!!"+l.slice(18):l="!<"+l+">",r.dump=l+" "+r.dump)}return!0}o(fn,"writeNode");function H9(r,e){var t=[],i=[],n,s;for(Bg(r,t,i),n=0,s=i.length;n<s;n+=1)e.duplicates.push(t[i[n]]);e.usedDuplicates=new Array(s)}o(H9,"getDuplicateReferences");function Bg(r,e,t){var i,n,s;if(r!==null&&typeof r=="object")if(n=e.indexOf(r),n!==-1)t.indexOf(n)===-1&&t.push(n);else if(e.push(r),Array.isArray(r))for(n=0,s=r.length;n<s;n+=1)Bg(r[n],e,t);else for(i=Object.keys(r),n=0,s=i.length;n<s;n+=1)Bg(r[i[n]],e,t)}o(Bg,"inspectNode");function K9(r,e){e=e||{};var t=new j9(e);t.noRefs||H9(r,t);var i=r;return t.replacer&&(i=t.replacer.call({"":i},"",i)),fn(t,0,i,!0,!0)?t.dump+`
`:""}o(K9,"dump$1");var Q9=K9,Y9={dump:Q9};function Kg(r,e){return function(){throw new Error("Function yaml."+r+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}o(Kg,"renamed");var X9=$t,J9=gw,Z9=ww,e6=Aw,t6=xw,r6=Gg,i6=Gw.load,n6=Gw.loadAll,s6=Y9.dump,a6=dr,o6={binary:Iw,float:Tw,map:_w,null:bw,pairs:Dw,set:Nw,timestamp:Pw,bool:Sw,int:Ew,merge:Fw,omap:Rw,seq:vw,str:yw},c6=Kg("safeLoad","load"),u6=Kg("safeLoadAll","loadAll"),l6=Kg("safeDump","dump"),Yo={Type:X9,Schema:J9,FAILSAFE_SCHEMA:Z9,JSON_SCHEMA:e6,CORE_SCHEMA:t6,DEFAULT_SCHEMA:r6,load:i6,loadAll:n6,dump:s6,YAMLException:a6,types:o6,safeLoad:c6,safeLoadAll:u6,safeDump:l6};var cf=class{constructor(e){this.rootPath=e}static{o(this,"FileSystemVaultAdapter")}async read(e){let t=this.resolvePath(e.path);if(!await Et.default.pathExists(t))throw new Error(`File not found: ${e.path}`);return Et.default.readFile(t,"utf-8")}async create(e,t){let i=this.resolvePath(e);if(await Et.default.pathExists(i))throw new Error(`File already exists: ${e}`);return await Et.default.ensureDir(Xt.default.dirname(i)),await Et.default.writeFile(i,t,"utf-8"),this.createFileObject(e)}async modify(e,t){let i=this.resolvePath(e.path);if(!await Et.default.pathExists(i))throw new Error(`File not found: ${e.path}`);await Et.default.writeFile(i,t,"utf-8")}async delete(e){let t=this.resolvePath(e.path);if(!await Et.default.pathExists(t))throw new Error(`File not found: ${e.path}`);await Et.default.remove(t)}async exists(e){let t=this.resolvePath(e);return Et.default.pathExists(t)}getAbstractFileByPath(e){let t=this.resolvePath(e);try{let i=Et.default.statSync(t);if(i.isFile())return this.createFileObject(e);if(i.isDirectory())return this.createFolderObject(e)}catch{return null}return null}getAllFiles(){let e=[];return this.walkDirectory(this.rootPath,t=>{if(t.endsWith(".md")){let i=Xt.default.relative(this.rootPath,t);e.push(this.createFileObject(i))}}),e}getFrontmatter(e){try{let t=Et.default.readFileSync(this.resolvePath(e.path),"utf-8");return this.extractFrontmatter(t)}catch{return null}}async updateFrontmatter(e,t){let i=await this.read(e),n=this.extractFrontmatter(i)||{},s=t(n),a=this.replaceFrontmatter(i,s);await this.modify(e,a)}async rename(e,t){let i=this.resolvePath(e.path),n=this.resolvePath(t);if(!await Et.default.pathExists(i))throw new Error(`File not found: ${e.path}`);await Et.default.ensureDir(Xt.default.dirname(n)),await Et.default.move(i,n)}async createFolder(e){let t=this.resolvePath(e);await Et.default.ensureDir(t)}getFirstLinkpathDest(e,t){let i=Xt.default.dirname(this.resolvePath(t)),n;if(Xt.default.isAbsolute(e)?n=this.resolvePath(e):n=Xt.default.resolve(i,e),e.endsWith(".md")||(n+=".md"),Et.default.existsSync(n)){let s=Xt.default.relative(this.rootPath,n);return this.createFileObject(s)}return null}async process(e,t){let i=await this.read(e),n=t(i);return await this.modify(e,n),n}getDefaultNewFileParent(){return{path:"",name:""}}async updateLinks(e,t,i){return Promise.resolve()}resolvePath(e){return Xt.default.isAbsolute(e)?e:Xt.default.join(this.rootPath,e)}createFileObject(e){let t=Xt.default.basename(e),i=Xt.default.basename(e,Xt.default.extname(e)),n=Xt.default.dirname(e);return{path:e,basename:t,name:i,parent:n!=="."?this.createFolderObject(n):null}}createFolderObject(e){return{path:e,name:Xt.default.basename(e)}}extractFrontmatter(e){let t=/^---\n([\s\S]*?)\n---/,i=e.match(t);if(!i)return null;try{let n=Yo.load(i[1]);return typeof n=="object"&&n!==null?n:null}catch{return null}}replaceFrontmatter(e,t){let i=Yo.dump(t,{lineWidth:-1,noRefs:!0,quotingType:'"'}),n=/^---\n([\s\S]*?)\n---/;return e.match(n)?e.replace(n,`---
${i.trim()}
---`):`---
${i.trim()}
---
${e}`}walkDirectory(e,t){let i=Et.default.readdirSync(e,{withFileTypes:!0});for(let n of i){let s=Xt.default.join(e,n.name);n.isDirectory()?this.walkDirectory(s,t):n.isFile()&&t(s)}}};var uf=class{static{o(this,"TableFormatter")}format(e){if(e.length===0)return"No results";let t=this.getAllVariables(e),i=e.map(n=>this.solutionToRow(n,t));return this.renderTable(t,i)}getAllVariables(e){let t=new Set;for(let i of e)for(let n of i.variables())t.add(n);return Array.from(t).sort()}solutionToRow(e,t){return t.map(i=>{let n=e.get(i);return n?this.formatValue(n.toString()):""})}formatValue(e){return e.length>50?e.substring(0,47)+"...":e}renderTable(e,t){let i=e.map((s,a)=>{let c=s.length+1,u=Math.max(...t.map(l=>l[a]?.length||0));return Math.max(c,u,10)}),n=[];n.push(this.renderSeparator(i,"top")),n.push(this.renderRow(e.map(s=>`?${s}`),i)),n.push(this.renderSeparator(i,"mid"));for(let s of t)n.push(this.renderRow(s,i));return n.push(this.renderSeparator(i,"bottom")),n.join(`
`)}renderRow(e,t){return`\u2502 ${e.map((n,s)=>n.padEnd(t[s])).join(" \u2502 ")} \u2502`}renderSeparator(e,t){let i=t==="top"?"\u250C":t==="mid"?"\u251C":"\u2514",n=t==="top"?"\u2510":t==="mid"?"\u2524":"\u2518",a=t==="mid"?"\u2500\u253C\u2500":"\u2500"+(t==="mid"?"\u253C":"\u2500")+"\u2500",c=e.map(u=>"\u2500".repeat(u+2));return`${i}${c.join(a)}${n}`}};var lf=class{static{o(this,"JsonFormatter")}format(e){let t=e.map(i=>i.toJSON());return JSON.stringify(t,null,2)}};var Xo=class{static{o(this,"TriplesFormatter")}formatNTriples(e){return e.map(t=>t.toString()).join(`
`)}formatTable(e){if(e.length===0)return"No triples generated.";let t=[];t.push("Subject | Predicate | Object"),t.push("------- | --------- | ------");for(let i of e){let n=this.formatNode(i.subject),s=this.formatNode(i.predicate),a=this.formatNode(i.object);t.push(`${n} | ${s} | ${a}`)}return t.join(`
`)}formatJson(e){let t=e.map(i=>({subject:this.nodeToJson(i.subject),predicate:this.nodeToJson(i.predicate),object:this.nodeToJson(i.object)}));return JSON.stringify(t,null,2)}formatNode(e){return e.value!==void 0?String(e.value):String(e)}nodeToJson(e){return"datatype"in e||"language"in e?{type:"literal",value:String(e.value),...e.datatype&&{datatype:e.datatype.value||String(e.datatype)},...e.language&&{language:e.language}}:"id"in e&&String(e.id).startsWith("_:")?{type:"bnode",value:String(e.id)}:{type:"uri",value:String(e.value)}}};function rb(r){return r.startsWith("VALIDATION_")?"validation":r.startsWith("PERMISSION_")?"permission":r.startsWith("STATE_")?"state":"internal"}o(rb,"getErrorCategory");var lt=class{static{o(this,"ResponseBuilder")}static success(e,t){return{success:!0,data:e,...t&&{meta:t}}}static error(e,t,i,n){return{success:!1,error:{code:e,category:rb(e),message:t,exitCode:i,...n?.recovery&&{recovery:n.recovery},...n?.context&&{context:n.context},...n?.stack&&{stack:n.stack}}}}};var pr=class extends Error{static{o(this,"CLIError")}constructor(e,t,i){super(e),this.name=this.constructor.name,this.context=t,this.recoveryHint=i,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}format(){let e=`\u274C ${this.name}: ${this.message}`;if(this.guidance&&(e+=`

\u{1F4A1} ${this.guidance}`),this.context&&Object.keys(this.context).length>0){e+=`

\u{1F4CB} Context:`;for(let[t,i]of Object.entries(this.context))e+=`
  ${t}: ${JSON.stringify(i)}`}return e}toStructuredResponse(e=!1){return lt.error(this.errorCode,this.message,this.exitCode,{recovery:this.recoveryHint||{message:this.guidance},context:this.context,stack:e?this.stack:void 0})}formatJson(e=!1){return JSON.stringify(this.toStructuredResponse(e),null,2)}};var ge=class r{static{o(this,"ErrorHandler")}static{this.outputFormat="text"}static setFormat(e){r.outputFormat=e}static getFormat(){return r.outputFormat}static isDebugMode(){return!!process.env.DEBUG}static handle(e){if(e instanceof pr){if(r.outputFormat==="json"){let n=e.toStructuredResponse(r.isDebugMode());console.log(JSON.stringify(n,null,2))}else console.error(e.format()),r.isDebugMode()&&(console.error(`
\u{1F4CD} Stack trace:`),console.error(e.stack));process.exit(e.exitCode)}let{exitCode:t,errorCode:i}=r.classifyError(e);if(r.outputFormat==="json"){let n=r.buildErrorResponse(i,e.message,t,r.isDebugMode()?e.stack:void 0);console.log(JSON.stringify(n,null,2))}else console.error(`\u274C Error: ${e.message}`),r.isDebugMode()&&console.error(e.stack);process.exit(t)}static handleWithMessage(e,t=1,i="INTERNAL_UNKNOWN"){if(r.outputFormat==="json"){let n=r.buildErrorResponse(i,e,t);console.log(JSON.stringify(n,null,2))}else console.error(`\u274C Error: ${e}`);process.exit(t)}static classifyError(e){let t=e.message.toLowerCase();return t.includes("transition")?{exitCode:6,errorCode:"STATE_INVALID_TRANSITION"}:t.includes("transaction")?{exitCode:7,errorCode:"INTERNAL_TRANSACTION_FAILED"}:t.includes("concurrent")||t.includes("modified")?{exitCode:8,errorCode:"STATE_CONCURRENT_MODIFICATION"}:e.message.includes("not found")||e.message.includes("ENOENT")?{exitCode:3,errorCode:"VALIDATION_FILE_NOT_FOUND"}:e.message.includes("EACCES")||e.message.includes("permission denied")?{exitCode:4,errorCode:"PERMISSION_DENIED"}:e.message.includes("Invalid")||e.message.includes("outside vault")||e.message.includes("Not a")?{exitCode:2,errorCode:"VALIDATION_INVALID_ARGUMENTS"}:{exitCode:1,errorCode:"INTERNAL_UNKNOWN"}}static buildErrorResponse(e,t,i,n){return lt.error(e,t,i,{recovery:r.getRecoveryHint(e),stack:n})}static getRecoveryHint(e){switch(e){case"VALIDATION_FILE_NOT_FOUND":return{message:"Verify the file path is correct and the file exists",suggestion:"Check file path spelling and ensure the file is in the vault"};case"VALIDATION_VAULT_NOT_FOUND":return{message:"Verify the vault path is correct",suggestion:"Check --vault option or current directory"};case"VALIDATION_INVALID_ARGUMENTS":return{message:"Check command syntax and argument format",suggestion:"Use --help for usage information"};case"STATE_INVALID_TRANSITION":return{message:"The requested state transition is not allowed",suggestion:"Check the current asset state and valid transitions"};case"STATE_CONCURRENT_MODIFICATION":return{message:"File was modified by another process",suggestion:"Wait and retry the command"};case"PERMISSION_DENIED":return{message:"Check file permissions",suggestion:"Ensure you have write access to the vault"};case"INTERNAL_TRANSACTION_FAILED":return{message:"Transaction could not complete",suggestion:"Check for locked files and retry"};default:return{message:"An unexpected error occurred",suggestion:"Check the error details and retry"}}}};var Jo=class extends pr{constructor(t,i){super(`File not found: ${t}`,{filepath:t,...i},{message:"Verify the file path is correct and the file exists",suggestion:`ls -la "${t}" or find . -name "$(basename ${t})"`});this.exitCode=3;this.errorCode="VALIDATION_FILE_NOT_FOUND";this.guidance=`Verify the file path is correct and the file exists.
Check:
  \u2022 File path spelling
  \u2022 File is in the vault directory
  \u2022 File has .md extension`}static{o(this,"FileNotFoundError")}};var rt=class extends pr{constructor(t,i,n){let s=`Check command syntax and argument format.
Use: exocortex command --help for usage information.`;super(t,n,{message:i||"Check command syntax and argument format",suggestion:"exocortex command --help"});this.exitCode=2;this.errorCode="VALIDATION_INVALID_ARGUMENTS";this.guidance=i||s}static{o(this,"InvalidArgumentsError")}};var hn=class extends pr{constructor(t,i){super(`Vault not found: ${t}`,{vaultPath:t,...i},{message:"Verify the vault path is correct and the directory exists",suggestion:`ls -la "${t}" or check --vault option`});this.exitCode=3;this.errorCode="VALIDATION_VAULT_NOT_FOUND";this.guidance=`The specified vault directory does not exist.
Check:
  \u2022 Path spelling and case sensitivity
  \u2022 Directory exists and is accessible
  \u2022 You have read permissions for the directory`}static{o(this,"VaultNotFoundError")}};function ib(){return new _r("query").description("Execute SPARQL query against Obsidian vault").argument("<query>","SPARQL query string or path to .sparql file").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--format <type>","Output format: table|json|csv|ntriples","table").option("--output <type>","Response format: text|json (for MCP tools)","text").option("--explain","Show optimized query plan").option("--stats","Show execution statistics").option("--no-optimize","Disable query optimization").action(async(r,e)=>{let t=e.output||"text";ge.setFormat(t);try{let i=Date.now(),n=f6(r),s=(0,Qg.resolve)(e.vault);if(!(0,Zo.existsSync)(s))throw new hn(s);t==="text"&&console.log(`\u{1F4E6} Loading vault: ${s}...`);let a=Date.now(),c=new cf(s),l=await new mr.NoteToRDFConverter(c).convertVault(),f=new mr.InMemoryTripleStore;await f.addAll(l);let h=Date.now()-a;t==="text"&&(console.log(`\u2705 Loaded ${l.length} triples in ${h}ms
`),console.log("\u{1F50D} Parsing SPARQL query..."));let g=new mr.SPARQLParser().parse(n);t==="text"&&console.log("\u{1F504} Translating to algebra...");let b=new mr.AlgebraTranslator().translate(g);if(!e.noOptimize&&b.type!=="construct")b=new mr.AlgebraOptimizer().optimize(b);else if(!e.noOptimize&&b.type==="construct"){let F=new mr.AlgebraOptimizer,k=b;b={...k,where:F.optimize(k.where)}}if(e.explain&&t==="text"){console.log("\u{1F4CA} Query Plan:");let F=new mr.AlgebraSerializer;if(b.type==="construct"){let k=b;console.log("CONSTRUCT Template:"),console.log("  (template patterns)"),console.log("WHERE:"),console.log(F.toString(k.where))}else console.log(F.toString(b));console.log()}t==="text"&&console.log("\u{1F3AF} Executing query...");let x=Date.now(),O=new mr.QueryExecutor(f);if(O.isConstructQuery(b)){let F=await O.executeConstruct(b),k=Date.now()-x,G=Date.now()-i;if(t==="json"){let W=new Xo,Ie={query:n,count:F.length,triples:JSON.parse(W.formatJson(F))},Je=lt.success(Ie,{durationMs:G,itemCount:F.length,loadDurationMs:h,execDurationMs:k,triplesScanned:l.length});console.log(JSON.stringify(Je,null,2))}else console.log(`\u2705 Generated ${F.length} triple(s) in ${k}ms
`),F.length>0?d6(F,e.format):console.log("No triples generated."),e.stats&&(console.log(`
\u{1F4CA} Execution Statistics:`),console.log(`  Vault loading: ${h}ms`),console.log(`  Query execution: ${k}ms`),console.log(`  Total time: ${G}ms`),console.log(`  Triples scanned: ${l.length}`),console.log(`  Triples generated: ${F.length}`))}else{let F=await O.executeAll(b),k=Date.now()-x,G=Date.now()-i;if(t==="json"){let W=F.map(ot=>ot.toJSON()),Ie={query:n,count:F.length,bindings:W},Je=lt.success(Ie,{durationMs:G,itemCount:F.length,loadDurationMs:h,execDurationMs:k,triplesScanned:l.length});console.log(JSON.stringify(Je,null,2))}else console.log(`\u2705 Found ${F.length} result(s) in ${k}ms
`),F.length>0?h6(F,e.format):console.log("No results found."),e.stats&&(console.log(`
\u{1F4CA} Execution Statistics:`),console.log(`  Vault loading: ${h}ms`),console.log(`  Query execution: ${k}ms`),console.log(`  Total time: ${G}ms`),console.log(`  Triples scanned: ${l.length}`),console.log(`  Results returned: ${F.length}`))}}catch(i){ge.handle(i)}})}o(ib,"sparqlQueryCommand");function f6(r){if(r.includes("SELECT")||r.includes("CONSTRUCT"))return r;let e=(0,Qg.resolve)(r);return(0,Zo.existsSync)(e)?(0,Zo.readFileSync)(e,"utf-8"):r}o(f6,"loadQuery");function h6(r,e){switch(e){case"json":let t=new lf;console.log(t.format(r));break;case"table":default:let i=new uf;console.log(i.format(r));break}}o(h6,"formatSelectResults");function d6(r,e){let t=new Xo;switch(e){case"json":console.log(t.formatJson(r));break;case"ntriples":console.log(t.formatNTriples(r));break;case"table":default:console.log(t.formatTable(r));break}}o(d6,"formatConstructResults");var uS=require("path");var Tt=Ye(Na()),Gn=Ye(require("path"));var Tb=Ye(gb(),1);var tc=o(r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>65536)throw new TypeError("pattern is too long")},"assertValidPattern");var b6={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},rc=o(r=>r.replace(/[[\]\\-]/g,"\\$&"),"braceEscape"),S6=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regexpEscape"),yb=o(r=>r.join(""),"rangesToString"),vb=o((r,e)=>{let t=e;if(r.charAt(t)!=="[")throw new Error("not in a brace expression");let i=[],n=[],s=t+1,a=!1,c=!1,u=!1,l=!1,f=t,h="";e:for(;s<r.length;){let b=r.charAt(s);if((b==="!"||b==="^")&&s===t+1){l=!0,s++;continue}if(b==="]"&&a&&!u){f=s+1;break}if(a=!0,b==="\\"&&!u){u=!0,s++;continue}if(b==="["&&!u){for(let[x,[O,F,k]]of Object.entries(b6))if(r.startsWith(x,s)){if(h)return["$.",!1,r.length-t,!0];s+=x.length,k?n.push(O):i.push(O),c=c||F;continue e}}if(u=!1,h){b>h?i.push(rc(h)+"-"+rc(b)):b===h&&i.push(rc(b)),h="",s++;continue}if(r.startsWith("-]",s+1)){i.push(rc(b+"-")),s+=2;continue}if(r.startsWith("-",s+1)){h=b,s+=2;continue}i.push(rc(b)),s++}if(f<s)return["",!1,0,!1];if(!i.length&&!n.length)return["$.",!1,r.length-t,!0];if(n.length===0&&i.length===1&&/^\\?.$/.test(i[0])&&!l){let b=i[0].length===2?i[0].slice(-1):i[0];return[S6(b),!1,f-t,!1]}let d="["+(l?"^":"")+yb(i)+"]",g="["+(l?"":"^")+yb(n)+"]";return[i.length&&n.length?"("+d+"|"+g+")":i.length?d:g,c,f-t,!0]},"parseClass");var mi=o((r,{windowsPathsNoEscape:e=!1}={})=>e?r.replace(/\[([^\/\\])\]/g,"$1"):r.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),"unescape");var E6=new Set(["!","?","+","*","@"]),_b=o(r=>E6.has(r),"isExtglobType"),T6="(?!(?:^|/)\\.\\.?(?:$|/))",ff="(?!\\.)",A6=new Set(["[","."]),x6=new Set(["..","."]),C6=new Set("().*{}+?[]^$\\!"),O6=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),Jg="[^/]",wb=Jg+"*?",bb=Jg+"+?",Va=class r{static{o(this,"AST")}type;#e;#t;#s=!1;#i=[];#a;#w;#u;#f=!1;#o;#c;#n=!1;constructor(e,t,i={}){this.type=e,e&&(this.#t=!0),this.#a=t,this.#e=this.#a?this.#a.#e:this,this.#o=this.#e===this?i:this.#e.#o,this.#u=this.#e===this?[]:this.#e.#u,e==="!"&&!this.#e.#f&&this.#u.push(this),this.#w=this.#a?this.#a.#i.length:0}get hasMagic(){if(this.#t!==void 0)return this.#t;for(let e of this.#i)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return this.#c!==void 0?this.#c:this.type?this.#c=this.type+"("+this.#i.map(e=>String(e)).join("|")+")":this.#c=this.#i.map(e=>String(e)).join("")}#g(){if(this!==this.#e)throw new Error("should only call on root");if(this.#f)return this;this.toString(),this.#f=!0;let e;for(;e=this.#u.pop();){if(e.type!=="!")continue;let t=e,i=t.#a;for(;i;){for(let n=t.#w+1;!i.type&&n<i.#i.length;n++)for(let s of e.#i){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(i.#i[n])}t=i,i=t.#a}}return this}push(...e){for(let t of e)if(t!==""){if(typeof t!="string"&&!(t instanceof r&&t.#a===this))throw new Error("invalid part: "+t);this.#i.push(t)}}toJSON(){let e=this.type===null?this.#i.slice().map(t=>typeof t=="string"?t:t.toJSON()):[this.type,...this.#i.map(t=>t.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#f&&this.#a?.type==="!")&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#a?.isStart())return!1;if(this.#w===0)return!0;let e=this.#a;for(let t=0;t<this.#w;t++){let i=e.#i[t];if(!(i instanceof r&&i.type==="!"))return!1}return!0}isEnd(){if(this.#e===this||this.#a?.type==="!")return!0;if(!this.#a?.isEnd())return!1;if(!this.type)return this.#a?.isEnd();let e=this.#a?this.#a.#i.length:0;return this.#w===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let t=new r(this.type,e);for(let i of this.#i)t.copyIn(i);return t}static#y(e,t,i,n){let s=!1,a=!1,c=-1,u=!1;if(t.type===null){let g=i,w="";for(;g<e.length;){let b=e.charAt(g++);if(s||b==="\\"){s=!s,w+=b;continue}if(a){g===c+1?(b==="^"||b==="!")&&(u=!0):b==="]"&&!(g===c+2&&u)&&(a=!1),w+=b;continue}else if(b==="["){a=!0,c=g,u=!1,w+=b;continue}if(!n.noext&&_b(b)&&e.charAt(g)==="("){t.push(w),w="";let x=new r(b,t);g=r.#y(e,x,g,n),t.push(x);continue}w+=b}return t.push(w),g}let l=i+1,f=new r(null,t),h=[],d="";for(;l<e.length;){let g=e.charAt(l++);if(s||g==="\\"){s=!s,d+=g;continue}if(a){l===c+1?(g==="^"||g==="!")&&(u=!0):g==="]"&&!(l===c+2&&u)&&(a=!1),d+=g;continue}else if(g==="["){a=!0,c=l,u=!1,d+=g;continue}if(_b(g)&&e.charAt(l)==="("){f.push(d),d="";let w=new r(g,f);f.push(w),l=r.#y(e,w,l,n);continue}if(g==="|"){f.push(d),d="",h.push(f),f=new r(null,t);continue}if(g===")")return d===""&&t.#i.length===0&&(t.#n=!0),f.push(d),d="",t.push(...h,f),l;d+=g}return t.type=null,t.#t=void 0,t.#i=[e.substring(i-1)],l}static fromGlob(e,t={}){let i=new r(null,void 0,t);return r.#y(e,i,0,t),i}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();let e=this.toString(),[t,i,n,s]=this.toRegExpSource();if(!(n||this.#t||this.#o.nocase&&!this.#o.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return i;let c=(this.#o.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${t}$`,c),{_src:t,_glob:e})}get options(){return this.#o}toRegExpSource(e){let t=e??!!this.#o.dot;if(this.#e===this&&this.#g(),!this.type){let u=this.isStart()&&this.isEnd(),l=this.#i.map(g=>{let[w,b,x,O]=typeof g=="string"?r.#h(g,this.#t,u):g.toRegExpSource(e);return this.#t=this.#t||x,this.#s=this.#s||O,w}).join(""),f="";if(this.isStart()&&typeof this.#i[0]=="string"&&!(this.#i.length===1&&x6.has(this.#i[0]))){let w=A6,b=t&&w.has(l.charAt(0))||l.startsWith("\\.")&&w.has(l.charAt(2))||l.startsWith("\\.\\.")&&w.has(l.charAt(4)),x=!t&&!e&&w.has(l.charAt(0));f=b?T6:x?ff:""}let h="";return this.isEnd()&&this.#e.#f&&this.#a?.type==="!"&&(h="(?:$|\\/)"),[f+l+h,mi(l),this.#t=!!this.#t,this.#s]}let i=this.type==="*"||this.type==="+",n=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#d(t);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let u=this.toString();return this.#i=[u],this.type=null,this.#t=void 0,[u,mi(this.toString()),!1,!1]}let a=!i||e||t||!ff?"":this.#d(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#n)c=(this.isStart()&&!t?ff:"")+bb;else{let u=this.type==="!"?"))"+(this.isStart()&&!t&&!e?ff:"")+wb+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=n+s+u}return[c,mi(s),this.#t=!!this.#t,this.#s]}#d(e){return this.#i.map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");let[i,n,s,a]=t.toRegExpSource(e);return this.#s=this.#s||a,i}).filter(t=>!(this.isStart()&&this.isEnd())||!!t).join("|")}static#h(e,t,i=!1){let n=!1,s="",a=!1;for(let c=0;c<e.length;c++){let u=e.charAt(c);if(n){n=!1,s+=(C6.has(u)?"\\":"")+u;continue}if(u==="\\"){c===e.length-1?s+="\\\\":n=!0;continue}if(u==="["){let[l,f,h,d]=vb(e,c);if(h){s+=l,a=a||f,c+=h-1,t=t||d;continue}}if(u==="*"){i&&e==="*"?s+=bb:s+=wb,t=!0;continue}if(u==="?"){s+=Jg,t=!0;continue}s+=O6(u)}return[s,mi(e),!!t,a]}};var $a=o((r,{windowsPathsNoEscape:e=!1}={})=>e?r.replace(/[?*()[\]]/g,"[$&]"):r.replace(/[?*()[\]\\]/g,"\\$&"),"escape");var Bt=o((r,e,t={})=>(tc(e),!t.nocomment&&e.charAt(0)==="#"?!1:new Rr(e,t).match(r)),"minimatch"),P6=/^\*+([^+@!?\*\[\(]*)$/,F6=o(r=>e=>!e.startsWith(".")&&e.endsWith(r),"starDotExtTest"),I6=o(r=>e=>e.endsWith(r),"starDotExtTestDot"),R6=o(r=>(r=r.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(r)),"starDotExtTestNocase"),D6=o(r=>(r=r.toLowerCase(),e=>e.toLowerCase().endsWith(r)),"starDotExtTestNocaseDot"),N6=/^\*+\.\*+$/,k6=o(r=>!r.startsWith(".")&&r.includes("."),"starDotStarTest"),j6=o(r=>r!=="."&&r!==".."&&r.includes("."),"starDotStarTestDot"),L6=/^\.\*+$/,M6=o(r=>r!=="."&&r!==".."&&r.startsWith("."),"dotStarTest"),V6=/^\*+$/,$6=o(r=>r.length!==0&&!r.startsWith("."),"starTest"),q6=o(r=>r.length!==0&&r!=="."&&r!=="..","starTestDot"),B6=/^\?+([^+@!?\*\[\(]*)?$/,U6=o(([r,e=""])=>{let t=Ab([r]);return e?(e=e.toLowerCase(),i=>t(i)&&i.toLowerCase().endsWith(e)):t},"qmarksTestNocase"),G6=o(([r,e=""])=>{let t=xb([r]);return e?(e=e.toLowerCase(),i=>t(i)&&i.toLowerCase().endsWith(e)):t},"qmarksTestNocaseDot"),W6=o(([r,e=""])=>{let t=xb([r]);return e?i=>t(i)&&i.endsWith(e):t},"qmarksTestDot"),z6=o(([r,e=""])=>{let t=Ab([r]);return e?i=>t(i)&&i.endsWith(e):t},"qmarksTest"),Ab=o(([r])=>{let e=r.length;return t=>t.length===e&&!t.startsWith(".")},"qmarksTestNoExt"),xb=o(([r])=>{let e=r.length;return t=>t.length===e&&t!=="."&&t!==".."},"qmarksTestNoExtDot"),Cb=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",Sb={win32:{sep:"\\"},posix:{sep:"/"}},H6=Cb==="win32"?Sb.win32.sep:Sb.posix.sep;Bt.sep=H6;var qt=Symbol("globstar **");Bt.GLOBSTAR=qt;var K6="[^/]",Q6=K6+"*?",Y6="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",X6="(?:(?!(?:\\/|^)\\.).)*?",J6=o((r,e={})=>t=>Bt(t,r,e),"filter");Bt.filter=J6;var $r=o((r,e={})=>Object.assign({},r,e),"ext"),Z6=o(r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return Bt;let e=Bt;return Object.assign(o((i,n,s={})=>e(i,n,$r(r,s)),"m"),{Minimatch:class extends e.Minimatch{static{o(this,"Minimatch")}constructor(n,s={}){super(n,$r(r,s))}static defaults(n){return e.defaults($r(r,n)).Minimatch}},AST:class extends e.AST{static{o(this,"AST")}constructor(n,s,a={}){super(n,s,$r(r,a))}static fromGlob(n,s={}){return e.AST.fromGlob(n,$r(r,s))}},unescape:o((i,n={})=>e.unescape(i,$r(r,n)),"unescape"),escape:o((i,n={})=>e.escape(i,$r(r,n)),"escape"),filter:o((i,n={})=>e.filter(i,$r(r,n)),"filter"),defaults:o(i=>e.defaults($r(r,i)),"defaults"),makeRe:o((i,n={})=>e.makeRe(i,$r(r,n)),"makeRe"),braceExpand:o((i,n={})=>e.braceExpand(i,$r(r,n)),"braceExpand"),match:o((i,n,s={})=>e.match(i,n,$r(r,s)),"match"),sep:e.sep,GLOBSTAR:qt})},"defaults");Bt.defaults=Z6;var Ob=o((r,e={})=>(tc(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:(0,Tb.default)(r)),"braceExpand");Bt.braceExpand=Ob;var e7=o((r,e={})=>new Rr(r,e).makeRe(),"makeRe");Bt.makeRe=e7;var t7=o((r,e,t={})=>{let i=new Rr(e,t);return r=r.filter(n=>i.match(n)),i.options.nonull&&!r.length&&r.push(e),r},"match");Bt.match=t7;var Eb=/[?*]|[+@!]\(.*?\)|\[|\]/,r7=o(r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),Rr=class{static{o(this,"Minimatch")}options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){tc(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||Cb,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let t of e)if(typeof t!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let i=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(i),this.debug(this.pattern,this.globParts);let n=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let u=s[0]===""&&s[1]===""&&(s[2]==="?"||!Eb.test(s[2]))&&!Eb.test(s[3]),l=/^[a-z]:/i.test(s[0]);if(u)return[...s.slice(0,4),...s.slice(4).map(f=>this.parse(f))];if(l)return[s[0],...s.slice(1).map(f=>this.parse(f))]}return s.map(u=>this.parse(u))});if(this.debug(this.pattern,n),this.set=n.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let i=0;i<e.length;i++)for(let n=0;n<e[i].length;n++)e[i][n]==="**"&&(e[i][n]="*");let{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):t>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let i=-1;for(;(i=t.indexOf("**",i+1))!==-1;){let n=i;for(;t[n+1]==="**";)n++;n!==i&&t.splice(i,n-i)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((i,n)=>{let s=i[i.length-1];return n==="**"&&s==="**"?i:n===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(i.pop(),i):(i.push(n),i)},[]),t.length===0?[""]:t))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let n=1;n<e.length-1;n++){let s=e[n];n===1&&s===""&&e[0]===""||(s==="."||s==="")&&(t=!0,e.splice(n,1),n--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(t=!0,e.pop())}let i=0;for(;(i=e.indexOf("..",i+1))!==-1;){let n=e[i-1];n&&n!=="."&&n!==".."&&n!=="**"&&(t=!0,e.splice(i-1,2),i-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let i of e){let n=-1;for(;(n=i.indexOf("**",n+1))!==-1;){let a=n;for(;i[a+1]==="**";)a++;a>n&&i.splice(n+1,a-n);let c=i[n+1],u=i[n+2],l=i[n+3];if(c!==".."||!u||u==="."||u===".."||!l||l==="."||l==="..")continue;t=!0,i.splice(n,1);let f=i.slice(0);f[n]="**",e.push(f),n--}if(!this.preserveMultipleSlashes){for(let a=1;a<i.length-1;a++){let c=i[a];a===1&&c===""&&i[0]===""||(c==="."||c==="")&&(t=!0,i.splice(a,1),a--)}i[0]==="."&&i.length===2&&(i[1]==="."||i[1]==="")&&(t=!0,i.pop())}let s=0;for(;(s=i.indexOf("..",s+1))!==-1;){let a=i[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){t=!0;let u=s===1&&i[s+1]==="**"?["."]:[];i.splice(s-1,2,...u),i.length===0&&i.push(""),s-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let i=t+1;i<e.length;i++){let n=this.partsMatch(e[t],e[i],!this.preserveMultipleSlashes);if(n){e[t]=[],e[i]=n;break}}return e.filter(t=>t.length)}partsMatch(e,t,i=!1){let n=0,s=0,a=[],c="";for(;n<e.length&&s<t.length;)if(e[n]===t[s])a.push(c==="b"?t[s]:e[n]),n++,s++;else if(i&&e[n]==="**"&&t[s]===e[n+1])a.push(e[n]),n++;else if(i&&t[s]==="**"&&e[n]===t[s+1])a.push(t[s]),s++;else if(e[n]==="*"&&t[s]&&(this.options.dot||!t[s].startsWith("."))&&t[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[n]),n++,s++}else if(t[s]==="*"&&e[n]&&(this.options.dot||!e[n].startsWith("."))&&e[n]!=="**"){if(c==="a")return!1;c="b",a.push(t[s]),n++,s++}else return!1;return e.length===t.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,t=!1,i=0;for(let n=0;n<e.length&&e.charAt(n)==="!";n++)t=!t,i++;i&&(this.pattern=e.slice(i)),this.negate=t}matchOne(e,t,i=!1){let n=this.options;if(this.isWindows){let b=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),x=!b&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),O=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),F=!O&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3]),k=x?3:b?0:void 0,G=F?3:O?0:void 0;if(typeof k=="number"&&typeof G=="number"){let[W,Ie]=[e[k],t[G]];W.toLowerCase()===Ie.toLowerCase()&&(t[G]=W,G>k?t=t.slice(G):k>G&&(e=e.slice(k)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var a=0,c=0,u=e.length,l=t.length;a<u&&c<l;a++,c++){this.debug("matchOne loop");var f=t[c],h=e[a];if(this.debug(t,f,h),f===!1)return!1;if(f===qt){this.debug("GLOBSTAR",[t,f,h]);var d=a,g=c+1;if(g===l){for(this.debug("** at the end");a<u;a++)if(e[a]==="."||e[a]===".."||!n.dot&&e[a].charAt(0)===".")return!1;return!0}for(;d<u;){var w=e[d];if(this.debug(`
globstar while`,e,d,t,g,w),this.matchOne(e.slice(d),t.slice(g),i))return this.debug("globstar found match!",d,u,w),!0;if(w==="."||w===".."||!n.dot&&w.charAt(0)==="."){this.debug("dot detected!",e,d,t,g);break}this.debug("globstar swallow a segment, and continue"),d++}return!!(i&&(this.debug(`
>>> no match, partial?`,e,d,t,g),d===u))}let b;if(typeof f=="string"?(b=h===f,this.debug("string match",f,h,b)):(b=f.test(h),this.debug("pattern match",f,h,b)),!b)return!1}if(a===u&&c===l)return!0;if(a===u)return i;if(c===l)return a===u-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return Ob(this.pattern,this.options)}parse(e){tc(e);let t=this.options;if(e==="**")return qt;if(e==="")return"";let i,n=null;(i=e.match(V6))?n=t.dot?q6:$6:(i=e.match(P6))?n=(t.nocase?t.dot?D6:R6:t.dot?I6:F6)(i[1]):(i=e.match(B6))?n=(t.nocase?t.dot?G6:U6:t.dot?W6:z6)(i):(i=e.match(N6))?n=t.dot?j6:k6:(i=e.match(L6))&&(n=M6);let s=Va.fromGlob(e,this.options).toMMPattern();return n&&typeof s=="object"&&Reflect.defineProperty(s,"test",{value:n}),s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,i=t.noglobstar?Q6:t.dot?Y6:X6,n=new Set(t.nocase?["i"]:[]),s=e.map(u=>{let l=u.map(f=>{if(f instanceof RegExp)for(let h of f.flags.split(""))n.add(h);return typeof f=="string"?r7(f):f===qt?qt:f._src});return l.forEach((f,h)=>{let d=l[h+1],g=l[h-1];f!==qt||g===qt||(g===void 0?d!==void 0&&d!==qt?l[h+1]="(?:\\/|"+i+"\\/)?"+d:l[h]=i:d===void 0?l[h-1]=g+"(?:\\/|"+i+")?":d!==qt&&(l[h-1]=g+"(?:\\/|\\/"+i+"\\/)"+d,l[h+1]=qt))}),l.filter(f=>f!==qt).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...n].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let i=this.options;this.isWindows&&(e=e.split("\\").join("/"));let n=this.slashSplit(e);this.debug(this.pattern,"split",n);let s=this.set;this.debug(this.pattern,"set",s);let a=n[n.length-1];if(!a)for(let c=n.length-2;!a&&c>=0;c--)a=n[c];for(let c=0;c<s.length;c++){let u=s[c],l=n;if(i.matchBase&&u.length===1&&(l=[a]),this.matchOne(l,u,t))return i.flipNegate?!0:!this.negate}return i.flipNegate?!1:this.negate}static defaults(e){return Bt.defaults(e).Minimatch}};Bt.AST=Va;Bt.Minimatch=Rr;Bt.escape=$a;Bt.unescape=mi;var Jb=require("node:url");var qa=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Fb=new Set,Zg=typeof process=="object"&&process?process:{},Ib=o((r,e,t,i)=>{typeof Zg.emitWarning=="function"?Zg.emitWarning(r,e,t,i):console.error(`[${t}] ${e}: ${r}`)},"emitWarning"),hf=globalThis.AbortController,Pb=globalThis.AbortSignal;if(typeof hf>"u"){Pb=class{static{o(this,"AbortSignal")}onabort;_onabort=[];reason;aborted=!1;addEventListener(i,n){this._onabort.push(n)}},hf=class{static{o(this,"AbortController")}constructor(){e()}signal=new Pb;abort(i){if(!this.signal.aborted){this.signal.reason=i,this.signal.aborted=!0;for(let n of this.signal._onabort)n(i);this.signal.onabort?.(i)}}};let r=Zg.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=o(()=>{r&&(r=!1,Ib("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))},"warnACPolyfill")}var i7=o(r=>!Fb.has(r),"shouldWarn");var $n=o(r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),"isPosInt"),Rb=o(r=>$n(r)?r<=Math.pow(2,8)?Uint8Array:r<=Math.pow(2,16)?Uint16Array:r<=Math.pow(2,32)?Uint32Array:r<=Number.MAX_SAFE_INTEGER?Ba:null:null,"getUintArray"),Ba=class extends Array{static{o(this,"ZeroArray")}constructor(e){super(e),this.fill(0)}},e1=class r{static{o(this,"Stack")}heap;length;static#e=!1;static create(e){let t=Rb(e);if(!t)return[];r.#e=!0;let i=new r(e,t);return r.#e=!1,i}constructor(e,t){if(!r.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},ic=class r{static{o(this,"LRUCache")}#e;#t;#s;#i;#a;#w;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#u;#f;#o;#c;#n;#g;#y;#d;#h;#E;#m;#T;#A;#_;#b;#S;#p;static unsafeExposeInternals(e){return{starts:e.#A,ttls:e.#_,sizes:e.#T,keyMap:e.#o,keyList:e.#c,valList:e.#n,next:e.#g,prev:e.#y,get head(){return e.#d},get tail(){return e.#h},free:e.#E,isBackgroundFetch:o(t=>e.#l(t),"isBackgroundFetch"),backgroundFetch:o((t,i,n,s)=>e.#M(t,i,n,s),"backgroundFetch"),moveToTail:o(t=>e.#$(t),"moveToTail"),indexes:o(t=>e.#C(t),"indexes"),rindexes:o(t=>e.#O(t),"rindexes"),isStale:o(t=>e.#v(t),"isStale")}}get max(){return this.#e}get maxSize(){return this.#t}get calculatedSize(){return this.#f}get size(){return this.#u}get fetchMethod(){return this.#a}get memoMethod(){return this.#w}get dispose(){return this.#s}get disposeAfter(){return this.#i}constructor(e){let{max:t=0,ttl:i,ttlResolution:n=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:l,disposeAfter:f,noDisposeOnSet:h,noUpdateTTL:d,maxSize:g=0,maxEntrySize:w=0,sizeCalculation:b,fetchMethod:x,memoMethod:O,noDeleteOnFetchRejection:F,noDeleteOnStaleGet:k,allowStaleOnFetchRejection:G,allowStaleOnFetchAbort:W,ignoreFetchAbort:Ie}=e;if(t!==0&&!$n(t))throw new TypeError("max option must be a nonnegative integer");let Je=t?Rb(t):Array;if(!Je)throw new Error("invalid max value: "+t);if(this.#e=t,this.#t=g,this.maxEntrySize=w||this.#t,this.sizeCalculation=b,this.sizeCalculation){if(!this.#t&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(O!==void 0&&typeof O!="function")throw new TypeError("memoMethod must be a function if defined");if(this.#w=O,x!==void 0&&typeof x!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#a=x,this.#S=!!x,this.#o=new Map,this.#c=new Array(t).fill(void 0),this.#n=new Array(t).fill(void 0),this.#g=new Je(t),this.#y=new Je(t),this.#d=0,this.#h=0,this.#E=e1.create(t),this.#u=0,this.#f=0,typeof l=="function"&&(this.#s=l),typeof f=="function"?(this.#i=f,this.#m=[]):(this.#i=void 0,this.#m=void 0),this.#b=!!this.#s,this.#p=!!this.#i,this.noDisposeOnSet=!!h,this.noUpdateTTL=!!d,this.noDeleteOnFetchRejection=!!F,this.allowStaleOnFetchRejection=!!G,this.allowStaleOnFetchAbort=!!W,this.ignoreFetchAbort=!!Ie,this.maxEntrySize!==0){if(this.#t!==0&&!$n(this.#t))throw new TypeError("maxSize must be a positive integer if specified");if(!$n(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#F()}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!k,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=$n(n)||n===0?n:1,this.ttlAutopurge=!!s,this.ttl=i||0,this.ttl){if(!$n(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#P()}if(this.#e===0&&this.ttl===0&&this.#t===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#t){let ot="LRU_CACHE_UNBOUNDED";i7(ot)&&(Fb.add(ot),Ib("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",ot,r))}}getRemainingTTL(e){return this.#o.has(e)?1/0:0}#P(){let e=new Ba(this.#e),t=new Ba(this.#e);this.#_=e,this.#A=t,this.#R=(s,a,c=qa.now())=>{if(t[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let u=setTimeout(()=>{this.#v(s)&&this.#I(this.#c[s],"expire")},a+1);u.unref&&u.unref()}},this.#x=s=>{t[s]=e[s]!==0?qa.now():0},this.#r=(s,a)=>{if(e[a]){let c=e[a],u=t[a];if(!c||!u)return;s.ttl=c,s.start=u,s.now=i||n();let l=s.now-u;s.remainingTTL=c-l}};let i=0,n=o(()=>{let s=qa.now();if(this.ttlResolution>0){i=s;let a=setTimeout(()=>i=0,this.ttlResolution);a.unref&&a.unref()}return s},"getNow");this.getRemainingTTL=s=>{let a=this.#o.get(s);if(a===void 0)return 0;let c=e[a],u=t[a];if(!c||!u)return 1/0;let l=(i||n())-u;return c-l},this.#v=s=>{let a=t[s],c=e[s];return!!c&&!!a&&(i||n())-a>c}}#x=o(()=>{},"#updateItemAge");#r=o(()=>{},"#statusTTL");#R=o(()=>{},"#setItemTTL");#v=o(()=>!1,"#isStale");#F(){let e=new Ba(this.#e);this.#f=0,this.#T=e,this.#D=t=>{this.#f-=e[t],e[t]=0},this.#k=(t,i,n,s)=>{if(this.#l(i))return 0;if(!$n(n))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(n=s(i,t),!$n(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return n},this.#N=(t,i,n)=>{if(e[t]=i,this.#t){let s=this.#t-e[t];for(;this.#f>s;)this.#L(!0)}this.#f+=e[t],n&&(n.entrySize=i,n.totalCalculatedSize=this.#f)}}#D=o(e=>{},"#removeItemSize");#N=o((e,t,i)=>{},"#addItemSize");#k=o((e,t,i,n)=>{if(i||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0},"#requireSize");*#C({allowStale:e=this.allowStale}={}){if(this.#u)for(let t=this.#h;!(!this.#j(t)||((e||!this.#v(t))&&(yield t),t===this.#d));)t=this.#y[t]}*#O({allowStale:e=this.allowStale}={}){if(this.#u)for(let t=this.#d;!(!this.#j(t)||((e||!this.#v(t))&&(yield t),t===this.#h));)t=this.#g[t]}#j(e){return e!==void 0&&this.#o.get(this.#c[e])===e}*entries(){for(let e of this.#C())this.#n[e]!==void 0&&this.#c[e]!==void 0&&!this.#l(this.#n[e])&&(yield[this.#c[e],this.#n[e]])}*rentries(){for(let e of this.#O())this.#n[e]!==void 0&&this.#c[e]!==void 0&&!this.#l(this.#n[e])&&(yield[this.#c[e],this.#n[e]])}*keys(){for(let e of this.#C()){let t=this.#c[e];t!==void 0&&!this.#l(this.#n[e])&&(yield t)}}*rkeys(){for(let e of this.#O()){let t=this.#c[e];t!==void 0&&!this.#l(this.#n[e])&&(yield t)}}*values(){for(let e of this.#C())this.#n[e]!==void 0&&!this.#l(this.#n[e])&&(yield this.#n[e])}*rvalues(){for(let e of this.#O())this.#n[e]!==void 0&&!this.#l(this.#n[e])&&(yield this.#n[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(let i of this.#C()){let n=this.#n[i],s=this.#l(n)?n.__staleWhileFetching:n;if(s!==void 0&&e(s,this.#c[i],this))return this.get(this.#c[i],t)}}forEach(e,t=this){for(let i of this.#C()){let n=this.#n[i],s=this.#l(n)?n.__staleWhileFetching:n;s!==void 0&&e.call(t,s,this.#c[i],this)}}rforEach(e,t=this){for(let i of this.#O()){let n=this.#n[i],s=this.#l(n)?n.__staleWhileFetching:n;s!==void 0&&e.call(t,s,this.#c[i],this)}}purgeStale(){let e=!1;for(let t of this.#O({allowStale:!0}))this.#v(t)&&(this.#I(this.#c[t],"expire"),e=!0);return e}info(e){let t=this.#o.get(e);if(t===void 0)return;let i=this.#n[t],n=this.#l(i)?i.__staleWhileFetching:i;if(n===void 0)return;let s={value:n};if(this.#_&&this.#A){let a=this.#_[t],c=this.#A[t];if(a&&c){let u=a-(qa.now()-c);s.ttl=u,s.start=Date.now()}}return this.#T&&(s.size=this.#T[t]),s}dump(){let e=[];for(let t of this.#C({allowStale:!0})){let i=this.#c[t],n=this.#n[t],s=this.#l(n)?n.__staleWhileFetching:n;if(s===void 0||i===void 0)continue;let a={value:s};if(this.#_&&this.#A){a.ttl=this.#_[t];let c=qa.now()-this.#A[t];a.start=Math.floor(Date.now()-c)}this.#T&&(a.size=this.#T[t]),e.unshift([i,a])}return e}load(e){this.clear();for(let[t,i]of e){if(i.start){let n=Date.now()-i.start;i.start=qa.now()-n}this.set(t,i.value,i)}}set(e,t,i={}){if(t===void 0)return this.delete(e),this;let{ttl:n=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=i,{noUpdateTTL:l=this.noUpdateTTL}=i,f=this.#k(e,t,i.size||0,c);if(this.maxEntrySize&&f>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.#I(e,"set"),this;let h=this.#u===0?void 0:this.#o.get(e);if(h===void 0)h=this.#u===0?this.#h:this.#E.length!==0?this.#E.pop():this.#u===this.#e?this.#L(!1):this.#u,this.#c[h]=e,this.#n[h]=t,this.#o.set(e,h),this.#g[this.#h]=h,this.#y[h]=this.#h,this.#h=h,this.#u++,this.#N(h,f,u),u&&(u.set="add"),l=!1;else{this.#$(h);let d=this.#n[h];if(t!==d){if(this.#S&&this.#l(d)){d.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:g}=d;g!==void 0&&!a&&(this.#b&&this.#s?.(g,e,"set"),this.#p&&this.#m?.push([g,e,"set"]))}else a||(this.#b&&this.#s?.(d,e,"set"),this.#p&&this.#m?.push([d,e,"set"]));if(this.#D(h),this.#N(h,f,u),this.#n[h]=t,u){u.set="replace";let g=d&&this.#l(d)?d.__staleWhileFetching:d;g!==void 0&&(u.oldValue=g)}}else u&&(u.set="update")}if(n!==0&&!this.#_&&this.#P(),this.#_&&(l||this.#R(h,n,s),u&&this.#r(u,h)),!a&&this.#p&&this.#m){let d=this.#m,g;for(;g=d?.shift();)this.#i?.(...g)}return this}pop(){try{for(;this.#u;){let e=this.#n[this.#d];if(this.#L(!0),this.#l(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#p&&this.#m){let e=this.#m,t;for(;t=e?.shift();)this.#i?.(...t)}}}#L(e){let t=this.#d,i=this.#c[t],n=this.#n[t];return this.#S&&this.#l(n)?n.__abortController.abort(new Error("evicted")):(this.#b||this.#p)&&(this.#b&&this.#s?.(n,i,"evict"),this.#p&&this.#m?.push([n,i,"evict"])),this.#D(t),e&&(this.#c[t]=void 0,this.#n[t]=void 0,this.#E.push(t)),this.#u===1?(this.#d=this.#h=0,this.#E.length=0):this.#d=this.#g[t],this.#o.delete(i),this.#u--,t}has(e,t={}){let{updateAgeOnHas:i=this.updateAgeOnHas,status:n}=t,s=this.#o.get(e);if(s!==void 0){let a=this.#n[s];if(this.#l(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#v(s))n&&(n.has="stale",this.#r(n,s));else return i&&this.#x(s),n&&(n.has="hit",this.#r(n,s)),!0}else n&&(n.has="miss");return!1}peek(e,t={}){let{allowStale:i=this.allowStale}=t,n=this.#o.get(e);if(n===void 0||!i&&this.#v(n))return;let s=this.#n[n];return this.#l(s)?s.__staleWhileFetching:s}#M(e,t,i,n){let s=t===void 0?void 0:this.#n[t];if(this.#l(s))return s;let a=new hf,{signal:c}=i;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let u={signal:a.signal,options:i,context:n},l=o((b,x=!1)=>{let{aborted:O}=a.signal,F=i.ignoreFetchAbort&&b!==void 0;if(i.status&&(O&&!x?(i.status.fetchAborted=!0,i.status.fetchError=a.signal.reason,F&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),O&&!F&&!x)return h(a.signal.reason);let k=g;return this.#n[t]===g&&(b===void 0?k.__staleWhileFetching?this.#n[t]=k.__staleWhileFetching:this.#I(e,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(e,b,u.options))),b},"cb"),f=o(b=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=b),h(b)),"eb"),h=o(b=>{let{aborted:x}=a.signal,O=x&&i.allowStaleOnFetchAbort,F=O||i.allowStaleOnFetchRejection,k=F||i.noDeleteOnFetchRejection,G=g;if(this.#n[t]===g&&(!k||G.__staleWhileFetching===void 0?this.#I(e,"fetch"):O||(this.#n[t]=G.__staleWhileFetching)),F)return i.status&&G.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),G.__staleWhileFetching;if(G.__returned===G)throw b},"fetchFail"),d=o((b,x)=>{let O=this.#a?.(e,s,u);O&&O instanceof Promise&&O.then(F=>b(F===void 0?void 0:F),x),a.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(b(void 0),i.allowStaleOnFetchAbort&&(b=o(F=>l(F,!0),"res")))})},"pcall");i.status&&(i.status.fetchDispatched=!0);let g=new Promise(d).then(l,f),w=Object.assign(g,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return t===void 0?(this.set(e,w,{...u.options,status:void 0}),t=this.#o.get(e)):this.#n[t]=w,w}#l(e){if(!this.#S)return!1;let t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof hf}async fetch(e,t={}){let{allowStale:i=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:f=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:g=this.ignoreFetchAbort,allowStaleOnFetchAbort:w=this.allowStaleOnFetchAbort,context:b,forceRefresh:x=!1,status:O,signal:F}=t;if(!this.#S)return O&&(O.fetch="get"),this.get(e,{allowStale:i,updateAgeOnGet:n,noDeleteOnStaleGet:s,status:O});let k={allowStale:i,updateAgeOnGet:n,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:u,sizeCalculation:l,noUpdateTTL:f,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:w,ignoreFetchAbort:g,status:O,signal:F},G=this.#o.get(e);if(G===void 0){O&&(O.fetch="miss");let W=this.#M(e,G,k,b);return W.__returned=W}else{let W=this.#n[G];if(this.#l(W)){let ue=i&&W.__staleWhileFetching!==void 0;return O&&(O.fetch="inflight",ue&&(O.returnedStale=!0)),ue?W.__staleWhileFetching:W.__returned=W}let Ie=this.#v(G);if(!x&&!Ie)return O&&(O.fetch="hit"),this.#$(G),n&&this.#x(G),O&&this.#r(O,G),W;let Je=this.#M(e,G,k,b),q=Je.__staleWhileFetching!==void 0&&i;return O&&(O.fetch=Ie?"stale":"refresh",q&&Ie&&(O.returnedStale=!0)),q?Je.__staleWhileFetching:Je.__returned=Je}}async forceFetch(e,t={}){let i=await this.fetch(e,t);if(i===void 0)throw new Error("fetch() returned undefined");return i}memo(e,t={}){let i=this.#w;if(!i)throw new Error("no memoMethod provided to constructor");let{context:n,forceRefresh:s,...a}=t,c=this.get(e,a);if(!s&&c!==void 0)return c;let u=i(e,c,{options:a,context:n});return this.set(e,u,a),u}get(e,t={}){let{allowStale:i=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=t,c=this.#o.get(e);if(c!==void 0){let u=this.#n[c],l=this.#l(u);return a&&this.#r(a,c),this.#v(c)?(a&&(a.get="stale"),l?(a&&i&&u.__staleWhileFetching!==void 0&&(a.returnedStale=!0),i?u.__staleWhileFetching:void 0):(s||this.#I(e,"expire"),a&&i&&(a.returnedStale=!0),i?u:void 0)):(a&&(a.get="hit"),l?u.__staleWhileFetching:(this.#$(c),n&&this.#x(c),u))}else a&&(a.get="miss")}#V(e,t){this.#y[t]=e,this.#g[e]=t}#$(e){e!==this.#h&&(e===this.#d?this.#d=this.#g[e]:this.#V(this.#y[e],this.#g[e]),this.#V(this.#h,e),this.#h=e)}delete(e){return this.#I(e,"delete")}#I(e,t){let i=!1;if(this.#u!==0){let n=this.#o.get(e);if(n!==void 0)if(i=!0,this.#u===1)this.#q(t);else{this.#D(n);let s=this.#n[n];if(this.#l(s)?s.__abortController.abort(new Error("deleted")):(this.#b||this.#p)&&(this.#b&&this.#s?.(s,e,t),this.#p&&this.#m?.push([s,e,t])),this.#o.delete(e),this.#c[n]=void 0,this.#n[n]=void 0,n===this.#h)this.#h=this.#y[n];else if(n===this.#d)this.#d=this.#g[n];else{let a=this.#y[n];this.#g[a]=this.#g[n];let c=this.#g[n];this.#y[c]=this.#y[n]}this.#u--,this.#E.push(n)}}if(this.#p&&this.#m?.length){let n=this.#m,s;for(;s=n?.shift();)this.#i?.(...s)}return i}clear(){return this.#q("delete")}#q(e){for(let t of this.#O({allowStale:!0})){let i=this.#n[t];if(this.#l(i))i.__abortController.abort(new Error("deleted"));else{let n=this.#c[t];this.#b&&this.#s?.(i,n,e),this.#p&&this.#m?.push([i,n,e])}}if(this.#o.clear(),this.#n.fill(void 0),this.#c.fill(void 0),this.#_&&this.#A&&(this.#_.fill(0),this.#A.fill(0)),this.#T&&this.#T.fill(0),this.#d=0,this.#h=0,this.#E.length=0,this.#f=0,this.#u=0,this.#p&&this.#m){let t=this.#m,i;for(;i=t?.shift();)this.#i?.(...i)}}};var Wa=require("node:path"),Bb=require("node:url"),Ui=require("fs"),d7=Ye(require("node:fs"),1),Un=require("node:fs/promises");var _f=require("node:events"),o1=Ye(require("node:stream"),1),Lb=require("node:string_decoder");var Db=typeof process=="object"&&process?process:{stdout:null,stderr:null},n7=o(r=>!!r&&typeof r=="object"&&(r instanceof Bn||r instanceof o1.default||s7(r)||a7(r)),"isStream"),s7=o(r=>!!r&&typeof r=="object"&&r instanceof _f.EventEmitter&&typeof r.pipe=="function"&&r.pipe!==o1.default.Writable.prototype.pipe,"isReadable"),a7=o(r=>!!r&&typeof r=="object"&&r instanceof _f.EventEmitter&&typeof r.write=="function"&&typeof r.end=="function","isWritable"),dn=Symbol("EOF"),pn=Symbol("maybeEmitEnd"),qn=Symbol("emittedEnd"),df=Symbol("emittingEnd"),nc=Symbol("emittedError"),pf=Symbol("closed"),Nb=Symbol("read"),mf=Symbol("flush"),kb=Symbol("flushChunk"),gi=Symbol("encoding"),Ua=Symbol("decoder"),Ot=Symbol("flowing"),sc=Symbol("paused"),Ga=Symbol("resume"),Pt=Symbol("buffer"),gr=Symbol("pipes"),Ft=Symbol("bufferLength"),t1=Symbol("bufferPush"),gf=Symbol("bufferShift"),Zt=Symbol("objectMode"),pt=Symbol("destroyed"),r1=Symbol("error"),i1=Symbol("emitData"),jb=Symbol("emitEnd"),n1=Symbol("emitEnd2"),qi=Symbol("async"),s1=Symbol("abort"),yf=Symbol("aborted"),ac=Symbol("signal"),Rs=Symbol("dataListeners"),Dr=Symbol("discarded"),oc=o(r=>Promise.resolve().then(r),"defer"),o7=o(r=>r(),"nodefer"),c7=o(r=>r==="end"||r==="finish"||r==="prefinish","isEndish"),u7=o(r=>r instanceof ArrayBuffer||!!r&&typeof r=="object"&&r.constructor&&r.constructor.name==="ArrayBuffer"&&r.byteLength>=0,"isArrayBufferLike"),l7=o(r=>!Buffer.isBuffer(r)&&ArrayBuffer.isView(r),"isArrayBufferView"),vf=class{static{o(this,"Pipe")}src;dest;opts;ondrain;constructor(e,t,i){this.src=e,this.dest=t,this.opts=i,this.ondrain=()=>e[Ga](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(e){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},a1=class extends vf{static{o(this,"PipeProxyErrors")}unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,t,i){super(e,t,i),this.proxyErrors=n=>t.emit("error",n),e.on("error",this.proxyErrors)}},f7=o(r=>!!r.objectMode,"isObjectModeOptions"),h7=o(r=>!r.objectMode&&!!r.encoding&&r.encoding!=="buffer","isEncodingOptions"),Bn=class extends _f.EventEmitter{static{o(this,"Minipass")}[Ot]=!1;[sc]=!1;[gr]=[];[Pt]=[];[Zt];[gi];[qi];[Ua];[dn]=!1;[qn]=!1;[df]=!1;[pf]=!1;[nc]=null;[Ft]=0;[pt]=!1;[ac];[yf]=!1;[Rs]=0;[Dr]=!1;writable=!0;readable=!0;constructor(...e){let t=e[0]||{};if(super(),t.objectMode&&typeof t.encoding=="string")throw new TypeError("Encoding and objectMode may not be used together");f7(t)?(this[Zt]=!0,this[gi]=null):h7(t)?(this[gi]=t.encoding,this[Zt]=!1):(this[Zt]=!1,this[gi]=null),this[qi]=!!t.async,this[Ua]=this[gi]?new Lb.StringDecoder(this[gi]):null,t&&t.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:o(()=>this[Pt],"get")}),t&&t.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:o(()=>this[gr],"get")});let{signal:i}=t;i&&(this[ac]=i,i.aborted?this[s1]():i.addEventListener("abort",()=>this[s1]()))}get bufferLength(){return this[Ft]}get encoding(){return this[gi]}set encoding(e){throw new Error("Encoding must be set at instantiation time")}setEncoding(e){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[Zt]}set objectMode(e){throw new Error("objectMode must be set at instantiation time")}get async(){return this[qi]}set async(e){this[qi]=this[qi]||!!e}[s1](){this[yf]=!0,this.emit("abort",this[ac]?.reason),this.destroy(this[ac]?.reason)}get aborted(){return this[yf]}set aborted(e){}write(e,t,i){if(this[yf])return!1;if(this[dn])throw new Error("write after end");if(this[pt])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof t=="function"&&(i=t,t="utf8"),t||(t="utf8");let n=this[qi]?oc:o7;if(!this[Zt]&&!Buffer.isBuffer(e)){if(l7(e))e=Buffer.from(e.buffer,e.byteOffset,e.byteLength);else if(u7(e))e=Buffer.from(e);else if(typeof e!="string")throw new Error("Non-contiguous data written to non-objectMode stream")}return this[Zt]?(this[Ot]&&this[Ft]!==0&&this[mf](!0),this[Ot]?this.emit("data",e):this[t1](e),this[Ft]!==0&&this.emit("readable"),i&&n(i),this[Ot]):e.length?(typeof e=="string"&&!(t===this[gi]&&!this[Ua]?.lastNeed)&&(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[gi]&&(e=this[Ua].write(e)),this[Ot]&&this[Ft]!==0&&this[mf](!0),this[Ot]?this.emit("data",e):this[t1](e),this[Ft]!==0&&this.emit("readable"),i&&n(i),this[Ot]):(this[Ft]!==0&&this.emit("readable"),i&&n(i),this[Ot])}read(e){if(this[pt])return null;if(this[Dr]=!1,this[Ft]===0||e===0||e&&e>this[Ft])return this[pn](),null;this[Zt]&&(e=null),this[Pt].length>1&&!this[Zt]&&(this[Pt]=[this[gi]?this[Pt].join(""):Buffer.concat(this[Pt],this[Ft])]);let t=this[Nb](e||null,this[Pt][0]);return this[pn](),t}[Nb](e,t){if(this[Zt])this[gf]();else{let i=t;e===i.length||e===null?this[gf]():typeof i=="string"?(this[Pt][0]=i.slice(e),t=i.slice(0,e),this[Ft]-=e):(this[Pt][0]=i.subarray(e),t=i.subarray(0,e),this[Ft]-=e)}return this.emit("data",t),!this[Pt].length&&!this[dn]&&this.emit("drain"),t}end(e,t,i){return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t="utf8"),e!==void 0&&this.write(e,t),i&&this.once("end",i),this[dn]=!0,this.writable=!1,(this[Ot]||!this[sc])&&this[pn](),this}[Ga](){this[pt]||(!this[Rs]&&!this[gr].length&&(this[Dr]=!0),this[sc]=!1,this[Ot]=!0,this.emit("resume"),this[Pt].length?this[mf]():this[dn]?this[pn]():this.emit("drain"))}resume(){return this[Ga]()}pause(){this[Ot]=!1,this[sc]=!0,this[Dr]=!1}get destroyed(){return this[pt]}get flowing(){return this[Ot]}get paused(){return this[sc]}[t1](e){this[Zt]?this[Ft]+=1:this[Ft]+=e.length,this[Pt].push(e)}[gf](){return this[Zt]?this[Ft]-=1:this[Ft]-=this[Pt][0].length,this[Pt].shift()}[mf](e=!1){do;while(this[kb](this[gf]())&&this[Pt].length);!e&&!this[Pt].length&&!this[dn]&&this.emit("drain")}[kb](e){return this.emit("data",e),this[Ot]}pipe(e,t){if(this[pt])return e;this[Dr]=!1;let i=this[qn];return t=t||{},e===Db.stdout||e===Db.stderr?t.end=!1:t.end=t.end!==!1,t.proxyErrors=!!t.proxyErrors,i?t.end&&e.end():(this[gr].push(t.proxyErrors?new a1(this,e,t):new vf(this,e,t)),this[qi]?oc(()=>this[Ga]()):this[Ga]()),e}unpipe(e){let t=this[gr].find(i=>i.dest===e);t&&(this[gr].length===1?(this[Ot]&&this[Rs]===0&&(this[Ot]=!1),this[gr]=[]):this[gr].splice(this[gr].indexOf(t),1),t.unpipe())}addListener(e,t){return this.on(e,t)}on(e,t){let i=super.on(e,t);if(e==="data")this[Dr]=!1,this[Rs]++,!this[gr].length&&!this[Ot]&&this[Ga]();else if(e==="readable"&&this[Ft]!==0)super.emit("readable");else if(c7(e)&&this[qn])super.emit(e),this.removeAllListeners(e);else if(e==="error"&&this[nc]){let n=t;this[qi]?oc(()=>n.call(this,this[nc])):n.call(this,this[nc])}return i}removeListener(e,t){return this.off(e,t)}off(e,t){let i=super.off(e,t);return e==="data"&&(this[Rs]=this.listeners("data").length,this[Rs]===0&&!this[Dr]&&!this[gr].length&&(this[Ot]=!1)),i}removeAllListeners(e){let t=super.removeAllListeners(e);return(e==="data"||e===void 0)&&(this[Rs]=0,!this[Dr]&&!this[gr].length&&(this[Ot]=!1)),t}get emittedEnd(){return this[qn]}[pn](){!this[df]&&!this[qn]&&!this[pt]&&this[Pt].length===0&&this[dn]&&(this[df]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[pf]&&this.emit("close"),this[df]=!1)}emit(e,...t){let i=t[0];if(e!=="error"&&e!=="close"&&e!==pt&&this[pt])return!1;if(e==="data")return!this[Zt]&&!i?!1:this[qi]?(oc(()=>this[i1](i)),!0):this[i1](i);if(e==="end")return this[jb]();if(e==="close"){if(this[pf]=!0,!this[qn]&&!this[pt])return!1;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[nc]=i,super.emit(r1,i);let s=!this[ac]||this.listeners("error").length?super.emit("error",i):!1;return this[pn](),s}else if(e==="resume"){let s=super.emit("resume");return this[pn](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,...t);return this[pn](),n}[i1](e){for(let i of this[gr])i.dest.write(e)===!1&&this.pause();let t=this[Dr]?!1:super.emit("data",e);return this[pn](),t}[jb](){return this[qn]?!1:(this[qn]=!0,this.readable=!1,this[qi]?(oc(()=>this[n1]()),!0):this[n1]())}[n1](){if(this[Ua]){let t=this[Ua].end();if(t){for(let i of this[gr])i.dest.write(t);this[Dr]||super.emit("data",t)}}for(let t of this[gr])t.end();let e=super.emit("end");return this.removeAllListeners("end"),e}async collect(){let e=Object.assign([],{dataLength:0});this[Zt]||(e.dataLength=0);let t=this.promise();return this.on("data",i=>{e.push(i),this[Zt]||(e.dataLength+=i.length)}),await t,e}async concat(){if(this[Zt])throw new Error("cannot concat in objectMode");let e=await this.collect();return this[gi]?e.join(""):Buffer.concat(e,e.dataLength)}async promise(){return new Promise((e,t)=>{this.on(pt,()=>t(new Error("stream destroyed"))),this.on("error",i=>t(i)),this.on("end",()=>e())})}[Symbol.asyncIterator](){this[Dr]=!1;let e=!1,t=o(async()=>(this.pause(),e=!0,{value:void 0,done:!0}),"stop");return{next:o(()=>{if(e)return t();let n=this.read();if(n!==null)return Promise.resolve({done:!1,value:n});if(this[dn])return t();let s,a,c=o(h=>{this.off("data",u),this.off("end",l),this.off(pt,f),t(),a(h)},"onerr"),u=o(h=>{this.off("error",c),this.off("end",l),this.off(pt,f),this.pause(),s({value:h,done:!!this[dn]})},"ondata"),l=o(()=>{this.off("error",c),this.off("data",u),this.off(pt,f),t(),s({done:!0,value:void 0})},"onend"),f=o(()=>c(new Error("stream destroyed")),"ondestroy");return new Promise((h,d)=>{a=d,s=h,this.once(pt,f),this.once("error",c),this.once("end",l),this.once("data",u)})},"next"),throw:t,return:t,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[Dr]=!1;let e=!1,t=o(()=>(this.pause(),this.off(r1,t),this.off(pt,t),this.off("end",t),e=!0,{done:!0,value:void 0}),"stop"),i=o(()=>{if(e)return t();let n=this.read();return n===null?t():{done:!1,value:n}},"next");return this.once("end",t),this.once(r1,t),this.once(pt,t),{next:i,throw:t,return:t,[Symbol.iterator](){return this}}}destroy(e){if(this[pt])return e?this.emit("error",e):this.emit(pt),this;this[pt]=!0,this[Dr]=!0,this[Pt].length=0,this[Ft]=0;let t=this;return typeof t.close=="function"&&!this[pf]&&t.close(),e?this.emit("error",e):this.emit(pt),this}static get isStream(){return n7}};var p7=Ui.realpathSync.native,uc={lstatSync:Ui.lstatSync,readdir:Ui.readdir,readdirSync:Ui.readdirSync,readlinkSync:Ui.readlinkSync,realpathSync:p7,promises:{lstat:Un.lstat,readdir:Un.readdir,readlink:Un.readlink,realpath:Un.realpath}},Ub=o(r=>!r||r===uc||r===d7?uc:{...uc,...r,promises:{...uc.promises,...r.promises||{}}},"fsFromOption"),Gb=/^\\\\\?\\([a-z]:)\\?$/i,m7=o(r=>r.replace(/\//g,"\\").replace(Gb,"$1\\"),"uncToDrive"),g7=/[\\\/]/,Br=0,Wb=1,zb=2,Bi=4,Hb=6,Kb=8,Ds=10,Qb=12,qr=15,cc=~qr,c1=16,Mb=32,lc=64,yi=128,wf=256,Sf=512,Vb=lc|yi|Sf,y7=1023,u1=o(r=>r.isFile()?Kb:r.isDirectory()?Bi:r.isSymbolicLink()?Ds:r.isCharacterDevice()?zb:r.isBlockDevice()?Hb:r.isSocket()?Qb:r.isFIFO()?Wb:Br,"entToType"),$b=new Map,fc=o(r=>{let e=$b.get(r);if(e)return e;let t=r.normalize("NFKD");return $b.set(r,t),t},"normalize"),qb=new Map,bf=o(r=>{let e=qb.get(r);if(e)return e;let t=fc(r.toLowerCase());return qb.set(r,t),t},"normalizeNocase"),Ef=class extends ic{static{o(this,"ResolveCache")}constructor(){super({max:256})}},l1=class extends ic{static{o(this,"ChildrenCache")}constructor(e=16*1024){super({maxSize:e,sizeCalculation:o(t=>t.length+1,"sizeCalculation")})}},Yb=Symbol("PathScurry setAsCwd"),er=class{static{o(this,"PathBase")}name;root;roots;parent;nocase;isCWD=!1;#e;#t;get dev(){return this.#t}#s;get mode(){return this.#s}#i;get nlink(){return this.#i}#a;get uid(){return this.#a}#w;get gid(){return this.#w}#u;get rdev(){return this.#u}#f;get blksize(){return this.#f}#o;get ino(){return this.#o}#c;get size(){return this.#c}#n;get blocks(){return this.#n}#g;get atimeMs(){return this.#g}#y;get mtimeMs(){return this.#y}#d;get ctimeMs(){return this.#d}#h;get birthtimeMs(){return this.#h}#E;get atime(){return this.#E}#m;get mtime(){return this.#m}#T;get ctime(){return this.#T}#A;get birthtime(){return this.#A}#_;#b;#S;#p;#P;#x;#r;#R;#v;#F;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(e,t=Br,i,n,s,a,c){this.name=e,this.#_=s?bf(e):fc(e),this.#r=t&y7,this.nocase=s,this.roots=n,this.root=i||this,this.#R=a,this.#S=c.fullpath,this.#P=c.relative,this.#x=c.relativePosix,this.parent=c.parent,this.parent?this.#e=this.parent.#e:this.#e=Ub(c.fs)}depth(){return this.#b!==void 0?this.#b:this.parent?this.#b=this.parent.depth()+1:this.#b=0}childrenCache(){return this.#R}resolve(e){if(!e)return this;let t=this.getRootString(e),n=e.substring(t.length).split(this.splitSep);return t?this.getRoot(t).#D(n):this.#D(n)}#D(e){let t=this;for(let i of e)t=t.child(i);return t}children(){let e=this.#R.get(this);if(e)return e;let t=Object.assign([],{provisional:0});return this.#R.set(this,t),this.#r&=~c1,t}child(e,t){if(e===""||e===".")return this;if(e==="..")return this.parent||this;let i=this.children(),n=this.nocase?bf(e):fc(e);for(let u of i)if(u.#_===n)return u;let s=this.parent?this.sep:"",a=this.#S?this.#S+s+e:void 0,c=this.newChild(e,Br,{...t,parent:this,fullpath:a});return this.canReaddir()||(c.#r|=yi),i.push(c),c}relative(){if(this.isCWD)return"";if(this.#P!==void 0)return this.#P;let e=this.name,t=this.parent;if(!t)return this.#P=this.name;let i=t.relative();return i+(!i||!t.parent?"":this.sep)+e}relativePosix(){if(this.sep==="/")return this.relative();if(this.isCWD)return"";if(this.#x!==void 0)return this.#x;let e=this.name,t=this.parent;if(!t)return this.#x=this.fullpathPosix();let i=t.relativePosix();return i+(!i||!t.parent?"":"/")+e}fullpath(){if(this.#S!==void 0)return this.#S;let e=this.name,t=this.parent;if(!t)return this.#S=this.name;let n=t.fullpath()+(t.parent?this.sep:"")+e;return this.#S=n}fullpathPosix(){if(this.#p!==void 0)return this.#p;if(this.sep==="/")return this.#p=this.fullpath();if(!this.parent){let n=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(n)?this.#p=`//?/${n}`:this.#p=n}let e=this.parent,t=e.fullpathPosix(),i=t+(!t||!e.parent?"":"/")+this.name;return this.#p=i}isUnknown(){return(this.#r&qr)===Br}isType(e){return this[`is${e}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#r&qr)===Kb}isDirectory(){return(this.#r&qr)===Bi}isCharacterDevice(){return(this.#r&qr)===zb}isBlockDevice(){return(this.#r&qr)===Hb}isFIFO(){return(this.#r&qr)===Wb}isSocket(){return(this.#r&qr)===Qb}isSymbolicLink(){return(this.#r&Ds)===Ds}lstatCached(){return this.#r&Mb?this:void 0}readlinkCached(){return this.#v}realpathCached(){return this.#F}readdirCached(){let e=this.children();return e.slice(0,e.provisional)}canReadlink(){if(this.#v)return!0;if(!this.parent)return!1;let e=this.#r&qr;return!(e!==Br&&e!==Ds||this.#r&wf||this.#r&yi)}calledReaddir(){return!!(this.#r&c1)}isENOENT(){return!!(this.#r&yi)}isNamed(e){return this.nocase?this.#_===bf(e):this.#_===fc(e)}async readlink(){let e=this.#v;if(e)return e;if(this.canReadlink()&&this.parent)try{let t=await this.#e.promises.readlink(this.fullpath()),i=(await this.parent.realpath())?.resolve(t);if(i)return this.#v=i}catch(t){this.#l(t.code);return}}readlinkSync(){let e=this.#v;if(e)return e;if(this.canReadlink()&&this.parent)try{let t=this.#e.readlinkSync(this.fullpath()),i=this.parent.realpathSync()?.resolve(t);if(i)return this.#v=i}catch(t){this.#l(t.code);return}}#N(e){this.#r|=c1;for(let t=e.provisional;t<e.length;t++){let i=e[t];i&&i.#k()}}#k(){this.#r&yi||(this.#r=(this.#r|yi)&cc,this.#C())}#C(){let e=this.children();e.provisional=0;for(let t of e)t.#k()}#O(){this.#r|=Sf,this.#j()}#j(){if(this.#r&lc)return;let e=this.#r;(e&qr)===Bi&&(e&=cc),this.#r=e|lc,this.#C()}#L(e=""){e==="ENOTDIR"||e==="EPERM"?this.#j():e==="ENOENT"?this.#k():this.children().provisional=0}#M(e=""){e==="ENOTDIR"?this.parent.#j():e==="ENOENT"&&this.#k()}#l(e=""){let t=this.#r;t|=wf,e==="ENOENT"&&(t|=yi),(e==="EINVAL"||e==="UNKNOWN")&&(t&=cc),this.#r=t,e==="ENOTDIR"&&this.parent&&this.parent.#j()}#V(e,t){return this.#I(e,t)||this.#$(e,t)}#$(e,t){let i=u1(e),n=this.newChild(e.name,i,{parent:this}),s=n.#r&qr;return s!==Bi&&s!==Ds&&s!==Br&&(n.#r|=lc),t.unshift(n),t.provisional++,n}#I(e,t){for(let i=t.provisional;i<t.length;i++){let n=t[i];if((this.nocase?bf(e.name):fc(e.name))===n.#_)return this.#q(e,n,i,t)}}#q(e,t,i,n){let s=t.name;return t.#r=t.#r&cc|u1(e),s!==e.name&&(t.name=e.name),i!==n.provisional&&(i===n.length-1?n.pop():n.splice(i,1),n.unshift(t)),n.provisional++,t}async lstat(){if((this.#r&yi)===0)try{return this.#W(await this.#e.promises.lstat(this.fullpath())),this}catch(e){this.#M(e.code)}}lstatSync(){if((this.#r&yi)===0)try{return this.#W(this.#e.lstatSync(this.fullpath())),this}catch(e){this.#M(e.code)}}#W(e){let{atime:t,atimeMs:i,birthtime:n,birthtimeMs:s,blksize:a,blocks:c,ctime:u,ctimeMs:l,dev:f,gid:h,ino:d,mode:g,mtime:w,mtimeMs:b,nlink:x,rdev:O,size:F,uid:k}=e;this.#E=t,this.#g=i,this.#A=n,this.#h=s,this.#f=a,this.#n=c,this.#T=u,this.#d=l,this.#t=f,this.#w=h,this.#o=d,this.#s=g,this.#m=w,this.#y=b,this.#i=x,this.#u=O,this.#c=F,this.#a=k;let G=u1(e);this.#r=this.#r&cc|G|Mb,G!==Br&&G!==Bi&&G!==Ds&&(this.#r|=lc)}#U=[];#G=!1;#z(e){this.#G=!1;let t=this.#U.slice();this.#U.length=0,t.forEach(i=>i(null,e))}readdirCB(e,t=!1){if(!this.canReaddir()){t?e(null,[]):queueMicrotask(()=>e(null,[]));return}let i=this.children();if(this.calledReaddir()){let s=i.slice(0,i.provisional);t?e(null,s):queueMicrotask(()=>e(null,s));return}if(this.#U.push(e),this.#G)return;this.#G=!0;let n=this.fullpath();this.#e.readdir(n,{withFileTypes:!0},(s,a)=>{if(s)this.#L(s.code),i.provisional=0;else{for(let c of a)this.#V(c,i);this.#N(i)}this.#z(i.slice(0,i.provisional))})}#B;async readdir(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();if(this.#B)await this.#B;else{let i=o(()=>{},"resolve");this.#B=new Promise(n=>i=n);try{for(let n of await this.#e.promises.readdir(t,{withFileTypes:!0}))this.#V(n,e);this.#N(e)}catch(n){this.#L(n.code),e.provisional=0}this.#B=void 0,i()}return e.slice(0,e.provisional)}readdirSync(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();try{for(let i of this.#e.readdirSync(t,{withFileTypes:!0}))this.#V(i,e);this.#N(e)}catch(i){this.#L(i.code),e.provisional=0}return e.slice(0,e.provisional)}canReaddir(){if(this.#r&Vb)return!1;let e=qr&this.#r;return e===Br||e===Bi||e===Ds}shouldWalk(e,t){return(this.#r&Bi)===Bi&&!(this.#r&Vb)&&!e.has(this)&&(!t||t(this))}async realpath(){if(this.#F)return this.#F;if(!((Sf|wf|yi)&this.#r))try{let e=await this.#e.promises.realpath(this.fullpath());return this.#F=this.resolve(e)}catch{this.#O()}}realpathSync(){if(this.#F)return this.#F;if(!((Sf|wf|yi)&this.#r))try{let e=this.#e.realpathSync(this.fullpath());return this.#F=this.resolve(e)}catch{this.#O()}}[Yb](e){if(e===this)return;e.isCWD=!1,this.isCWD=!0;let t=new Set([]),i=[],n=this;for(;n&&n.parent;)t.add(n),n.#P=i.join(this.sep),n.#x=i.join("/"),n=n.parent,i.push("..");for(n=e;n&&n.parent&&!t.has(n);)n.#P=void 0,n.#x=void 0,n=n.parent}},Tf=class r extends er{static{o(this,"PathWin32")}sep="\\";splitSep=g7;constructor(e,t=Br,i,n,s,a,c){super(e,t,i,n,s,a,c)}newChild(e,t=Br,i={}){return new r(e,t,this.root,this.roots,this.nocase,this.childrenCache(),i)}getRootString(e){return Wa.win32.parse(e).root}getRoot(e){if(e=m7(e.toUpperCase()),e===this.root.name)return this.root;for(let[t,i]of Object.entries(this.roots))if(this.sameRoot(e,t))return this.roots[e]=i;return this.roots[e]=new za(e,this).root}sameRoot(e,t=this.root.name){return e=e.toUpperCase().replace(/\//g,"\\").replace(Gb,"$1\\"),e===t}},Af=class r extends er{static{o(this,"PathPosix")}splitSep="/";sep="/";constructor(e,t=Br,i,n,s,a,c){super(e,t,i,n,s,a,c)}getRootString(e){return e.startsWith("/")?"/":""}getRoot(e){return this.root}newChild(e,t=Br,i={}){return new r(e,t,this.root,this.roots,this.nocase,this.childrenCache(),i)}},xf=class{static{o(this,"PathScurryBase")}root;rootPath;roots;cwd;#e;#t;#s;nocase;#i;constructor(e=process.cwd(),t,i,{nocase:n,childrenCacheSize:s=16*1024,fs:a=uc}={}){this.#i=Ub(a),(e instanceof URL||e.startsWith("file://"))&&(e=(0,Bb.fileURLToPath)(e));let c=t.resolve(e);this.roots=Object.create(null),this.rootPath=this.parseRootPath(c),this.#e=new Ef,this.#t=new Ef,this.#s=new l1(s);let u=c.substring(this.rootPath.length).split(i);if(u.length===1&&!u[0]&&u.pop(),n===void 0)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=n,this.root=this.newRoot(this.#i),this.roots[this.rootPath]=this.root;let l=this.root,f=u.length-1,h=t.sep,d=this.rootPath,g=!1;for(let w of u){let b=f--;l=l.child(w,{relative:new Array(b).fill("..").join(h),relativePosix:new Array(b).fill("..").join("/"),fullpath:d+=(g?"":h)+w}),g=!0}this.cwd=l}depth(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.depth()}childrenCache(){return this.#s}resolve(...e){let t="";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(!a||a===".")&&(t=t?`${a}/${t}`:a,this.isAbsolute(a)))break}let i=this.#e.get(t);if(i!==void 0)return i;let n=this.cwd.resolve(t).fullpath();return this.#e.set(t,n),n}resolvePosix(...e){let t="";for(let s=e.length-1;s>=0;s--){let a=e[s];if(!(!a||a===".")&&(t=t?`${a}/${t}`:a,this.isAbsolute(a)))break}let i=this.#t.get(t);if(i!==void 0)return i;let n=this.cwd.resolve(t).fullpathPosix();return this.#t.set(t,n),n}relative(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.relative()}relativePosix(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.relativePosix()}basename(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.name}dirname(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),(e.parent||e).fullpath()}async readdir(e=this.cwd,t={withFileTypes:!0}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i}=t;if(e.canReaddir()){let n=await e.readdir();return i?n:n.map(s=>s.name)}else return[]}readdirSync(e=this.cwd,t={withFileTypes:!0}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i=!0}=t;return e.canReaddir()?i?e.readdirSync():e.readdirSync().map(n=>n.name):[]}async lstat(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.lstat()}lstatSync(e=this.cwd){return typeof e=="string"&&(e=this.cwd.resolve(e)),e.lstatSync()}async readlink(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e.withFileTypes,e=this.cwd);let i=await e.readlink();return t?i:i?.fullpath()}readlinkSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e.withFileTypes,e=this.cwd);let i=e.readlinkSync();return t?i:i?.fullpath()}async realpath(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e.withFileTypes,e=this.cwd);let i=await e.realpath();return t?i:i?.fullpath()}realpathSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e.withFileTypes,e=this.cwd);let i=e.realpathSync();return t?i:i?.fullpath()}async walk(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=[];(!s||s(e))&&c.push(i?e:e.fullpath());let u=new Set,l=o((h,d)=>{u.add(h),h.readdirCB((g,w)=>{if(g)return d(g);let b=w.length;if(!b)return d();let x=o(()=>{--b===0&&d()},"next");for(let O of w)(!s||s(O))&&c.push(i?O:O.fullpath()),n&&O.isSymbolicLink()?O.realpath().then(F=>F?.isUnknown()?F.lstat():F).then(F=>F?.shouldWalk(u,a)?l(F,x):x()):O.shouldWalk(u,a)?l(O,x):x()},!0)},"walk"),f=e;return new Promise((h,d)=>{l(f,g=>{if(g)return d(g);h(c)})})}walkSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=[];(!s||s(e))&&c.push(i?e:e.fullpath());let u=new Set([e]);for(let l of u){let f=l.readdirSync();for(let h of f){(!s||s(h))&&c.push(i?h:h.fullpath());let d=h;if(h.isSymbolicLink()){if(!(n&&(d=h.realpathSync())))continue;d.isUnknown()&&d.lstatSync()}d.shouldWalk(u,a)&&u.add(d)}}return c}[Symbol.asyncIterator](){return this.iterate()}iterate(e=this.cwd,t={}){return typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd),this.stream(e,t)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t;(!s||s(e))&&(yield i?e:e.fullpath());let c=new Set([e]);for(let u of c){let l=u.readdirSync();for(let f of l){(!s||s(f))&&(yield i?f:f.fullpath());let h=f;if(f.isSymbolicLink()){if(!(n&&(h=f.realpathSync())))continue;h.isUnknown()&&h.lstatSync()}h.shouldWalk(c,a)&&c.add(h)}}}stream(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=new Bn({objectMode:!0});(!s||s(e))&&c.write(i?e:e.fullpath());let u=new Set,l=[e],f=0,h=o(()=>{let d=!1;for(;!d;){let g=l.shift();if(!g){f===0&&c.end();return}f++,u.add(g);let w=o((x,O,F=!1)=>{if(x)return c.emit("error",x);if(n&&!F){let k=[];for(let G of O)G.isSymbolicLink()&&k.push(G.realpath().then(W=>W?.isUnknown()?W.lstat():W));if(k.length){Promise.all(k).then(()=>w(null,O,!0));return}}for(let k of O)k&&(!s||s(k))&&(c.write(i?k:k.fullpath())||(d=!0));f--;for(let k of O){let G=k.realpathCached()||k;G.shouldWalk(u,a)&&l.push(G)}d&&!c.flowing?c.once("drain",h):b||h()},"onReaddir"),b=!0;g.readdirCB(w,!0),b=!1}},"process");return h(),c}streamSync(e=this.cwd,t={}){typeof e=="string"?e=this.cwd.resolve(e):e instanceof er||(t=e,e=this.cwd);let{withFileTypes:i=!0,follow:n=!1,filter:s,walkFilter:a}=t,c=new Bn({objectMode:!0}),u=new Set;(!s||s(e))&&c.write(i?e:e.fullpath());let l=[e],f=0,h=o(()=>{let d=!1;for(;!d;){let g=l.shift();if(!g){f===0&&c.end();return}f++,u.add(g);let w=g.readdirSync();for(let b of w)(!s||s(b))&&(c.write(i?b:b.fullpath())||(d=!0));f--;for(let b of w){let x=b;if(b.isSymbolicLink()){if(!(n&&(x=b.realpathSync())))continue;x.isUnknown()&&x.lstatSync()}x.shouldWalk(u,a)&&l.push(x)}}d&&!c.flowing&&c.once("drain",h)},"process");return h(),c}chdir(e=this.cwd){let t=this.cwd;this.cwd=typeof e=="string"?this.cwd.resolve(e):e,this.cwd[Yb](t)}},za=class extends xf{static{o(this,"PathScurryWin32")}sep="\\";constructor(e=process.cwd(),t={}){let{nocase:i=!0}=t;super(e,Wa.win32,"\\",{...t,nocase:i}),this.nocase=i;for(let n=this.cwd;n;n=n.parent)n.nocase=this.nocase}parseRootPath(e){return Wa.win32.parse(e).root.toUpperCase()}newRoot(e){return new Tf(this.rootPath,Bi,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")||e.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(e)}},Ha=class extends xf{static{o(this,"PathScurryPosix")}sep="/";constructor(e=process.cwd(),t={}){let{nocase:i=!1}=t;super(e,Wa.posix,"/",{...t,nocase:i}),this.nocase=i}parseRootPath(e){return"/"}newRoot(e){return new Af(this.rootPath,Bi,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")}},hc=class extends Ha{static{o(this,"PathScurryDarwin")}constructor(e=process.cwd(),t={}){let{nocase:i=!0}=t;super(e,{...t,nocase:i})}},RU=process.platform==="win32"?Tf:Af,Xb=process.platform==="win32"?za:process.platform==="darwin"?hc:Ha;var v7=o(r=>r.length>=1,"isPatternList"),_7=o(r=>r.length>=1,"isGlobList"),Ka=class r{static{o(this,"Pattern")}#e;#t;#s;length;#i;#a;#w;#u;#f;#o;#c=!0;constructor(e,t,i,n){if(!v7(e))throw new TypeError("empty pattern list");if(!_7(t))throw new TypeError("empty glob list");if(t.length!==e.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=e.length,i<0||i>=this.length)throw new TypeError("index out of range");if(this.#e=e,this.#t=t,this.#s=i,this.#i=n,this.#s===0){if(this.isUNC()){let[s,a,c,u,...l]=this.#e,[f,h,d,g,...w]=this.#t;l[0]===""&&(l.shift(),w.shift());let b=[s,a,c,u,""].join("/"),x=[f,h,d,g,""].join("/");this.#e=[b,...l],this.#t=[x,...w],this.length=this.#e.length}else if(this.isDrive()||this.isAbsolute()){let[s,...a]=this.#e,[c,...u]=this.#t;a[0]===""&&(a.shift(),u.shift());let l=s+"/",f=c+"/";this.#e=[l,...a],this.#t=[f,...u],this.length=this.#e.length}}}pattern(){return this.#e[this.#s]}isString(){return typeof this.#e[this.#s]=="string"}isGlobstar(){return this.#e[this.#s]===qt}isRegExp(){return this.#e[this.#s]instanceof RegExp}globString(){return this.#w=this.#w||(this.#s===0?this.isAbsolute()?this.#t[0]+this.#t.slice(1).join("/"):this.#t.join("/"):this.#t.slice(this.#s).join("/"))}hasMore(){return this.length>this.#s+1}rest(){return this.#a!==void 0?this.#a:this.hasMore()?(this.#a=new r(this.#e,this.#t,this.#s+1,this.#i),this.#a.#o=this.#o,this.#a.#f=this.#f,this.#a.#u=this.#u,this.#a):this.#a=null}isUNC(){let e=this.#e;return this.#f!==void 0?this.#f:this.#f=this.#i==="win32"&&this.#s===0&&e[0]===""&&e[1]===""&&typeof e[2]=="string"&&!!e[2]&&typeof e[3]=="string"&&!!e[3]}isDrive(){let e=this.#e;return this.#u!==void 0?this.#u:this.#u=this.#i==="win32"&&this.#s===0&&this.length>1&&typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0])}isAbsolute(){let e=this.#e;return this.#o!==void 0?this.#o:this.#o=e[0]===""&&e.length>1||this.isDrive()||this.isUNC()}root(){let e=this.#e[0];return typeof e=="string"&&this.isAbsolute()&&this.#s===0?e:""}checkFollowGlobstar(){return!(this.#s===0||!this.isGlobstar()||!this.#c)}markFollowGlobstar(){return this.#s===0||!this.isGlobstar()||!this.#c?!1:(this.#c=!1,!0)}};var w7=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",Qa=class{static{o(this,"Ignore")}relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(e,{nobrace:t,nocase:i,noext:n,noglobstar:s,platform:a=w7}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=a,this.mmopts={dot:!0,nobrace:t,nocase:i,noext:n,noglobstar:s,optimizationLevel:2,platform:a,nocomment:!0,nonegate:!0};for(let c of e)this.add(c)}add(e){let t=new Rr(e,this.mmopts);for(let i=0;i<t.set.length;i++){let n=t.set[i],s=t.globParts[i];if(!n||!s)throw new Error("invalid pattern object");for(;n[0]==="."&&s[0]===".";)n.shift(),s.shift();let a=new Ka(n,s,0,this.platform),c=new Rr(a.globString(),this.mmopts),u=s[s.length-1]==="**",l=a.isAbsolute();l?this.absolute.push(c):this.relative.push(c),u&&(l?this.absoluteChildren.push(c):this.relativeChildren.push(c))}}ignored(e){let t=e.fullpath(),i=`${t}/`,n=e.relative()||".",s=`${n}/`;for(let a of this.relative)if(a.match(n)||a.match(s))return!0;for(let a of this.absolute)if(a.match(t)||a.match(i))return!0;return!1}childrenIgnored(e){let t=e.fullpath()+"/",i=(e.relative()||".")+"/";for(let n of this.relativeChildren)if(n.match(i))return!0;for(let n of this.absoluteChildren)if(n.match(t))return!0;return!1}};var f1=class r{static{o(this,"HasWalkedCache")}store;constructor(e=new Map){this.store=e}copy(){return new r(new Map(this.store))}hasWalked(e,t){return this.store.get(e.fullpath())?.has(t.globString())}storeWalked(e,t){let i=e.fullpath(),n=this.store.get(i);n?n.add(t.globString()):this.store.set(i,new Set([t.globString()]))}},h1=class{static{o(this,"MatchRecord")}store=new Map;add(e,t,i){let n=(t?2:0)|(i?1:0),s=this.store.get(e);this.store.set(e,s===void 0?n:n&s)}entries(){return[...this.store.entries()].map(([e,t])=>[e,!!(t&2),!!(t&1)])}},d1=class{static{o(this,"SubWalks")}store=new Map;add(e,t){if(!e.canReaddir())return;let i=this.store.get(e);i?i.find(n=>n.globString()===t.globString())||i.push(t):this.store.set(e,[t])}get(e){let t=this.store.get(e);if(!t)throw new Error("attempting to walk unknown path");return t}entries(){return this.keys().map(e=>[e,this.store.get(e)])}keys(){return[...this.store.keys()].filter(e=>e.canReaddir())}},dc=class r{static{o(this,"Processor")}hasWalkedCache;matches=new h1;subwalks=new d1;patterns;follow;dot;opts;constructor(e,t){this.opts=e,this.follow=!!e.follow,this.dot=!!e.dot,this.hasWalkedCache=t?t.copy():new f1}processPatterns(e,t){this.patterns=t;let i=t.map(n=>[e,n]);for(let[n,s]of i){this.hasWalkedCache.storeWalked(n,s);let a=s.root(),c=s.isAbsolute()&&this.opts.absolute!==!1;if(a){n=n.resolve(a==="/"&&this.opts.root!==void 0?this.opts.root:a);let h=s.rest();if(h)s=h;else{this.matches.add(n,!0,!1);continue}}if(n.isENOENT())continue;let u,l,f=!1;for(;typeof(u=s.pattern())=="string"&&(l=s.rest());)n=n.resolve(u),s=l,f=!0;if(u=s.pattern(),l=s.rest(),f){if(this.hasWalkedCache.hasWalked(n,s))continue;this.hasWalkedCache.storeWalked(n,s)}if(typeof u=="string"){let h=u===".."||u===""||u===".";this.matches.add(n.resolve(u),c,h);continue}else if(u===qt){(!n.isSymbolicLink()||this.follow||s.checkFollowGlobstar())&&this.subwalks.add(n,s);let h=l?.pattern(),d=l?.rest();if(!l||(h===""||h===".")&&!d)this.matches.add(n,c,h===""||h===".");else if(h===".."){let g=n.parent||n;d?this.hasWalkedCache.hasWalked(g,d)||this.subwalks.add(g,d):this.matches.add(g,c,!0)}}else u instanceof RegExp&&this.subwalks.add(n,s)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new r(this.opts,this.hasWalkedCache)}filterEntries(e,t){let i=this.subwalks.get(e),n=this.child();for(let s of t)for(let a of i){let c=a.isAbsolute(),u=a.pattern(),l=a.rest();u===qt?n.testGlobstar(s,a,l,c):u instanceof RegExp?n.testRegExp(s,u,l,c):n.testString(s,u,l,c)}return n}testGlobstar(e,t,i,n){if((this.dot||!e.name.startsWith("."))&&(t.hasMore()||this.matches.add(e,n,!1),e.canReaddir()&&(this.follow||!e.isSymbolicLink()?this.subwalks.add(e,t):e.isSymbolicLink()&&(i&&t.checkFollowGlobstar()?this.subwalks.add(e,i):t.markFollowGlobstar()&&this.subwalks.add(e,t)))),i){let s=i.pattern();if(typeof s=="string"&&s!==".."&&s!==""&&s!==".")this.testString(e,s,i.rest(),n);else if(s===".."){let a=e.parent||e;this.subwalks.add(a,i)}else s instanceof RegExp&&this.testRegExp(e,s,i.rest(),n)}}testRegExp(e,t,i,n){t.test(e.name)&&(i?this.subwalks.add(e,i):this.matches.add(e,n,!1))}testString(e,t,i,n){e.isNamed(t)&&(i?this.subwalks.add(e,i):this.matches.add(e,n,!1))}};var b7=o((r,e)=>typeof r=="string"?new Qa([r],e):Array.isArray(r)?new Qa(r,e):r,"makeIgnore"),Cf=class{static{o(this,"GlobUtil")}path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#e=[];#t;#s;signal;maxDepth;includeChildMatches;constructor(e,t,i){if(this.patterns=e,this.path=t,this.opts=i,this.#s=!i.posix&&i.platform==="win32"?"\\":"/",this.includeChildMatches=i.includeChildMatches!==!1,(i.ignore||!this.includeChildMatches)&&(this.#t=b7(i.ignore??[],i),!this.includeChildMatches&&typeof this.#t.add!="function")){let n="cannot ignore child matches, ignore lacks add() method.";throw new Error(n)}this.maxDepth=i.maxDepth||1/0,i.signal&&(this.signal=i.signal,this.signal.addEventListener("abort",()=>{this.#e.length=0}))}#i(e){return this.seen.has(e)||!!this.#t?.ignored?.(e)}#a(e){return!!this.#t?.childrenIgnored?.(e)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;this.paused=!1;let e;for(;!this.paused&&(e=this.#e.shift());)e()}onResume(e){this.signal?.aborted||(this.paused?this.#e.push(e):e())}async matchCheck(e,t){if(t&&this.opts.nodir)return;let i;if(this.opts.realpath){if(i=e.realpathCached()||await e.realpath(),!i)return;e=i}let s=e.isUnknown()||this.opts.stat?await e.lstat():e;if(this.opts.follow&&this.opts.nodir&&s?.isSymbolicLink()){let a=await s.realpath();a&&(a.isUnknown()||this.opts.stat)&&await a.lstat()}return this.matchCheckTest(s,t)}matchCheckTest(e,t){return e&&(this.maxDepth===1/0||e.depth()<=this.maxDepth)&&(!t||e.canReaddir())&&(!this.opts.nodir||!e.isDirectory())&&(!this.opts.nodir||!this.opts.follow||!e.isSymbolicLink()||!e.realpathCached()?.isDirectory())&&!this.#i(e)?e:void 0}matchCheckSync(e,t){if(t&&this.opts.nodir)return;let i;if(this.opts.realpath){if(i=e.realpathCached()||e.realpathSync(),!i)return;e=i}let s=e.isUnknown()||this.opts.stat?e.lstatSync():e;if(this.opts.follow&&this.opts.nodir&&s?.isSymbolicLink()){let a=s.realpathSync();a&&(a?.isUnknown()||this.opts.stat)&&a.lstatSync()}return this.matchCheckTest(s,t)}matchFinish(e,t){if(this.#i(e))return;if(!this.includeChildMatches&&this.#t?.add){let s=`${e.relativePosix()}/**`;this.#t.add(s)}let i=this.opts.absolute===void 0?t:this.opts.absolute;this.seen.add(e);let n=this.opts.mark&&e.isDirectory()?this.#s:"";if(this.opts.withFileTypes)this.matchEmit(e);else if(i){let s=this.opts.posix?e.fullpathPosix():e.fullpath();this.matchEmit(s+n)}else{let s=this.opts.posix?e.relativePosix():e.relative(),a=this.opts.dotRelative&&!s.startsWith(".."+this.#s)?"."+this.#s:"";this.matchEmit(s?a+s+n:"."+n)}}async match(e,t,i){let n=await this.matchCheck(e,i);n&&this.matchFinish(n,t)}matchSync(e,t,i){let n=this.matchCheckSync(e,i);n&&this.matchFinish(n,t)}walkCB(e,t,i){this.signal?.aborted&&i(),this.walkCB2(e,t,new dc(this.opts),i)}walkCB2(e,t,i,n){if(this.#a(e))return n();if(this.signal?.aborted&&n(),this.paused){this.onResume(()=>this.walkCB2(e,t,i,n));return}i.processPatterns(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,l]of i.matches.entries())this.#i(c)||(s++,this.match(c,u,l).then(()=>a()));for(let c of i.subwalkTargets()){if(this.maxDepth!==1/0&&c.depth()>=this.maxDepth)continue;s++;let u=c.readdirCached();c.calledReaddir()?this.walkCB3(c,u,i,a):c.readdirCB((l,f)=>this.walkCB3(c,f,i,a),!0)}a()}walkCB3(e,t,i,n){i=i.filterEntries(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,l]of i.matches.entries())this.#i(c)||(s++,this.match(c,u,l).then(()=>a()));for(let[c,u]of i.subwalks.entries())s++,this.walkCB2(c,u,i.child(),a);a()}walkCBSync(e,t,i){this.signal?.aborted&&i(),this.walkCB2Sync(e,t,new dc(this.opts),i)}walkCB2Sync(e,t,i,n){if(this.#a(e))return n();if(this.signal?.aborted&&n(),this.paused){this.onResume(()=>this.walkCB2Sync(e,t,i,n));return}i.processPatterns(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,l]of i.matches.entries())this.#i(c)||this.matchSync(c,u,l);for(let c of i.subwalkTargets()){if(this.maxDepth!==1/0&&c.depth()>=this.maxDepth)continue;s++;let u=c.readdirSync();this.walkCB3Sync(c,u,i,a)}a()}walkCB3Sync(e,t,i,n){i=i.filterEntries(e,t);let s=1,a=o(()=>{--s===0&&n()},"next");for(let[c,u,l]of i.matches.entries())this.#i(c)||this.matchSync(c,u,l);for(let[c,u]of i.subwalks.entries())s++,this.walkCB2Sync(c,u,i.child(),a);a()}},pc=class extends Cf{static{o(this,"GlobWalker")}matches=new Set;constructor(e,t,i){super(e,t,i)}matchEmit(e){this.matches.add(e)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((e,t)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?t(this.signal.reason):e(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},mc=class extends Cf{static{o(this,"GlobStream")}results;constructor(e,t,i){super(e,t,i),this.results=new Bn({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(e){this.results.write(e),this.results.flowing||this.pause()}stream(){let e=this.path;return e.isUnknown()?e.lstat().then(()=>{this.walkCB(e,this.patterns,()=>this.results.end())}):this.walkCB(e,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}};var S7=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",vi=class{static{o(this,"Glob")}absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(e,t){if(!t)throw new TypeError("glob options required");if(this.withFileTypes=!!t.withFileTypes,this.signal=t.signal,this.follow=!!t.follow,this.dot=!!t.dot,this.dotRelative=!!t.dotRelative,this.nodir=!!t.nodir,this.mark=!!t.mark,t.cwd?(t.cwd instanceof URL||t.cwd.startsWith("file://"))&&(t.cwd=(0,Jb.fileURLToPath)(t.cwd)):this.cwd="",this.cwd=t.cwd||"",this.root=t.root,this.magicalBraces=!!t.magicalBraces,this.nobrace=!!t.nobrace,this.noext=!!t.noext,this.realpath=!!t.realpath,this.absolute=t.absolute,this.includeChildMatches=t.includeChildMatches!==!1,this.noglobstar=!!t.noglobstar,this.matchBase=!!t.matchBase,this.maxDepth=typeof t.maxDepth=="number"?t.maxDepth:1/0,this.stat=!!t.stat,this.ignore=t.ignore,this.withFileTypes&&this.absolute!==void 0)throw new Error("cannot set absolute and withFileTypes:true");if(typeof e=="string"&&(e=[e]),this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(e=e.map(u=>u.replace(/\\/g,"/"))),this.matchBase){if(t.noglobstar)throw new TypeError("base matching requires globstar");e=e.map(u=>u.includes("/")?u:`./**/${u}`)}if(this.pattern=e,this.platform=t.platform||S7,this.opts={...t,platform:this.platform},t.scurry){if(this.scurry=t.scurry,t.nocase!==void 0&&t.nocase!==t.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{let u=t.platform==="win32"?za:t.platform==="darwin"?hc:t.platform?Ha:Xb;this.scurry=new u(this.cwd,{nocase:t.nocase,fs:t.fs})}this.nocase=this.scurry.nocase;let i=this.platform==="darwin"||this.platform==="win32",n={...t,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:i,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},s=this.pattern.map(u=>new Rr(u,n)),[a,c]=s.reduce((u,l)=>(u[0].push(...l.set),u[1].push(...l.globParts),u),[[],[]]);this.patterns=a.map((u,l)=>{let f=c[l];if(!f)throw new Error("invalid pattern object");return new Ka(u,f,0,this.platform)})}async walk(){return[...await new pc(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new pc(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new mc(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new mc(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};var p1=o((r,e={})=>{Array.isArray(r)||(r=[r]);for(let t of r)if(new Rr(t,e).hasMagic())return!0;return!1},"hasMagic");function Pf(r,e={}){return new vi(r,e).streamSync()}o(Pf,"globStreamSync");function eS(r,e={}){return new vi(r,e).stream()}o(eS,"globStream");function tS(r,e={}){return new vi(r,e).walkSync()}o(tS,"globSync");async function Zb(r,e={}){return new vi(r,e).walk()}o(Zb,"glob_");function Ff(r,e={}){return new vi(r,e).iterateSync()}o(Ff,"globIterateSync");function rS(r,e={}){return new vi(r,e).iterate()}o(rS,"globIterate");var E7=Pf,T7=Object.assign(eS,{sync:Pf}),A7=Ff,x7=Object.assign(rS,{sync:Ff}),C7=Object.assign(tS,{stream:Pf,iterate:Ff}),Of=Object.assign(Zb,{glob:Zb,globSync:tS,sync:C7,globStream:eS,stream:T7,globStreamSync:Pf,streamSync:E7,globIterate:rS,iterate:x7,globIterateSync:Ff,iterateSync:A7,Glob:vi,hasMagic:p1,escape:$a,unescape:mi});Of.glob=Of;var Ns=Ye(Dn());var Wn=class{constructor(e){this.rootPath=e}static{o(this,"NodeFsAdapter")}async readFile(e){let t=this.resolvePath(e);if(!await Tt.default.pathExists(t))throw new Ns.FileNotFoundError(e);return Tt.default.readFile(t,"utf-8")}async fileExists(e){let t=this.resolvePath(e);return Tt.default.pathExists(t)}async getFileMetadata(e){let t=await this.readFile(e);return this.extractFrontmatter(t)}async createFile(e,t){let i=this.resolvePath(e);if(await Tt.default.pathExists(i))throw new Ns.FileAlreadyExistsError(e);return await Tt.default.ensureDir(Gn.default.dirname(i)),await Tt.default.writeFile(i,t,"utf-8"),e}async updateFile(e,t){let i=this.resolvePath(e);if(!await Tt.default.pathExists(i))throw new Ns.FileNotFoundError(e);await Tt.default.writeFile(i,t,"utf-8")}async writeFile(e,t){let i=this.resolvePath(e);await Tt.default.ensureDir(Gn.default.dirname(i)),await Tt.default.writeFile(i,t,"utf-8")}async deleteFile(e){let t=this.resolvePath(e);if(!await Tt.default.pathExists(t))throw new Ns.FileNotFoundError(e);await Tt.default.remove(t)}async renameFile(e,t){let i=this.resolvePath(e),n=this.resolvePath(t);if(!await Tt.default.pathExists(i))throw new Ns.FileNotFoundError(e);await Tt.default.ensureDir(Gn.default.dirname(n)),await Tt.default.move(i,n)}async createDirectory(e){let t=this.resolvePath(e);await Tt.default.ensureDir(t)}async directoryExists(e){let t=this.resolvePath(e);return await Tt.default.pathExists(t)?(await Tt.default.stat(t)).isDirectory():!1}async getMarkdownFiles(e){let t=e?this.resolvePath(e):this.rootPath,i=Gn.default.join(t,"**/*.md");return(await Of(i,{nodir:!0})).map(a=>Gn.default.relative(this.rootPath,a))}async findFilesByMetadata(e){let t=await this.getMarkdownFiles(),i=[];for(let n of t)try{let s=await this.getFileMetadata(n);this.matchesQuery(s,e)&&i.push(n)}catch{continue}return i}async findFileByUID(e){let t=await this.findFilesByMetadata({exo__Asset_uid:e});return t.length>0?t[0]:null}resolvePath(e){return Gn.default.isAbsolute(e)?e:Gn.default.join(this.rootPath,e)}extractFrontmatter(e){let t=/^---\n([\s\S]*?)\n---/,i=e.match(t);if(!i)return{};try{let n=Yo.load(i[1]);return typeof n=="object"&&n!==null?n:{}}catch{return{}}}matchesQuery(e,t){for(let[i,n]of Object.entries(t)){let s=e[i];if(Array.isArray(s)){if(!s.some(a=>this.normalizeValue(a)===this.normalizeValue(n)))return!1}else if(this.normalizeValue(s)!==this.normalizeValue(n))return!1}return!0}normalizeValue(e){return e==null?"":String(e).replace(/["'[\]]/g,"").trim()}};var gc=Ye(require("path")),m1=Ye(Na());var Ya=class{constructor(e){this.vaultRoot=e}static{o(this,"PathResolver")}resolve(e){if(!gc.default.isAbsolute(e))return gc.default.resolve(this.vaultRoot,e);let t=gc.default.resolve(e),i=gc.default.resolve(this.vaultRoot);if(!t.startsWith(i))throw new rt(`File path ${e} is outside vault root ${this.vaultRoot}`,"Provide a file path within the vault directory.",{filepath:e,vaultRoot:this.vaultRoot});return t}validate(e){if(!m1.default.existsSync(e))throw new Jo(e);if(!m1.default.statSync(e).isFile())throw new rt(`Not a file: ${e}`,"Provide a path to a file, not a directory.",{filepath:e});if(!e.endsWith(".md"))throw new rt(`Not a Markdown file: ${e}`,"Provide a path to a .md file.",{filepath:e})}getVaultRoot(){return this.vaultRoot}};var cS=Ye(Dn());var iS=Ye(Dn());var _i=class{static{o(this,"BaseCommandExecutor")}constructor(e){this.pathResolver=e.pathResolver,this.fsAdapter=e.fsAdapter,this.frontmatterService=e.frontmatterService,this.dryRun=e.dryRun}resolveAndValidate(e){let t=this.pathResolver.resolve(e);this.pathResolver.validate(t);let i=t.replace(this.pathResolver.getVaultRoot()+"/","");return{resolvedPath:t,relativePath:i}}getCurrentTimestamp(){return iS.DateFormatter.toLocalTimestamp(new Date)}isAssetArchived(e){if(e?.exo__Asset_isArchived===!0)return!0;let t=e?.archived;if(t==null)return!1;if(typeof t=="boolean")return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){let i=t.toLowerCase().trim();return i==="true"||i==="yes"||i==="1"}return!1}extractAliasesFromFrontmatter(e){let t=e.match(/aliases:\s*\n((?:  - .*\n?)*)/);return t?t[1].split(`
`).filter(n=>n.trim()).map(n=>n.replace(/^\s*-\s*/,"").trim()):[]}};var yc=class extends _i{static{o(this,"StatusCommandExecutor")}constructor(e){super(e)}async executeStart(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_startTimestamp",n),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Started: ${e}`),console.log("   Status: Doing"),console.log(`   Start time: ${n}`),process.exit(0)}catch(t){ge.handle(t)}}async executeComplete(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_endTimestamp",n),s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Completed: ${e}`),console.log("   Status: Done"),console.log(`   Completion time: ${n}`),process.exit(0)}catch(t){ge.handle(t)}}async executeTrash(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(t,s),console.log(`\u2705 Trashed: ${e}`),console.log("   Status: Trashed"),console.log(`   Resolution time: ${n}`),process.exit(0)}catch(t){ge.handle(t)}}async executeArchive(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.readFile(t),n=this.frontmatterService.updateProperty(i,"archived","true");n=this.frontmatterService.removeProperty(n,"aliases"),await this.fsAdapter.updateFile(t,n),console.log(`\u2705 Archived: ${e}`),console.log("   Archived: true"),console.log("   Aliases removed"),process.exit(0)}catch(t){ge.handle(t)}}async executeMoveToBacklog(e){try{await this.updateStatus(e,"ems__EffortStatusBacklog","Backlog"),process.exit(0)}catch(t){ge.handle(t)}}async executeMoveToAnalysis(e){try{await this.updateStatus(e,"ems__EffortStatusAnalysis","Analysis"),process.exit(0)}catch(t){ge.handle(t)}}async executeMoveToToDo(e){try{await this.updateStatus(e,"ems__EffortStatusToDo","ToDo"),process.exit(0)}catch(t){ge.handle(t)}}async updateStatus(e,t,i){let{relativePath:n}=this.resolveAndValidate(e),s=await this.fsAdapter.readFile(n),a=this.frontmatterService.updateProperty(s,"ems__Effort_status",`"[[${t}]]"`);await this.fsAdapter.updateFile(n,a),console.log(`\u2705 Moved to ${i}: ${e}`),console.log(`   Status: ${i}`)}};var Ut=[];for(let r=0;r<256;++r)Ut.push((r+256).toString(16).slice(1));function nS(r,e=0){return(Ut[r[e+0]]+Ut[r[e+1]]+Ut[r[e+2]]+Ut[r[e+3]]+"-"+Ut[r[e+4]]+Ut[r[e+5]]+"-"+Ut[r[e+6]]+Ut[r[e+7]]+"-"+Ut[r[e+8]]+Ut[r[e+9]]+"-"+Ut[r[e+10]]+Ut[r[e+11]]+Ut[r[e+12]]+Ut[r[e+13]]+Ut[r[e+14]]+Ut[r[e+15]]).toLowerCase()}o(nS,"unsafeStringify");var sS=require("node:crypto");var Rf=new Uint8Array(256),If=Rf.length;function g1(){return If>Rf.length-16&&((0,sS.randomFillSync)(Rf),If=0),Rf.slice(If,If+=16)}o(g1,"rng");var aS=require("node:crypto"),y1={randomUUID:aS.randomUUID};function P7(r,e,t){r=r||{};let i=r.random??r.rng?.()??g1();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){if(t=t||0,t<0||t+16>e.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let n=0;n<16;++n)e[t+n]=i[n];return e}return nS(i)}o(P7,"_v4");function F7(r,e,t){return y1.randomUUID&&!e&&!r?y1.randomUUID():P7(r,e,t)}o(F7,"v4");var v1=F7;var Xa=Ye(Dn());var vc=class extends _i{static{o(this,"AssetCreationExecutor")}constructor(e){super(e)}async executeCreateTask(e,t,i={}){try{await this.createAsset(e,t,"ems__Task",i),process.exit(0)}catch(n){ge.handle(n)}}async executeCreateMeeting(e,t,i={}){try{await this.createAsset(e,t,"ems__Meeting",i),process.exit(0)}catch(n){ge.handle(n)}}async executeCreateProject(e,t,i={}){try{await this.createAsset(e,t,"ems__Project",i),process.exit(0)}catch(n){ge.handle(n)}}async executeCreateArea(e,t,i={}){try{await this.createAsset(e,t,"ems__Area",i),process.exit(0)}catch(n){ge.handle(n)}}async createAsset(e,t,i,n={}){if(!t||t.trim().length===0)throw new Error("Label cannot be empty");let s=t.trim(),{relativePath:a}=this.resolveAndValidate(e);if(await this.fsAdapter.fileExists(a))throw new Xa.FileAlreadyExistsError(e);let u=v1(),l=this.buildAssetFrontmatter(i,u,s,n),f=Xa.MetadataHelpers.buildFileContent(l);await this.fsAdapter.createFile(a,f),console.log(`\u2705 Created ${this.getAssetTypeName(i)}: ${e}`),console.log(`   UID: ${u}`),console.log(`   Label: ${s}`),console.log(`   Class: ${i}`)}buildAssetFrontmatter(e,t,i,n={}){let s=Xa.DateFormatter.toLocalTimestamp(new Date),a={exo__Asset_isDefinedBy:'"[[Ontology/EMS]]"',exo__Asset_uid:t,exo__Asset_label:i,exo__Asset_createdAt:s,exo__Instance_class:[`"[[${e}]]"`],aliases:[i]};return(e==="ems__Task"||e==="ems__Project"||e==="ems__Meeting")&&(a.ems__Effort_status='"[[ems__EffortStatusDraft]]"'),n.prototype&&(a.ems__Effort_prototype=`"[[${n.prototype}]]"`),n.area&&(a.ems__Effort_area=`"[[${n.area}]]"`),n.parent&&(a.ems__Effort_parent=`"[[${n.parent}]]"`),a}getAssetTypeName(e){return{ems__Task:"task",ems__Meeting:"meeting",ems__Project:"project",ems__Area:"area"}[e]||"asset"}};var _1=Ye(require("path"));var oS=Ye(Dn());var _c=class extends _i{static{o(this,"PropertyCommandExecutor")}constructor(e){super(e)}async executeRenameToUid(e){try{let{relativePath:t}=this.resolveAndValidate(e),i=await this.fsAdapter.getFileMetadata(t);if(!i.exo__Asset_uid)throw new Error("Asset missing exo__Asset_uid property");let n=_1.default.basename(t,".md"),s=i.exo__Asset_uid;if(n===s&&(console.log(`\u2705 Already renamed: ${e}`),console.log(`   Current filename matches UID: ${s}.md`),process.exit(0)),!i.exo__Asset_label||i.exo__Asset_label.trim()===""){let u=await this.fsAdapter.readFile(t),l=this.frontmatterService.updateProperty(u,"exo__Asset_label",n),f=this.isAssetArchived(i),h=l;f||(h=this.frontmatterService.updateProperty(l,"aliases",`
  - ${n}`)),await this.fsAdapter.updateFile(t,h),console.log(`   Updated label: "${n}"`)}let a=_1.default.dirname(t),c=a!=="."?`${a}/${s}.md`:`${s}.md`;await this.fsAdapter.renameFile(t,c),console.log("\u2705 Renamed to UID format"),console.log(`   Old: ${t}`),console.log(`   New: ${c}`),process.exit(0)}catch(t){ge.handle(t)}}async executeUpdateLabel(e,t){try{if(!t||t.trim().length===0)throw new Error("Label cannot be empty");let i=t.trim(),{relativePath:n}=this.resolveAndValidate(e),s=await this.fsAdapter.readFile(n),a=this.frontmatterService.updateProperty(s,"exo__Asset_label",i),c=this.frontmatterService.parse(a),u=this.extractAliasesFromFrontmatter(c.content);if(u.includes(i)||(u.length===0?a=this.frontmatterService.updateProperty(a,"aliases",`
  - ${i}`):a=this.frontmatterService.updateProperty(a,"aliases",`${u.map(l=>`
  - ${l}`).join("")}
  - ${i}`)),this.dryRun){if(console.log("\u{1F50D} DRY RUN: Preview of changes (not applied)"),console.log(`   File: ${e}`),console.log("   Changes:"),console.log(`     \u2022 exo__Asset_label: "${i}"`),u.includes(i))console.log("     \u2022 aliases: unchanged (label already present)");else{let l=u.length===0?[i]:[...u,i];console.log(`     \u2022 aliases: [${l.map(f=>`"${f}"`).join(", ")}]`)}console.log(`
\u{1F4A1} Run without --dry-run to apply changes`),process.exit(0)}await this.fsAdapter.updateFile(n,a),console.log("\u2705 Updated label"),console.log(`   File: ${e}`),console.log(`   New label: "${i}"`),console.log("   Aliases synchronized"),process.exit(0)}catch(i){ge.handle(i)}}async executeSchedule(e,t){try{await this.updatePlannedTimestamp(e,t,"ems__Effort_plannedStartTimestamp"),process.exit(0)}catch(i){ge.handle(i)}}async executeSetDeadline(e,t){try{await this.updatePlannedTimestamp(e,t,"ems__Effort_plannedEndTimestamp"),process.exit(0)}catch(i){ge.handle(i)}}async updatePlannedTimestamp(e,t,i){let{relativePath:n}=this.resolveAndValidate(e);if(!await this.fsAdapter.fileExists(n))throw new Error(`File not found: ${e}`);if(!/^\d{4}-\d{2}-\d{2}$/.test(t))throw new Error(`Invalid date format: ${t}. Expected YYYY-MM-DD (e.g., 2025-11-25)`);let a=oS.DateFormatter.toTimestampAtStartOfDay(t),c=await this.fsAdapter.readFile(n),u=this.frontmatterService.updateProperty(c,i,a);await this.fsAdapter.writeFile(n,u),console.log(`\u2705 ${i==="ems__Effort_plannedStartTimestamp"?"Scheduled":"Set deadline for"}: ${e}`),console.log(`   Date: ${t}`),console.log(`   Timestamp: ${a}`)}};var zn=Ye(require("path"));var wc=class extends _i{static{o(this,"FolderRepairExecutor")}constructor(e){super(e)}async executeRepairFolder(e){try{let{relativePath:t}=this.resolveAndValidate(e),n=(await this.fsAdapter.getFileMetadata(t))?.exo__Asset_isDefinedBy;if(!n)throw new Error("Cannot determine expected folder: missing exo__Asset_isDefinedBy");let s=this.extractReference(n);if(!s)throw new Error("Cannot determine expected folder: invalid exo__Asset_isDefinedBy format");let a=await this.findReferencedFile(s,t);if(!a)throw new Error(`Cannot determine expected folder: referenced asset not found: ${s}`);let c=zn.default.dirname(a),u=c==="."?"":c,l=zn.default.dirname(t),f=l==="."?"":l;if(this.normalizePath(f)===this.normalizePath(u))return console.log("\u2705 Already in correct folder"),console.log(`   File: ${e}`),console.log(`   Folder: ${u||"(root)"}`),process.exit(0),{moved:!1,oldPath:t,newPath:t,expectedFolder:u};if(this.dryRun){let w=zn.default.basename(t),b=u?`${u}/${w}`:w;return console.log("\u{1F50D} DRY RUN: Preview of changes (not applied)"),console.log(`   File: ${e}`),console.log(`   Current folder: ${f||"(root)"}`),console.log(`   Expected folder: ${u||"(root)"}`),console.log(`   Would move to: ${b}`),console.log(`
\u{1F4A1} Run without --dry-run to apply changes`),process.exit(0),{moved:!1,oldPath:t,newPath:b,expectedFolder:u}}let h=zn.default.basename(t),d=u?`${u}/${h}`:h;if(await this.fsAdapter.fileExists(d))throw new Error(`Cannot move file: ${d} already exists`);return u&&(await this.fsAdapter.directoryExists(u)||await this.fsAdapter.createDirectory(u)),await this.fsAdapter.renameFile(t,d),console.log("\u2705 Moved to correct folder"),console.log(`   Old path: ${t}`),console.log(`   New path: ${d}`),console.log(`   Expected folder: ${u||"(root)"}`),process.exit(0),{moved:!0,oldPath:t,newPath:d,expectedFolder:u}}catch(t){ge.handle(t)}}extractReference(e){if(typeof e!="string")return null;let t=e.trim().replace(/^["']|["']$/g,"");return t=t.replace(/^\[\[|\]\]$/g,""),t||null}async findReferencedFile(e,t){let i=e.endsWith(".md")?e:`${e}.md`;if(e.includes("/")&&await this.fsAdapter.fileExists(i))return i;let n=zn.default.dirname(t),s=n?`${n}/${i}`:i;if(await this.fsAdapter.fileExists(s))return s;let c=await this.fsAdapter.findFileByUID(e);return c||(await this.fsAdapter.getMarkdownFiles()).find(f=>{let h=zn.default.basename(f,".md"),d=zn.default.basename(i,".md");return h===d})||null}normalizePath(e){return e.replace(/\\/g,"/").replace(/^\.\//,"").replace(/\/$/,"")}};var Df=class{static{o(this,"CommandExecutor")}constructor(e,t=!1){this.context={pathResolver:new Ya(e),fsAdapter:new Wn(e),frontmatterService:new cS.FrontmatterService,dryRun:t},this.statusExecutor=new yc(this.context),this.creationExecutor=new vc(this.context),this.propertyExecutor=new _c(this.context),this.folderRepairExecutor=new wc(this.context)}async execute(e,t,i){try{let n=this.context.pathResolver.resolve(t);this.context.pathResolver.validate(n),await this.context.fsAdapter.readFile(n.replace(this.context.pathResolver.getVaultRoot()+"/","")),console.log("\u2705 Command infrastructure verified"),console.log(`   Command: ${e}`),console.log(`   File: ${n}`),console.log(`   Vault: ${this.context.pathResolver.getVaultRoot()}`),Object.keys(i).length>0&&console.log(`   Options: ${JSON.stringify(i,null,2)}`),console.log(`
\u{1F4DD} Note: Actual command execution will be implemented in follow-up issues.`),console.log("    This PR establishes the infrastructure foundation."),process.exit(0)}catch(n){ge.handle(n)}}getVaultRoot(){return this.context.pathResolver.getVaultRoot()}async executeStart(e){return this.statusExecutor.executeStart(e)}async executeComplete(e){return this.statusExecutor.executeComplete(e)}async executeTrash(e){return this.statusExecutor.executeTrash(e)}async executeArchive(e){return this.statusExecutor.executeArchive(e)}async executeMoveToBacklog(e){return this.statusExecutor.executeMoveToBacklog(e)}async executeMoveToAnalysis(e){return this.statusExecutor.executeMoveToAnalysis(e)}async executeMoveToToDo(e){return this.statusExecutor.executeMoveToToDo(e)}async executeCreateTask(e,t,i={}){return this.creationExecutor.executeCreateTask(e,t,i)}async executeCreateMeeting(e,t,i={}){return this.creationExecutor.executeCreateMeeting(e,t,i)}async executeCreateProject(e,t,i={}){return this.creationExecutor.executeCreateProject(e,t,i)}async executeCreateArea(e,t,i={}){return this.creationExecutor.executeCreateArea(e,t,i)}async executeRenameToUid(e){return this.propertyExecutor.executeRenameToUid(e)}async executeUpdateLabel(e,t){return this.propertyExecutor.executeUpdateLabel(e,t)}async executeSchedule(e,t){return this.propertyExecutor.executeSchedule(e,t)}async executeSetDeadline(e,t){return this.propertyExecutor.executeSetDeadline(e,t)}async executeRepairFolder(e){return this.folderRepairExecutor.executeRepairFolder(e)}};function Gt(r,e,t,i,n){if(r==="json"){let s={command:e,filepath:t,action:i,...n&&{changes:n}},a=lt.success(s);console.log(JSON.stringify(a,null,2))}else console.log(`\u2705 ${i}`)}o(Gt,"outputResult");function ks(r,e,t,i){let n=new rt(`--${e} option is required for ${t} command`,i,{command:t,missingOption:e});ge.handle(n)}o(ks,"handleMissingOption");function lS(){return new _r("command").description("Execute plugin command on single asset").argument("<command-name>","Command to execute (rename-to-uid, start, complete, schedule, set-deadline, etc.)").argument("<filepath>","Path to asset file (relative to vault root or absolute)").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--label <value>","Asset label (required for update-label and creation commands)").option("--prototype <uid>","Prototype UID for inheritance (creation commands)").option("--area <uid>","Area UID for effort linkage (creation commands)").option("--parent <uid>","Parent UID for effort linkage (creation commands)").option("--date <value>","Date in YYYY-MM-DD format (required for schedule and set-deadline commands)").option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").action(async(r,e,t)=>{let i=t.format||"text";ge.setFormat(i);try{let n=(0,uS.resolve)(t.vault),s=new Df(n,t.dryRun);switch(r){case"rename-to-uid":await s.executeRenameToUid(e),Gt(i,r,e,"Renamed file to UID-based name");break;case"update-label":t.label||ks(i,"label","update-label",'exocortex command update-label <filepath> --label "<value>"'),await s.executeUpdateLabel(e,t.label),Gt(i,r,e,`Updated label to "${t.label}"`,{label:t.label});break;case"start":await s.executeStart(e),Gt(i,r,e,"Started task");break;case"complete":await s.executeComplete(e),Gt(i,r,e,"Completed task");break;case"trash":await s.executeTrash(e),Gt(i,r,e,"Moved task to trash");break;case"archive":await s.executeArchive(e),Gt(i,r,e,"Archived task");break;case"move-to-backlog":await s.executeMoveToBacklog(e),Gt(i,r,e,"Moved task to backlog");break;case"move-to-analysis":await s.executeMoveToAnalysis(e),Gt(i,r,e,"Moved task to analysis");break;case"move-to-todo":await s.executeMoveToToDo(e),Gt(i,r,e,"Moved task to todo");break;case"create-task":t.label||ks(i,"label","create-task",'exocortex command create-task <filepath> --label "<value>"'),await s.executeCreateTask(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Gt(i,r,e,`Created task "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-meeting":t.label||ks(i,"label","create-meeting",'exocortex command create-meeting <filepath> --label "<value>"'),await s.executeCreateMeeting(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Gt(i,r,e,`Created meeting "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-project":t.label||ks(i,"label","create-project",'exocortex command create-project <filepath> --label "<value>"'),await s.executeCreateProject(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Gt(i,r,e,`Created project "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"create-area":t.label||ks(i,"label","create-area",'exocortex command create-area <filepath> --label "<value>"'),await s.executeCreateArea(e,t.label,{prototype:t.prototype,area:t.area,parent:t.parent}),Gt(i,r,e,`Created area "${t.label}"`,{label:t.label,prototype:t.prototype,area:t.area,parent:t.parent});break;case"schedule":t.date||ks(i,"date","schedule",'exocortex command schedule <filepath> --date "YYYY-MM-DD"'),await s.executeSchedule(e,t.date),Gt(i,r,e,`Scheduled task for ${t.date}`,{date:t.date});break;case"set-deadline":t.date||ks(i,"date","set-deadline",'exocortex command set-deadline <filepath> --date "YYYY-MM-DD"'),await s.executeSetDeadline(e,t.date),Gt(i,r,e,`Set deadline to ${t.date}`,{date:t.date});break;case"repair-folder":{let a=await s.executeRepairFolder(e);Gt(i,r,e,a.moved?`Moved to correct folder: ${a.newPath}`:"Already in correct folder",{moved:a.moved,oldPath:a.oldPath,newPath:a.newPath,expectedFolder:a.expectedFolder});break}default:await s.execute(r,e,t),Gt(i,r,e,`Executed ${r}`);break}}catch(n){ge.handle(n)}})}o(lS,"commandCommand");var hS=require("path");var mn=Ye(require("fs")),w1=Ye(require("path")),fS=require("events");var I7={watch:mn.default.watch.bind(mn.default),existsSync:mn.default.existsSync.bind(mn.default),statSync:mn.default.statSync.bind(mn.default),readFileSync:mn.default.readFileSync.bind(mn.default)},Nf=class extends fS.EventEmitter{constructor(t,i={}){super();this.watcher=null;this.debounceTimers=new Map;this.isRunning=!1;this.vaultPath=w1.default.resolve(t),this.fsAdapter=i.fsAdapter??I7,this.options={pattern:i.pattern??"**/*.md",assetType:i.assetType??"",debounceMs:i.debounceMs??100,recursive:i.recursive??!0}}static{o(this,"FileSystemWatcher")}start(){this.isRunning||(this.watcher=this.fsAdapter.watch(this.vaultPath,{recursive:this.options.recursive},(t,i)=>{i&&this.handleFileEvent(t,i.toString())}),this.watcher.on("error",t=>{this.emit("error",t)}),this.isRunning=!0,this.emit("started"))}stop(){if(this.isRunning){for(let t of this.debounceTimers.values())clearTimeout(t);this.debounceTimers.clear(),this.watcher&&(this.watcher.close(),this.watcher=null),this.isRunning=!1,this.emit("stopped")}}isWatching(){return this.isRunning}handleFileEvent(t,i){let n=w1.default.join(this.vaultPath,i),s=i;if(!this.matchesPattern(s))return;let a=this.debounceTimers.get(n);a&&clearTimeout(a);let c=setTimeout(()=>{this.debounceTimers.delete(n),this.processFileEvent(n,s)},this.options.debounceMs);this.debounceTimers.set(n,c)}processFileEvent(t,i){let n=this.fsAdapter.existsSync(t),s;if(!n)s="delete";else{let u=this.fsAdapter.statSync(t);s=Date.now()-u.birthtimeMs<1e3?"create":"modify"}let a;if(n&&t.endsWith(".md")&&(a=this.extractAssetType(t)),this.options.assetType&&a!==this.options.assetType)return;let c={type:s,path:t,relativePath:i,timestamp:new Date().toISOString(),assetType:a};this.emit("change",c)}matchesPattern(t){return this.options.pattern?Bt(t,this.options.pattern):!0}extractAssetType(t){try{let n=this.fsAdapter.readFileSync(t,"utf-8").match(/^---\n([\s\S]*?)\n---/);if(!n)return;let a=n[1].match(/exo__Instance_class:\s*(?:\[?"?\[\[([^\]]+)\]\]"?\]?|"?\[\[([^\]]+)\]\]"?)/);return a?a[1]||a[2]:void 0}catch{return}}};var b1=Ye(require("fs"));function dS(){return new _r("watch").description("Watch vault for file changes and emit NDJSON events").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--pattern <glob>","Glob pattern to filter files (e.g., '*.md', 'tasks/**')").option("--asset-type <type>","Filter by asset type (e.g., 'ems__Task', 'ems__Project')").option("--debounce <ms>","Debounce interval in milliseconds","100").action(async r=>{ge.setFormat("json");try{let e=(0,hS.resolve)(r.vault);if(!b1.default.existsSync(e))throw new hn(e);if(!b1.default.statSync(e).isDirectory())throw new rt(`Vault path is not a directory: ${e}`,"Provide a path to a directory, not a file",{vaultPath:e});let t=parseInt(r.debounce?.toString()??"100",10);if(isNaN(t)||t<0)throw new rt("--debounce must be a non-negative integer","Use a positive integer value for debounce",{debounce:r.debounce});let i=new Nf(e,{pattern:r.pattern,assetType:r.assetType,debounceMs:t});i.on("change",s=>{console.log(JSON.stringify(s))}),i.on("error",s=>{let a=lt.error("INTERNAL_OPERATION_FAILED",s.message,5,{recovery:{message:"Check file permissions and vault access",suggestion:"Ensure the vault directory is accessible"}});console.log(JSON.stringify(a))});let n=o(()=>{i.stop(),process.exit(0)},"shutdown");process.on("SIGINT",n),process.on("SIGTERM",n),console.error(`Watching vault: ${e}`),r.pattern&&console.error(`  Pattern filter: ${r.pattern}`),r.assetType&&console.error(`  Asset type filter: ${r.assetType}`),console.error(`  Debounce: ${t}ms`),console.error("Press Ctrl+C to stop"),i.start()}catch(e){ge.handle(e)}})}o(dS,"watchCommand");var E1=require("path"),T1=Ye(Na());var js=Ye(require("path"));var Ja=Ye(Dn());var wi=Ye(Na()),S1=Ye(require("crypto"));var kf=class{constructor(){this.backups=new Map;this.fileHashes=new Map}static{o(this,"TransactionManager")}async begin(e){if(!wi.default.existsSync(e))throw new Error(`Cannot backup non-existent file: ${e}`);let t=await wi.default.readFile(e,"utf-8"),i=S1.default.createHash("sha256").update(t).digest("hex");this.fileHashes.set(e,i);let n=`${e}.backup.${Date.now()}`;await wi.default.writeFile(n,t,"utf-8"),this.backups.set(e,n)}async verify(e){let t=this.fileHashes.get(e);if(!t)return!0;if(!wi.default.existsSync(e))return!1;let i=await wi.default.readFile(e,"utf-8");return S1.default.createHash("sha256").update(i).digest("hex")===t}async commit(){for(let e of this.backups.values())wi.default.existsSync(e)&&await wi.default.remove(e);this.backups.clear(),this.fileHashes.clear()}async rollback(){for(let[e,t]of this.backups.entries())wi.default.existsSync(t)&&(await wi.default.copy(t,e,{overwrite:!0}),await wi.default.remove(t));this.backups.clear(),this.fileHashes.clear()}getTrackedFiles(){return Array.from(this.backups.keys())}};var Ls=class{static{o(this,"BatchExecutor")}constructor(e,t=!1){this.pathResolver=new Ya(e),this.fsAdapter=new Wn(e),this.frontmatterService=new Ja.FrontmatterService,this.transactionManager=new kf,this.dryRun=t}async executeBatch(e,t=!1){let i=Date.now(),n=[],s=0,a=0;if(e.length===0)return{success:!0,total:0,succeeded:0,failed:0,results:[],durationMs:Date.now()-i,atomic:t};if(t&&!this.dryRun)try{await this.backupAllFiles(e)}catch(u){return{success:!1,total:e.length,succeeded:0,failed:e.length,results:e.map(l=>({success:!1,command:l.command,filepath:l.filepath,error:`Backup failed: ${u.message}`})),durationMs:Date.now()-i,atomic:t}}for(let u of e){let l=await this.executeSingleOperation(u);if(n.push(l),l.success)s++;else if(a++,t&&!this.dryRun){await this.transactionManager.rollback();let f=n.length;for(let h=f;h<e.length;h++)n.push({success:!1,command:e[h].command,filepath:e[h].filepath,error:"Not executed due to atomic rollback"}),a++;return{success:!1,total:e.length,succeeded:0,failed:e.length,results:n,durationMs:Date.now()-i,atomic:t,rolledBack:!0}}}return t&&!this.dryRun&&await this.transactionManager.commit(),{success:a===0,total:e.length,succeeded:s,failed:a,results:n,durationMs:Date.now()-i,atomic:t,...t&&{rolledBack:!1}}}static parseInput(e){try{let t=JSON.parse(e);if(!Array.isArray(t))throw new rt("Batch input must be a JSON array of operations",`exo batch --input '[{"command":"start","filepath":"task.md"}]'`);for(let i of t){if(!i.command||typeof i.command!="string")throw new rt('Each operation must have a "command" string property','{"command":"start","filepath":"task.md"}');if(!i.filepath||typeof i.filepath!="string")throw new rt('Each operation must have a "filepath" string property','{"command":"start","filepath":"task.md"}')}return t}catch(t){throw t instanceof rt?t:new rt(`Failed to parse batch input: ${t.message}`,`exo batch --input '[{"command":"start","filepath":"task.md"}]'`)}}async backupAllFiles(e){let t=new Set;for(let i of e){let n=this.pathResolver.resolve(i.filepath);t.add(n)}for(let i of t)await this.transactionManager.begin(i)}async executeSingleOperation(e){try{let t=this.pathResolver.resolve(e.filepath);this.pathResolver.validate(t);let i=t.replace(this.pathResolver.getVaultRoot()+"/","");if(await this.fsAdapter.readFile(i),this.dryRun)return{success:!0,command:e.command,filepath:e.filepath,action:`Would execute ${e.command} (dry-run)`};switch(e.command){case"start":return await this.executeStart(i,e);case"complete":return await this.executeComplete(i,e);case"trash":return await this.executeTrash(i,e);case"archive":return await this.executeArchive(i,e);case"move-to-backlog":return await this.executeStatusUpdate(i,e,"ems__EffortStatusBacklog","Moved to backlog");case"move-to-analysis":return await this.executeStatusUpdate(i,e,"ems__EffortStatusAnalysis","Moved to analysis");case"move-to-todo":return await this.executeStatusUpdate(i,e,"ems__EffortStatusToDo","Moved to todo");case"update-label":return await this.executeUpdateLabel(i,e);case"schedule":return await this.executeSchedule(i,e);case"set-deadline":return await this.executeSetDeadline(i,e);case"repair-folder":return await this.executeRepairFolder(i,e);default:return{success:!1,command:e.command,filepath:e.filepath,error:`Unknown command: ${e.command}`}}}catch(t){return{success:!1,command:e.command,filepath:e.filepath,error:t.message}}}getCurrentTimestamp(){return Ja.DateFormatter.toLocalTimestamp(new Date)}async executeStart(e,t){let i=await this.fsAdapter.readFile(e),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDoing]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_startTimestamp",n),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Started task",changes:{status:"Doing",startTimestamp:n}}}async executeComplete(e,t){let i=await this.fsAdapter.readFile(e),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusDone]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_endTimestamp",n),s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Completed task",changes:{status:"Done",endTimestamp:n,resolutionTimestamp:n}}}async executeTrash(e,t){let i=await this.fsAdapter.readFile(e),n=this.getCurrentTimestamp(),s=this.frontmatterService.updateProperty(i,"ems__Effort_status",'"[[ems__EffortStatusTrashed]]"');return s=this.frontmatterService.updateProperty(s,"ems__Effort_resolutionTimestamp",n),await this.fsAdapter.updateFile(e,s),{success:!0,command:t.command,filepath:t.filepath,action:"Trashed task",changes:{status:"Trashed",resolutionTimestamp:n}}}async executeArchive(e,t){let i=await this.fsAdapter.readFile(e),n=this.frontmatterService.updateProperty(i,"archived","true");return n=this.frontmatterService.removeProperty(n,"aliases"),await this.fsAdapter.updateFile(e,n),{success:!0,command:t.command,filepath:t.filepath,action:"Archived task",changes:{archived:!0,aliasesRemoved:!0}}}async executeStatusUpdate(e,t,i,n){let s=await this.fsAdapter.readFile(e),a=this.frontmatterService.updateProperty(s,"ems__Effort_status",`"[[${i}]]"`);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:n,changes:{status:i.replace("ems__EffortStatus","")}}}async executeUpdateLabel(e,t){let i=t.options?.label;if(!i||i.trim()==="")return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "label"'};let n=i.trim(),s=await this.fsAdapter.readFile(e),a=this.frontmatterService.updateProperty(s,"exo__Asset_label",`"${n}"`);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Updated label to "${n}"`,changes:{label:n}}}async executeSchedule(e,t){let i=t.options?.date;if(!i)return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "date"'};if(!/^\d{4}-\d{2}-\d{2}$/.test(i))return{success:!1,command:t.command,filepath:t.filepath,error:`Invalid date format: ${i}. Expected YYYY-MM-DD`};let n=await this.fsAdapter.readFile(e),s=Ja.DateFormatter.toTimestampAtStartOfDay(i),a=this.frontmatterService.updateProperty(n,"ems__Effort_scheduledTimestamp",s);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Scheduled for ${i}`,changes:{scheduledTimestamp:s}}}async executeSetDeadline(e,t){let i=t.options?.date;if(!i)return{success:!1,command:t.command,filepath:t.filepath,error:'Missing required option: "date"'};if(!/^\d{4}-\d{2}-\d{2}$/.test(i))return{success:!1,command:t.command,filepath:t.filepath,error:`Invalid date format: ${i}. Expected YYYY-MM-DD`};let n=await this.fsAdapter.readFile(e),s=Ja.DateFormatter.toTimestampAtStartOfDay(i),a=this.frontmatterService.updateProperty(n,"ems__Effort_deadlineTimestamp",s);return await this.fsAdapter.updateFile(e,a),{success:!0,command:t.command,filepath:t.filepath,action:`Set deadline to ${i}`,changes:{deadlineTimestamp:s}}}async executeRepairFolder(e,t){let n=(await this.fsAdapter.getFileMetadata(e))?.exo__Asset_isDefinedBy;if(!n)return{success:!1,command:t.command,filepath:t.filepath,error:"Cannot determine expected folder: missing exo__Asset_isDefinedBy"};let s=this.extractReference(n);if(!s)return{success:!1,command:t.command,filepath:t.filepath,error:"Cannot determine expected folder: invalid exo__Asset_isDefinedBy format"};let a=await this.findReferencedFile(s,e);if(!a)return{success:!1,command:t.command,filepath:t.filepath,error:`Cannot determine expected folder: referenced asset not found: ${s}`};let c=js.default.dirname(a),u=c==="."?"":c,l=js.default.dirname(e),f=l==="."?"":l;if(this.normalizePath(f)===this.normalizePath(u))return{success:!0,command:t.command,filepath:t.filepath,action:"Already in correct folder",changes:{moved:!1,folder:u||"(root)"}};let h=js.default.basename(e),d=u?`${u}/${h}`:h;return await this.fsAdapter.fileExists(d)?{success:!1,command:t.command,filepath:t.filepath,error:`Cannot move file: ${d} already exists`}:(await this.fsAdapter.renameFile(e,d),{success:!0,command:t.command,filepath:t.filepath,action:`Moved to ${u||"(root)"}`,changes:{moved:!0,oldPath:e,newPath:d,expectedFolder:u||"(root)"}})}extractReference(e){if(typeof e!="string")return null;let t=e.trim().replace(/^["']|["']$/g,"");return t=t.replace(/^\[\[|\]\]$/g,""),t||null}async findReferencedFile(e,t){let i=e.endsWith(".md")?e:`${e}.md`;if(e.includes("/")&&await this.fsAdapter.fileExists(i))return i;let n=js.default.dirname(t),s=n!=="."?`${n}/${i}`:i;if(await this.fsAdapter.fileExists(s))return s;let c=await this.fsAdapter.findFileByUID(e);return c||(await this.fsAdapter.getMarkdownFiles()).find(f=>{let h=js.default.basename(f,".md"),d=js.default.basename(i,".md");return h===d})||null}normalizePath(e){return e.replace(/\\/g,"/").replace(/^\.\//,"").replace(/\/$/,"")}};function R7(r,e){if(r==="json"){let t=lt.success(e,{durationMs:e.durationMs,itemCount:e.total});console.log(JSON.stringify(t,null,2))}else{if(console.log(`
\u{1F4E6} Batch Execution ${e.success?"Complete":"Failed"}`),console.log(`   Total: ${e.total} operations`),console.log(`   \u2705 Succeeded: ${e.succeeded}`),console.log(`   \u274C Failed: ${e.failed}`),console.log(`   \u23F1\uFE0F  Duration: ${e.durationMs}ms`),e.atomic&&console.log(`   \u{1F512} Atomic mode: ${e.rolledBack?"Rolled back":"Committed"}`),e.failed>0){console.log(`
\u{1F4CB} Failed Operations:`);for(let t of e.results.filter(i=>!i.success))console.log(`   \u274C ${t.command} ${t.filepath}: ${t.error}`)}if(e.succeeded>0&&r==="text"){console.log(`
\u{1F4CB} Successful Operations:`);for(let t of e.results.filter(i=>i.success))console.log(`   \u2705 ${t.command} ${t.filepath}: ${t.action}`)}}}o(R7,"outputResult");function pS(){return new _r("batch").description("Execute multiple operations in a single CLI invocation").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--input <json>","JSON array of operations to execute").option("--file <path>","Path to JSON file containing operations").option("--atomic","All-or-nothing execution (rollback on any failure)").option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").action(async r=>{let e=r.format||"text";ge.setFormat(e);try{let t=(0,E1.resolve)(r.vault),i;if(r.input)i=r.input;else if(r.file){let c=(0,E1.resolve)(r.file);if(!T1.default.existsSync(c))throw new rt(`Batch file not found: ${c}`,"exocortex batch --file operations.json");i=await T1.default.readFile(c,"utf-8")}else throw new rt("Either --input or --file option is required",`exocortex batch --input '[{"command":"start","filepath":"task.md"}]' or exocortex batch --file operations.json`);let n=Ls.parseInput(i);if(n.length===0)throw new rt("Batch input contains no operations",`exocortex batch --input '[{"command":"start","filepath":"task.md"}]'`);let a=await new Ls(t,r.dryRun).executeBatch(n,r.atomic);R7(e,a),process.exit(a.success?0:5)}catch(t){ge.handle(t)}})}o(pS,"batchCommand");var mS=require("path");function D7(r,e){if(r==="json"){let t=lt.success(e,{durationMs:e.durationMs,itemCount:e.total});console.log(JSON.stringify(t,null,2))}else{if(console.log(`
\u{1F4E6} Batch Repair ${e.success?"Complete":"Completed with Errors"}`),console.log(`   Total files: ${e.total}`),console.log(`   \u{1F4C1} Moved: ${e.movedCount}`),console.log(`   \u2705 Already correct: ${e.alreadyCorrectCount}`),console.log(`   \u274C Errors: ${e.errorCount}`),console.log(`   \u23F1\uFE0F  Duration: ${e.durationMs}ms`),e.errorCount>0){console.log(`
\u{1F4CB} Failed Files:`);for(let t of e.results.filter(i=>!i.success))console.log(`   \u274C ${t.filepath}: ${t.error}`)}if(e.movedCount>0&&r==="text"){console.log(`
\u{1F4CB} Moved Files:`);for(let t of e.results.filter(i=>i.success&&i.changes?.moved))console.log(`   \u{1F4C1} ${t.filepath} \u2192 ${t.changes?.newPath}`)}}}o(D7,"outputResult");function gS(){return new _r("batch-repair").description("Batch repair folder locations for all markdown files in a directory").argument("<directory>","Directory to process (relative to vault root)").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--dry-run","Preview changes without modifying files").option("--format <type>","Output format: text|json (default: text)","text").option("--progress","Show progress during processing (default: true)",!0).option("--no-progress","Disable progress output").action(async(r,e)=>{let t=e.format||"text";ge.setFormat(t);try{let i=(0,mS.resolve)(e.vault),n=new Wn(i),s=r;if(!await n.directoryExists(s))throw new rt(`Directory not found: ${s}`,"exocortex batch-repair <existing-directory>");let c=await n.getMarkdownFiles(s);if(c.length===0){if(t==="json"){let O=lt.success({success:!0,total:0,movedCount:0,alreadyCorrectCount:0,errorCount:0,results:[],durationMs:0,atomic:!1});console.log(JSON.stringify(O,null,2))}else console.log(`
\u{1F4C2} No markdown files found in ${s}`);process.exit(0)}let u=c.map(O=>({command:"repair-folder",filepath:O})),l=e.progress!==!1&&t==="text",f=0;l&&console.log(`
\u{1F50D} Processing ${c.length} files in ${s}...`);let d=await new Ls(i,e.dryRun).executeBatch(u,!1),g=0,w=0,b=0;for(let O of d.results)if(O.success?O.changes?.moved?g++:w++:b++,l&&!e.dryRun){f++;let F=Math.round(f/c.length*100);process.stdout.write(`\r   Processing ${f}/${c.length} (${F}%)...`)}l&&process.stdout.write("\r"+" ".repeat(60)+"\r");let x={...d,movedCount:g,alreadyCorrectCount:w,errorCount:b};D7(t,x),process.exit(x.success?0:5)}catch(i){ge.handle(i)}})}o(gS,"batchRepairCommand");var jf=require("fs"),bi=require("path");function yS(){return new _r("resolve").description("Resolve UUID to file path").argument("<uuid>","Full or partial UUID to resolve").option("--vault <path>","Path to Obsidian vault",process.cwd()).option("--format <type>","Output format: uri|path|json (default: uri)","uri").option("--output <type>","Response format: text|json (for MCP tools)","text").option("--partial","Match partial UUIDs (returns all matches)").action(async(r,e)=>{let t=e.output||"text";ge.setFormat(t);try{let i=Date.now();if(!N7(r))throw new rt(`Invalid UUID format: ${r}`,"exocortex resolve <uuid> [--format uri|path|json] [--partial]",{uuid:r});let n=(0,bi.resolve)(e.vault);if(!(0,jf.existsSync)(n))throw new hn(n);let s=k7(n,r,e.partial??!1),a=Date.now()-i;if(s.length===0){if(t==="json"){let c=lt.error("VALIDATION_FILE_NOT_FOUND",`UUID not found: ${r}`,3,{context:{uuid:r}});console.log(JSON.stringify(c,null,2))}else console.error(`UUID not found: ${r}`);process.exit(1)}e.partial||s.length>1?L7(s,n,e.format,t,r,a):j7(s[0],n,e.format,t,r,a)}catch(i){ge.handle(i)}})}o(yS,"resolveCommand");function N7(r){if(r.length<4)return!1;let e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,t=/^[0-9a-f-]+$/i;return e.test(r)||t.test(r)}o(N7,"isValidUuidFormat");function k7(r,e,t){let i=[],n=e.toLowerCase();function s(a){let c=(0,jf.readdirSync)(a,{withFileTypes:!0});for(let u of c){let l=(0,bi.join)(a,u.name);if(u.isDirectory())!u.name.startsWith(".")&&u.name!=="node_modules"&&s(l);else if(u.isFile()&&u.name.endsWith(".md")){let f=u.name.toLowerCase();t?f.includes(n)&&i.push(l):(f.startsWith(n+".md")||f.startsWith(n+" ")||f.startsWith(n+"-"))&&i.push(l)}}}return o(s,"walk"),s(r),i}o(k7,"findFilesWithUuid");function vS(r){return`obsidian://vault/${encodeURI(r)}`}o(vS,"pathToObsidianUri");function _S(r){let e=r.match(/^([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/i);return e?e[1]:(0,bi.basename)(r,".md")}o(_S,"extractUuidFromFilename");function j7(r,e,t,i,n,s){let a=(0,bi.relative)(e,r),c=vS(a),u=_S((0,bi.basename)(r));if(i==="json"){let l={uuid:u,path:a,absolutePath:r,uri:c},f=lt.success(l,{durationMs:s,searchUuid:n});console.log(JSON.stringify(f,null,2))}else switch(t){case"path":console.log(r);break;case"json":console.log(JSON.stringify({uuid:u,path:a,absolutePath:r,uri:c},null,2));break;case"uri":default:console.log(c);break}}o(j7,"outputSingleResult");function L7(r,e,t,i,n,s){let a=r.map(c=>{let u=(0,bi.relative)(e,c),l=vS(u);return{uuid:_S((0,bi.basename)(c)),path:u,absolutePath:c,uri:l}});if(i==="json"){let c=lt.success({matches:a,count:a.length},{durationMs:s,searchUuid:n,itemCount:a.length});console.log(JSON.stringify(c,null,2))}else switch(t){case"path":for(let c of a)console.log(c.absolutePath);break;case"json":console.log(JSON.stringify(a,null,2));break;case"uri":default:for(let c of a)console.log(c.uri);break}}o(L7,"outputMultipleResults");var Hn=new _r;Hn.name("exocortex").description("CLI tool for Exocortex knowledge management system").version("0.1.0");Hn.command("sparql").description("SPARQL query execution").addCommand(ib());Hn.addCommand(lS());Hn.addCommand(dS());Hn.addCommand(pS());Hn.addCommand(gS());Hn.addCommand(yS());Hn.parse();
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

tslib/tslib.es6.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT *)
*/
